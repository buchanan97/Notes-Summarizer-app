think dsp digital signal processing python version dsp digital signal processing python version allen downey green tea press needham massachusettscopyright c allen downey green tea press washburn ave needham ma permission granted copy distribute modify document term creative common international license available http latex source book available http signal processing favorite topic useful area science engineering understand fundamental idea provides insight thing world especially thing hear unless studied electrical mechanical engineering probably chance learn signal processing problem book class use present material starting mathematical abstraction like phasors tend theoretical application little apparent relevance premise book know program use skill learn thing fun doing approach present important idea right away end rst chapter analyze sound recording signal generate new sound chapter introduces new technique application apply real signal step learn use technique rst work approach practical hope agree fun book example supporting code book python know core python familiar feature using object ning familiar python want start book think python introduction python people programmed mark lutz learning python better people programming chapter preface use numpy scipy extensively familiar great explain function data structure use assume reader know basic mathematics including complex bers need calculus understand concept gration di erentiation use linear algebra explain using code code sound sample used book available http git version control allows track le make project collection le git control called github hosting service provides storage git repository convenient web interface github homepage repository provides way work code create copy repository github pressing fork button github account need create forking repository github use track code write working book clone repo mean copy le computer clone repository need github account wo able write change github want use git download le zip le using button corner github page code written work python python translation developed book using anaconda continuum analytics free python distribution includes package need run code lot anaconda easy install default doe installation need administrative privilege support python python download anaconda http want use anaconda need following using code vii basic numerical computation http scienti c computation http visualization http commonly used package included python installation hard install environment trouble installing recommend using anaconda python distribution include package exercise use python script use jupyter notebook used jupyter read http way work jupyter notebook run jupyter computer installed anaconda probably got jupyter default check start server command line like jupyter notebook installed install anaconda like conda install jupyter start server launch default web browser create new tab open browser window run jupyter binder binder service run jupyter tual machine follow link http jupyter home page notebook book supporting data script run script modify run code virtual machine run temporary change make disappear virtual machine leave idle hour view notebook nbviewer refer notebook later book provide link nbviewer provides static view code result use link read notebook listen example wo able modify run code use interactive widget good luck fun viii chapter preface contributor list suggestion correction send email downey make change based feedback add contributor list unless ask omitted include sentence error appears make easy search page section number ne easy work thanks started writing thought book bene ted sations boulos harb google aurelio ramos harmonix music system fall semester nathan lintz ian daniher worked independent study project helped rst draft book reddit dsp forum anonymous user ramjetsoundwave helped x problem implementation brownian noise andodli typo spring pleasure teaching material oscar siddhartan govindasamy suggestion correction gyger corrected arithmetic error masetti sent number helpful suggestion peter sent helpful suggestion special thanks freesound source sound sample use book freesound user uploaded sound include wave le github repository book using original le name easy nd source unfortunately freesound user make real name available thank using user name sample used book tributed freesound user iluppai wc thirsk docquesting kleeb landup themusicalnomad bcjordan rockwehrmann jcveliz thank content preface v book v using code vi sound signal periodic signal spectral decomposition signal reading writing wave spectrum wave object signal object exercise harmonic triangle wave square wave aliasing computing spectrum exercise content signal linear chirp exponential chirp spectrum chirp spectrogram gabor limit leakage windowing implementing spectrogram exercise noise uncorrelated noise integrated spectrum brownian noise pink noise gaussian noise exercise autocorrelation correlation serial correlation autocorrelation autocorrelation periodic signal correlation dot product using numpy exercise xi discrete cosine transform synthesis synthesis array analysis orthogonal matrix inverse dct dct class exercise discrete fourier transform complex exponential complex signal synthesis problem synthesis matrix analysis problem analysis dft dft periodic dft real signal exercise filtering convolution smoothing convolution frequency domain convolution theorem gaussian lter content convolution autocorrelation exercise di erentiation integration finite di erences frequency domain di erentiation integration cumulative sum integrating noise exercise lti system signal system window lters acoustic response system convolution proof convolution theorem exercise modulation sampling convolution impulse amplitude modulation sampling aliasing interpolation exercise sound signal asignal represents quantity varies time nition pretty abstract let start concrete example sound sound variation air pressure sound signal represents variation air pressure time microphone device measure variation generates electrical signal represents sound speaker device take electrical signal produce sound microphone speaker called transducer transduce convert signal form book signal processing includes process synthesizing transforming analyzing signal focus sound signal method apply electronic signal mechanical vibration signal domain apply signal vary space time like elevation hiking trail apply signal dimension like image think signal varies space movie signal varies space time start simple sound code chapter repository book section view http chapter sound signal time s figure segment recording bell periodic signal start periodic signal signal repeat period time example strike bell vibrates generates sound record sound plot transduced signal look like figure signal resembles sinusoid mean shape trigonometric sine function signal periodic chose duration repetition known cycle duration cycle called period thefrequency signal number cycle second inverse period unit frequency cycle second hertz abbreviated strictly speaking number cycle dimensionless number hertz really second frequency signal hz slightly lower hz standard tuning pitch orchestral music musical note speci cally familiar c pitch notation numerical indicates octave note middle octave higher http tuning fork generates sinusoid vibration tine form simple harmonic motion musical instrument produce periodic signal shape signal sinusoidal example figure spectral decomposition time s figure segment recording violin segment recording violin playing boccherini string quintet e movement signal periodic shape signal complex shape periodic signal called waveform musical instrument produce waveform complex sinusoid shape waveform determines musical timbre perception quality sound people usually perceive complex waveform rich warm interesting sinusoid spectral decomposition important topic book spectral decomposition idea signal expressed sum sinusoid di erent frequency important mathematical idea book discrete fourier transform ordft take signal produce spectrum spectrum set sinusoid add produce signal important algorithm book fast fourier form orfft way compute dft example figure show spectrum violin recording ure range frequency make signal show strength amplitude frequency chapter sound signal frequency hz figure spectrum segment violin recording lowest frequency component called fundamental frequency fundamental frequency signal near hz actually little lower signal fundamental frequency largest amplitude dominant frequency normally perceived pitch sound determined fundamental frequency dominant spike spectrum frequency integer multiple fundamental component called harmonic musically harmonious fundamental frequency octave higher fundamental octave doubling frequency approximately perfect fth familiar musical interval like perfect fth http music octave fundamental approximately c major harmonic make note major chord octave approximate note make western music adjusted equal temperament http given harmonic amplitude reconstruct signal adding sinusoid signal signal wrote python module called contains class tions working signal nd repository book section represent signal thinkdsp provides class called signal parent class signal type including sinusoid represents sine cosine signal thinkdsp provides function create sine cosine signal freq frequency hz ampis amplitude unspeci ed unit ned largest amplitude record play offset aphase o set radian phase o set determines period signal start example sine signal start sin start sin signal method use add mix result sumsignal represents sum signal signal basically python representation mathematical function signal ned value t negative nity nity ca signal evaluate context ate mean taking sequence point time t computing sponding value signal y represent tsandysusing numpy array encapsulate object called wave wave represents signal evaluated sequence point time point time called frame term borrowed movie video measurement called sample used interchangeably signal provides return new wave object wave plural written prefer use standard english plural familiar hope choice doe sound chapter sound signal time s figure segment mixture sinusoid signal duration length wave second start start time second framerate integer number frame second number sample second frame second framerates commonly used audio le format including waveform audio file wav example evaluates signal frame half time frame timestep second wave provides plot method us pyplot plot wave like pyplot matplotlib included python distribution install period second plot look like solid block color zoom small number period use segment copy segment wave return new wave period segment period property signal return period second start andduration second example copy rst period frommix result wave reading writing wave plot segment look like figure signal contains frequency component complicated signal tuning fork complicated violin reading writing wave thinkdsp provides read wav le return wave andwave provides write writes wav le listen wave medium player play wav le unix system use aplay simple robust included linux distribution thinkdsp provides run medium player cess aplay usesaplay default provide player spectrum wave provides return spectrum spectrum andspectrum provides plot spectrum provides method modify spectrum applies lter mean component given cuto frequency attenuated reduced magnitude factor applies lter mean attenuates component cuto attenuates component band frequency cuto example attenuates frequency chapter sound signal wave spectrum signal figure relationship class thinkdsp low pas lter remove bright sound result sound darker hear sound like convert spectrum wave play wave theplay method writes wave le play use jupyter notebook use make audio widget play sound wave object complicated function provides wrapper function numpy scipy primary class thinkdsp signal wave spectrum given signal make wave given wave make spectrum vice versa relationship shown figure wave object contains attribute ysis numpy array contains value signal tsis array time signal evaluated sampled framerate number sample unit time unit time usually second doe example day wave provides property start end andduration modify t property change accordingly modify wave access tsandysdirectly example rst line scale wave factor making louder second line shift wave time making start second later wave provides method perform common operation example transformation signal object read documentation method http signal object signal parent class provides function common kind signal child class inherit method provide evaluate evaluates signal given sequence time example sinusoid child class signal nition class sinusoid signal def self self freq amp offset func parameter frequency cycle second hz amplitude unit amplitude arbitrary usually chosen corresponds maximum input microphone maximum output speaker indicates period signal start offset unit radian reason explain python function used evaluate signal particular point time usually yielding sine cosine signal like init method just tuck parameter away future use signal provides look like chapter sound signal def self n round duration framerate t start n framerate y t return wave y t start andduration start time duration second framerate number frame sample second ni number sample tsis numpy array sample time compute y invokesevaluate provided sinusoid def evaluate self t phase t y phase return y let unwind function step time frequency cycle second element tsis time second product number cycle start time constant store multiplying cycle phase think phase start time expressed radian cycle phase tists e ect shifting signal left right time result value multiplying yield signal range math notation evaluate written like whereais amplitude fis frequency ti time phase o set like wrote lot code evaluate simple expression code provides framework dealing kind signal just exercise exercise begin exercise download code book following instruction section solution exercise exercise jupyter load read run example view notebook http exercise tohttp download sound sample includes music speech sound ned pitch select roughly segment pitch constant compute plot spectrum segment selected connection make timbre sound harmonic structure spectrum lter harmonic convert spectrum wave listen doe sound relate change spectrum exercise synthesize compound signal creating sinsignal nal object adding evaluate signal wave listen compute spectrum plot happens add frequency component multiple fundamental exercise write function called stretch take wave stretch factor speed slows wave modifying tsandframerate hint line chapter sound signalschapter harmonic chapter present new waveform look spectrum understand harmonic structure set sinusoid introduce important phenomenon digital signal cessing aliasing explain little spectrum class work code chapter repository book section view http triangle wave sinusoid contains frequency component spectrum peak complicated waveform like violin recording yield dfts peak section investigate relationship waveform spectrum start triangle waveform like version sinusoid figure show triangle waveform frequency hz generate triangle wave use class trianglesignal sinusoid def evaluate self t cycle t chapter harmonic time s figure segment triangle signal hz frac cycle y frac y normalize unbias y return y trianglesignal fromsinusoid take guments freq amp andoffset di erence evaluate saw tsis sequence sample time want evaluate signal way generate triangle wave detail tant evaluate work number cycle start time split number cycle fraction stored frac integer sequence ramp given frequency subtracting yield value taking absolute value yield waveform shift waveform centered normalize scale given amplitude amp code generates figure signal triangle wave frequency hz frequency hz figure spectrum triangle signal hz shown vertical scale version right cut o fundamental harmonic clearly use signal make wave use wave make spectrum wave spectrum figure show view result view right scaled harmonic clearly expected highest peak fundamental frequency hz additional peak harmonic frequency integer multiple surprise peak multiple harmonic triangle wave odd multiple fundamental frequency example feature spectrum relationship amplitude frequency harmonic amplitude drop o proportion frequency squared example frequency ratio rst harmonic hz amplitude ratio approximately frequency ratio harmonic hz amplitude ratio approximately relationship called harmonic structure underscore variable convention mean intend use value chapter harmonic time s figure segment square signal hz square wave thinkdsp provides squaresignal represents square signal class nition class squaresignal sinusoid def evaluate self t cycle t frac cycle y unbias frac return y liketrianglesignal squaresignal fromsinusoid take parameter evaluate method similar cycle number cycle start time frac fractional ramp period unbias shiftsfrac ramp map ative value positive value multiplying ampyields square wave jump andamp figure show period square wave frequency hz figure show spectrum like triangle wave square wave contains odd harmonic peak hz amplitude aliasing frequency hz figure spectrum square signal hz harmonic drop o slowly speci cally amplitude drop proportion frequency frequency squared exercise end chapter chance explore waveform harmonic structure aliasing confession chose example previous section carefully avoid showing confusing time confused figure show spectrum triangle wave hz sampled frame second view right scaled harmonic harmonic wave hz gure peak hz expected peak hz fourth peak hz look closely peak actually hz going problem evaluate signal discrete point time lose information happened sample low frequency component problem lot sample period sample signal hz frame second sample period turn just barely frequency higher chapter harmonic frequency hz frequency hz figure spectrum triangle signal hz sampled frame second view right scaled harmonic let generate cosine signal hz sample frame second framerate signal duration segment duration signal segment duration figure show result plotted signal gray line sample using vertical line make easier compare wave problem clear signal di erent wave identical sample hz signal frame second result indistinguishable hz signal reason hz signal indistinguishable hz hz indistinguishable hz e ect called aliasing high frequency signal pled appears low frequency signal example highest frequency measure hz half sampling rate frequency hz folded computing spectrum time s figure cosine signal hz sampled frame second signal di erent sample identical threshold called frequency called nyquist frequency seehttp folding pattern continues aliased frequency go zero example harmonic hz triangle wave hz folded hz appear hz get folded hz hz fact small peak hz figure hz computing spectrum seen wave method time implementation leaving detail later import rfft rfftfreq class wave def self n len chapter harmonic d h rfft f rfftfreq n d return spectrum h f parameter self wave object ni number sample wave anddis inverse frame rate time sample numpy module provides function related fast fourier transform fft algorithm computes discrete fourier transform dft usesrfft stand fft wave contains real value complex later fft handle complex signal result rfft h numpy array complex number represents amplitude phase o set frequency component wave result rfftfreq f array contains frequency corresponding h understand value h consider way think plex number complex number sum real imaginary whereiis imaginary unit think x andyas cartesian coordinate complex number product magnitude complex exponential aei whereais magnitude angle radian called think aand polar coordinate value hscorresponds frequency component magnitude proportional amplitude corresponding component angle phase o set spectrum class provides property amp andangles return numpy array representing magnitude angle h plot spectrum object usually plot amp versusfs useful plot angle versusfs tempting look real imaginary part h need encourage think dft exercise vector amplitude phase o set happen encoded form complex number modify spectrum access hsdirectly example cutoff rst line multiple element hsby double amplitude component second line set element hswhere corresponding frequency exceeds cuto frequency spectrum provides method perform operation cutoff read documentation method http point better idea signal wave trum class work explained fast fourier transform work chapter exercise solution exercise exercise use jupyter load try ples view notebook http exercise sawtooth signal waveform ramp linearly drop repeat http write class called sawtoothsignal extends signal provides evaluate evaluate sawtooth signal compute spectrum sawtooth wave doe harmonic structure compare triangle square wave exercise make square signal hz make wave sample frame second plot spectrum harmonic aliased listen wave hear aliased harmonic chapter harmonic exercise spectrum object spectrum print rst value start zero magnitude component frequency doe mean try experiment make triangle signal frequency make wave tion second plot waveform make spectrum object print plitude phase component make wave modi ed spectrum plot e ect doe operation waveform exercise write function take spectrum parameter modi e dividing element hsby corresponding frequency fromfs hint division zero unde ned want set test function using square triangle sawtooth wave compute spectrum plot modify spectrum using function plot make wave modi ed spectrum listen e ect doe operation signal exercise triangle square wave odd harmonic tooth wave odd harmonic harmonic square sawtooth wave drop o proportion harmonic gle wave drop o like nd waveform odd harmonic drop o like hint way approach construct signal want adding sinusoid start signal similar want modify signal signal worked far periodic mean repeat forever mean frequency component contain change time chapter consider signal frequency component dochange time word pretty sound signal chapter present spectrogram common way visualize periodic signal code chapter repository book section view http linear chirp start chirp signal variable frequency thinkdsp provides signal called chirp make sinusoid sweep linearly range frequency example sweep hz octave signal wave figure show segment wave near beginning middle end clear frequency increasing let chirp implemented class chapter signal time s figure chirp waveform near beginning middle end class chirp signal def self start end amp start andendare frequency hz start end chirp ampis amplitude function evaluates signal def evaluate self t freqs len t dts t dphis freqs dts phase dphis y phase return y tsis sequence point time signal evaluated function simple assume compute frequency point time use return numpy array nvalues start andend computes di erence adjacent element t returning length interval second element tsare equally spaced thedtsare exponential chirp step gure phase change interval section saw frequency constant phase increase linearly time frequency function time change phase short time interval t python freqs containsf t anddtscontains time interval write dphis freqs dts dphis contains change phase total phase timestep adding change phase dphis phase phase computes cumulative sum want doe start use add beginning result numpy array ith element contains sum rstiterms dphis total phase end ith interval finally computes amplitude wave function phase remember phase expressed radian know calculus notice limit tgets small d t dt dividing dtyields d t word frequency derivative phase conversely phase integral frequency used cumsum frequency phase approximating integration exponential chirp listen chirp notice pitch rise quickly rst slows chirp span octave take s span rst octave twice long span chapter signal reason perception pitch depends logarithm quency result interval hear note depends ratio frequency di erence musical term perceived di erence pitch example octave interval ratio pitch interval octave interval octave di erence frequency bigger ratio result frequency increase linearly linear chirp perceived pitch increase logarithmically want perceived pitch increase linearly frequency crease exponentially signal shape called exponential chirp code make class expochirp chirp def evaluate self t start end freqs start end len t return t freqs instead version evaluate us creates series frequency logarithm equally spaced mean increase exponentially chirp code make signal wave listen example compare linear exponential chirp spectrum chirp think happens compute spectrum chirp example construct chirp spectrum signal wave spectrum spectrogram frequency hz figure spectrum chirp figure show result spectrum component frequency hz variation look little like eye sauron seehttp spectrum approximately hz indicates signal spends equal time frequency range based observation able guess spectrum exponential chirp look like spectrum give hint structure signal obscures relationship frequency time example tell looking spectrum frequency went spectrogram recover relationship frequency time break chirp segment plot spectrum segment result called fourier transform stft way visualize stft common trogram show time frequency column spectrogram show spectrum short segment using color grayscale represent amplitude example compute spectrogram chirp signal wave chapter signal time s hz figure spectrogram chirp wave provides return spectrogram object spectrogram number sample segment chose fft number sample power figure show result show time second show frequency hz cut o spectrogram range go hz half framerate spectrogram show clearly frequency increase linearly time similarly spectrogram exponential chirp shape exponential curve notice peak column blurred cell blurring ect limited resolution spectrogram gabor limit thetime resolution spectrogram duration segment corresponds width cell spectrogram segment frame frame second duration segment second thefrequency resolution frequency range element spectrum corresponds height cell frame leakage frequency component range hz range component hz generally ni segment length spectrum contains nents framerate r maximum frequency spectrum time resolution frequency resolution ideally like time resolution small rapid change frequency like frequency resolution small small change frequency ca notice time resolution inverse frequency resolution get smaller get bigger example double segment length cut frequency resolution half good double time resolution bad increasing framerate doe help sample range frequency increase time tradeo called gabor limit fundamental limitation kind analysis leakage order explain work explain ing order explain windowing problem meant address leakage discrete fourier transform dft use compute spectrum treat wave periodic assumes nite segment operates complete period nite signal repeat time practice assumption false creates problem common problem discontinuity beginning end segment dft assumes signal periodic implicitly connects end segment beginning make loop end doe connect smoothly beginning discontinuity creates additional frequency component segment signal example let start sine signal contains frequency component chapter signal frequency hz figure spectrum periodic segment sinusoid left segment middle windowed segment right signal select segment happens integer multiple period end segment connects smoothly beginning dft behaves duration wave duration spectrum figure left show result expected single peak hz duration multiple period bad thing happen duration signal start end figure middle show spectrum segment peak hz additional component spread hz spread called spectral leakage energy actually fundamental frequency leak frequency example leakage happens using dft segment discontinuous treat windowing time s figure segment sinusoid hamming window middle product segment window windowing reduce leakage smoothing discontinuity ning end segment way windowing function designed transform segment pas periodic figure show segment end doe connect smoothly beginning figure middle show window common window function window function perfect shown optimal di erent application hamming good window figure show result multiplying window original signal window close signal unchanged window close signal attenuated window taper end end segment connects smoothly beginning figure right show spectrum windowed signal windowing reduced leakage substantially chapter signal time s figure overlapping hamming window code look like wave provideswindow applies ming window class wave def window self window window numpy provides hamming computes hamming window given length window len wave window numpy provides function compute window function including bartlett blackman hanning andkaiser exercise end chapter asks experiment window implementing spectrogram understand windowing understand implementation spectrogram wave method computes spectrogram class wave def self window j step implementing spectrogram j len segment j window t t step j step return spectrogram longest function book handle handle parameter self wave object number sample segment window hamming window length segment iandjare slice index select segment wave step o set segment step half segment overlap half figure show overlapping window look like dictionary map timestamp spectrum inside loop select slice wave apply window construct spectrum object add nominal time segment t midpoint advance iandj continue long jdoes past end wave finally method construct return spectrogram tion spectrogram class spectrogram object def self like init method just store parameter attribute spectrogram provides plot generates pseudocolor plot time frequency spectrogram chapter signal exercise solution exercise exercise run listen example repository book available http leakage example try replacing hamming window window provided numpy e ect leakage http exercise write class called sawtoothchirp extends chirp override evaluate generate sawtooth waveform frequency crease decrease linearly hint combine evaluate function chirp andsawtoothsignal draw sketch think spectrogram signal look like plot e ect aliasing visually apparent listen carefully hear exercise make sawtooth chirp sweep hz use make wave duration s framerate khz draw sketch think spectrum look like plot spectrum got right exercise musical terminology note slide pitch similar chirp make recording glissando plot spectrogram rst second suggestion george gershwin rhapsody blue start famous clarinet glissando download http exercise trombone player play glissando extending bone slide blowing continuously slide extends total length tube get longer resulting pitch inversely proportional length assuming player move slide constant speed doe quency vary time write class called trombonegliss extends chirp provides evaluate make wave simulates trombone glissando hz exercise plot spectrogram resulting wave trombone glissando like linear exponential chirp exercise make nd recording series vowel sound look spectrogram identify di erent vowel chapter signalschapter noise english mean unwanted unpleasant sound context signal processing di erent sens english mean unwanted signal kind signal interfere signal consider noise refers signal contains component quencies lack harmonic structure periodic signal saw previous chapter chapter second kind code chapter repository book section view http uncorrelated noise simplest way understand noise generate simplest kind generate uncorrelated uniform noise uu noise mean signal contains random value uniform distribution value range equally likely mean value independent knowing value provides information class represents uu chapter noise time s figure waveform uncorrelated uniform noise class uncorrelateduniformnoise def evaluate self t y len t return y uncorrelateduniformnoise inherits inherits signal usual evaluate function take t time signal evaluated us generates value uniform distribution example value range toamp following example generates uu noise duration second sample second signal wave play wave sound like static hear tune radio tween channel figure show waveform look like expected look pretty random let look spectrum spectrum similar plot power instead amplitude power square amplitude switching amplitude power chapter conventional context uncorrelated noise frequency hz figure power spectrum uncorrelated uniform noise figure show result like signal spectrum look pretty random fact israndom precise word thing like know noise signal spectrum distribution random signal set possible value probability example uniform noise signal set value range value probability alternative gaussian noise set value range negative positive nity value near likely probability drop o according gaussian curve value signal independent dependency uu noise value dent alternative brownian noise value sum previous value random value signal high particular point time expect stay high low expect stay low power frequency spectrum uu noise power frequency drawn distribution average power frequency alternative pink noise power inversely related frequency power frequency fis drawn distribution mean proportional chapter noise frequency hz fraction total power figure integrated spectrum uncorrelated uniform noise integrated spectrum uu noise relationship power frequency clearly looking integrated spectrum function quency f show cumulative power spectrum spectrum provides method computes integratedspectrum def self c c c return integratedspectrum c numpy array containing power frequency computes cumulative sum power dividing element normalizes integrated spectrum run result integratedspectrum class nition class integratedspectrum object def self c f c f like spectrum integratedspectrum provides compute plot integrated spectrum like integ result shown figure straight line indicates power frequency constant average noise equal power brownian noise time s figure waveform brownian noise quencies called white noise analogy light equal mixture light visible frequency white brownian noise uu noise uncorrelated mean value doe depend alternative brownian noise value sum previous value random called analogy brownian motion particle suspended uid move apparently random unseen interaction uid brownian motion described using random walk mathematical model path distance step characterized random distribution random walk particle move random time step location particle point time sum previous step observation suggests way generate brownian noise generate related random step add class nition implement algorithm class browniannoise def evaluate self t dy len t chapter noise frequency hz frequency hz figure spectrum brownian noise linear scale left scale right y dy y normalize unbias y return y evaluate generate uncorrelated signal compute cumulative sum sum likely escape range use unbias shift mean normalize desired maximum amplitude code generates browniannoise object plot waveform signal wave figure show result waveform wanders clear correlation successive value amplitude high tends stay high vice versa plot spectrum brownian noise linear scale figure left doe look like nearly power lowest frequency higher frequency component visible shape spectrum clearly plot power frequency scale code import plt spectrum pink noise log log result figure right relationship power quency noisy roughly linear spectrum provides us scipy compute square t power spectrum class spectrum def self x y t x y return t discard rst component spectrum component responds log unde ned return result object contains estimated slope intercept mination standard error purpose need slope brownian noise slope power spectrum chapter write relationship logf wherepis power fis frequency ki intercept line important purpose exponentiating side yield wherekisek important relevant power tional characteristic brownian noise brownian noise called red noise reason white noise called combine visible light power proportional power end spectrum red brownian noise called noise think confusing wo use chapter noise time s figure waveform pink noise pink noise red noise relationship frequency power special exponent generally thesize noise exponent power constant frequency result white noise result red noise result white red noise called pink noise way generate pink noise simplest ate white noise apply lter desired exponent thinkdsp provides class represents pink noise signal class pinknoise def self amp beta ampis desired amplitude signal beta desired exponent pinknoise provides generates pink noise frequency hz pink red figure spectrum white pink red noise scale def self signal uncorrelateduniformnoise wave duration start framerate spectrum return duration length wave second start start time wave included interface type signal random noise start time irrelevant framerate number sample second creates white noise wave computes spectrum applies lter desired exponent convert ltered spectrum wave unbiases normalizes wave spectrum provides def self denom denom denom divide element spectrum f power square amplitude operation divide power component chapter noise normal model real normal model imag figure normal probability plot real imaginary part spectrum gaussian noise f treat component special case partly avoid dividing partly element represents bias signal going set figure show resulting waveform like brownian noise wanders way suggests correlation successive value visually look random chapter come observation precise mean random finally figure show spectrum white pink red noise scale relationship exponent slope spectrum apparent gure gaussian noise started uncorrelated uniform uu noise showed spectrum equal power frequency average uu noise white people talk noise mean uu noise fact mean uncorrelated gaussian ug noise thinkdsp provides implementation ug noise class uncorrelatedgaussiannoise def evaluate self t exercise y len t return y return numpy array value gaussian bution case mean standard deviation theory range value negative positive nity expect value ug noise similar way uu noise spectrum equal power frequency average ug white esting property spectrum ug noise ug noise precisely real imaginary part spectrum uncorrelated gaussian value test claim generate spectrum ug noise erate probability plot graphical way test distribution gaussian signal wave spectrum normalprobabilityplot provided included repository book familiar normal probability plot read chapter think stats athttp com figure show result gray line linear model t data dark line data straight line normal probability plot indicates data come gaussian distribution random variation extreme line straight indicates spectrum ug noise ug noise spectrum uu noise ug noise approximately fact central limit theorem spectrum uncorrelated noise approximately gaussian long distribution nite mean standard deviation number sample large exercise solution exercise chapter noise exercise soft murmur web site play mixture natural noise source including rain wave wind http nd list recording http download le compute spectrum signal doe power spectrum look like white noise pink noise brownian noise doe spectrum vary time exercise noise signal mixture frequency change time long run expect power frequency equal sample power frequency random estimate average power frequency break long signal segment compute power spectrum segment compute average segment read algorithm http implement bartlett method use estimate power spectrum noise wave hint look implementation exercise athttp download daily price bitcoin csv le read le compute spectrum bitcoin price function time doe resemble white pink brownian noise exercise geiger counter device detects radiation ionizing particle strike detector output surge current total output point time modeled uncorrelated poisson noise sample random quantity poisson distribution corresponds number particle detected interval write class called uncorrelatedpoissonnoise inherits provides evaluate use generate random value poisson distribution parameter function lam average number particle interval use attribute ampto specify lam example framerate khz andampis expect second generate second noise listen low value amp like sound like geiger counter higher value sound like white noise compute plot power spectrum look like white noise exercise algorithm chapter generating pink noise ceptually simple computationally expensive native like algorithm research method exercise compute spectrum result rm desired lationship power chapter noisechapter autocorrelation previous chapter characterized white noise mean value independent brownian noise value depends preceding value chapter ne term precisely present autocorrelation function useful tool signal analysis code chapter repository book section view http correlation general correlation variable mean know value information way quantify correlation common pearson correlation usually denoted variable xandy contain nvalues mean xandy standard deviation pearson correlation including positive say correlation positive mean variable high tends high negative correlation negative variable high tends chapter autocorrelation time s figure sine wave di er phase o set radian correlation magnitude strength correlation variable perfectly correlated mean know make perfect prediction near zero correlation probably weak know doe tell say weak possible nonlinear relationship captured correlation nonlinear relationship important statistic relevant signal processing wo say python provides way compute correlation take number variable computes correlation matrix includes correlation pair variable present example variable ne function construct sine wave di erent phase o set def offset signal wave return wave instantiate wave di erent o set figure show rst period wave look like wave high usually high expect correlation offset radian figure correlation sine wave function phase o set result cosine option indicates corrcoef divide n equation use default result correlation matrix rst element correlation similarly element correlation o element contain value interested tion value indicates strength correlation moderate phase o set increase correlation decrease wave degree phase yield correlation increase o set di er degree point come circle correlation figure show relationship correlation phase o set sine wave shape curve look familiar cosine thinkdsp provides simple interface computing correlation wave chapter autocorrelation serial correlation signal represent measurement quantity vary time ample sound signal worked represent measurement voltage current correspond change air pressure perceive sound measurement like serial correlation correlation element previous compute serial correlation shift signal compute correlation shifted version original def wave n len wave lag corr return corr take wave object lag integer number place shift wave computes correlation wave shifted version test function noise signal previous chapter expect uu noise uncorrelated based way generated mention signal wave wave ran example got indicates small serial correlation di erent value run comparably small brownian noise signal value sum previous value random expect strong serial correlation signal wave wave sure result got greater pink noise sense brownian noise uu noise expect intermediate correlation signal wave wave autocorrelation pink noise parameter correlation figure serial correlation pink noise range parameter parameter got serial correlation vary rameter uncorrelated noise brownian serial correlation range shown figure autocorrelation previous section computed correlation value shifted element array easily compute serial correlation di erent lag think function map value lag corresponding correlation evaluate function looping value lag def autocorr wave lag range len corrs wave lag lag lag return lag corrs autocorr take wave object return autocorrelation function pair sequence lag sequence integer half length wave corrs sequence serial correlation lag figure show autocorrelation function pink noise value low value signal correlated tion function drop o zero quickly larger value serial correlation stronger drop o slowly serial correlation chapter autocorrelation β β figure autocorrelation function pink noise range ters long lag phenomenon called dependence cause indicates value signal depends preceding value autocorrelation periodic signal autocorrelation pink noise interesting mathematical property limited application autocorrelation periodic signal useful example downloaded recording singing chirp repository book includes le use jupyter notebook chapter play figure show spectrogram wave fundamental frequency harmonic clearly chirp start near hz drop hz roughly estimate pitch particular point time use spectrum doe work short segment wave plot spectrum duration segment spectrum autocorrelation periodic signal time s hz figure spectrogram vocal chirp frequency hz figure spectrum segment vocal chapter autocorrelation time s figure segment chirp starting second segment start second last second figure show spectrum clear peak near hz hard identify pitch precisely length segment sample framerate hz frequency resolution hz section mean estimated pitch o hz musical term range hz hz semitone big di erence better frequency resolution taking longer segment pitch changing time blur peak spread start end pitch segment saw section estimate pitch precisely using autocorrelation signal periodic expect autocorrelation spike lag equal period work plot segment recording import plt def wave offset autocorrelation periodic signal lag index figure autocorrelation function segment chirp corr text r corr text time s segment start second start second later ure show result segment similar correlation result suggests period near second corresponds frequency hz example estimated period trial error automate process use autocorrelation function lag corrs autocorr segment lag corrs figure show autocorrelation function segment starting second rst peak occurs compute frequency corresponds period like period lag frequency period estimated fundamental frequency hz evaluate precision estimate run computation lag correspond frequency hz frequency precision using autocorrelation hz compared hz using spectrum musical term expected error cent semitone chapter autocorrelation correlation dot product started chapter nition pearson correlation used ne serial correlation autocorrelation tent term used statistic context signal processing nitions little di erent signal processing working unbiased signal mean normalized signal standard deviation case nition e nx ixiyi common simplify ixiyi nition correlation doe generally fall useful property think xandyas vector recognize formula dot product seehttp dot product indicates degree signal similar normalized standard deviation angle vector explains figure cosine curve using numpy numpy provides function correlate computes correlation function autocorrelation function use compute autocorrelation segment previous section using numpy figure autocorrelation function computed option mode tellscorrelate range lagto use value range wherenis length wave array figure show result symmetric signal cal negative lag e ect positive lag compare result autocorr select second half n len half compare figure figure notice correlation computed smaller lag increase us unstandardized nition correlation lag get bigger overlap signal get smaller magnitude correlation decrease correct dividing length length range n half length finally standardize result correlation half half adjustment result computed autocorr nearly di er reason important curious autocorr standardizes correlation independently lag standardized end importantly know autocorrelation use estimate fundamental period signal way compute chapter autocorrelation exercise solution exercise exercise jupyter notebook chapter includes interaction let compute autocorrelations di erent lag use interaction estimate pitch vocal chirp di erent start time exercise example code show use lation estimate fundamental frequency periodic signal encapsulate code function called use track pitch recorded sound work try superimposing pitch estimate trogram recording exercise did exercise previous chapter downloaded historical price bitcoins estimated power spectrum price change using data compute autocorrelation bitcoin price doe autocorrelation function drop o quickly evidence odic behavior exercise repository book nd jupyter notebook explores autocorrelation pitch perception phenomenon called missing fundamental read notebook run example try selecting di erent segment recording running example vi hart excellent video called noise ence mathematics sound frequency pitch demonstrates missing fundamental phenomenon explains pitch perception work degree know watch http discrete cosine transform topic chapter discrete cosine transform dct used related format compressing music jpeg similar format image mpeg family format video dct similar way discrete fourier transform dft using spectral analysis learn dct work easier explain dft step start synthesis problem given set frequency nents amplitude construct wave rewrite synthesis problem using numpy array good performance provides insight step look analysis problem given signal set frequency nd amplitude frequency component start solution conceptually simple slow finally use principle linear algebra nd algorithm know linear algebra great explain need code chapter repository book section view http chapter discrete cosine transform synthesis suppose list amplitude list frequency ask construct signal sum frequency component using object thinkdsp module simple way perform operation called synthesis def amp f t component freq amp amp freq zip amp f signal component y t return y amp list amplitude fsis list frequency tsis sequence time signal evaluated component list cossignal object represents sum frequency component finally evaluate computes value signal time t test function like amp f framerate t framerate y amp f t wave y framerate example make signal contains fundamental frequency hz harmonic hz sharp render signal second frame second put result wave object conceptually synthesis pretty simple form doe help analysis inverse problem given wave identify frequency component amplitude synthesis array way write synthesize synthesis array tn b c d e f figure synthesis array def amp f t args t f m args y m amp return y function look di erent doe thing let work computes outer product tsandfs result array row element tsand column element f element array product frequency time multiply args apply co element result co tsrun column column contains cosine signal particular frequency evaluated sequence time multiplies row mbyamps add product term linear algebra multiplying matrix m vector amp term signal computing weighted sum frequency component figure show structure computation row matrix m corresponds time second tnis time nth row column corresponds frequency hz fkis frequency kth chapter discrete cosine transform labeled nth row letter athroughd example value ofais co tn result dot product y vector element row thenth element labeled e sum product likewise element y element ysis sum frequency component evaluated point time multiplied corresponding amplitude exactly wanted use code previous section check version ofsynthesize produce result amp f t amp f t max ab biggest di erence expect error writing computation term linear algebra make code smaller faster linear algebra provides concise notation operation matrix vector example write synthesize like co f whereais vector amplitude ti vector time fis vector frequency symbol outer product vector analysis ready solve analysis problem suppose wave tell sum cosine given set frequency nd amplitude frequency component word givenys tsandfs recover amp term linear algebra rst step synthesis co f want nd aso word want solve linear numpy provides doe exactly code look orthogonal matrix def y f t args t f m args amp m y return amp rst line use tsandfsto build matrix computes amp hitch general solve linear equation matrix square number equation row number unknown column example frequency evaluated signal time equation unknown general yscontains element unlikely analyze using frequency case know yswere actually generated adding frequency component use value wave array recoveramps simplicity use rst sample signal using value y fsandtsfrom previous section run like n len f y n f t n sure algorithm work slow solving linear equation take time proportional wherenis number column better orthogonal matrix way solve linear system inverting matrix inverse matrixmis property identity matrix value diagonal element solve equation multiply side yield chapter discrete cosine transform right replace multiply iby vector result implies compute nd awith simple matrix multiplication using take time proportional better inverting matrix slow general special case faster particular misorthogonal inverse mi just transpose m writtenmt numpy transposing array operation doe actually element array instead creates change way element accessed matrix orthogonal transpose inverse implies mean check matrix orthogonal computing mtm let matrix look like previous ample mhas row good idea work smaller example def amp n t n n n f n n y amp f t amp vector amplitude saw frequency component sample signal point time way mi square tsis vector equally spaced sample time range time unit chose time unit millisecond arbitrary choice minute drop computation frame rate nsamples time unit nyquist frequency n hz example fsis vector equally spaced frequency hz value tsandfs matrix m recognize approximation ofp co notice matrix symmetric mean element j k equal element k j implies mi transpose sadly mi orthogonal compute mtm identity matrix choose tsandfscarefully make morthogonal way version discrete cosine transform dct simple option shift tsandfsby half unit version called roman numeral indicating fourth version dct updated version def amp n t n n f n y amp f t compare previous version notice change added tsandfs second canceled simpli e expression f value mi chapter discrete cosine transform andmtmis o element displayed mean representation small negative number matrix close mean mi orthogonal just o factor purpose good becausemis symmetric orthogonal inverse mi just write version analyze def y f t args t f m args amp m y return amp instead using just multiply combining write implementation def y n len y t n n f n args t f m args amp m y return amp ysis wave array pas tsandfsas parameter gure based n length y got right function solve analysis problem givenysit able recover amp test like amp n t n n f n y amp f t y max ab amp inverse dct frequency hz figure dct triangle signal hz sampled khz starting amp synthesize wave array use compute biggest di erence amp expect error inverse dct finally notice identical di erence divide result use insight compute inverse dct def amp return amp solves synthesis problem take vector tudes return wave array y test starting amp applying testing started amp y amp y max ab amp biggest di erence dct class thinkdsp provides dct class encapsulates dct way chapter discrete cosine transform spectrum class encapsulates fft make dct object invoke wave signal wave dct result dct triangle wave hz shown figure value dct positive negative negative value dct corresponds negated cosine equivalently cosine shifted degree us common type dct provided import class wave def self n len h f n return dct h f result dctare stored h corresponding frequency puted section stored f used initialize dct object dct provides performs inverse dct test like max ab biggest di erence expect error class dct def self n len y n return wave y default inverse dct doe normalize result divide exercise exercise following exercise provide starter code solution exercise chapter claim take time proportional take time proportional true run range input size time jupyter use command timeit plot run time versus input size scale straight line slope slope want test exercise major application dct compression sound image simplest form compression work like break long signal segment compute dct segment identify frequency component amplitude low ble remove store frequency amplitude remain play signal load frequency amplitude segment apply inverse dct implement version algorithm apply recording music speech component eliminate di erence perceptible order make method practical need way store sparse array array element zero numpy provides implementation sparse array read http exercise repository book nd jupyter notebook explores e ect phase sound perception read notebook run example choose segment sound run experiment nd general relationship phase structure sound perceive chapter discrete cosine transformchapter discrete fourier transform using discrete fourier transform dft chapter explained work time understand discrete cosine transform dct understand dft di erence instead using cosine function use complex exponential function start explaining complex exponential follow progression chapter start synthesis problem given set frequency nents amplitude construct signal synthesis problem equivalent inverse dft rewrite synthesis problem form matrix tion using numpy array solve analysis problem equivalent dft given signal nd amplitude phase o set frequency component finally use linear algebra nd way compute dft code chapter repository book section view http chapter discrete fourier transform complex exponential interesting move mathematics generalization operation type example factorial function operates integer natural nition factorial ni product integer certain inclination wonder compute factorial like natural nition doe apply look way compute factorial function way work leonhard euler generalization factorial function know gamma function http euler useful generalization applied mathematics complex exponential function natural nition exponentiation repeated multiplication ple nition doe apply exponent exponentiation expressed power series e nition work real number imaginary number simple extension complex number applying nition pure imaginary number ei rearranging term equivalent ei co derivation http formula formula implies ei complex number magnitude think point complex plane unit circle think vector angle radian vector positive argument case exponent complex number complex signal whereais real number indicates amplitude ei unit complex number indicates angle numpy provides version expthat work complex number phi z phi z python us jto represent imaginary unit number ending ji considered imaginary justi argument imaginary complex result complex number speci cally represented number example result complex number attribute real andimag magnitude use function ab z z angle use z example rms ei complex number magnitude angle radian complex signal t function time ei t function time speci cally ei t co t t function describes quantity varies time signal ically complex exponential signal chapter discrete fourier transform special case frequency signal constant t result complex sinusoid co generally signal start phase o set yielding ei thinkdsp provides implementation signal complexsinusoid class complexsinusoid sinusoid def evaluate self t phase t y phase return y complexsinusoid fromsinusoid provides version evaluate identical di erence us instead result numpy array complex number signal wave frequency signal cycle second amplitude unspeci ed unit phase o set radian example evaluates signal place equally spaced second resulting sample complex number synthesis problem just did real sinusoid create compound signal adding complex sinusoid di erent frequency brings complex version synthesis problem given frequency amplitude complex component evaluate signal simplest solution create complexsinusoid object add def amp f t component freq amp synthesis problem time s real imag figure real imaginary part mixture complex sinusoid amp freq zip amp f signal component y t return y function identical section di erence replaced cossignal withcomplexsinusoid example amp f framerate t framerate y amp f t result lowest level complex signal sequence complex number interpret intuition real signal represent quantity vary time example sound signal represents change air pressure measure world yield complex number complex signal satisfying answer question best o er unsatisfying answer complex signal mathematical abstraction useful putation analysis doe correspond directly chapter discrete fourier transform real world like think complex signal sequence complex number contains signal real imaginary part taking second point view split previous signal real imaginary part n t n y n real t n y n imag figure show segment result real sum cosine imaginary sum sine waveform look di erent contain frequency component proportion ear sound general hear phase o set synthesis matrix saw section express synthesis problem term matrix multiplication def amp f t args t f m args y m amp return y amp numpy array contains sequence amplitude fsis sequence containing frequency component tscontains time evaluate signal args contains outer product tsandfs tsrunning row fsrunning column want refer figure column matrix mcontains complex sinusoid particular quency evaluated sequence t multiply mby amplitude result vector element correspond t element sum complex sinusoid evaluated particular time example previous section synthesis matrix time s figure real complex signal di er phase o set y amp f t y result example amplitude real complex e ect doe complex amplitude result remember think complex number way sum real imaginary product real amplitude complex exponential aei using second interpretation happens multiply complex amplitude complex sinusoid frequency f aexpi multiplying aei amplitude aand add phase o set test claim running previous example frequency component phi amp phi f t t n n t n n sinceamps array real multiplying phi yield chapter discrete fourier transform array complex number phase o set phiradians nitudes amp figure show result phase o set shift wave left quarter cycle change waveform phase o set applied di erent frequency change frequency component line general solution synthesis problem handle complex amplitude ready analysis problem analysis problem analysis problem inverse synthesis problem given sequence sample y knowing frequency make signal compute complex amplitude component saw section solve problem forming synthesis matrix m solving linear equation def y f t args t f m args amp m y return amp take possibly complex wave array y sequence real quencies f sequence real time t return sequence complex amplitude amp continuing previous example rm recovers amplitude started linear solver work mhas square need y fsandtsto length insure slicingysandtsdown length f n len f y n f t n approximately amplitude started ponent small imaginary analysis analysis unfortunately solving linear equation slow dct able speed thing choosing fsandtsso thatmis orthogonal way inverse mi transpose m compute dct inverse dct matrix multiplication thing dft small change mi complex need unitary orthogonal mean inverse mi conjugate transpose m compute transposing matrix negating imaginary element http numpy method conj andtranspose want code computes component n t n n f n args t f m args ifmis unitary conjugate transpose m andi identity matrix test mi unitary like mstarm m result tolerance error somis unitary extra factor n similar extra factor dct use result write faster version def y f t args t f m args amp y n return amp test appropriate value fsandts n amp f n t n n y amp f t y f t result correct tolerance arithmetic chapter discrete fourier transform dft function hard use work fsand tsare chosen correctly instead rewrite just ysand compute fsandtsitself make function compute synthesis matrix m def n t n n f n args t f m args return m write function take ysand return amp def y n len y m n amp y n return amp computes close dft di erence conventional nition dft doe divide n def dft y n len y m n amp y return amp rm version yield result fft dft y result close amp n version y oating point error inverse dft transpose conjugatem nowwe divide n def idft amp n len amp m n y amp n return dft periodic finally rm dft idft amp yieldsamps y idft amp dft y time change nition dft divide bynand inverse dft doe consistent presentation synthesis analysis problem change nition operation divide byp dft inverse dft symmetric ca time stuck slightly weird tion practical purpose doe really matter dft periodic chapter presented dft form matrix multiplication compute synthesis matrix m analysis matrix wave array y element result product row write form summation dft y k ny n exp wherekis index frequency andnis index time sodft y k thekth element dft normally evaluate summation nvalues ofk running evaluate value k point start repeat value ki value mathematically plugging summation dft y ny n exp sum exponent break part dft y ny n exp exp second term exponent integer multiple chapter discrete fourier transform frequency hz figure dft hz sawtooth signal sampled khz result drop dft y ny n exp summation equivalent dft y k dft periodic period need result exercise asks implement fast fourier transform fft aside writing dft form summation provides insight work review diagram section column synthesis matrix signal evaluated sequence time analysis matrix conjugate transpose synthesis matrix rowis signal evaluated sequence time summation correlation ywith signal array section element dft correlation quanti e similarity wave array y complex exponential particular frequency dft real signal spectrum class thinkdsp based computes dft work real signal dft presented chapter general work complex signal happens apply dft real signal let look exercise signal wave h dft amp h code make sawtooth wave frequency hz sampled framerate complex dft wave amp contains tude frequency frequency amplitude correspond look body dft f n tempting think value right frequency problem thatdftdoes know sampling rate dft assumes duration wave time unit think sampling rate nper time unit order interpret frequency convert arbitrary time unit second like f n framerate n change range frequency actual framerate khz plot spectrum f amp figure show amplitude signal frequency component khz left half gure expect dominant frequency hz harmonic dropping o like right half gure surprise past hz amplitude harmonic start growing peaking hz going answer aliasing remember framerate hz folding frequency hz saw section component hz indistinguishable component hz evaluate dft hz value hz similarly value hz hz dft real signal symmetric folding frequency additional information past point save time uating rst half dft exactly doe exercise solution exercise chapter discrete fourier transform exercise notebook chapter contains tional example explanation read run code exercise chapter showed express dft inverse dft matrix multiplication operation time tional wherenis length wave array fast application faster algorithm fast fourier transform fft take time proportional nlogn key fft lemma dft y n e n dft o n wheredft y n thenth element dft y eis wave array containing element y andocontains odd element lemma suggests recursive algorithm dft given wave array y split element e odd element o compute dft eandoby making recursive call compute dft y value nusing lemma base case recursion wait length yi case dft y length yi small compute dft matrix multiplication possibly using precomputed matrix hint suggest implement algorithm incrementally starting version truly recursive step instead making recursive usedft ned section step working rm result consistent implementation add base case rm work finally replace step recursive call hint remember dft periodic nd useful read fft http filtering convolution chapter present important useful idea related signal processing convolution theorem understand convolution theorem understand convolution start simple example smoothing code chapter repository book section view http smoothing smoothing operation try remove variation signal order reveal trend example plot daily change price stock look noisy smoothing operator make easier price generally going time common smoothing algorithm moving average computes mean previous nvalues value example figure show daily closing price facebook december gray line raw data darker line show moving average smoothing remove extreme change make easier trend smoothing operation apply sound signal example start square wave hz saw section harmonic square wave drop o slowly contains chapter filtering convolution time day daily close day average figure daily closing price facebook stock moving average signal wave segment wave segment signal segment shorter segment use plotting compute moving average signal create window element normalize element add window window sum window compute average rst element multiplying window wave array y n len y padded window n prod padded y sum prod padded version window zero added end length prod product window wave array sum elementwise product average rst element array element average compute element smoothed signal shift window right compute average element wave array starting convolution time s figure square signal hz gray moving average rolled rolled prod rolled y sum prod result compute moving average repeat process store result array named smoothed smoothed y rolled padded range n smoothed sum rolled y rolled rolled rolled copy padded get shifted right element time loop inside loop multiply segment rolled select element add figure show result gray line original signal darker line smoothed signal smoothed signal start ramp leading edge window reach rst transition level o window cross transition result transition abrupt corner sharp listen smoothed signal sound buzzy slightly convolution operation just computed called convolution mon operation numpy provides implementation simpler chapter filtering convolution faster version convolved y window valid convolved computes convolution wave array window mode ag valid indicates compute value window wave array overlap completely stop right edge window reach end wave array result figure actually di erence loop previous section actually computes f g n m g wherefis wave array length n gi window symbol compute nth element result shift gto right index nition convolution slightly di erent n m g convolution di erence index g mhas negated summation iterates element gbackward assuming negative index wrap end array window used example symmetric convolution yield result use window careful wonder convolution ned way reason nition come naturally application especially analysis system topic chapter nition basis convolution theorem coming frequency domain frequency hz figure spectrum square wave smoothing frequency domain smoothing make transition square signal abrupt make sound slightly let e ect operation spectrum plot spectrum original wave spectrum smoothed wave convolved window smooth convolved mode ag indicates result length input example include value ok figure show result fundamental frequency unchanged rst harmonic attenuated higher harmonic eliminated smoothing e ect lter saw section section component attenuated compute ratio spectrum amp ratio chapter filtering convolution frequency hz ratio figure ratio spectrum square wave smoothing ratio amp ratio ratio ratio amplitude smoothing amp small ratio big noisy simplicity set ratio harmonic figure show result expected ratio high low frequency drop o cuto frequency near hz feature did expect cuto ratio bounce convolution theorem answer convolution theorem stated mathematically dft dft f g wherefis wave array gi window word convolution theorem say convolve fandg compute dft answer computing dft fandg multiplying result concisely convolution time domain corresponds multiplication frequency domain explains figure convolve wave window multiply spectrum wave spectrum window work compute dft gaussian lter frequency hz ratioboxcar filter amplitude ratio figure ratio spectrum square wave smoothing dft smoothing window padded window n padded ab padded contains window padded zero length wave contains dft smoothing window figure show result ratio computed previous section ratio exactly amplitude cally ab dft dft f ab dft g context dft window called lter convolution window time domain corresponding lter frequency main lter expressed multiplication frequency domain corresponding window gaussian lter moving average window used previous section lter good dft drop o steeply rst bounce bounce called sidelobes moving average window like square wave spectrum contains harmonic drop o proportionally relatively chapter filtering convolution boxcar gaussian figure boxcar gaussian window better gaussian window scipy provides function compute common convolution window including gaussian gaussian gaussian sum gaussian mi number element window stdis standard deviation gaussian distribution used compute figure show shape window discrete approximation gaussian curve gure show moving average window previous example called boxcar window look like rectangular railway car ran computation previous section curve generated figure show ratio spectrum smoothing dft gaussian window lter gaussian smoothing better simple moving age ratio drop o stay low sidelobes saw boxcar window doe better job cutting o higher frequency reason doe dft gaussian curve gaussian curve ratio drop o proportion exp faster convolution frequency hz ratiogaussian filter amplitude ratio figure ratio spectrum gaussian smoothing dft window convolution reason fft important algorithm bined convolution theorem provides way compute convolution autocorrelation convolution theorem state dft dft f g way compute convolution idft dft f g whereidft inverse dft simple implementation convolution take time proportional algorithm using fft take time proportional tonlogn rm work computing convolution way example apply bitcoin data shown figure df y example us panda read data csv le included repository book familiar panda chapter filtering convolution going book interested learn think stats athttp result df dataframe data structure provided panda ysis numpy array contains daily closing price create gaussian window convolve y window window smoothed y window valid computes thing using fft import fft ifft def signal window fft signal fft window return ifft test padding window length ysand computing convolution padded window n y padded result bogus value beginning mi length window slice o bogus value result agrees digit precision m len window autocorrelation section presented nitions convolution saw convolution window reversed algorithm convolution use compute autocorrelations using data previous section compute autocorrelation facebook stock price corrs close close result length close corresponding lag gray line figure show result cept peak apparent periodic behavior autocorrelation figure autocorrelation function computed numpy fftcorrelate signal autocorrelation function drop o slowly suggesting signal resembled pink noise saw section compute autocorrelation using convolution signal double length trick necessary fft based assumption signal periodic wrap end beginning data like assumption invalid adding zero trimming result remove bogus value remember convolution reverse direction window order cancel e ect reverse direction window calling ip numpy array result view array copy operation fast def signal n len signal signal signal n window signal corrs signal window corrs corrs n return corrs result length rst valid rest result select valid element roll result select rst n corresponding lag chapter filtering convolution shown figure result identical digit precision notice correlation figure large number ize shown section strategy used work prepare signal ipping padding trim invalid part result padding trimming nuisance library like numpy provide function exercise solution exercise exercise notebook chapter read run code contains interactive widget let experiment parameter gaussian window e ect cuto frequency go wrong increase width gaussian std increasing number element window m exercise chapter claimed fourier transform sian curve gaussian curve discrete fourier transforms relationship approximately true try example happens fourier transform varystd exercise did exercise chapter saw e ect hamming window window provided numpy spectral leakage insight e ect window looking dfts addition gaussian window used chapter create hamming window size zero pad window plot dfts window act better lter nd useful plot dfts yscale experiment di erent window di erent di erentiation integration chapter pick previous chapter left o looking lationship window time domain lters frequency domain particular look e ect nite di erence window proximates di erentiation cumulative sum operation mate integration code chapter repository book section view http finite di erences section applied smoothing window stock price facebook smoothing window time domain corresponds lter frequency domain section look daily price change computing di erence successive element time domain corresponds lter code read data store wave compute spectrum import panda pd name date open high low close volume df chapter di erentiation integration time day frequency figure daily closing price facebook spectrum time series y close y spectrum example us panda read csv le result dataframe df column opening price closing price high low price select closing price save wave object framerate sample day figure show time series spectrum visually time series resembles brownian noise section spectrum look like straight line albeit noisy estimated slope consistent brownian noise let compute daily price change using diff y change diff figure show resulting wave spectrum daily change resemble white noise estimated slope spectrum near zero expect white noise frequency domain computing di erence successive element tion window order element di erentiation time day frequency figure daily price change facebook spectrum time series remember convolution revers window applying nal e ect operation frequency domain computing dft window padded len close padded figure show result nite di erence window corresponds high pas lter amplitude increase frequency linearly low frequency sublinearly section di erentiation window used previous section numerical approximation rst derivative lter approximates e ect di erentiation di erentiation time domain corresponds simple lter quency domain gure little math suppose complex sinusoid frequency f ef t chapter di erentiation integration frequency ratiodiff derivative frequency ratiointegral figure filter corresponding di di erentiate operator left integration operator right yscale rst derivative efis d dtef t rewrite d dtef t t word taking derivative efis multiplying complex number magnitude compute lter corresponds di erentiation like started spectrum close right size framerate replaced hswith figure left show lter straight line saw section multiplying complex sinusoid complex number e ect multiplies amplitude case shift phase o set case familiar language operator eigenfunctions efis eigenfunction di erentiation operator corresponding eigenvalue seehttp familiar language di erentiation operator function take function return function example di erentiation operator function g eigenfunction operator applyingatog e ect multiplying function scalar case scalar eigenvalue corresponds functiong given operator eigenfunctions sponding eigenvalue complex sinusoid eigenfunctions di erentiation operator easy di erentiate multiply complex scalar signal component process slightly harder express signal sum complex sinusoid compute derivative component multiplication add di erentiated component process sound familiar identical algorithm convolution section compute dft multiply lter compute inverse dft spectrum provides method applies di erentiation lter class spectrum def differentiate self use compute derivative facebook time series deriv figure compare daily price change computed derivative just computed selected rst value time series di erences clearly derivative noisier ampli e high frequency component shown figure left rst element derivative noisy problem derivative chapter di erentiation integration time day change diff derivative figure comparison daily price change computed applying di erentiation lter assumption signal periodic e ect connects element time series rst element creates artifact boundary summarize shown di erence successive value signal expressed convolution simple window result imation rst derivative erentiation time domain corresponds simple lter frequency domain periodic signal result rst derivative exactly signal approximate derivative using dft compute derivative basis spectral odsfor solving di erential equation http particular useful analysis linear system coming chapter integration previous section showed di erentiation time domain corresponds simple lter frequency domain multiplies integration time day closing price integrated derivative figure comparison original time series integrated tive component integration inverse di erentiation corresponds simple lter divide component compute lter like figure right show lter yscale make easier spectrum provides method applies integration lter class spectrum def integrate self rm integration lter correct applying spectrum derivative just computed notice dividing result numpy nan special value represents number partially deal problem setting value converting spectrum wave chapter di erentiation integration time s frequency hz figure sawtooth wave spectrum figure show integrated derivative original time series identical integrated derivative shifted problem clobbered component set bias signal surprising general di erentiation loses information bias integration ca recover sense nan telling element unknown provide integration result identical rms integration lter correct inverse di erentiation lter cumulative sum way di operator approximates di erentiation lative sum approximates integration demonstrate sawtooth signal signal figure show wave spectrum wave provides method computes cumulative sum wave array return new wave object class wave def cumsum self y cumulative sum time s frequency hz figure parabolic wave spectrum t return wave y t use compute cumulative sum figure show resulting wave spectrum did exercise chapter waveform look familiar parabolic signal comparing spectrum parabolic signal spectrum tooth amplitude component drop o quickly chapter saw component sawtooth drop o proportion cumulative sum approximates integration integration lters component proportion component parabolic wave drop o proportion graphically computing lter corresponds cumulative sum cumsum inverse operation diff start copy lter corresponds diff operation invert h figure show lters corresponding cumulative sum integration cumulative sum good approximation integration highest frequency drop o little chapter di erentiation integration cumsum filter integral filter figure filter corresponding cumulative sum integration rm correct lter cumulative sum compare ratio spectrum spectrum method computes ratio def ratio self denom thresh return small resulting ratio noisy set value nan figure show ratio lter corresponding cumulative sum agree rms inverting lter diff yield lter forcumsum finally rm convolution theorem applies applying cumsum lter frequency domain limit error identical computed using cumsum convolution theorem work note demonstration work periodic integrating noise frequency hz ratiocumsum filter ratio figure filter corresponding cumulative sum actual ratio spectrum integrating noise section generated brownian noise computing cumulative sum white noise understand e ect cumsum frequency domain insight spectrum brownian noise white noise equal power frequency average compute cumulative sum amplitude component divided power square magnitude power component divided average power frequency fis proportional wherekis constant important taking log side yield logf plot spectrum brownian noise scale expect straight line slope approximately section plotted spectrum closing price facebook estimated slope consistent brownian noise stock price similar spectrum use diff operator compute daily change multiplied amplitude component lter proportional f mean multiplied power component scale ation add slope power spectrum chapter di erentiation integration slope result near little lower diff mate di erentiation exercise notebook chapter want read run code solution exercise exercise goal exercise explore e ect diff differentiate signal create triangle wave plot apply diff plot result compute spectrum triangle wave apply differentiate plot result convert spectrum wave plot di erences e ect diff anddifferentiate wave exercise goal exercise explore e ect cumsum integrate signal create square wave plot apply cumsum plot result compute spectrum square wave apply integrate plot result convert spectrum wave plot di erences e ect cumsum andintegrate wave exercise goal exercise explore e ect integrating twice create sawtooth wave compute spectrum apply integrate twice plot resulting wave spectrum mathematical form wave doe resemble sinusoid exercise goal exercise explore e ect di ence derivative create cubicsignal ned thinkdsp compute second di erence applying diff twice doe result look like compute second derivative applying differentiate spectrum twice doe result look plot lters corresponds di erence derivative compare hint order lters scale use wave framerate lti system chapter present theory signal system using musical tic example explains important application convolution theorem characterization linear system ne soon code chapter repository book section view http signal system context signal processing abstract representation take signal input produce signal output example electronic ampli er circuit take electrical signal input produce louder signal output example listen musical performance think room take sound performance location generated produce somewhat di erent sound location hear alinear property linearity input time sult sum output mathematically input input whereaandbare scalar presentation follows http chapter lti system time invariance e ect doe vary time depend state input er shift time output er shift identical physical system property approximately contain resistor capacitor inductor lti degree component behave like idealized model system contain spring mass dashpots lti assuming linear spring force proportional displacement dashpots force proportional velocity relevant application book medium transmit sound including air water solid lti system lti system described linear di erential equation solution equation complex sinusoid http result provides algorithm computing e ect lti input signal express signal sum complex sinusoid component input component compute corresponding output nent add output component point hope algorithm sound familiar algorithm used convolution section di erentiation section process called spectral decomposition input signal spectral component order apply process lti characterize nding e ect component input signal mechanical system turn simple way kick record output technically called impulse output called impulse response wonder single impulse completely characterize answer computing dft impulse wave array impulse window lters impulse impulse impulse wave array spectrum spectrum one impulse sum component equal magnitude frequency spectrum confused white noise average power frequency varies average test inputting impulse testing response frequency test time linear simultaneous test interfere window lters kind characterization work start simple example moving average think operation take signal input produce slightly smoother signal output example know window compute sponding lter usually case section look example know window lter ahead time window computes moving average section window nd corresponding lter computing dft window filtr figure show result lter corresponds moving average window lter approximate shape gaussian curve imagine did know window corresponding lter wanted characterize inputting impulse measuring impulse chapter lti system figure dft moving average window example compute impulse response multiplying spectrum impulse lter converting result spectrum wave product filtr filtered one product identical lter ltered wave identical window example demonstrates thing spectrum impulse one dft impulse response identical lter characterizes impulse response identical convolution window characterizes acoustic response characterize acoustic response room open space simple way generate impulse pop balloon gun gunshot put impulse sound hear impulse response example use recording gunshot characterize room gun red use impulse response simulate e ect room violin acoustic response time s frequency hz figure waveform gunshot example repository book view listen example http gunshot response response select segment starting second remove silence gunshot figure left show waveform gunshot compute dft response transfer figure right show result spectrum encodes response room frequency spectrum contains complex number represents amplitude multiplier phase shift spectrum called atransfer function contains information transfer input output simulate e ect room sound violin violin recording used section violin len response chapter lti system input time s output figure waveform violin recording convolution violin gunshot wave sampled framerate hz coincidentally duration trimmed violin wave length gunshot compute dft violin wave spectrum know magnitude phase component input know transfer function product dft output use compute output wave output spectrum transfer figure show input output substantially di erent di erences clearly audible load listen thing nd striking ample sense room like sound like long narrow room hard oors ceiling like ring range thing glossed example mention case bother violin recording started formed room recorded really computed example sound violin transformation properly simulate sound violin di erent room characterized room violin recorded applied inverse transfer function system convolution time s figure sum wave shifted scaled copy system convolution think previous example black magic thinking make head hurt previous section suggested way think impulse component amplitude frequency impulse response contains sum response component transfer function dft impulse response encodes e ect frequency component form amplitude multiplier phase shift input compute response breaking input component computing response component adding like way think altogether convolution convolution theorem multiplication frequency domain corresponds convolution time domain example output convolution input response key understanding work think sample input wave sequence impulse varying chapter lti system impulse input yield copy impulse response shifted time scaled amplitude input output sum shifted scaled copy impulse sponse copy add linear let work way gradually suppose instead ring gun big amplitude smaller amplitude compute response adding original impulse response scaled shifted copy function make shifted scaled copy wave def wave shift factor re shift factor return re parameter shift time shift second factor multiplicative factor use compute response salute shift factor response response shift factor figure show result hear sound like surprisingly sound like gunshot rst louder second suppose instead gun add gun red rate shot second loop computes result dt total k range total response k dt shot second hear individual shot instead sound like periodic signal hz play example sound like car horn garage brings key insight think wave series sample sample impulse di erent amplitude example generate sawtooth signal system convolution f g g g f g g g f g g g h figure diagram sum scaled shifted copy signal wave loop series impulse make sawtooth add impulse response total t y zip total response t y result sound like play sawtooth wave ring range listen figure show diagram computation fis sawtooth g impulse response sum shifted scaled copy example shown h g g g generally h n m g recognize equation section convolution fandg show input fand impulse response isg output convolution fandg summary way think e ect signal input sequence impulse output sum scaled shifted copy impulse response sum convolution input impulse chapter lti system dft impulse response transfer function encodes e ect frequency component magnitude phase o set dft input encodes magnitude phase o set frequency component contains multiplying dft input transfer function yield dft output equivalence description surprise basically statement convolution theorem convolution fandgin time domain corresponds multiplication frequency domain wondered convolution ned backwards talked smoothing di erence window know reason nition convolution appears naturally response lti signal proof convolution theorem o long time prove convolution theorem ct state dft dft f dft g wherefandgare vector length proceed step special case fis complex exponential volution ghas e ect multiplying fby scalar general case fis complex exponential use dft express sum exponential component compute convolution component multiplication add result step prove convolution theorem rst let assemble piece need dft g gi dft g k k ng n exp wherekis index frequency andnis index time result vector ncomplex proof convolution theorem inverse dft f f idft f n n kf k exp nition convolution n mf m g wheremis index time convolution commutative equivalently write n mf g m let consider special case fis complex exponential frequencyk ek f n n exp wherekis index frequency ni index time pluggingekinto second nition convolution yield n mexp g m split rst term product n mexp exp g m rst half doe depend m pull summation n exp x mexp g m recognize rst term ek summation g k using ma index time write n n g k show complex exponential ek convolution ghas e ect multiplying ekbyg k mathematical term ekis eigenvector operation g k corresponding eigenvalue chapter lti system section second proof input signal f doe happen complex exponential express sum complex exponential computing dft value kfrom f k complex magnitude component frequency input component complex exponential magnitude f k output component complex exponential magnitude f k g k based rst proof linear output just sum output nents n kf k g k ek n plugging nition ekyields n kf k g k exp right hand inverse dft product fg idft fg substituting dft f dft g idft dft f dft g finally taking dft side yield convolution theorem dft dft f dft g qed exercise solution exercise exercise section convolution sum shifted scaled copy signal strictly speaking operation linear convolution doe assume signal periodic section multiply dft signal transfer function operation corresponds circular convolution exercise signal periodic result notice output contains extra note beginning wrap end fortunately standard solution problem add zero end signal computing dft avoid compute linear convolution modify example rm nates extra note beginning output exercise open air library provides source interested auralization acoustical impulse response data http browse collection impulse sponse data download sound interesting short recording sample rate impulse response downloaded simulate sound recording space impulse response measured computed way convolving recording pulse response computing lter corresponds impulse response multiplying dft chapter lti systemschapter modulation sampling section saw signal sampled hz component hz indistinguishable component hz example folding frequency hz half sampling rate did explain chapter explores e ect sampling present sampling rem explains aliasing folding frequency start exploring e ect convolution impulse use e ect explain amplitude modulation turn useful understanding sampling theorem code chapter repository book section view http convolution impulse saw section convolution signal series impulse e ect making shifted scaled copy signal example read signal sound like beep filename wave filename construct wave chapter modulation sampling wave time s time s figure e ect convolving signal left series impulse left result right sum shifted scaled copy signal impulse convolve convolved impulse figure show result signal left impulse lower left result right hear result sound like series beep decreasing loudness point example just demonstrate convolution impulse make shifted scaled copy result useful section amplitude modulation amplitude modulation used broadcast radio application transmitter signal contain amplitude modulation frequency hz figure demonstration amplitude modulation row spectrum signal row spectrum modulation row spectrum demodulation row demodulated signal chapter modulation sampling music multiplying cosine signal act wave result wave suitable broadcast radio typical frequency radio united state khz http receiving end broadcast signal recover original signal surprisingly demodulation work multiplying broadcast signal carrier wave work modulate signal carrier wave khz signal filename wave filename carrier multiply using operator multiplies wave array elementwise modulated wave result sound pretty bad hear figure show happening frequency domain row spectrum original signal row spectrum modulated signal multiplying carrier contains copy original spectrum shifted plus minus khz understand recall convolution time domain corresponds multiplication frequency domain conversely multiplication time domain corresponds convolution frequency domain multiply signal carrier convolving spectrum dft carrier carrier simple cosine wave dft impulse plus minus khz convolution impulse make shifted scaled copy spectrum notice amplitude spectrum smaller modulation energy original signal split copy demodulate signal multiplying carrier wave demodulated modulated sampling row figure show result multiplication time domain corresponds convolution frequency domain make shifted scaled copy spectrum modulated spectrum contains peak peak get split half shifted plus minus khz copy meet khz added copy end centered plus minus khz listen demodulated signal sound pretty good extra copy spectrum add high frequency component original signal high speaker probably ca play people ca hear good speaker good ear case rid extra component applying lter filtered result quite close original wave half power lost demodulating ltering problem practice power lost transmitting receiving broadcast signal amplify result factor issue sampling explained amplitude modulation interesting help understand sampling process measuring analog signal series point time usually equal spacing example wav le used example recorded pling output microphone using converter adc sampling rate khz standard rate quality sound khz standard dvd sound khz folding frequency khz higher people hear http wave sample bit level depth turn adding bit chapter modulation sampling frequency hz figure spectrum signal sampling improve sound quality noticeably http course application audio signal require higher sampling rate order capture higher frequency higher order reproduce waveform delity demonstrate e ect sampling process going start wave sampled khz select sample khz exactly sampling analog signal e ect load recording drum solo filename wave filename figure show spectrum wave function sample wave def sample wave y len wave y return y use select fourth element sampled sample wave sampling train impulse train time s frequency hz figure dft impulse train impulse train result framerate original element zero play sampled wave doe sound good sampling process introduces component original figure show spectrum sampled wave contains copy original spectrum look like ve copy split highest lowest frequency understand copy come think sampling process multiplication series impulse instead using sample select fourth element use function make series impulse called impulse train def wave factor y len wave y t len wave return y t multiply original wave impulse train impulse wave chapter modulation sampling sampled wave impulse result doe sound good understand multiplication time domain corresponds convolution frequency domain multiply impulse train convolving dft impulse train turn dft impulse train impulse train figure show example row impulse train example frequency hz dft train impulse copy spectrum row show impulse train lower frequency hz dft train impulse general impulse time domain correspond fewer impulse frequency domain summary think sampling multiplication impulse train impulse train corresponds convolution pulse train frequency domain impulse train make multiple copy signal spectrum aliasing section demodulating signal got rid extra copy spectrum applying lter thing sampling turn perfect solution figure show row spectrum drum solo contains high frequency component extend past khz sample wave convolve spectrum impulse train second row make copy spectrum row row show result applying lter cuto folding frequency hz convert result wave similar original wave problem lter component hz lost result sound aliasing frequency hz figure spectrum drum solo spectrum impulse train second row spectrum sampled wave row ltering chapter modulation sampling spectrum sampled frequency hz filtered figure spectrum bass guitar solo spectrum sampling middle ltering component hz quite right include contribution leftover spectral copy tried lter spectral copy overlap sampling lose information spectrum wo able recover copy overlap thing work pretty second example loaded recording bass guitar solo figure show spectrum row contains visible energy hz second row show spectrum sampled wave row show spectrum low pas lter amplitude lower ltered energy shape spectrum exactly started convert wave sound interpolation time s frequency hz figure brick wall lter right corresponding lution window left interpolation low pas lter used step brick wall lter frequency cuto removed completely hit brick wall figure right show lter look like course multiplication lter frequency domain corresponds convolution dow time domain nd window computing inverse dft lter shown figure left function normalized sinc function discrete approximation http function sinc x apply lter convolving sinc function think convolution sum shifted scaled copy sinc function value sinc integer value shift sinc function zero point scale change height zero point add shifted scaled copy interpolate sampled chapter modulation sampling time s figure example interpolation adding shifted scaled copy sinc function figure show work using short segment bass guitar solo line original wave vertical gray line sampled value curve shifted scaled copy sinc function sum sinc function identical original wave read sentence surprising started signal contained energy hz sampled hz able recover original spectrum exactly example started wave sampled hz resampled hz resampling gap spectral copy sampling rate khz original signal contains component exceed half sampling rate hz copy overlap lose information signal limited contains energy hz spectral copy overlap lose information recover original signal exactly result known sampling theorem http example doe prove sampling theorem hope help understand say work notice argument doe depend original sampling rate khz result original exercise higher frequency original continuous analog signal sample framerate f recover original signal exactly long contains energy frequency exercise solution exercise exercise code chapter read listen example exercise chris montgomery excellent video called digital tell demonstrates sampling rem action present lot excellent information sampling watch http exercise seen sample signal low framerate frequency folding frequency aliased happens longer possible lter component guishable lower frequency good idea lter frequency sampling lter used purpose called lter returning drum solo example apply lter sampling apply lter remove spectral copy introduced sampling result identical ltered chapter modulation samplingindex anaconda vi clone vi contributor viii fork vi git vi github vi installation vii jupyter vii matplotlib vii numpy vii repository vi scipy vii