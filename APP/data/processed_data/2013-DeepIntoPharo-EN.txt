deep pharo alexandre bergel damien cassou stéphane ducasse jannik lavalii book available free download http copyright alexandre bergel damien cassou stéphane ducasse jannik laval content book protected creative common unported license free share copy distribute transmit work remix adapt work following condition attribution attribute work manner speciﬁed author licensor way suggests endorse use work share alike alter transform build work distribute resulting work similar compatible license reuse distribution make clear license term work best way link web page condition waived permission copyright holder license impairs restricts author s moral right fair dealing right way affected summary legal code license published square bracket associate switzerland http isbn edition august cover art jérôme bergel jeromebergel preface library zero conﬁguration script handler getting vm image getting vm handling command line option anatomy handler using zeroconf script jenkins chapter summary file filesystem getting started navigating ﬁle opening read write stream renaming copying deleting ﬁles directory main entry point filereference looking filesystem internals chapter summary socket basic concept tcp client tcp server content socketstream tip networking experiment chapter summary setting framework setting architecture setting browser declaring setting organizing setting providing precise value domain launching script action management extending setting browser chapter summary regular expression pharo tutorial example generating site map regex syntax regex api implementation note vassili bykov chapter summary ii source management versioning code monticello basic usage exploring monticello repository advanced topic getting change set version kind repository ﬁle format chapter summary gofer scripting package loading preamble package management gofer using gofer gofer action useful script chapter summary managing project metacello introduction tool job metacello feature simple case study loading metacello conﬁguration managing dependency package baseline group dependency project dependency granularity executing code installation platform speciﬁc package milestoning development symbolic version load type conditional loading project version attribute chapter summary iii framework glamour installation ﬁrst browser presentation transmission port composing interaction chapter summary agile visualization roassal installation ﬁrst visualization content roassal core model detailing shape edge linking element layout event callback interaction hierarchy understanding view s camera pharo chapter summary scripting visualization mondrian installation ﬁrst visualization starting mondrian visualizing collection framework reshaping node multiple edge colored shape color popup view subviews forwarding event event interaction chapter summary iv language handling exception introduction ensuring execution handling return exception handler error code don t specifying exception handled signaling exception finding handler handling exception comparing outer pas exception ensure interaction example deprecation example halt implementation speciﬁc exception use exception exception implementation ensure s implementation chapter summary block detailed analysis basic variable block variable outlive deﬁning method returning inside block context representing method execution message execution chapter conclusion exploring little number power number bit shifting multiplying power bit manipulation access s complement number negative number s complement number smallintegers pharo hexadecimal chapter summary content fun float test equality ﬂoats dissecting float ﬂoats printing inexact float rounding inexact fun inexact representation chapter summary v tool proﬁling application doe proﬁling mean simple example code proﬁling pharo read interpret result illustrative analysis counting message memorized fibonacci spacetally memory consumption class advice messagetally implemented chapter summary petitparser building modular parser writing parser petitparser composite grammar petitparser testing grammar case study json parser petitparser browser packrat parser chapter summary biography preface smalltalk known excellent tool agile exploratory programming book author present new dialect smalltalk called pharo speciﬁcally designed inventive developer author key member pharo team plished object oriented educator researcher designer ous smalltalk project author ported pharo enjoy deep pharo dave using programming language far convenient way human tell computer pharo programming language highly inﬂuenced smalltalk pharo syntax bunch semantics rule programming language pharo come extensible ﬂexible programming ment thanks numerous library framework pharo shine modeling visualizing data scripting networking range application light syntax malleable object model pharo monly praised early learner experienced programmer enjoy object paradigm simplicity expressiveness pharo living environment empowers programmer derful unique experience deep pharo second volume book series initiated pharo deep pharo book reading http ﬁgure modern software development object technology thomas best known founder past ceo object technology international ibm oti lab oti responsible initial development eclipse open source ide visual age java development environment available http preface ny reader fantastic journey exciting part pharo cover new library filesystem framework roassal glamour complex aspect exception block book divided part chapter ﬁrst deal truly library second source code management advanced framework fourth cover advanced topic language particular exception block number ﬁfth tooling including proﬁling parsing pharo supported strong community grows daily pharo s community active innovative pushing limit software engineering pharo community consists software engineering ware casual programmer consultant researcher teacher book exists pharo community naturally dedicate book group people consider second family acknowledgment like thank various people contributed book particular like thank camillo bruni participation zero conﬁguration chapter noury bouraqadi luc fabresse socket chapter alain plantec effort setting framework chapter effort integrate pharo oscar nierstrasz writing chapter regex monticello dale henrichs mariano martinez peck participation metacello chapter tudor doru girba glamour chapter ﬁrst tion clément bera effort exception chapter nicolas cellier participation fun float chapter lukas renggli petitparser work refactoring engine smalllint jan kurs guillaume larcheveque participation titparser chapter colin putney initial version filesystem camillo bruni review filesystem rewrite pharo core vanessa peña participation roassal mondrian ters renato cerro help proofreading editing question support bug ﬁxes contribution agement like thank hernan wilkinson carlos ferro review nicolas cellier feedback number chapter vassili bykov permission adapt regex documentation thank inria lille nord europe supporting project hosting web site book thank object proﬁle sponsoring cover thank pharo community siastic support project informing error ﬁrst edition book grateful respective institution national research agency support offered facility particular thank program vid university chile fondecyt project thank plomo équipe librarieschapter zero conﬁguration script handler participation camillo bruni camillobruni weren t fed able install pharo single command line pas argument using nice debugger interactive ronment development doe mean pharo developer value tomatic script love command line yes want best world really wanted free mind retaining arbitrary information zero conﬁguration script automatically downloads need started version pharo support way deﬁne handle command line argument chapter show zeroconf script pharo pas argument environment getting vm image way download zero conﬁguration script download latest pharo image vm wget wget installed use zero conﬁguration script handler execute script just downloaded change permission using chmod invoke bash follows conﬁgurations plethora conﬁgurations available url script easily built image version vm following expression vm possible value image stable alpha possible value vm vm vms vmlatest vmslatest course just download image image just vm vm looking help let s look script help bash help help say command downloads current virtual machine put folder addition creates script pharo launch script launch image ui mode finally downloads latest image change ﬁles script downloads latest pharo image script downloads latest pharo vm following artifact created change ﬁle pharo image pharo image opened pharo vm pharo script run downloaded vm headless mode script run downloaded vm ui mode directory containing vm grabbing executing just want directly execute script following bash option output downloaded bash ﬁle standard pipe bash like log web use quiet wget bash note believer automated task script fetched tomatically jenkins server http gitorious server http yes lieve automated task free vm getting vm use different script example load latest vm bash script check help message script downloads latest pharo vm following artifact created pharo script run downloaded vm headless mode script run downloaded vm ui mode directory containing vm figure show list script available http handling command line option brand new nice way handle command line argument easily extendable let look command line handled usual start showing ﬁnd way ﬁnd way highly value just use help option explanation help produce following output usage subcommand help copyright version list help print help message copyright print copyright version print version image vm list list description active command line handler subcommand valid subcommand list documentation defaultcommandlinehandler handle default command line argument option defaultcommandlinehandler activated handler ﬁrst check handler available activate zero conﬁguration script handler figure script available http version handler list default option important version list let look getting version typical important command line option version use report bug deviant behavior version m nbcointerpreter nativeboost uuid dec command line option nbcogit nativeboost uuid dec git commit date esteban lorenzano estebanlm jenkins build version argument give version virtual machine wish obtain version image need open image use world menu select list available handler command line option listlists rent option handler list depends handler currently loaded particular mean simply add dler speciﬁc situation wish following list show available handler list currently installed command line handler st load executes source ﬁles fuel load fuel ﬁles conﬁg install inspect metacello conﬁgurations command line save rename image change ﬁle test command line test runner update load update printversion print image version eval directly evaluates passed line script loading metacello conﬁguration explanation use conﬁg option just request associated help follows conﬁg help note help associated handler command line generic usage conﬁg help repository url conﬁguration install version group username password help help message repository url monticello repository conﬁguration valid metacello conﬁguration version valid version given conﬁguration group valid metacello group username optional username access conﬁguration repository password optional password access conﬁguration zero conﬁguration script handler example display help message pharo conﬁg list conﬁgurations repository pharo conﬁg list available version confgurtation pharo conﬁg conﬁgurationoffoo install stable version pharo conﬁg conﬁgurationoffoo install install speciﬁc version pharo conﬁg conﬁgurationoffoo install speciﬁc version speciﬁc group pharo conﬁg conﬁgurationoffoo anatomy handler mentioned command line mechanism open tended look handler eval option deﬁned evaluating pharo expression use command line evaluate expression follows eval eval help usage eval help smalltalk expression help list help message smallltalk expression valid smalltalk expression evaluated result printed stdout documentation commandlinehandler read string command line output evaluated result quits image handler evaluates argument passed image eval read directly stdin echo evalusing zeroconf script jenkins handler deﬁned follows deﬁne subclass mandlinehandler basiccodeloader subclass commandlinehandler evaluatecommandlinehandler subclass basiccodeloader basiccodeloader subclass evaluatecommandlinehandler instancevariablenames classvariablenames pooldictionaries category deﬁne commandname class method isresponsiblefor evaluatecommandlinehandler class commandname evaluatecommandlinehandler class isresponsiblefor commandlinearguments directly handle evaluate option commandlinearguments withfirstargument evaluate includes arg iftrue true commandlinearguments includessubcommand self commandname evaluatecommandlinehandler class description evaluates passed line script deﬁne method activate executed tion match evaluatecommandlinehandler activate self activatehelp self argument ifempty self evaluatestdin self evaluatearguments self quit particular deﬁne class comment class comment printed help requested want image saved end evaluation script use save option just eval using zeroconf script jenkins script possibility specify option write jenkins script rely bash zero conﬁguration script handler example command use jenkins project xmlwriter hosted pharoextras jenkins put params job export dirname wget vm bash save delete version conﬁg repo conﬁgurationof version test chapter summary really easily access latest version pharo build script addition handler open new horizon used shell file filesystem participation max leske maxleske library dealing ﬁles pharo called filesystem offer expressive elegant design chapter present key aspect api cover need filesystem result long hard work people tem originally developed colin putney library distributed mit license component pharo camillo bruni change original design camillo bruni integrated pharo help esteban lorenzano guillermo polito ter exist previous work contributor filesystem grateful getting started framework support different kind ﬁlesystems changeable transparently work probably common usage filesystem directly work ﬁles stored going work class filesystem offer factory offer access ent ﬁlesystems sending message disktofilesystem return ﬁle physical sending memory creates new ﬁle stored memory image working working filesystem disk workingdirectory file filesystem working filesystem disk workingdirectory class filereference message workingdirectory return reference directory containing pharo image reference instance class filereference reference central object framework vide primary mechanism working ﬁles directory filesystem deﬁnes class important filesystem filereference filelocator filesystemdirectoryentry fers factory method create new ﬁle filereference reference folder ﬁle offer method navigate perform operation afilelocator late binding reference asked perform concrete eration ﬁle locator look current location origin resolve path filesystemdirectoryentry allows additional information ﬁle directory class belong core package explained chapter use platform speciﬁc class unixstore windowsstore internal class code snippet work filereference instance navigating ﬁle let s play filesystem immediate child list immediate child working tory execute following expression working working filesystem disk workingdirectory working child anarray file file notice child return direct ﬁles folder recursively cess child current directory use message allchildren follows working allchildren converting string character ﬁle reference common handy operation simply send asfilereference string corresponding ﬁle ﬁle asfilereference note error raised string doe point existing ﬁle check ﬁle exists asfilereference exists false ﬁles filtering realized using standard pattern matching ﬁle ﬁnd st ﬁles working directory simply execute working allchildren select basename endswith basename message return ﬁle basename accessing given ﬁle directory use slash operator obtain erence speciﬁc ﬁle directory working directory working cache working filesystem disk workingdirectory cache working getting parent folder navigating parent easy using theparent message working cache working filesystem disk workingdirectory cache working parent cache parent parent working true accessing directory property check various property element example following try cache directory executing following expression cache exists true cache issymlink ask symbolic link false cache isfile false cache isdirectory true cache basename cache file filesystem cache parent fullname method exists isfile isdirectory basename deﬁned filereference class notice message path basename idiom use parent fullname obtain message path return path object internally used filesystem meant publicly used note filesystem doe really distinguish ﬁles folder lead cleaner code seen application composite design pattern querying ﬁle entry status additional information tem entry filesystemdirectoryentry using message entry note access ﬁle permission example cache entry creation cache entry creationtime cache entry creationseconds cache entry modiﬁcationtime cache entry size directory size cache entry permission cache entry permission class filesystempermission cache entry permission iswritable true cache entry isfile false cache entry isdirectory true location framework support location reference point ﬁle directory asking perform concrete operation location behaves way reference location filelocator desktop filelocator home filelocator imagedirectory filelocator vmdirectory save location image image ent machine operating location resolve expected directory ﬁle note ﬁle location speciﬁc virtual read write stream opening read write stream open stream ﬁle just ask reference using message writestream orreadstream follows working stream working filesystem disk workingdirectory stream working writestream stream nextputall world stream close stream working readstream stream content world stream close note writestream override existing ﬁle readstream throw exception ﬁle doe exist forgetting close stream common mistake advanced programmer regularly fall closing stream free low level resource good thing message readstreamdo writestreamdo free programmer explicitly closing stream consider working working filesystem disk workingdirectory working writestreamdo stream stream nextputall world working readstreamdo stream stream content mind ﬁle easily overridden giving ing consider following situation working working filesystem disk workingdirectory working readstreamdo stream stream content alexandre damien jannik ﬁle simply overridden filesystem disk workingdirectory writestreamdo stream stream nextputall joe reading ﬁle odd result working working filesystem disk workingdirectory working readstreamdo stream stream content joee alexandre damien jannik use message openfilestream astring writable aboolean stream corresponding write file filesystem stream stream filesystem disk openfilestream writable true stream nextputall alexandre damien jannik look stream protocol filereference convenience method renaming copying deleting ﬁles rectory file copied renamed using message copyto renameto note copyto task argument ﬁlereference renameto take path pathname reference working working filesystem disk workingdirectory working writestreamdo stream stream nextputall world working copyto working working working filesystem disk workingdirectory working readstreamdo stream stream content world working working filesystem disk workingdirectory working renameto working working filesystem disk workingdirectory working readstreamdo stream stream content world directory creation create directory use message createdirectory follows working working filesystem disk workingdirectory backup working backup createdirectory backup isdirectory true backup child main entry point filereference copy copy content directory using sage copyallto copy complete backup rectory using copyallto cache copyallto backup note copying target directory created doe exist deleting delete single ﬁle use message delete working delete delete complete directory tree including receiver use deleteall careful delete wrong folder backup deleteall main entry point filereference filesystem based multiple concept class filesystem path filereference important filereference offer set operation manipulate ﬁles far seen basic operation section cover elaborated operation design level ﬁle reference filereference combine entity path path ﬁlesystem filesystem single object provides simple protocol manipulate handle ﬁles filereference implement operation filesystem largely polymorphic need track path ﬁlesystem separately filereference information access given ﬁle reference access usual information using message basename base extension pf pf filesystem disk workingdirectory child second pffullname pfbasename file filesystem pfbasenamewithoutextension pfbase pfextension pfextensions orderedcollection indicator filesystem introduces notion ﬁle reference indicator indicator visual clue conveying type reference kind indicator implemented non existing reference directory string ﬁle filereference deﬁnes sage basenamewithindicator take advantage indicator following expression use pfbasenamewithindicator pf parent basename pf parent basenamewithindicator path need access portion path message pathsegments return cut path element string member design point view string considered dead object better deal real object example using path message pf pathsegments asmjit pf path path cache size filereference provides way access size ﬁle pf humanreadablesize kb pf size main entry point filereference file information limited information ﬁle entry using creationtime permission information access entry using message entry pf pf filesystem disk workingdirectory child second pf creationtime pf modiﬁcationtime pf permission r entry object represent metadata single ﬁle pf pf filesystem disk workingdirectory child second pfentry pf parent entry return entry child receiver operating ﬁles operation ﬁles deleting delete deleteall deleteallchildren delete receiver raise error doe exist delete deletes ﬁle deleteall deletes directory content deleteallchildren deletes child directory addition deleteifabsent executes block ﬁle doe exist finally ensuredelete deletes ﬁle doe raise error ﬁle doe exist similarly ensuredeleteallchildren ensuredeleteall raise tion receiver doe exist filesystem disk workingdirectory delete error filesystem disk workingdirectory deleteall error filesystem disk workingdirectory ensurecreatedirectory filesystem disk workingdirectory deleteall filesystem disk workingdirectory deleteifabsent warning signal did exist filesystem disk workingdirectory deleteallchildren file filesystem filesystem disk workingdirectory ensurecreatedirectory filesystem disk workingdirectory deleteallchildren creating directory createdirectory creates new directory raise ror exists ensurecreatedirectory veriﬁes directory doe exist creates necessary ensurecreatefile creates necessary ﬁle filesystem disk workingdirectory createdirectory filesystem disk workingdirectory createdirectory directoryexists true true filesystem disk workingdirectory delete filesystem disk workingdirectory ensurecreatedirectory filesystem disk workingdirectory ensurecreatedirectory filesystem disk workingdirectory isdirectory true ﬁles ﬁles using sage moveto expects ﬁle reference filesystem disk workingdirectory exist false filesystem disk workingdirectory exist false filesystem disk workingdirectory moveto filesystem disk workingdirectory targetfolder error filesystem disk workingdirectory ensurecreatefile filesystem disk workingdirectory ensurecreatedirectory filesystem disk workingdirectory moveto filesystem disk workingdirectory targetfolder filesystem disk workingdirectory exists false filesystem disk workingdirectory exists true moving ﬁles copy use copyallto copy ﬁles copy ﬁles contained source folder target message copyallto performs deep copy receiver location speciﬁed argument receiver ﬁle ﬁle copied ceiver directory directory content copied main entry point filereference argument reference doe exist created copy filesystem disk workingdirectory createdirectory filesystem disk workingdirectory ensurecreatefile filesystem disk workingdirectory ensurecreatefile filesystem disk workingdirectory createdirectory filesystem disk workingdirectory copyallto filesystem disk workingdirectory filesystem disk workingdirectory exists true filesystem disk workingdirectory exists true message copyallto used copy single ﬁle filesystem disk workingdirectory ensurecreatedirectory filesystem disk workingdirectory ensurecreatefile filesystem disk workingdirectory ensurecreatefile filesystem disk workingdirectory ensurecreatedirectory filesystem disk workingdirectory copyallto filesystem disk workingdirectory filesystem disk workingdirectory exists true filesystem disk workingdirectory exists false locator locator reference left deliberately fuzzy resolved concrete reference ﬁle operation performed instead ﬁlesystem path locator origin path origin abstract ﬁlesystem location user s home directory image ﬁle vm executable receives message like isfile locator ﬁrst resolve origin resolve path origin locator make possible specify thing like item named cache directory image ﬁle speciﬁcation remain valid image saved moved directory sibly different computer locator filelocator imagedirectory locator printstring imagedirectory locator resolve package locator isfile file filesystem locator isdirectory true following origin currently supported directory image resides image ﬁle change ﬁle executable running virtual machine directory containing vm application parent vmbinary user s home directory directory hold content user s desktop directory user s document stored application deﬁne origin able resolve automatically instead user asked ually choose directory choice cached future resolution request require user interaction absolutepath message absolutepath return absolute path receiver ﬁle reference virtual message path absolutepath provide similar result ﬁle late bound reference instance filelocator absolutepath resolve ﬁle return absolute path path return unresolved ﬁle reference shown filelocator image parent path image filelocator image parent absolutepath path filelocator image parent absolutepath path reference locator provide simple method dealing directory filesystem internals looking filesystem internals stage able comfortably use filesystem cover need ﬁle handing section internal component filesystem go important implementation detail surely reader willing new kind ﬁle example data base remote ﬁle filereference filesystem path path ﬁlesystems lowest level filesystem api filereference combine path ﬁlesystem single object vides simpler protocol working ﬁles previous section reference implement path protocol method like parent resolve filesystem ﬁlesystem interface access hierarchy directory ﬁles ﬁlesystem provided host operating represented diskstore subclass user access directly instead use filesystem showed previously kind ﬁlesystems possible memory ﬁlesystem vides ram disk ﬁlesystem ﬁles stored bytearrays image zip ﬁlesystem represents content zip ﬁle ﬁlesystem working directory used resolve relative path passed example f filesystem memory f workingdirectorypath path grifﬂe path nurp path f resolve nurp f createdirectory path created f writestreamon grifﬂe close created f isfile grifﬂe true f isdirectory grifﬂe false f copy grifﬂe nurp copied f exists nurp true f delete grifﬂe deleted f isfile grifﬂe false f isdirectory grifﬂe file filesystem path path fundamental element filesystem api resent ﬁlesystem path abstract sense provide protocol working path having manipulate string example showing deﬁne absolute path relative path ﬁle extension parent navigation parent normally need use path example f grifﬂe nurp f filesystem memory grifﬂe f referenceto path nurp f referenceto path grifﬂe isfile false grifﬂe isdirectory false grifﬂe parent ensurecreatedirectory grifﬂe ensurecreatefile grifﬂe exists grifﬂe isfile true grifﬂe copyto nurp nurp exists true grifﬂe delete absolute path path relative path path relative path extension path changing extension path parent directory path parent resolving relative path path resolve path resolving absolute path path resolve path summary resolving string path resolve comparing path contains path false note path protocol message like parent resolve available reference visitor method sufﬁcient common task application developer ﬁnd need perform sophisticated tions directory tree visitor protocol simple visitor need implement visitfile visitdirectory actual traversal ﬁlesystem handled guide guide work visitor crawling ﬁlesystem notifying itor ﬁles directory discovers guide class preorderguide postorderguide breadthfirstguide traverse tem different order arrange guide traverse ﬁlesystem particular visitor simple s example breadthfirstguide areference avisitor enumeration method described implemented tor copyvisitor deletevisitor collectvisitor example chapter summary filesystem powerful elegant library manipulate ﬁles damental pharo pharo community continue extend build class filereference important entry point work offer factory class method build ﬁle system hard disk memory central class framework represents ﬁle folder ﬁle reference offer method operate ﬁle navigate ﬁle sending message asfilereference string character return responding ﬁle reference asfilereference file filesystem creating ﬁle writing simple filesystem disk workingdirectory writestreamdo stream stream nextputall world late binding reference useful ﬁle location hard disk depends running context offer large set low level given socket written noury bouraqadi luc fabresse modern software involve multiple device collaborate network basic approach set collaboration use ets typical use world wide web browser server interact socket carry http request response concept socket ﬁrst introduced researcher university berkeley deﬁned ﬁrst socket api c ming language context unix operating system concept socket spread operating system api ported programming language chapter present api socket context pharo ﬁrst example use socket building client server notion client server inherent socket server wait request emitted client introduce socketstream use practice likely use socketstream instead plain socket chapter end description unix networking utility useful experimenting basic concept socket remote communication involves process ing data byte network process access socket socket figure socket deﬁned aplug communication network figure remote communication socket socket used establish bidirectional communication allow sending receiving data interaction according communication protocol encapsulated socket net network ethernet basic protocol widely used stand transmission control protocol internet protocol tcp short tcp use guarantee reliable communication data loss quire application involved communication connected actually communicating connection established interacting party send receive arbitrary byte referred stream communication data reach destination order sending stand user datagram protocol internet protocol udp short datagrams chunk data size exceed udp unreliable protocol reason udp doe guarantee datagrams actually reach destination second reason reception order multiple datagrams single sender ceiver arrive arbitrary order udp faster tcp connection required sending data typical use udp used social application client need notify server status requesting interaction ing invisible remainder chapter focus tcp socket create client socket connect server exchange data close connection section lifecycle illustrated using example area client showing use client socket interact web server tion present server socket use implement server handle concurrent connection introduce socket stream section overview beneﬁts describing use client server tcp client tcp client application initiate tcp connection exchange data application server important mention client server developed different language client pharo decomposes step create tcp socket connect socket server exchange data server socket close socket create tcp socket pharo provides single socket class creation method socket type tcp udp create tcp socket need evaluate ing expression socket newtcp connect tcp socket server connect tcp socket server need object representing ip address server address instance socketaddress handy way create use netnameresolver provides ip style network lookup translation facility script provides example socket address creation ﬁrst creates address string describing server second doe creation string representing ip address server note use netnameresolver need machine connected network likely case exception retrieving local host address basically directory map device name ip socket generic address refer machine run software pharo script creating socket address esugaddress localaddress esugaddress netnameresolver addressforname localaddress netnameresolver addressforname connect tcp socket server shown script message connectto port attempt connect socket server using server address port provided parameter server address refers address network interface ethernet wiﬁ used server port refers communication endpoint network interface network interface ip transport protocol tcp udp collection port numbered given protocol port number interface used single process script connecting tcp socket esug server clientsocket serveraddress clientsocket socket newtcp serveraddress netnameresolver addressforname clientsocket connectto serveraddress port waitforconnectionfor clientsocket isconnected true connectto port message return immediately issuing request connect socket primitive message waitforconnectionfor suspends current process socket nected server wait requested eter socket connected second connectiontimedout exception signaled execution proceed evaluating expression clientsocket isconnected answer true exchange data server connection established client exchange instance bytestring server typically client sends quest server wait response web browser act ing schema web browser client issue request web server identiﬁed url request path resource server html ﬁle picture browser awaits server response html code picture byte client script exchanging data server tcp socket clientsocket data create connect tcp clientsocket clientsocket senddata server data clientsocket receivedata process data script show protocol send receive data client socket send string server server using senddata message send receivedata message client socket read answer note reading answer blocking meaning receivedata return response read content variable data processed script bounding maximum time data reception create connect tcp clientsocket data clientsocket receivedatatimeout process data connectiontimedout timeoutexception self crlog data received crlog connection slow server note using receivedata client wait server ther sends data close connection mean client wait indeﬁnitely alternative client signal connectiontimedout exception client waited long shown script use message receivedatatimeout ask client socket wait second data received period time processed silently data received second connectiontimedout signaled example log description happened close socket tcp socket remains alive device end connected socket closed sending message close socket remains nected close indeﬁnitely network failure socket accept destroy message free resource required socket practice use closeanddestroy ﬁrst attempt close socket sending close message socket connected ration second socket destroyed note exist socket closeanddestroy second take parameter duration wait fore destroying socket script interaction web site cleanup clientsocket serveraddress httpquery htmltext httpquery string crlf string crlf string crlfcrlf serveraddress netnameresolver addressforname clientsocket socket newtcp clientsocket connectto serveraddress port waitforconnectionfor clientsocket senddata httpquery htmltext clientsocket receivedatatimeout htmltext crlog ensure clientsocket closeanddestroy summarize step described far use example getting web page server script forge string corresponding query start keyword followed slash saying requesting root ﬁle server speciﬁed protocol second line includes web server port line http query refers format cepted client intend display result query thetranscript state http query line beginning accept client accepts text html format retrieve ip address server create tcp socket connect server use ip address got previous step default port web server connection established second waitforconnectionfor connectiontimedout exception sending http query clientsocket senddata httpquery read received html text display socket note ask socket wait second answer server clientsocket receivedatatimeout timeout socket answer socket finally close socket free related resource clientsocket closeanddestroy ensure cleanup mean ensure message sent block performs socket connection data exchange web server transfer protocol used web server tcp server let build simple tcp server tcp server application awaits tcp connection tcp client connection established server client send receive data order big difference server client server us socket socket used handling client connection second serf exchanging data particular client tcp socket server tcp server step create ﬁrst tcp socket labelled connectionsocket wait connection making connectionsocket listen port accept client request connection result connectionsocket build second socket labelled interactionsocket exchange data client interactionsocket connectionsocket continue wait new connection bly create new socket exchange data client close interactionsocket close connectionsocket decide kill server stop cepting client connection figure socket server concurrently server multiple client concurrency explicit figure server listens incoming client connection request connectionsocket socket exchanging data possibly multiple client multiple teractionsockets client following ﬁrst illustrate socket serving machinery complete server class explain server related concurrency issue serving basic example illustrate serving basic simple example echo tcp server accepts single client request sends client data received quits code provided script script basic echo server connectionsocket interactionsocket receiveddata prepare socket handling client connection request connectionsocket socket newtcp connectionsocket listenon backlogsize build new socket interaction client connection request accepted interactionsocket connectionsocket waitforacceptfor rid connection socket useless rest example connectionsocket closeanddestroy display data client receiveddata interactionsocket receivedata receiveddata crlog send echo client ﬁnish interaction interactionsocket senddata receiveddata interactionsocket closeanddestroy create socket use handling incoming nections conﬁgure listen port backlogsize set meaning ask operating allocate buffer tion request backlog actually used example realistic server handle multiple connection store pending connection request backlog connection socket referenced variable connectionsocket set start listening client connection waitforacceptfor message make socket wait connection request second client tempts connect second message answer nil wise new socket interactionsocket connected client s socket point need connection socket anymore close connectionsocket closeanddestroy message server interaction socket connected client use exchange data message receivedata senddata presented section used achieve goal example wait data client display transcript lastly send client preﬁxed string ﬁnishing interaction client closing interaction socket different option test server script ﬁrst simple use nc netcat utility discussed section run server script workspace terminal evaluate following command line echo hello pharo nc localhost result transcript pharo image following line displayed hello pharo client terminal echo hello pharo pure pharo alternative relies using different image run server code client code ples run user interaction process pharo ui frozen point waitforacceptfor script provides code run client image note run server code ﬁrst client fail note interaction client server terminate want run example second time need run side script echo client clientsocket serveraddress echostring serveraddress netnameresolver addressforname clientsocket socket newtcp clientsocket connectto serveraddress port waitforconnectionfor clientsocket senddata pharo echostring clientsocket receivedatatimeout echostring ensure clientsocket closeanddestroy socket echo server class deﬁne echoserver class deal concurrency issue handle concurrent client query doe freeze ui figure show example echoserver handle client figure echo server concurrently serving client deﬁnition labelled class echoserver declares instance variable ﬁrst connectionsocket refers socket used listening client connection instance variable isrunning holding boolean isrunninglock holding mutex used manage server process dealing synchronization sue class echoserver class deﬁnition object subclass echoserver instancevariablenames isrunning isrunninglock classvariablenames pooldictionaries category isrunning instance variable ﬂag set truewhile server running accessed different process need ensure value read presence ple write access achieved using lock isrunninglock instance able guarantee isrunning accessed single process time method theechoserver isrunning read accessor echoserver isrunning isrunninglock critical isrunning tcp server method theechoserver isrunning write accessor echoserver isrunning aboolean isrunninglock critical isrunning aboolean access ﬂag possible accessor method method method isrunning read written inside block argument message critical sent isrunninglock lock instance mutex method receiving critical message mutex evaluates argument block evaluation cesses send critical message mutex suspended ﬁrst block mutex resume suspended process ﬁrst suspended cycle repeated suspended process mutex ensures isrunning ﬂag read wrote sequentially method theechoserver initialize method echoserver initialize super initialize isrunninglock mutex new self isrunning false manage server introduced method echoserver start echoserver stop begin simplest echoserver stop deﬁnition provided method simply set theisrunning ﬂag false consequence stopping serving loop method echoserver serve method method theechoserver stop method echoserver stop self isrunning false method theechoserver serve method echoserver serve self isrunning whiletrue self interactonconnection ensure connectionsocket closeanddestroy activity serving process implemented serve method method interacts client connection isrunning ﬂag true stop serving process terminates destroying connection socket ensure message guarantee destruction performed serving process terminated abnormally nation occur exception network disconnection user action process browser socket method theechoserver start method echoserver start isrunninglock critical self isrunning iftrue self self isrunning true connectionsocket socket newtcp connectionsocket listenon backlogsize self serve fork creation serving process responsibility method echoserver start line method echoserver start method ﬁrst check wether server running return isrunning ﬂag set true tcp socket dedicated connection handling created listen port backlog size set mentioned allocates buffer storing ing client connection request value depends fast server depending vm hardware mum rate client connection request backlog size large avoid losing connection request big avoid wasting memory finally echoserver start method creates process ing forkmessage self serve block created process priority creator process performs echoserver start method ui process executed workspace method theechoserver interactonconnection method echoserver interactonconnection interactionsocket interactionsocket connectionsocket waitforacceptfor iftimedout self interactusing interactionsocket fork method echoserver serve method trigger interaction connected client interaction handled echoserver interactonconnection method method connection socket wait client connection second client attempt connect period simply return socket cated interaction result process client connection request interaction performed process forkin line method theechoserver interactusing method echoserver interactusing interactionsocket receiveddata receiveddata interactionsocket receivedatatimeout receiveddata crlog interactionsocket senddata receiveddata ensure interactionsocket closeanddestroy socketstream interaction implemented method echoserver interactusing method client boil reading data provided client sending preﬁxed string worth noting ensure interaction socket destroyed exchanged data timeout socketstream socketstream stream encapsulates tcp socket eas data exchange providing buffering set facility od provides api socket figure socketstream allows use socket easy way socketstream created using method socketstream class openconnectiontohost port providing host address port initialises new socket default parameter build socketstream existing socket method socketstream class allows send data socket conﬁgured new socketstream receive data useful od receivedata wait data timeout receiveavailabledata receives data doe wait arrive method isdataavailable allows check data available stream receiving send data using method nextput nextputall ornextputallflush data stream method nextputallflush ﬂushes pending data putting data stream finally socketstream ﬁnished used send sage close ﬁnish close associated socket useful method ofsocketstream explained socket socketstream client illustrate socket stream use client following code snippet script show client us socket stream ﬁrst line webpage script getting ﬁrst line web page using socketstream stream httpquery result stream socketstream openconnectiontohostnamed port httpquery string crlf string crlf string crlf stream sendcommand httpquery stream nextline crlog ensure stream close ﬁrst line creates stream encapsulates newly created socket connected provided server responsibility message openconnectiontohostnamed port suspends execution tion server established server doe respond socket stream signal connectiontimedout exception exception actually naled underlying socket default timeout delay second deﬁned method socket class standardtimeout choose different value using socketstream timeout method socket stream connected server forge send http query notice compared script page skipped ﬁnal string crlf script socketstream sendcommand method automatically insert cr lf character sending data mark line ending reception requested web page triggered sending nextline message socket stream wait second data received data displayed transcript safely ensure connection closed example display ﬁrst line response sent server easily display response including html code sending uptoend message socket stream note wait bit longer compared displaying single line socketstream server socketstreams used server wrap interaction socket shown script script simple server using socketstream connectionsocket interactionsocket interactionstream connectionsocket socket newtcp connectionsocket listenon backlogsize interactionsocket connectionsocket waitforacceptfor interactionstream socketstream interactionsocket interactionstream sendcommand pharo server interactionstream nextline ensure connectionsocket closeanddestroy interactionstream ifnotnil interactionstream close server relying socket stream us socket handling ing connection request socket stream come action socket created interaction client socket wrapped socket stream eas data exchange using message sendcommand nextline close destroy socket handling nections close interaction socket stream care closing destroying underlying interaction socket binary ascii mode data exchanged treated byte character socket stream conﬁgured exchange byte using binary sends receives data byte array conversely socket stream conﬁgured exchange character default setting using message ascii sends receives data string suppose instance echoserver section started mean following expression server echoserver new server start default behavior socket stream handle ascii string sends reception instead script behavior binary mode nextputallflush message receives byte array argument put byte buffer immediately trigger sending flush message uptoend message answer array byte sent server note message block connection server closed script asocketstream interacting binary mode interactionstream socket openconnectiontohostnamed port interactionstream binary interactionstream nextputallflush interactionstream uptoend note client manages string ascii mode byte array binary mode impact server ascii mode socket stream handle instance bytestring character map single byte delimiting data socketstream act simply gateway network sends read byte giving semantics semantics zation meaning exchanged data handled object developer decide protocol use enforce ing side correct interaction good practice reify protocol materialize ject wrap socket stream protocol object analyzes exchanged data decides accordingly message send socket stream involved entity conversation need protocol deﬁnes ganize data sequence byte character sender conform organization allow receiver extract valid data received sequence byte possible solution set delimiters inserted byte character corresponding data example delimiter quence ascii character cr lf sequence considered ful developer socketstream class introduced sendcommand message method illustrated script appends cr lf sent data reading cr followed lf receiver know received sequence character complete safely converted valid data facility method nextline illustrated script implemented socketstream perform reading reception sequence use character byte delimiter ask socket stream read speciﬁc using upto message advantage using delimiters handle data arbitrary size con need analyze received byte character ﬁnd limit resource consuming alternative approach change byte character organized chunk ﬁxed size typical use approach streaming audio video content script content streaming source sending data interactionstream create instance socketstream contentfile filestream ﬁlenamed contentfile binary content contentfile uptoend chunksize chunkstartindex chunkstartindex content size whiletrue interactionstream chunksize putall content startingat chunkstartindex chunkstartindex chunkstartindex interactionstream ﬂush script give example script streaming ﬁle open binary ﬁle retrieve content using message uptoend loop sending data chunk byte rely thenext putall startingat message take argument size number byte character data chunk data source sequenceable collection index ﬁrst element chunk example make assumption size content collection multiple chunk size course real setting assumption doe hold need deal data smaller chunk possible solution replace missing byte zero addition ing memory ﬁrst practical solution streaming approach usually used instead script reading data chunk using socketstream interactionstream chunksize chunk interactionstream socketstream openconnectiontohostnamed port interactionstream isdataavailable iffalse delay formilliseconds wait chunksize interactionstream isdataavailable whiletrue chunk interactionstream chunksize chunk crlog interactionstream close crlog read data chunk socketstream responds message trated script consider server running port machine sends string size multiple right connection wait millisecond data received read data chunk ﬁve character display transcript server sends string character transcript hello line world second socket tip networking experiment section related socket socket stream used action web server example forged http query send server chose example make experiment straightforward platform agnostic real scale application tions involving http coded using higher level library zinc http library default pharo network programming easily scale complexity using box outside pharo necessary identify source odd behavior section list number unix utility deal low level network operation reader unix machine linux mac o x cygwin window use nc netcat netstat lsoffor test nc netcat ncallows set client server tcp default tocol udp redirects content stdin lowing snippet show send client server local machine listening port echo hello client nc command line start server listening port sends server ﬁrst client connect terminates interaction echo hi server nc server running mean option string produced preceding echo sent ﬁrst client connect alternative solution make ncserver send text type simply evaluate following command line echo nc type text terminal started server run client terminal text displayed client repeat action type text server start client time needed interactive making connection client server persistent evaluating following command summary line client sends line ended enter terminate sending eof signal echo cat nc netstat command provides information network interface socket computer provides statistic need use appropriate option ﬁlter information following command line allows playing status tcp socket address note port number address separated dot netstat lsof lsofcommand list ﬁles open course includes socket ﬁle unix lsofuseful ask netstat answer lsofshows link process socket ﬁnd socket related program example provided following command line list tcp socket nand poptions force lsofto display host address port number tcp chapter summary chapter introduces use tcp socket socket stream develop network client server reviewed survival kit network programming socket communication gateway stance class socket programming involves server client server wait request emitted client message senddata receivedata socket primitive send receive socket maximum waiting time set using receivedatatimeout buffered stream encapsulates tcp socket network dns accessible class netnameresolver convert device name numerical internet address unix doe provide networking utility useful ging testing purpose mentioned introduction recommend using socket stream higher level provide facility method cessfully used project swazoo kom web server used tively aidaweb seaside web framework socket stream remain cation involving different object distributed communicating image software developer need deal message passing remote object serializing argument result care distributed object stroyed referenced remote recurrent trivial issue solved broker orb orb free developer networking issue allows expressing remote munications simply using message exchanged remote object setting framework participation alain plantec application matures need provide variation default selection color default font default font size variation represent user preference possible software customizations release pharo contained used setting framework manage preference setting application expose ﬁguration setting limited managing pharo preference suggest using application nice setting intrusive support modular decomposition software added application application s inception setting framework look setting architecture setting support approach preference deﬁnition manipulation want express sentence package subsystem deﬁne customization point represented variable class variable code freely access customization value us change behaviour reﬂect preference subsystem describes preference late point time code subsystem explicitly refer setting object adapt setting framework control ﬂow subsystem doe involve setting jor point difference setting preference available vocabulary apreference particular value managed variable value sically preference value stored class variable instance variable singleton directly managed use simple accessors pharo contains numerous preference user interface theme desktop background color boolean ﬂag allow prohibit use sound deﬁne preference tion asetting adeclaration description preference value viewed updated setting browser preference value scribed setting setting built particular method tagged speciﬁc pragma speciﬁc pragma serf classiﬁcation tag used automatically identify method setting ure section explains declare setting pharo user need browse existing preference eventually change value dedicated user interface major role setting browser presented section figure package declares us customization point variable example usedstrategy declared class variable realestateagent customization point described setting instance ated automatic running setting declaration method setting browser collect setting instance present setting browser figure show important point architecture place ting setting package unloaded package deﬁning erences doe depend setting package architecture ported following point customization point application customization point ﬁned figure class realstateagent package deﬁnes class variable usedstrategy deﬁnes dows appear ﬂow package modular class realstateagent doe depend ting framework class realstateagent designed parametrized description customization point setting framework support description setting usedstrategy figure package basic setting deﬁnes method extension class realstateagent class important point method declaring setting doe refer directly setting class scribe setting using builder way description present package introducing reference collecting setting user presentation setting package deﬁnes tool manage setting setting browser user open change preference setting browser collect setting us description change value preference control ﬂow program dependency package setting package preference inverse setting browser setting browser shown figure mainly allows browse currently declared setting change related preference value open setting browser just use world menu world evaluate following expression settingbrowser open setting presented tree middle panel setting ing ﬁltering available panel currently selected setting description left panel current package set right panel setting framework figure setting browser browsing changing preference value setting declaration organized tree browsed dle panel description setting just click setting selected left panel updated information selected setting changing preference value simply browser line hold widget right update value kind widget depends actual type preference value preference value kind setting browser currently able present speciﬁc input widget following type boolean color directoryname font number point string word ﬁeld range input widget using slider used course list possible widget closed possible make setting browser support new kind preference value use different input get point explained section actual type setting string filename number orpoint change value user enter text editable widget case input conﬁrmedthe setting browser hitting return key setting value changed widget come handy retrieve use previously entered value click case filename adirectoryname button added open ﬁle directory chooser dialog possible action accessible contextual menu pending selected setting different possible version shown figure figure contextual popup menu expand setting tree node recursively accessible keyboard shortcut collapse setting tree node recursively accessible keyboard shortcut expand currently selected setting tree node recursively b open browser method declares setting accessible keyboard shortcut setting handy want change setting implementation simply implemented stand framework investigating example declare setting explained section export action string setting exported action menu option allow display action coded action management explained section default d set selected setting value default useful example played setting observe effect ﬁnally decide come default list e input widget editable menu item allows forget previously entered value emptying recorded setting framework searching ﬁltering setting pharo contains lot setting ﬁnding tedious ﬁlter setting list entering search text ﬁeld bar settingsbrowser setting description contains text entered shown text regular expression regexp checkbox checked way ﬁlter list setting choose package just click choose package button dialog opened list package setting declared choose setting declared selected package shown notice right text pane updated selected package depending using pharo change preference repeately example doing stration want bigger font work need set proxy home needed having change set ences depending doing dious boring setting browser possible save current set preference value named style reloaded later setting style management presented section declaring setting global preference pharo viewed changed using setting browser preference typically class variable instance variable singleton want able change value settingsbrowser setting declared setting declared particular class method implemented follows take builder argument tagged systemsettings pragma argument abuilder serf api facade building setting declaration pragma allows setting browser dynamically cover current setting declaration important point setting declaration package ciﬁc mean package responsible declaring setting particular package speciﬁc setting declared class companion package global setting deﬁning class package case direct beneﬁt package loaded setting automatically loaded package unloaded setting automatically unloaded addition setting declaration refer setting class builder argument assures application dependentdeclaring setting setting able remove setting want deﬁne extremely small footprint application let s example casesensitivefinds preference boolean preference used text searching true text ﬁnding case sensitive preference stored casesensitivefinds class variable class texteditor value queried changed respectively texteditor class casesensitivefinds texteditor class casesensitivefinds given texteditor class casesensitivefinds casesensitivefinds ifnil casesensitivefinds false texteditor class casesensitivefinds aboolean casesensitivefinds aboolean deﬁne setting preference casesensitivefinds class variable able change setting browser method implemented result shown screenshot figure codeholdersystemsettings class casesensitivefindssettingson abuilder systemsettings abuilder setting casesensitivefinds target texteditor label sensitive search translated description true ﬁnd command text make search case fashion translated parent codeediting figure casesensitivefinds setting framework let s study setting declaration detail header codeholdersystemsettings class casesensitivefindssettingson abuilder class method declared class codeholdersystemsettings class dedicated setting contains setting declaration ing class mandatory fact class deﬁne setting larations deﬁne way make sure setting declaration packaged different package preference deﬁnition layering purpose method take builder argument object serf facade api setting building content method essentially consists sending message builder declare organize ting pragma setting declaration tagged systemsettings pragma codeholdersystemsettings class casesensitivefindssettingson abuilder systemsettings fact setting browser opened ﬁrst collect setting larations searching method systemsettings pragma tion compile setting declaration method setting browser opened automatically updated new setting setting conﬁguration setting declared sending message setting builder identiﬁer passed argument example identiﬁer casesensitivefinds codeholdersystemsettings class casesensitivefindssettingson abuilder systemsettings abuilder setting casesensitivefinds sending message setting builder creates setting node builder wrapper setting node default symbol passed asdeclaring setting argument considered selector used setting browser preference value selector changing preference value default built adding colon getter selector casesensitivefinds selector sent target default class method implemented codeholdersystemsettings line setting declaration sufﬁcient casesensitivefinds casesensitivefinds cessors implemented codeholdersystemsettings fact default initialization ﬁt need course adapt setting node conﬁguration account speciﬁc situation example corresponding getter setter cessors casesensitivefinds setting implemented class tor explicitly set target texteditor sending message target setting node target class texteditor passed argument shown updated deﬁnition codeholdersystemsettings class casesensitivefindssettingson abuilder systemsettings abuilder setting casesensitivefinds target texteditor short version fully functional compiled taken account setting browser shown figure figure ﬁrst simple version casesensitivefinds setting unfortunately presentation really label shown setting browser identiﬁer symbol used build accessors access description explanation available setting new setting simply added root setting tree address shortcoming better conﬁgure setting node label description respectively label description message string setting framework codeholdersystemsettings class casesensitivefindssettingson abuilder systemsettings abuilder setting casesensitivefinds target texteditor label sensitive search translated description true ﬁnd command text make search case fashion translated parent codeediting don t forget send translated label description string greatly facilitate translation language concerning classiﬁcation setting tree organization way improve point fully detailed section target target setting receiver getting changing preference value time class typically preference value stored class variable class method used accessors accessing setting receiver singleton object currently case preference example free type font preference stored instance variable freetypesettings singleton receiver freetypesettings instance ing following expression freetypesettings current use expression conﬁgure target corresponding setting example glyphcontrast preference declared follow abuilder setting glyphcontrast target freetypesettings current label contrast translated simple unfortunately declaring singleton target like good idea declaration compatible setting style functionality section case separately indicate target class message selector send target class singleton shown example use thetargetselector message abuilder setting glyphcontrast target freetypesettings organizing setting targetselector current label contrast translated default value way setting browser build setting input widget depends actual value type preference having nilas value preference problem setting browser t ﬁgure input use basically properly shown good input widget preference set non nilvalue set default value preference initializing usual initialize method lazy initialization programed accessor method ence regarding setting browser best way lazy initialization example casesensitivefinds preference given section deed explained section setting browser contextual menu reset preference value default globally reset preference value fact setting preference value reset nil consequence preference automatically set default value soon using dedicated accessor possible change way accessor implemented reason preference accessor maintained package allowed change shown example workaround indicate default value declaration setting sending message default setting node codeholdersystemsettings class casesensitivefindssettingson abuilder systemsettings abuilder setting casesensitivefinds default true organizing setting setting browser setting organized tree related ting shown child setting framework declaring parent simplest way declare setting child setting use parent message identiﬁer parent setting passed gument example parent node existing node declared codeediting identiﬁer codeholdersystemsettings class casesensitivefindssettingson abuilder systemsettings abuilder setting casesensitivefinds target texteditor label sensitive search translated description true ﬁnd command text make search case fashion translated parent codeediting codeediting node declared example deﬁned group declaring group group simple node value used dren grouping node identiﬁed codeediting created sending group message builder identiﬁer passed argument notice shown figure codeediting node root declared child codebrowsing node codeholdersystemsettings class codeeditingsettingson abuilder systemsettings abuilder group codeediting label translated parent codebrowsing declaring able declare setting child node useful package want enrich existing standard setting tedious setting application speciﬁc directly declaring setting method sible typically root group declared application setting child setting declared method simply sending message root group message take block argument block new setting implicitly declared child root group receiver message setting figure declaring subtree method conﬁgurable formatter ting example example look figure show setting refactoring browser conﬁgurable formatter setting fully declared method rbconﬁgurableformatter class settingson given declares new root group conﬁgurableformatter child formatcommentwithstatements indentstring rbconﬁgurableformatter class settingson abuilder systemsettings abuilder group conﬁgurableformatter target self parent refactoring label formatter translated description related formatter translated abuilder setting formatcommentwithstatements label comment statement translated abuilder setting indentstring label string translated optional depending value particular preference want hide setting doesn t make sense example background color desktop plain doesn t make sense setting related gradient background instead user want gradient background second color gradient rection gradient origin setting presented look figure left gradient widget unchecked meaning actual value false case child right gradient widget checked setting value set trueand consequence setting useful set gradient background setting framework figure example optional subtree right gradient selected left gradient selected additional preference available handle optional setting simple optional setting declared child boolean parent setting case child setting shown parent value true concerning desktop gradient example setting declared polymorphsystemsettings given abuilder setting usedesktopgradientfill label description true setting available deﬁne desktop background color gradient abuilder setting desktopgradientfillcolor label color description second color gradient ﬁrst given color setting translated abuilder pickone desktopgradientdirection label domainvalues horizontal vertical radial abuilder pickone desktopgradientorigin label domainvalues left translated topleft parent setting value given evaluating polymorphsystemsettings class usedesktopgradientfill return true child color desktopgradientdirection desktopgradientorigin shown ordering setting default sibling setting sorted alphabetically label want change default behavior changing setting ordering way simply forbidding default ordering explicitly specifying order following example appearance group indicate ordering performed sending noordering message parent precise value domain appearancesettingson abuilder systemsettings abuilder group appearance label translated description setting concerned look n feel translated noordering indicate order setting node sibling sending message order number passed argument number integer float node order number placed sorted according respective order number order given item ordering applied sibling example look standardfonts group declared abuilder group standardfonts label font translated target standardfonts parent appearance abuilder launcher updatefromsystem order targetselector current script updatefromsystem label font translated abuilder setting defaultfont label translated abuilder setting codefont label translated abuilder setting listfont example launcher updatefromsystem declared ﬁrst node sibling identiﬁers defaultfont codefont listfont placed according declaration order providing precise value domain default possible value set preference restricted given actual type preference example color preference widget allows choose color number widget allows user enter number case particular set value desired example standard browser user interface theme setting choice ﬁnite set class free type cache size range setting framework allowed case comfortable widget accept particular value address issue domain value set constrained range list value declaring range setting example let s consider screen margin preference shown figure value represents margin size pixel left window expanded figure example range setting value integer make sense set stead minimum maximum constitute good range value use range constrain setting widget shown example comparing simple setting difference new setting node created range message instead setting message valid range given sending range message setting node interval given argument screenmarginsettingon abuilder systemsettings abuilder range fullscreenmargin target systemwindow parent window label screen margin translated description space left window s opened fullscreen translated range selecting list preference value constrained particular list value possible declare drop list used setting browser drop list initialized predeﬁned valid value example providing precise value domain consider window position strategy example corresponding widget shown action setting browser figure allowed value stagger figure example list setting example show simpliﬁed declaration window position strategy setting windowpositionstrategysettingson abuilder systemsettings abuilder pickone usedstrategy label position strategy translated target realestateagent domainvalues stagger cascade standard comparing simple setting difference new setting node created pickone message instead setting message list authorized value given sending domainvalues sage newly declared setting node collection given ment default value ﬁrst concerning window strategy example value set preference reverse stagger cascade standard unfortunately value handy programmer pect value example kind strategy object symbol directly serve selector fact second solution chosen realestateagent class maintainer inspect value returned realestateagent usedstrategy realize result asymbol reverse stagger cascade standard symbol look way window position strategy setting really implemented declaration differs basic tion given previously domainvalues argument simple array symbol array association declaration windowpositionstrategysettingson abuilder systemsettings abuilder pickone usedstrategy setting framework domainvalues stagger translated staggerfor initialextent world cascade translated cascadefor initialextent world translated standardfor initialextent world setting browser point view content list exactly user notice difference array association given argument domainvalues key ciations used user interface concerning value preference inspect realestateagent usedstrategy notice result value staggerfor initialextent world cascadefor initialextent world dardfor initialextent world fact value association used compute possible real value setting list possible value kind example let s look way user interface theme setting declared polymorphsystemsettings class abuilder pickone uithemeclass label interface theme translated target self domainvalues uitheme allthemeclasses collect c c themename c example domainvalues take array association puted time setting browser opened association theme key class implement theme value launching script imagine want launch external conﬁguration tool want allow conﬁgure particular package help script case declare launcher launcher shown label regular setting value entered instead button labelled launch integrated setting browser clicking launch associated script example use true type font updated collecting available font host evaluating following expression freetypefontprovider current updatefromsystem possible run script setting browser corresponding launcher shown figure integration launcher action management figure example launcher simple simply declare setting example look launcher tt font declared graphicfontsettings class standardfontssettingson systemsettings abuilder group standardfonts abuilder launcher updatefromsystem target freetypefontprovider targetselector current script updatefromsystem label font translated comparing simple setting difference new setting node created sending launcher message builder message script sent setting node selector script passed argument action management preference removed pharo obsolete large number setting browser easy use tedious set preference subset time start working new image solution implement script set preferred choice best way create speciﬁc class purpose include package reload time want setup fresh image kind class setting style manage setting style setting browser helpful way help discover change preference value second create update particular style setting framework scripting setting preference variable accessible accessor method naturally possible initialize set preference simple script sake simplicity let s implement setting style example script implemented change background color set font bigger default let s create setting style class mypreferredstyle script deﬁned method mypreferredstyle method loadstyle selector standard hook setting related script evaluating mypreferredstyle loadstyle f n desktop color polymorphsystemsettings desktopcolor color white bigger font n standardfonts defaultfont current default font f logicalfontfamilyname n familyname pointsize font preferred size standardfonts setallstandardfontsto f reset font polymorphsystemsettings class setting related polymorph declared standardfonts class used manage pharo default font question desktop color setting declared polymorphsystemsettings defaultfonts class allows font ment setting declared managed general answer quite simple just use setting browser explained section double clicking item open browser declaration current setting node use contextual menu browsing declaration target class preference variable stored selector preference value like mypreferredstyle loadstyle automatically uated mypreferredstyle loaded purpose thing implement initialize method mypreferredstyle class mypreferredstyle class initialize self new loadstyle integrating style setting browser script integrated setting browser loaded browsed removed purpose declare make sure setting browser discover justextending setting browser implement method named stylename class style class concerning example previous section implemented follows mypreferredstyle class stylename style used settingbrowser settingstyle preferred style mypreferredstyle class stylename take argument return style string settingstyle pragma used let setting browser know mypreferredstyle setting style class method compiled open setting browser popup style menu shown figure dialog list style name comprising figure dialog loading style style extending setting browser explained section setting browser default able age simple preference type default possibility generally situation helpful able handle complex preference value example let focus text selection preference primary selection optional kind text selection secondary selection ﬁnd replace selection selection bar selection background color set primary secondary ﬁnd replace selection text color chosen declaring selection setting individually far according default possibility setting declared text selection characteristic corresponding preference changed individually setting browser setting setting framework particular selection kind grouped child ting group immediate improvement optional text selection boolean setting used instead simple group example let s secondary selection text selection kind optional set background text color ing preference declared instance variable themesettings ues read changed current theme getting associated themesettings instance color setting declared dren usesecondaryselection boolean setting given abuilder setting usesecondaryselection target uitheme targetselector currentsettings label secondary selection translated abuilder setting secondaryselectioncolor label selection color translated abuilder setting secondaryselectiontextcolor label selection text color translated figure show setting declaration setting browser look feel clean fact observation take line selection kind little bit able view selection take lot vertical space underlying model explicitly designed setting selection kind grouped setting browser responding preference value declared separated instance ables themesettings section improve ﬁrst solution better design figure secondary selection setting declared basic setting ues improved selection preference design better solution design concept text selection preference value manage selection preference setting browser stead text selection preference basically color background second text primary lection selection optional design text selection preference follow object subclass textselectionpreference instancevariablenames textcolor mandatory used classvariablenames primaryselection secondaryselection selectionbar pooldictionaries category textselectionpreference instance variable color mandatory instance variable set false used boolean instance variable changed instead mandatory set true used instance variable set trueand changeable textselectionpreference class variable kind possible text selection preference getters setter plemented able manage preference setting browser example primaryselection textselectionpreference class primaryselection primaryselection ifnil primaryselection self new textcolor color black backgroundcolor color blue alpha mandatory true notice mandatory attribute initialized true example selection bar preference textselectionpreference class selectionbar selectionbar ifnil selectionbar self new backgroundcolor color lightblue verymuchlighter mandatory false notice preference declared optional text color preference changeable setting browser declare method ﬁrst setting declaration second implement view setting declaration implemented follow textselectionpreference class selectionpreferenceon setting framework systemsettings abuilder group selectioncolors label selection color translated parent appearance target self abuilder setting primaryselection order label abuilder setting secondaryselection label abuilder setting ﬁndreplaceselection label abuilder setting selectionbar label bar absolutely new declaration thing change value preference user deﬁned class fact case user deﬁned application speciﬁc preference class particular thing implement supplementary method view method named settinginputwidgetfornode implemented class method method settinginputwidgetfornode responsibility build input widget setting browser method take settingdeclaration ment settingdeclaration basically model instance managed thesettings browser settingdeclaration instance serf preference value holder deed setting view setting browser internally resented settingdeclaration instance text selection preference want able change color selection optional possibility enable disable regarding color depending selection preference value background color shown text color preference value nil mean having text color doe make sense corresponding color chooser built settinginputwidgetfornode method implemented textselectionpreference class settinginputwidgetfornode asettingdeclaration preferencevalue backcolorui usedui uielements preferencevalue asettingdeclaration preferencevalue usedui self usedcheckboxforpreference preferencevalue backcolorui self backgroundcolorchooserforpreference preferencevalue uielements usedui backcolorui preferencevalue textcolor ifnotnil self textcolorchooserforpreference preferencevalue ifnil self theme newrowin self world uielements cellinset chapter summary method simply add basic element row return row notice actual preference value instance textselectionpreference obtained settingdeclaration instance ing preferencevalue user interface element built based actual textselectionpreference instance ﬁrst element checkbox space returned checkboxforpreference invocation method implemented follow textselectionpreference class usedcheckboxforpreference aselectionpreference optional iftrue self theme newcheckboxin self world aselectionpreference getselected used setselected used getenabled optional label help disable selection iffalse morph new height width color color transparent element color chooser example background color chooser built follows textselectionpreference class backgroundcolorchooserforpreference aselectionpreference self theme newcolorchooserin self world aselectionpreference getcolor backgroundcolor setcolor backgroundcolor getenabled used help color translated setting browser user interface look shown figure line selection kind instead previous version chapter summary presented setting new framework manage preference ular way key point setting support modular ﬂow control package responsible deﬁne customization point setting framework figure text selection setting implemented speciﬁc ence class locally using setting possible tion point finally setting browser collect setting description present user ﬂow setting browser customized regular expression pharo participation oscar nierstrasz regular expression widely used scripting language perl python ruby useful identify string match certain pattern check input conforms expected format rewrite string new format pharo support regular expression regex package contributed vassili bykov regex installed default pharo regular template match set string example regular expression h match string hello match pharo follows matchesregex h true matchesregex h true matchesregex h true matchesregex h false matchesregex h false chapter start small tutorial example develop couple class generate simple site map web site use regular expression identify html ﬁles ii strip path ﬁle just ﬁle iii extract tle web page site map iv generate relative path root directory web site html ﬁles contains complete tutorial example provide complete tion regex package based largely vassili bykov s documentation regular expression pharo provided t utorial example generating site map job write simple application generate site map web site stored locally hard drive site map contain link html ﬁles web site using title document text link furthermore link indented reﬂect directory structure web site accessing web directory web site machine copy html ﬁles local directory serve test bed develop class webdir webpage represent directory web page idea create instance webdir point root directory containing web site send message maketoc walk ﬁles directory inside build site map create new ﬁle called containing link page web site thing watch webdir webpage remember path root web site properly generate link relative root deﬁne class webdir instance variable webdir homepath ﬁne appropriate initialization method deﬁne method prompt user location web site computer follows webdir setdir dir home path webdir dir homepath path webdir class ondir dir self new setdir dir home dir pathname webdir class selecthome self ondir filelist modalfolderselector method open browser select directory open inspect result webdir selecthome prompted giving directory containing web page able verify original documentation class rxparser example generating site map webdir homepath properly initialized directory holding web site path directory nice able programmatically instantiate webdir let s add creation method add following method try inspecting result webdir onpath path web site webdir class onpath homepath self onpath homepath home homepath webdir class onpath path home homepath self new setdir path asfilereference home homepath pattern matching html ﬁles far good like use regexes ﬁnd html ﬁles web site contains browse abstractfilereference class ﬁnd method ﬁlenames list ﬁles directory want select just ﬁle extension regex need ﬁrst dot match character x matchesregex true matchesregex true character cr asstring matchesregex true known kleene star stephen kleene invented regex operator match preceding regex number time including zero matchesregex x true x matchesregex x true matchesregex x true y matchesregex x false dot special character regexes want literally match dot escape matchesregex true x matchesregex true matchesregex true x matchesregex false let s check regex html ﬁles work regular expression pharo matchesregex true matchesregex true matchesregex false matchesregex false look good let s try application add following method webdir try test web site webdir htmlfiles webdir ﬁlenames select matchesregex send htmlfiles webdir instance print thing like webdir onpath htmlfiles caching regex browse matchesregex discover extension method string creates fresh instance rxparser time sent ﬁne ad hoc query applying regex ﬁle web site smarter create just instance rxparser reuse let s add new instance variable htmlregex towebdir initialize sending asregex regex string modify webdir htmlfiles use regex time follows webdir initialize htmlregex asregex webdir htmlfiles webdir ﬁlenames select htmlregex match listing html ﬁles work just did reuse regex object time accessing web page accessing detail individual web page responsibility separate class let s deﬁne let webdir class create instance deﬁne class webpage instance variable path identify html ﬁle homepath identify root directory web site need totutorial example generating site map correctly generate link root web site ﬁles contains deﬁne initialization method instance creation method class webpage initializepath ﬁlepath homepath dirpath path ﬁlepath homepath dirpath webpage class ﬁlepath forhome homepath self new initializepath ﬁlepath homepath homepath awebdir instance able return list web page contains add following method webdir inspect return value verify work correctly webdir webpage self htmlfiles collect webpage webdir fullname forhome homepath like webdir onpath webpage array webpage webpage string substitution s informative let s use regex actual ﬁle web page want strip away character path directory unix ﬁle directory end slash need delete slash ﬁle path string extension method copywithregex matchesreplacedwith doe want copywithregex elo matchesreplacedwith example regex elo match character e loro operator like kleene star match exactly oneor instance regex preceding match entire substring replay fresh string letter add following method verify work regular expression pharo webpage ﬁlename path copywithregex matchesreplacedwith like test web site webdir onpath webpage collect ﬁlename extracting regex match task extract title html page need way content page forward add following method try webpage content filestream oldfileornonenamed path content actually problem web page contain character case better following code webpage content filestream oldfileornonenamed path converter new content able like webdir onpath webpage ﬁrst content head title home page let s extract title case looking text occurs html tag title need way extract partof match regular expression subexpressions regexes delimited parenthesis consider regex ˆaeiou aeiou consists subexpressions ﬁrst match sequence second match vowel operator ˆat start bracketed set character negates pharo caret return keyword write avoid sion write ˆwhen using caret regular expression negate set character forget actually example generating site map try match preﬁx string extract match ˆaeiou aeiou asregex matchespreﬁx true subexpression subexpression subexpression successfully matching regex string send message subexpression extract entire match send subexpression nwhere number subexpressions regex regex subexpressions numbered use trick extract title html ﬁle deﬁne following method webpage title title asregexignoringcase matchespreﬁx self content iftrue subexpression iffalse self ﬁlename untitled html doe care tag upper lower case make regex case insensitive instantiating asregexignoringcase test title extractor like webdir onpath webpage ﬁrst title page string substitution order generate site map need generate link individual web page use document title link just need generate right path web page root web site luckily simple path web page minus path root directory web site watch thing homepath variable doe end append relative path doe include leading notice difference following result copywithregex matchesreplacedwith copywithregex matchesreplacedwith regular expression pharo ﬁrst result absolute path probably want deﬁne following method webpage relativepath path copywithregex homepath matchesreplacedwith webpage link self relativepath self title able like webdir onpath webpage ﬁrst link home page generating site map actually regular expression need generate site map just need method complete application want site map generation just add following method web site subdirectory need way access webdir webdirs webdir directorynames collect webdir onpath webdir pathname home homepath need generate html bullet list containing link web page web directory subdirectory indented bullet list webdir printtocon astream self htmlfiles ifnotempty astream nextputall ul cr self webpage astream nextputall li nextputall link nextputall cr self webdirs printtocon astream astream nextputall cr create ﬁle called root web directory dump site map syntax webdir tocfilename webdir maketoc tocstream tocstream webdir self tocfilename writestream self printtocon tocstream tocstream close generate table content arbitrary web directory webdir selecthome maketoc figure small site map regex syntax closer look syntax regular expression ported regex package simplest regular expression single character match exactly character sequence character match string exactly sequence character matchesregex true matchesregex true matchesregex false operator applied regular expression produce complex regular expression sequencing placing expression operator certain sense invisible arguably regular expression pharo seen kleene star regular expression followed asterisk match number including match original expression example matchesregex true matchesregex true b matchesregex true matchesregex false b doe match kleene star higher precedence sequencing star applies shortest possible subexpression precedes example ab mean afollowed zero occurrence b zero occurrence ofab matchesregex true matchesregex false obtain regex match zero occurrence ab enclose abin parenthesis matchesregex ab true matchesregex ab false c spoil fun useful operator similar instance regex modiﬁes match zero stance matchesregex true matchesregex false need b matchesregex true matchesregex c false b seen character special meaning regular expression need match literally escaped preceding backslash backslash special character need escaped literal match hold special character matchesregex false star right string special matchesregex true matchesregex true operator express choice sion match string subexpressions match string lowest precedence lower sequencing ample ab mean followed number b s b followed number s regex syntax matchesregex true matchesregex true matchesregex false bit complex example expression c match car cdr caar cadr function matchesregex c true matchesregex c true matchesregex c true possible write expression match string example expression string error apply expression invalid far used character smallest component ular expression useful component character set string character enclosed square bracket match single character appears bracket example match matchesregex true matchesregex false matchesregex false set match character using plus operator build following binary number nizer matchesregex true matchesregex false ﬁrst character opening bracket ˆ set inverted match single character notappearing bracket matchesregex false matchesregex true convenience set include range pair character separated hyphen equivalent listing character special character set ˆ close set example literally match set ˆ matchesregex true caret start matchesregex true hyphen end matchesregex true closing bracket start universal set regular expression pharo syntax represents literal match character match char group subexpression escape following special character kleene star match previous regex zero time match previous regex time match previous regex zero time match choice left right regex abcd match choice character abcd ˆ abcd match negated choice character match range character match alphanumeric match match digit match match space match table regex syntax nutshell character class regular expression include following backquote escape fer popular class character match alphanumeric character match digit match whitespace variant match complementary character table give summary syntax seen far mentioned introduction regular expression especially ful validating user input character class turn especially useful deﬁning regexes example number matched regex matchesregex true matchesregex false better want specify number start digit matchesregex true matchesregex true matchesregex true matchesregex false leading regex syntax check negative positive number matchesregex true matchesregex true matchesregex true matchesregex true matchesregex false negative zero matchesregex false leading zero floating point number require digit dot matchesregex true matchesregex true matchesregex true matchesregex true matchesregex false need digit recognizer general number format like matchesregex true character class include grep element listed table syntax represents alnum alphanumeric alpha alphabetic character cntrl control character ascii code digit decimal digit graph graphical character ascii code lower lowercase character print printable character graph punct punctuation character space whitespace character upper uppercase character xdigit hexadecimal character table regex character class note element component character class enclosed extra set square bracket form valid regular expression example string digit represented digit primitive expression operator common implementation regular expression matchesregex digit regular expression pharo special character class primitive expression unique smalltalk implementation sequence character colon treated unary selector supposed understood character character match expression answer true message selector allows readable efﬁcient way specifying character class example equivalent isdigit efﬁcient analogously character set character class negated ˆisdigit match character answer false toisdigit equivalent far seen following equivalent way write regular expression match string digit digit matchesregex true matchesregex true matchesregex true matchesregex digit true matchesregex isdigit true matching boundary group special primitive expression shown table used match boundary string syntax represents ˆ match string beginning line match string end line match string word boundary match string word boundary match string beginning word match string end word table primitive match string boundary world matchesregex true word boundary w world matchesregex false boundary o regex api focused mainly syntax regexes closer look different message understood string andregex api regexes matching preﬁxes ignoring case far example used string extension method matchesregex string understand following message preﬁxmatchesregex matchesregexignoringcase preﬁxmatchesregexignoringcase message preﬁxmatchesregex just like matchesregex receiver expected match regular expression passed argument matching just preﬁx matchesregex false preﬁxmatchesregex true matchesregexignoringcase true matchesregexignoringcase false preﬁxmatchesregexignoringcase true enumeration interface application need access allmatches certain regular expression string match accessible using protocol modeled familiar collection enumeration protocol regex matchesdo evaluates ablock match regular expression receiver string list orderedcollection new meet jill regex matchesdo word list add word orderedcollection regex matchescollect evaluates ablock match regular expression receiver string collect result answer sequenceablecollection meet jill regex matchescollect word word size orderedcollection allregexmatches return collection match substring ceiver string regular expression jill went hill allregexmatches orderedcollection regular expression pharo replacement translation possible replace match regular expression certain string using message copywithregex matchesreplacedwith hate ignatz copywithregex lower matchesreplacedwith love ignatz general substitution match translation message evaluates block passing match regular expression receiver string answer copy receiver block result spliced place respective match love ignatz copywithregex matchestranslatedusing asuppercase love ignatz message enumeration replacement protocol perform sensitive match version provided string protocol instead accessible using matching face presented following question interface send message matchesregex string following happens fresh instance rxparser created regular expression string passed yielding expression s syntax tree syntax tree passed initialization parameter instance ofrxmatcher instance set data structure work recognizer regular expression described tree original string passed matcher matcher check match matcher repeatedly match number string regular sion using message deﬁned string regular expression string parsed new matcher created match avoid overhead building matcher regular expression reusing matcher example create matcher class instance initialization stage store variable future use create matcher using following method send asregex orasregexignoringcase api directly instantiate rxmatcher using class method forstring orforstring ignorecase convenience method send matchesin collect match string octal asregex octal matchesin orderedcollection hex asregexignoringcase hex matchesin orderedcollection hex rxmatcher forstring ignorecase true hex matchesin orderedcollection matching matcher understands message return trueto indicate successful match search false match astring true argument string astring match asregex match true matchespreﬁx astring true preﬁx argument string essarily string match asregex matchespreﬁx hate krazy true search astring search string ﬁrst occurrence matching substring note ﬁrst method try matching beginning string using example matcher method answer success given string previous fail asregex search hate krazy true ﬁnds matcher store outcome match attempt report lastresult answer boolean outcome recent match attempt match attempted answer unspeciﬁed number asregex number search throw brick number lastresult true matchesstream matchesstreampreﬁx searchstream analogous message take stream regular expression pharo ignatz readstream throw brick krazy name asregex name matchesstreampreﬁx ignatz true subexpression match successful match attempt query original string matched regex subexpression sized regular expression expression regular expression compiled subexpressions assigned index starting example regex subexpressions including complete expression parenthesized subexpression ﬁrst leaf subexpression second leaf subexpression highest valid index equal plus number matching thesis valid index parenthesized subexpressions successful match matcher report original string matched subexpression understands message subexpressioncount answer total number subexpressions est value used subexpression index matcher value available immediately initialization change subexpression take valid index argument sent successful match attempt method answer substring original string corresponding subexpression matched subbeginning subend answer position argument string stream given subexpression match started ended spectively item asregex item search throw brick krazy item subexpressioncount item subexpression brick complete expression item subexpression brick subexpression item subexpression ﬁrst leaf subexpression item subexpression second leaf subexpression item subbeginning orderedcollection item subend orderedcollection regex api item subbeginning orderedcollection item subend orderedcollection elaborate example following piece code us mmm dd yyyy date format recognizer convert date array year month day string date asregex result date match iftrue date subexpression date subexpression date subexpression iffalse match enumeration replacement string enumeration replacement protocol saw earlier section actually implemented matcher rxmatcher implement following method iterating match string matchesin matchesin matchesin collect copy replacingmatcheswith copy translatingmatchesusing seuss cat hat awords asregex match word awords matchesin seuss orderedcollection awords matchesin seuss collect asuppercase orderedcollection awords copy seuss replacingmatcheswith grinch grinch grinch awords copy seuss translatingmatchesusing asuppercase cat hat following method iterating match stream matchesonstream matchesonstream matchesonstream collect copystream replacingmatcheswith copystream translatingmatchesusing readstream drummer piper lord lady writestream nummatch asregex nummatch copystream translatingmatchesusing asnumber asfloat asstring close content drummer piper lord lady regular expression pharo error handling exception raised rxparser building regexes exception common parent regexerror use usual smalltalk exception handling mechanism catch handle raised syntax error detected parsing regex raised error detected building matcher raised error occurs matching ple bad selector speciﬁed using selector syntax matcher s internal error asregex regexerror ex ex printstring nullable closure implementation note vassili bykov look ﬁrst case method string matchesregex need access package rxparser accepts string stream character regular sion produce syntax tree corresponding expression tree instance rxs class rxmatcher accepts syntax tree regular expression built parser compiles matcher structure instance rxm class rxmatcher instance test string positionable stream character match original regular expression search string stream substring matching expression match matcher report speciﬁc string matched expression parenthesized subexpression class support functionality used rxparser rxmatcher caveat matcher similar spirit notin design henry spencer s original regular expression implementation focus simplicity matcher pass spencer s test suite test suite protocol quite extra test added chance good summary acknowledgment ﬁrst release matcher thanks fellow smalltalkers convinced native smalltalk regular expression matcher worth effort alive advice encouragement release possible want thank felix hack eliot miranda robb shecter david smith francis wolinski haven t met heard agrees complete waste time chapter summary regular expression essential tool manipulating string trivial way chapter presented regex package pharo essential point chapter simple matching just send matchesregex string performance matter send asregex string representing regex reuse resulting matcher multiple match subexpression matching regex easily retrieved matching regex replace translate subexpressions new copy string matched enumeration interface provided access match certain regular expression regexes work stream ii source managementchapter versioning code monticello oscar nierstrasz versioning help store log multiple version code addition help manage concurrent access common source code repository keep track change set document enables developer collaborate soon size software increase class probably need versioning different versioning system available probably popular principle use age development pharo software project practice disconnect versioning pharo environment tion tool version plain text ﬁles individual package class method lack ability track change appropriate level granularity versioning tool know store class method instead plain text better job supporting development process multiple repository store project squeaksource main repository sioning system pharo class method line versioning code monticello text unit change chapter use smalltalkhub squeaksource use similarly smalltalkhub central online tory store version application using monticello smalltalkhub equivalent sourceforge monticello lent cv chapter learn use use monticello smalltalkhub manage software acquainted monticello brieﬂy earlier chapter delf tail monticello describes additional feature useful versioning large application basic usage start reviewing basic creating package committing change update merge change running example perfect number use small running example perfect chapter illustrate feature monticello start project deﬁning simple test deﬁne subclass testcase called perfecttest package perfect ﬁne following test method protocol running perfecttest testperfect self assert isperfect self assert isperfect self assert isperfect course test fail implemented isperfect method integer like code control monticello revise extend launching monticello monticello included standard pharo distribution monticello browser selected world menu figure cello browser consists list pane button pane left pane ﬁrst application pharo programming environment number discovered euclid perfect number positive integer sum proper divisor ﬁrst perfect usage list installed package right pane show known repository ous operation performed button pane menu list pane figure monticello browser creating package monticello manages version package package essentially named set class method fact package object instance packageinfo know identify class method long like version perfecttest class right way deﬁne package called perfect containing perfecttest lated class method introduce later moment package exists category called coincidentally perfect perfect monticello map category package press monticello browser enter perfect voilà just created perfect monticello package monticello package follow number important naming convention class method category new package named perfect contains class category perfect category name start includes perfecttest class method belonging anyclass category deﬁned protocol named perfect perfect protocol name start method known extension don t deﬁne soon method belonging class category perfect gories name begin protocol versioning code monticello figure creating perfect package name start belonging package cludes testperfect method belongs protocol running committing change note figure save button disabled greyed save perfect package need specify want save repository package container local machine remote accessed network various protocol used establish connection pharo image tory later section monticello support large choice repository commonly used http used smalltalkhub repository called package set default shown ﬁrst entry list repository monticello browser figure created automatically local directory pharo image located contain copy package download remote ries default copy package saved save remote server package know repository saved add new repository selected package press button offer number choice different kind repository including http rest chapter work package repository need explore feature monticello select directory repository named package cache press save enter propriate log message accept save usage figure set new version commit message save version package perfect package saved package directory contained directory pharo image note use kind repository http ftp local directory copy package saved use favorite ﬁle browser window explorer finder xterm conﬁrm ﬁle perfect created package cache sponds aversion immutable snapshot package written repository version unique version number identify repository aware number notglobally unique repository ﬁle identiﬁer different shot example perfect repository ﬁnal deployed version project saving version tory available number automatically assigned version change number wish note version branch interfere numbering scheme cv subversion shall later version default ordered version number viewing repository class extension let s implement method make test green deﬁne following method class integer method protocol called perfect add new boundary test check test green past convention developer log change using initial developer sharing identical initial convention use identiﬁer based apblack andrewblack versioning code monticello integer isperfect self self divisor sum self integer divisor self select self rem perfecttest testperfectboundary self assert isperfect self assert isperfect method integer belong perfect category dobelong perfect package protocol start match package method known class extension extend existing class method available load perfect package clean dirty package modifying code package development tool make package dirty mean version package image different version saved loaded figure modifying perfect package dirty monticello browser dirty package recognized terix preceding indicates package ted change need saved repository change lost saving dirty package clean try browse change button save change perfect package conﬁrm package clean usage repository inspector content repository explored using repository inspector launched using open button monticello cf figure select package repository open like figure figure repository inspector package repository listed inspector underlined package mean package installed image bold underlined mean package installed recent version repository normal typeface mean package installed image package selected pane list version lected package underlined version mean version installed image bold version mean version ancestor installed version mean newer version belongs different branch installed version versioning code monticello version displayed normal typeface show older sion installed current inspector open menu different sorting option unchanged entry menu discard ticular sorting us order given repository loading unloading updating package present version perfect package stored safely package repository unload package load earlier version ﬁnally update select perfect package repository monticello browser click package select unload package figure unloading package able conﬁrm perfect package vanished image monticello browser select package repository pane selecting package pane open repository inspector scroll select perfect package displayed normal face indicated installed select version package load usage figure loading earlier version able verify original red test loaded select second version perfect package repository inspector load updated package latest version test green branching abranch line development version exists independently line share common ancestor version look far time create new version branch saving package ing useful want new parallel development ple suppose job doing software maintenance company day different division asks software part tweaked thing slightly differently way deal situation create second branch program rate tweak leaving ﬁrst branch unmodiﬁed repository inspector select version perfect package load version displayed bold indicating longer loaded ancestor version implement following integer method place perfect protocol modify existing perfecttest test method versioning code monticello integer isperfect self iftrue false self divisor sum self integer divisor self select self perfecttest testperfect self assert isperfect self assert isperfect self assert isperfect self assert isperfect test green implementation fect number slightly different attempt load version perfect package warning unsaved change figure unsaved change warning select cancel avoid overwriting new method save change enter log message accept new version congratulation created new branch perfect age repository inspector open refresh new version figure merging merge version package using merge ton monticello browser typically want basic usage figure version separate branch version discover working version ii branch previously independent scenario common multiple developer working package consider current situation perfect package illustrated left figure published new version based version version based version version constitute independent branch figure branching left merging right point realize change version like merge change version version currently loaded like merge change version publish new merged version illustrated right figure versioning code monticello figure select separate branch bold merged select version repository browser shown figure click themerge button merge tool tool allows package version merging element contained package listed upper text pane lower text pane show deﬁnition selected ment figure version perfect package merged current version figure difference version ofexploring monticello repository theperfect package method perfecttest testperfectboundary new indicated method integer changed lower pane old new version source code integer isperfect new code displayed red removed code barred displayed blue unchanged code shown black method class conﬂict deﬁnition altered ure show conﬂicting method class integer isperfect divisor conﬂicting package element indicated underlined barred bold set typeface convention follows conﬂict plain typeface indicates deﬁnition conﬂicting example method perfecttest testperfectboundary doe conﬂict existing method installed method conﬂicting decision need posed change reject proposed method integer isperfect conﬂict existing deﬁnition image conﬂict resolved right clicking method current version use incoming version right replace current element right arrow used replace current element image ure integer isperfect version used left version rejected element left arrow rejected local deﬁnition replaced ure integer divisor version rejected deﬁnition version remain use incoming version integer isperfect current version integer divisor click merge button conﬁrm test green commit new merged version perfect version refresh repository inspector version shown bold version ancestor currently loaded version figure exploring monticello repository monticello useful feature figure monticello browser window button used save open look browse change used explore state history versioning code monticello figure older version ancestor merged version browse browse button open snapshot browser display content package advantage snapshot browser browser ability display class extension select perfect package click browse button figure snapshot browser reveals perfect package extends class integer method example figure show class extension deﬁned perfect package note code edited environment set accordingly class method open regular topic good practice browse code package publishing ensure really contains think doe change change button computes difference code image recent version package repository make following change perfecttest click change button monticello browser perfecttest testperfect self assert isperfect self assert isperfect self assert isperfect self assert isperfect perfecttest self assert select isperfect figure patch browser show difference code image recently committed version figure show perfect package locally modiﬁed changed method new method usual change offer choice contextual operation advanced topic look advanced topic including history aging dependency making conﬁguration class versioning code monticello history package select item history open version history viewer display comment committed version selected package figure version package case perfect listed left information selected version displayed right select perfect package right click select history item figure version history viewer provides information ous version package particular version explore change respect current working copy package loaded image spawn new history browser relative selected version dependency application live typically require ence package order work properly example let look content management pier large piece software facet tool documentation blog catch gy security facet implemented separate package pier package used isolation refer method class deﬁned package monticello provides dependency anism declaring required package given package ensure correctly loaded essentially dependency mechanism ensures required age package loaded package loaded quired package require package process plied recursively tree dependency ensuring leaf tree loaded branch depend new topic version required package checked new version age depend automatically depend new version dependency expressed repository quiring required package live repository figure illustrates work pier package package act kind umbrella requires pier package figure dependency pier dependency installing pier package installed furthermore developing package need saved dependent dirty package saved automatically let work practice perfect package currently dle test implementation suppose like instead separate separate package implementation loaded test default like load following step load version perfect package package cache create new package browser called newperfect drag class perfecttest package rename perfect protocol integer class newperfect rename versioning code monticello monticello browser add package newperfect newperfect extension add newperfect newperfect required package newperfect newperfect save package newperfect repository note ticello prompt comment save required package check package saved package cache monticello think perfect loaded unload load newperfect repository inspector cause newperfect extension andnewperfect loaded required package check test run note newperfect selected monticello browser dependent package displayed bold figure figure newperfect newperfect newperfect develop perfect package load save newperfect required package reason load newperfect repository cause newperfect newperfect loaded repository modify perfecttest class cause newperfect newperfect dirty newperfect extension topic commit change save newperfect mit new version newperfect requires new version ofnewperfect depend existing unmodiﬁed sion newperfect loading latest version newperfect allwill load latest version required package instead save newperfect notcause newperfect saved bad effectively break dependency load latest version newperfect latest version required package don t level package sufﬁx perfect match subpackages ﬁne perfect required package perfect perfecttest run trouble monticello save class package want package level build ﬂexible dependency package recommend using metacello conﬁguration chapter button creates kind conﬁguration structure thing add dencies class initialization monticello load package image class deﬁnes initialize method class sent initialize message sage sent class deﬁne method class class doe deﬁne method initialized initialize ﬁned superclass nb initialize method invoked merely reload package class initialization used perform number check cial action particularly useful application add new instance ables class class extension strictly limited adding new method class extension method need new instance variable exist suppose example want extend testcase class sunit method track history time test red need store information unfortunately deﬁne instance variable versioning code monticello solution deﬁne initialize method class class testcaseextension class initialize testcase instvarnames includes iffalse testcase addinstvarname package loaded code evaluated instance variable added doe exist note change class package package dirty previous example package sunit contains testcase installing testcaseextension package sunit dirty getting change set version monticello version snapshot package version contains complete set class method deﬁnitions constitute underlying package useful patch version patch set necessary effect version version change set pharo mechanism deﬁne patch change set composed global effect new change set created edited change sorter tool available world entry difference monticello version easily captured creating new change set loading second version package illustration capture difference version theperfect package load version perfect monticello browser open change sorter create new change set let s fect load version change sorter difference sion change set saved ﬁlesystem clicking selecting ﬁle ﬁle located pharo repository kind repository kind repository supported monticello ent characteristic us repository access right deﬁned globally tied lar user smalltalkhub example http http repository probably popular kind repository kind supported smalltalkhub nice thing http repository easy link directly speciﬁc version web site little conﬁguration work http server http repository browsable ordinary web browser webdav client http repository used http server smalltalkhub example simple apache monticello repository restricted access right install worked monticello repository right box redhat server posterity sake add conﬁg alias directory dav option index order allow deny allow allowoverride limit write permission list valid user limitexcept propfind option report authname authorization realm authuserfile authtype basic require valid give world authorized monticello repository created htpasswd went love monticello look forward future improvement ftp similar http repository us ftp server instead ftp server offer restricted access right different ftp client used browse monticello repository versioning code monticello good repository type store version good object database good fully distributed database management us active client s repository make good working repository version saved retreived transaction support journaling replication capability offered good suitable large repository used client directory directory repository store version directory local ﬁle requires little work set s handy private project requires network connection s option disconnected development package using exercise chapter example kind repository version directory repository copied public shared repository later time smalltalkhub support feature allowing package version ﬁles imported given project simply log smalltalkhub navigate project click import version link directory subdirectory directory subdirectory similar directory look subdirectory retrieve list available package instead having ﬂat directory contains package version repository hierarchically structured subdirectory smtp smtp repository useful sending version mail creating smtp repository specify destination email address address developer package s maintainer example mailing list version saved repository emailed address smtp repository programmatically adding repository particular purpose necessary programmatically add new repository happens managing conﬁgurations large set distributed monticello package simply customizing entry available monticello browser example following code snippet programmatically add new directory repository path repo mcdirectoryrepository new directory repository path asfilereference mcrepositorygroup default addrepository repo using smalltalkhub smalltalkhub online repository use store monticello package instance running accessible http figure smalltalkhub online monticello code repository use web browser visit main page http select project kind repository expression mchttprepository location user password versioning code monticello add repository monticello clicking selecting http template url corresponding project copy repository expression web page paste template going commit new version package need ﬁll user password open repository select latest version phexample click load pressing join link smalltalkhub home page probably ﬁrst step smalltalkhub account member new project allows create new project figure repository smalltalkhub conﬁgurable smalltalkhub offer option cf figure conﬁgure project itory tag assigned license chosen access people project restricted private public user deﬁned member project create team share project ﬁle format version stored repository binary ﬁles ﬁles commonly mcz ﬁles carry extension stand monticellothe ﬁle format zip mcz ﬁle simply zipped ﬁle containing source code mcz ﬁle dragged dropped open image ﬁle just like change set pharo prompt ask want load package contains monticello know repository package came use technique velopment try unzip ﬁle example view source code directly normally end user need unzip ﬁles self unzip ﬁnd following member mcz ﬁle file content mcz ﬁles actually zip archive follow certain tions conceptually version contains thing version related particular package mcz ﬁle contains ﬁle called package contains information package s snapshot contains author initial date time snapshot taken try snapshot mcz ﬁle contains member called version contains information version doesn t contain history source code s shot code single point time uuid identifying snapshot record uuids previous snapshot s descended snapshot record state package ular time mcz ﬁle contains directory named member directory contain deﬁnitions program element combined form snapshot current version cello create member directory called version depend speciﬁc version age mcz ﬁle contain directory member dependency member named package monticello package depends example ﬁle contain ﬁles named dependency versioning code monticello source code encoding member named contains standard ﬁleout code belongs package metadata encoding member zip archive encoded ing conceptually expression represent nestable naries pair element list represent key value example following excerpt version ﬁle package named aa message log message date january time author ancestor message basically say version log message created january ab ancestor named chapter summary chapter presented functionality monticello lowing point covered monticello mapped smalltalk category method protocol add package called footo monticello include class category called fooor starting include method category protocol starting finally include class extension method protocol called foo starting modify method class package marked dirty monticello saved repository kind repository popular http repository hosted smalltalkhub saved package cache locally directory called package monticello repository inspector used browse repository select version package load unload create new branch package basing new version version earlier latest version tory inspector keep track ancestry package tell version belong separate branch branch merged monticello offer ﬁne degree control resolution conﬂicts merged version merged sion ancestor version summary monticello track dependency package package dependency required package saved new sion package created depends latest sion required package class package initialize method initialize sent class package loaded mechanism used perform various check action particularly useful application add new instance variable class deﬁning extension method monticello store package version special zipped ﬁle ﬁle extension mcz ﬁle contains snapshot complete source code version package ﬁles containing important metadata package dependency drag drop mcz ﬁle image quick way load gofer scripting package loading pharo proposes powerful tool manage source code based merging tree distributed versioning particular presented monticello chapter pharo us package named monticello chapter ﬁrst reminder key aspect monticello script package using gofer gofer simple api monticello gofer developed renggli extended lorenzano bruni used metacello language manage package map present metacello chapter chapter preamble package management package package list class method deﬁnition pharo package associated namespace package extend class deﬁned package mean example package network add method class string string deﬁned package network class extension support deﬁnition layer allows natural deﬁnition package deﬁne package simply need declare using monticello browser deﬁne class extension deﬁne method category starting followed package network object subclass buttonsbar instancevariablenames gofer scripting package loading figure browser show class string get method asurl asurlrelativeto package network classvariablenames pooldictionaries category list change package publication simply selecting package clicking change monticello browser package versioning version management help sion storage keep history evolution provides management concurrent access source code repository keep trace saved change allows collaborate engineer project grows important use version ment monticello deﬁnes package version management pharo pharo class method elementary entity sioned monticello action superclass change instance variable change method adding changing deleting source anpreamble package management figure change browser show method string asurl changed http server allows save project particularly package aged monticello equivalent forge provides ment contributor status visibility information wiki rss feed source open everybody available http distributed architecture monticello monticello distributed version control management like git dedicated smalltalk monticello manipulates source code entity class method ble manage local distributed code server gofer allows script server publish download synchronize server monticello us local cache package time package quired ﬁrst looked local cache similar way package saved saved local cache physical point view monticello package zipped ﬁle containing complete source code package clear following make distinction package loaded pharo image package saved cache loaded package currently loaded called working copy package deﬁne following term image ject bytecode executed virtual machine loaded package loaded package server loaded memory dirty package loaded package unsaved modiﬁcations dirty package loaded package example figure package loaded server modiﬁed package loaded server modiﬁed locally image dirty saved server versioned gofer scripting package loading figure left typical setup clean dirty package loaded cached right package published saved cache remote server gofer gofer scripting tool monticello developed lukas renggli used metacello map project management tem built monticello gofer support easy creation script load save merge update fetch package addition gofer make sure stay clean state gofer allows load package located different repository single operation load latest ble version currently developed version gofer basis pharo pharo metacello us gofer underlying infrastructure load complex project gofer adapted load simple package ask gofer update executing following sion gofer gofer updateusing gofer using gofer using gofer simple need specify location package loaded ﬁnally operation performed location sent ﬁle http ftp simply location used access monticello repository example used following expression mchttprepository location user password typical gofer script say want load package repository available http account janniklaval gofer new url package load repository http ftp requires identiﬁcation sage url username password available pay close attention single message cascade message directory support access local ﬁles gofer new url username password package load work project provide credential gofer new url username password package deﬁne package loaded disablepackagecache disable package lookup local cache disablerepositoryerrors stop error raising load load package public server used gofer s api offer number shortcut shorten script want write script gofer scripting package loading people load code case having specify word really adequate example smalltalkhub verbose url http main project goferexample use smalltalkhubuser project sage just specify minimal information chapter use shortcut http specifying user password gofer new smalltalkhubuser pharobooks project goferexample package load addition gofer doe succeed load package ﬁed url look local cache normally root image possible force gofer use cache using message disablepackagecache use using message enablepackagecache similar manner gofer return error ries reachable instruct ignore error using sage disablerepositoryerrors enable message use message enablerepositoryerrors package identiﬁcation url option speciﬁed deﬁne package want load using message version deﬁnes exact version load message package used load latest version available repository following example load version package gofer new smalltalkhubuser project version load specify constraint identify package using sage package astring constraint ablock pas block example following code load latest version package saved developer named janniklaval gofer new smalltalkhubuser project package constraint version version author loadgofer action gofer action loading package load package different server crete example load ﬁrst conﬁguration osprocess using metacello conﬁguration gofer new load version conﬁguration osprocess url package load load osprocess need ask conﬁguration smalltalk conﬁgurationofosprocess project version stable load following code snippet load multiple package different server loading order respected script load ﬁrst collection arithmetic necessary sound ﬁnally phratch port scratch visual programming language note load complete phratch application moment gofer new url package url package package package package url package load example impression collection looked collectionarithmetic repository server smalltalkhub phratch looked project phratch smalltalkhub server case gofer doe account order absence version number gofer load recent package version looking server rewrite script following way gofer new url url gofer scripting package loading url package package package package package package load want specify package loaded speciﬁc server write multiple script gofer new url package load gofer new url package package package package load gofer new url package load note script load latest version package fragile new package version published load unstable general good practice control version external component rely use latest version current development problem solved metacello tool express conﬁgurations load protocol gofer support ftp loading local directory cally use message change ftp specify url using heading gofer new url work local directory message directory followed lute path directory used specify directorygofer action use reachable gofer new directory finally possible look package repository folder using keen star gofer new directory gofer instance parametrized send message form different action list possible action described later load load speciﬁed package update update package loaded version merge merge distant version currently loaded localchanges list change basis version version currently modiﬁed remotechanges change version currently modiﬁed version published server cleanup cleanup package obsolete information cleaned commit commit save package distant server sage log revert reload previously loaded package recompile recompile package unload unload package image fetch download remote package version mote server local cache push upload version local cache mote server working remote server monticello distributed versioning control useful synchronize version published remote server one locally published mc local cache main operation port task merge update revert operation message merge performs merge remote version working copy currently loaded gofer scripting package loading change present working copy merged code remote copy case merge working copy get dirty republished new version contain current change change remote version case conﬂicts user warned operation happen silently gofer new smalltalkhubuser project package merge message update load remote version image tions working copy lost message revert reset local version load current version change working copy lost commit commit operation merged changed package want save use message commit commit second expecting comment general good practice gofer new save package repository smalltalkhubuser project package comment change save commit try use message commit localchanges remotechanges operation loading saving version useful verify change locally server message localchanges show change loaded version working copy remotechanges show difference working copy published version server return list change gofer new smalltalkhubuser project package check publish change comparing local change versus package published server localchanges using message browselocalchanges browseremotechanges possible browse change using normal code action gofer new smalltalkhubuser project add latest version package browse latest version published server browseremotechanges unload operation message unload unloads package image note using monticello browser delete package operation doe remove code class associated package just destroys package unloading package destroys package class contains following code unloads package class current image gofer new package unload note unload gofer way gofer gofer unload doe work fetch push operation monticello distributed versioning tem good idea save version want locally forced published remote server especially true working tedious synchronize local remote published package message fetch push support task message fetch copy package missing remote server local server package loaded pharo fetch load package remote server break gofer new smalltalkhubuser project package fetch want load package locally remember set lookup take account local cache disables error presented beginning chapter message disablerepositoryerrors enablepackagecache message push performs inverse operation publishes locally available package remote server package published locally pushed gofer scripting package loading gofer new smalltalkhubuser project package push pattern copy version project project used local cache way autonomous network failure package backed regular backup message easy write script sync synchronizes local remote repository gofer new smalltalkhubuser project package push gofer new smalltalkhubuser project package fetch mentioned earlier multiple package pushed fetched gofer new smalltalkhubuser project package package push gofer new smalltalkhubuser project package package fetch automating answer package installation asks information password systematic use build server package probably stop important know supply answer script question message valuesupplyinganswers support task gofer new squeaksource package load useful script valuesupplyinganswers seaside true user password test false message sent block giving list question answer shown previous example conﬁguration loading gofer support metacello conﬁguration loading provides set following message handle conﬁgurations conﬁgurationof loadversion loaddevelopment loadstable example loading development version nativeboost need specify nativeboost project load conﬁgurationofnativeboost execute loading development version gofer new smalltalkhubuser project conﬁguration loaddevelopment repository doe match conﬁguration use conﬁgurationof provide conﬁguration class useful script gofer offer nice facility gather package given itory message allresolved script getting number package repository gofer new smalltalkhubuser project allresolved size following script gather package version package turn dictionary script grouping version package name gofer new smalltalkhubuser project gofer scripting package loading allresolved groupedby packagename script getting package list kozen project hosted gofer new allresolved groupedby packagename key fetching package script fetch package given repository useful grabbing ﬁles having version locally script fetching package repository gofer new allresolved self crlog packagename package packagename fetch script fetching refactoring package repository gofer new allresolved select match packagename pack self crlog pack packagename package pack packagename fetch publishing local ﬁles following script publishes ﬁles local cache given tory script publish package ﬁles new repository using pharo gofer new repository mchttprepository location user useful script password filesystem workingdirectory allentries select match f version join f ﬁndtokens allbutlast push following script us new ﬁlesystem library package version script pay attention publish mcz ﬁles extended publish selectively speciﬁc package script publish package ﬁles new repository using pharo gofer new repository mchttprepository location user password filesystem disk workingdirectory allfiles select match basename groupedby base copyuptolast key package push script publish fame moose team smalltalkhub repo mcsmalltalkhubrepository owner project user password gofer new repository repo filesystem disk workingdirectory allfiles select fame match basename groupedby base copyuptolast key package push page love simple script think version migrate monticello gofer scripting package loading script script synchronize monticello repository source gofersource destination goferdestination ﬁles destinationfiles source mchttprepository location destination mcsmalltalkhubrepository owner project y ourpackage user y ourname password gofersource gofer new repository source goferdestination gofer new repository destination ﬁles source allversionnames select relevant mcz package gofersource allresolved select resolved ﬁles anysatisfy resolved thendo gofersource package packagename download mcz computer gofersource fetch check ﬁles destination destinationfiles destination allversionnames select mcz destination ﬁles reject ﬁle destinationfiles includes ﬁle thendo ﬁle goferdestination version ﬁle send smalltalkhub goferdestination push check exactly ﬁles source destination destination allversionnames sorted ﬁles sorted chapter summary gofer provides robust stable implementation script ment package project grows really sider using metacello chapter chapter introduce script package gofer method load allows load package source given method url package method url support ftp local directory summary api provides useful shortcut smalltalkhubuser project shortcut http http gemsource forhttp load package calling method package multiple time calling load gofer instance parametrized perform number relevant operation update merge push managing project metacello participation dale henrichs mariano martinez peck marianopeck problem trying load project error package aware missing worse present wrong version situation easily occur project load ﬁne developer developer working context different solution project developer use package dependency management explicitly manage dependency age make project chapter show use metacello pharo s package management demonstrates beneﬁts ing introduction say metacello package management monticello exactly doe mean package management tion tool automate process installing upgrading conﬁguring removing group software package metacello group package simplify thing user manages dependency version component loaded make sure set package managing project metacello package management provides consistent way install age package management system incorrectly referred installers lead confusion package management tem doe lot install software used package agement system context example include envy visualage smalltalk maven java debian ubuntu key feature package management rectly load package need manually install make possible dependency dependency dencies speciﬁed description package information allow package management tool load correct order example power metacello pharocore age load anypackage anyproject problem dencies course metacello doe magic work long package developer properly deﬁned dependency tool job pharo provides tool managing software package closely related purpose tool monticello age version source code gofer scripting interface cello metacello package management monticello source code versioning source code versioning process assigning unique version particular software state let commit new version update new version committed merge change look difference version revert older version pharo us monticello source code versioning age monticello package monticello let tions individual package monticello doe provide good way easily specify dependency package identify stable version package group package meaningful unit ter describes gofer monticello s scripting interface gofer small tool sits monticello used load update merge difference revert mit recompile unload group monticello package gofer make sure operation performed cleanly possible information chapter metacello package management metacello introduces notion ofmetacello feature project set related monticello package used manage project dependency metadata metacello manages dependency package metacello feature metacello consistent important feature monticello based following idea declarative project description metacello project named version consisting list monticello package version dependency explicitly expressed term named version required project required project reference metacello project collectively description called project metadata project metadata versioned metacello project metadata represented instance method class managing metadata code brings lot power comparison xml package management system use metacello project metadata stored monticello package subject version trol result concurrent update project metadata managed easily parallel version metadata merged just like parallel version code base metacello following feature metacello run platform support monticello currently mean pharo squeak glass conditional package loading enable project run multiple form metacello support conditional loading monticello package conﬁgurations metacello manages conﬁgurations project large project frequently multiple variation different set package project required platform unique conﬁguration beled version string metacello support deﬁnition kind entity represented method baseline version baseline baseline deﬁnes basic structure project baseline list package required project compose project baseline deﬁnes order package loaded repository package managing project metacello figure conﬁgurations group baseline version cies version version identiﬁes exact version package project loaded version based baseline version package baseline version monticello ﬁle speciﬁed project baseline version metacello version number speciﬁed conﬁgurationofprojecta figure contains baseline baseline version version baseline composed package packagea packageb version based baseline speciﬁes version package version based baseline speciﬁes different version packagea baseline composed package packagea packageb agec depends external project projectb new package agec project dependency projectb added project new baseline version reﬂecting new structure needed created simple case study sion based baseline speciﬁes version package sion dependent project simple case study example start simple conﬁguration expressed version gradually add baseline normal life better start deﬁnining baseline followed version let s start using metacello manage software project called browser ﬁrst step create metacello conﬁguration project simply copying class metacelloconﬁgtemplate naming conﬁgurationofcoolbrowser right clicking class select copy using monticello browser chapter tion class describes currently available conﬁgurations project set baseline version previously called metadata conﬁguration represents different version project load project different environment different version pharo vention metacello conﬁguration constructed preﬁxing project conﬁgurationof class deﬁnition object subclass conﬁgurationofcoolbrowser instancevariablenames classvariablenames pooldictionaries category notice conﬁgurationofcoolbrowser method explain later used notice class inherits object important metacello tions loaded prerequisite including metacello metacello conﬁgurations rely common superclass imagine project coolbrowser version ple metacello create conﬁguration od method content version project method name version method unimportant long method annotated version pragma shown convention version method named versionxxx xxx version number illegal character like suppose moment project coolbrowser contains age coolbrowser coolbrowser figure tion method version method look like following managing project metacello figure simple version conﬁgurationofcoolbrowser spec version spec common spec blessing release spec repository spec package package method spec build description version project object spec common code version speciﬁed using sage consists particular version package named coolbrowser coolbrowser speciﬁed message package packagename versionname version available cello repository http speciﬁed using message repository blessing method used denote released version speciﬁcation changed ture blessing development used version stabilized let look detail immediately method selector pragma deﬁnition version pragma version indicates version created method associated version coolbrowser project said method portant metacello us pragma method identify version deﬁned argument method spec variable method used receiver different message blessing package repository time block passed argument message package new object pushed stack message block sent object simple case study symbol common indicates project version common platform addition common attribute platform metacello run pharo squeak gemstone squeakcommon pharo pharo method metacelloplatformattributes deﬁnes attribute value use password monticello repository requires password case use message repository username password instead repository spec repository username password speciﬁcation object spec object object representing mation given version version just number cation object access speciﬁcation using spec message normally needed conﬁgurationofcoolbrowser project version spec answer object instance class metacellomcversionspec tains exactly information method deﬁnes version creating new version let assume version project consists package version coolbrowser coolbrowser new package coolbrowser version coolbrowser specify new conﬁguration creating following method named conﬁgurationofcoolbrowser spec version spec common spec repository spec package package package manage multiple repository add multiple tory spec just specify multiple time repository expression conﬁgurationofcoolbrowser spec managing project metacello figure version project spec common spec repository spec repository use message repositoryoverrides self whateverversion repositoryoverrides self whateverrepo load note message recursively propagate dependent ﬁgurations naming conﬁguration previously learned convention conﬁguration class example conﬁgurationofcoolbrowser convention create monticello package conﬁguration class class package example create package conﬁgurationofcoolbrowser containing exactly class conﬁgurationofcoolbrowser making package conﬁguration class starting string conﬁgurationof make easy scan repository listing available project convenient conﬁgurations stored monticello repository loading metacello conﬁguration course point specifying project conﬁgurations metacello able load exactly conﬁguration image suremanaging dependency package coherent set package version load version send message load version example loading version coolbrowser conﬁgurationofcoolbrowser project version load conﬁgurationofcoolbrowser project version load note addition print result expression list package load order metacello manages package loaded order handy debug conﬁgurations selective loading default loadmessage load package ciated version later change deﬁning particular group called default want load subset package project list name package interested argument load method conﬁgurationofcoolbrowser project version load debugging conﬁguration want simulate loading uration actually loading use record orrecord instead ofload orload result simulation send message loaddirective follows conﬁgurationofcoolbrowser project version record loaddirective apart load record useful method fetch fetch explained record simply record monticello ﬁles downloaded order fetch access downloads needed monticello ﬁles just record implementation load ﬁrst doe fetch doload managing dependency package project generally composed package pendencies package likely certain package depends speciﬁc version package handling dependency correctly really important major beneﬁts metacello type managing project metacello internal dependency package inside project depend package project dependency project common project depend project package project ple pier content management depends magritte metadata modeling framework seaside framework web application development let focus internal dependency imagine package coolbrowser coolbrowser depend coolbrowser described figure speciﬁcations version did capture dependency new conﬁguration doe conﬁgurationofcoolbrowser spec version spec common spec repository spec package package spec ﬁle requires package spec ﬁle requires added dependency information using requires tive introduced ﬁle message refers speciﬁc sion package coolbrowser coolbrowser require coolbrowser loaded loaded notice did specify exact version pend cause problem don t worry address ciency soon version mixing structural information required age repository version information exact number version expect time version information change frequently structural information remain ture metacello introduces concept baseline figure version internal dependency package project baseline baseline represents skeleton architecture project term structural dependency package project baseline ﬁnes structure project using just package name ture change baseline updated absence structural change change limited picking speciﬁc version package baseline let s continue example modify use baseline create method baseline note method version pragma form readability purpose add baseline argument blessing message mandatory deﬁnes baseline conﬁgurationofcoolbrowser spec convention version convention spec common spec blessing baseline mandatory declare baseline spec repository spec package package spec requires package spec requires method deﬁnes structure used version example version managing project metacello figure version import baseline express cies package shown figure baseline speciﬁes repository package dependency package doe specify speciﬁc version package deﬁne version term baseline use pragma version import follows conﬁgurationofcoolbrowser spec version import spec common spec package package package method specify speciﬁc version package pragma version import speciﬁes list version version sion based speciﬁc version speciﬁed loaded way regardless fact us baseline conﬁgurationofcoolbrowser project version figure second version import baseline version loading baseline version doe contain explicit package version information load conﬁgurationofcoolbrowser project version load loader encounter package version information tempts load recent version package repository especially developer working project useful load baseline version access recent work developer case baseline version really bleeding edge version declaring new version suppose want create new sion project version structure version contains different version package capture content importing baseline relationship depicted figure conﬁgurationofcoolbrowser spec version import spec common spec package package package creating baseline big project require time effort capture dependency package managing project metacello thing look later baseline deﬁned creating new version project greatly simpliﬁed take little time group suppose coolbrowser project grows developer writes test coolbrowser constitute new package named coolbrowser naturally depends coolbrowser coolbrowser shown figure want load project test addition convenient able load test simple expression like conﬁgurationofcoolbrowser project version load instead having explicitly list test package like conﬁgurationofcoolbrowser project version load metacello provides notion group group collection item item package project group group useful let set item various pose maybe want offer user possibility installing just core core development feature make easy deﬁning appropriate group let s example look deﬁne new baseline deﬁnes group shown figure example create group called test comprises coolbrowser coolbrowser deﬁne group use method group groupname groupelements argument package project group collection thing code corresponding figure conﬁgurationofcoolbrowser spec version spec common spec blessing baseline spec repository spec package package spec requires package spec requires package spec requires specgroups figure baseline group default core extra test withouttests completewithtests group default group group group group group group deﬁned baseline deﬁning group line version group structural component note default group used subsequent section default group tions package loaded method loadis used using baseline deﬁne version sion addition new package coolbrowser conﬁgurationofcoolbrowser spec version import spec common spec package package package package managing project metacello example deﬁned group use use project package load method take parameter package project group collection item following statement possible conﬁgurationofcoolbrowser project version load load single package conﬁgurationofcoolbrowser project version load load single group conﬁgurationofcoolbrowser project version load load single group conﬁgurationofcoolbrowser project version load load package group conﬁgurationofcoolbrowser project version load load package group conﬁgurationofcoolbrowser project version load load package conﬁgurationofcoolbrowser project version load load group group default default group special load message load member default group loading allgroup load package default default load conﬁgurationofcoolbrowser project version load load just coolbrowser coolbrowser presence default group load package project use predeﬁned allgroup shown conﬁgurationofcoolbrowser project version load project core test default group conﬁguration core real code test associated test question loaded default group remember get loaded specify parameter saying spec group say default load test specify default default equivalent case spec group test believe using default good load test explicitly test group default group specify default dependency project way package depend package project depend project example pier content management cm depends magritte seaside project depend tirety project group package project just package project depending project metacello description suppose package project x depends package b project y project y described using metacello case dependency follows baseline method spec package spec requires package spec repository version method package work point shortcoming approach cause project b described metacello conﬁguration cies b managed dependency package b loaded recommendation case time create conﬁguration project managing project metacello depending project metacello conﬁguration let look case project depend described using metacello let s introduce new project called cooltoolset us package coolbrowser project conﬁguration class called conﬁgurationofcooltoolset suppose package cooltoolset called cooltoolset cooltoolset package pend package coolbrowser version just normal version import baseline conﬁgurationofcooltoolset spec version import spec common spec package package project depend follows convention class conﬁgurationofcoolbrowser package conﬁgurationofcoolbrowser deﬁnition baseline simple default just need specify version ingversionstring want load project repository using repository conﬁgurationofcooltoolset spec version spec common spec repository spec project spec repository load versionstring spec package spec requires package spec requires named project reference coolbrowser project reference arbitrary select want recommended choose make sense project reference speciﬁcation cooltoolset package iﬁed coolbrowser required explained later message project allows specify exact version project want load message load specify package group load eter load load package group collection thing notice calling load dependency project optional need want load different default load cooltoolset like conﬁgurationofcooltoolset project version load unconventional project project depend doe follow default convention provide information identify conﬁguration let s assume conﬁguration stored class conﬁgurationofcoolbrowser stored monticello package called coolbrowser instead recommended conﬁgurationofcoolbrowser conﬁgurationofcooltoolset spec version spec common spec repository spec project spec classname load ﬁle repository spec package spec requires package spec requires message classname speciﬁes class contains project metadata case conﬁgurationofcoolbrowser message ﬁle repository metacello information need search load class conﬁgurationofcoolbrowser present image argument ﬁle monticello package contains metadata class argument ofrepository url monticello repository contains package monticello repository protected use message repository username password instead load cooltoolset like conﬁgurationofcooltoolset project version managing project metacello figure dependency conﬁgurations depending multiple project using cause entire coolbrowser project loaded cooltoolset wanted specify dependency coolbrowser s test package separately core package deﬁne line conﬁgurationofcooltoolset spec version spec common spec blessing baseline spec repository spec project default spec classname optional load optional repository project test spec load repository spec package spec requires default package spec requires coolbrowser test baseline creates project reference reference named coolbrowser default load default group reference named browser test load test group conﬁguration coolbrowser declare cooltoolset requires coolbrowser default cooltoolset requires cooltoolset coolbrowser test note use requires collection dependent project possible load just core package conﬁgurationofcooltoolset project version load test load core conﬁgurationofcooltoolset project version load did internal dependency baseline baseline doe specify version project conﬁguration depends instead version method using message project conﬁgurationofcooltoolset spec version import spec common spec blessing beta spec package package project default project test loading speciﬁc package addition baseline method version method specify age load conﬁgurationofsoup say want load version package conﬁgurationofsoup spec version import spec common spec project spec load versionstring spec package package package use load message project reference specify package project want load solution nice factor information project reference duplicate managing project metacello conﬁgurationofsoup spec version import spec pharo spec project spec versionstring stable load repository spec package package package version baseline recommended prevents specifying version baseline happens project reference addition message like ﬁle repository message called versionstring let specify version project directly project reference example conﬁgurationofcooltoolset spec version spec common spec repository spec project spec classname load versionstring ﬁle repository spec package spec requires package spec requires don t deﬁne version reference coolbrowser default coolbrowser test version method version speciﬁed line using versionstring used version speciﬁed baseline method metacello load recent version project reusing information information cated project reference remove duplication use theproject copyfrom method example conﬁgurationofcooltoolset specabout dependency granularity version spec common spec blessing baseline spec repository spec project default spec load repository ﬁle project test copyfrom default spec load spec package spec requires default package spec requires test dependency granularity want discus difference depending package ing project different way express imagine following fame spec version spec spec blessing spec description ﬁrst version smalltalkhub copied baseline squeaksource spec repository spec package package package spec requires package spec requires package package spec repository package spec requires example spec group smalltalkbinding group managing project metacello baseline package spec repository express package speciﬁed repository approach good way just downloading package itory metacello involved example phexamplecore dependency loaded following express dependency project presented spec version spec spec blessing spec description make explicit fame depends hashtable phexample smalltalkhub working conﬁgurations spec repository spec project spec versionstring stable repository spec project spec versionstring stable repository spec package spec requires package package spec requires package spec requires package package spec requires example spec group smalltalkbinding group express dependency project lose fact package depends phexample loss information information simply deﬁne conﬁguration new project named example phexamplecore able press dependent phexamplecore follows specexecuting code installation project spec versionstring stable load repository spec requires phexamplecore executing code installation occasionally ﬁnd need execute code package project loaded example installing browser good idea register default loaded maybe want open workspace installation metacello provides feature mean message preloaddoit postloaddoit argument message selector method ﬁned conﬁguration class shown moment deﬁned single package entire project continuing example conﬁgurationofcoolbrowser spec version import spec common spec package spec ﬁle preloaddoit preloadforcore postloaddoit postloadforcore package package conﬁgurationofcoolbrowser preloadforcore transcript preload script sorry better idea conﬁgurationofcoolbrowser postloadforcore loader package packagespec transcript cr postloadforcore executed loader loader printstring spec packagespec printstring smalltalk systembrowser ifpresent cl cl default smalltalk classnamed coolbrowser managing project metacello notice method preloaddoit postloaddoit receive selector performed load note method postloadforcore package take parameter load method argument loader ﬁrst optional argument loaded packagespec second optional argument pending need choose argument want pre post load script used version method baseline script depends version likely change different version baseline method exactly way mentioned pre post load script package level project level example following conﬁguration conﬁgurationofcoolbrowser spec version import spec common spec blessing release spec preloaddoit preloadforcoolbrowser spec postloaddoit postloadforcoolbrowser spec package spec ﬁle preloaddoit preloadforcore postloaddoit postloadforcore package package package package example added pre post load script project level selector receive argument platform speciﬁc package suppose want different package loaded depending platform conﬁguration loaded context example cool browser package called coolbrowser deﬁne abstract class apis following package coolbrowser coolbrowser speciﬁc package metacello automatically load package used platform need specify platform speciﬁc information using method shown following example deﬁne different package sion loaded depending platform platform speciﬁc age loaded addition common one depending plateform executing script conﬁgurationofcoolbrowser spec version import spec common spec package spec gemstone spec package spec pharo spec package specifying version aspect specify baseline speciﬁc information conﬁgurationofcoolbrowser spec version spec common spec blessing baseline spec repository spec package package spec requires package spec requires package spec requires spec group group group group group group spec gemstone managing project metacello spec package spec pharo spec package notice add package coolbrowser core group manage package uniform way lot ﬂexibility runtime load coolbrowser metacello automatically detects dialect load happening load speciﬁc package dialect dialect speciﬁc version dialect example conﬁgurationofcoolbrowser spec version spec common spec blessing baseline spec repository spec package package spec requires package spec requires package spec requires spec group group group group group group spec gemstone spec package spec pharo spec package loading order notice platform tribute common squeakcommon pharo obtain information doing conﬁgurationof project attribute speciﬁed section common pharo tions loaded conﬁgurationofcoolbrowser spec version spec common platform speciﬁc package spec blessing baseline spec repository spec package package spec requires package spec requires package spec requires spec group group group group group group spec gemstone spec package spec pharo spec package spec spec package finally note method used specify platform speciﬁc package different dialect want conﬁguration inside block example deﬁne change customize group package ries dialect dialect conﬁgurationofcoolbrowser spec version spec common spec blessing spec pharo spec repository spec spec group group group group group group managing project metacello spec gemstone spec repository spec package package spec requires spec group group example pharo use different repository stone mandatory itory differ thing like version post pre code execution dependency addition addons test available gemstone package group included doing inside common inside speciﬁc dialect milestoning development symbolic sion large evolving application difﬁcult know version conﬁguration use speciﬁc conﬁgurationofomnibrowser vides good example problem version used image version loaded version version load version provide example illustration metacello metacello introduces symbolic version version term isting literal version like symbolic version iﬁed using symbolicversion pragma deﬁned stable version omnibrowser version pharo omnibrowser stable spec symbolicversion stable spec version spec version spec version symbolic version used literal version used load expression conﬁgurationofxmlparser project version stable loadmilestoning development symbolic version conﬁgurationofxmlparser project version stable load project reference baseline version spec version spec squeakcommon spec blessing baseline spec repository spec project spec classname versionstring stable repository spec package spec requires package spec requires package spec requires note stable override bleeding edge loading behavior fool load baseline remember loading baseline load bleeding edge version make sure stable version omnibrowser platform loaded latest section different symbolic version standard symbolic version couple standard symbolic version deﬁned stable symbolic version speciﬁes stable literal version ticular platform version platform stable version version used loading exception bleedingedge version default need edit conﬁguration add stable ordevelopment version formation want certiﬁed version platform pay attention rely stable version package doe mean package change package implementor produce new version incompatible development symbolic version speciﬁes literal version use development blessing development typically managing project metacello development version used developer managing tivities project transition bleedingedge tostable mean want certiﬁed version platform development mode bleedingedge symbolic version speciﬁes latest mcz ﬁles project version default bleedingedge symbolic version ﬁned latest baseline version available default speciﬁcation forbleedingedge deﬁned project bleedingedge version primarily developer know doing guarantee bleedingedge version load let tion correctly want latest published ﬁle specifying symbolic version symbolicversion pragma legal use symbolic version like following deﬁnition symbolic version stable stable spec symbolicversion stable spec gemstone version spec version spec version spec version spec version development use special symbolic version notdeﬁned following nition symbolic version development development spec symbolicversion development spec common version notdeﬁned spec version spec version indicates version common tag ing symbolic version resolve notdeﬁned result metacellosymbolicversionnotdeﬁnederror signaled development symbolic version use version wouldd like including symbolic version following code show specify speciﬁc version baseline load latest version speciﬁed baseline stable version development spec symbolicversion spec version development specmilestoning development symbolic version symbolicversion spec version development spec symbolicversion spec version stable warning term stable misleading doe mean load exactly version developer rely change meaning stable point stable version stable version introduce incompatibility code release code use speciﬁc version sure impacted change project blessing loading package project pas stage step software development process life cycle development alpha beta release blessing taken account load logic result lowing expression conﬁgurationofcoolbrowser project latestversion version latestversion answer latest version blessing development broken blessing ﬁnd latest development version example execute expression conﬁgurationofcoolbrowser project latestversion development version independently blessing using lastversion method illustrated conﬁgurationofcoolbrowser project lastversion general development blessing used version unstable version stabilized different blessing applied following expression load latest version package latest baseline version conﬁgurationofcoolbrowser project latestversion baseline load latest baseline version reﬂect project structure executing previous expression load absolute bleeding edge version managing project metacello hint pattern emerge working metacello create baseline version use stable version project baseline literal version use explicit version explicit repeatable speciﬁcation set project known work example pharo include spec look like spec project dev spec classname versionstring stable project spec classname versionstring stable project spec classname versionstring stable loading pharo cause stable version project loaded remember time stable version change incompatibility package creep using stable version better shape using bleedingedge stable version known work pharo literal version corresponding spec look like spec project dev project project driven stake ground stating version known work passed test unit year future able load pharo exactly package time stable version drifted time just bringing image like loadload type pharo dev code load stable version pharo today tomorrow want duplicate environment working ask version pharo load explicit version reproduce bug request need deal package structure change imagine want develop application application package version ther changed application package grated base solution deﬁne dependency use symbolic tag marker follows spec spec package depends zinc common required package package spec spec project spec classname versionstring repository spec package depends zinc spec requires use stable version baseline need thing special version speciﬁcation load type metacello let specify way package loaded load type time writing possible load type atomic linear atomic loading used package partitioned way loaded individually deﬁnitions package merged giant load monticello age loader class initialize method code execution formed set package managing project metacello use linear load package loaded order class initialize method code execution performed just loading speciﬁc package important notice managing dependence doe imply order package loaded package adepends package b doesn t mean b loaded just guarantee want load bwill loaded problem happens method override package override method package order preserved problem sure order load sure version method ﬁnally loaded using atomic loading package order lost mentioned problem use linear mode package loaded order method override preserved possible problem linear mode following suppose project depends project band project dversion cdepends project dversion project version question dversion doe ahave end fault change using method operator project method metacello ﬁnally load version latest atomic loading loaded linear loading version depending dependency order loaded ﬁnally loaded mean loaded ﬁrst problem older version package project load pharo image using mentioned reason default mode linear user use atomic loading particular case completely sure finally want explicitly set load type project method example conﬁgurationofcooltoolset project project ifnil constructor bootstrap metacello loaded self class ensuremetacello construct metacello project constructor smalltalk metacelloversionconstructor self project constructor project project loadtype linear atomic project conditional loading conditional loading loading project usually user want decide load certain package depending speciﬁc condition example existence certain package image suppose want load seaside image seaside tool depends omnibrowser used managing instance web server little tool code want load tool need omnibrowser user need package native provide different group includes package doe problem ﬁnal user aware load different group different situation conditional loading example load seaside tool omnibrowser present image automatically metacello need explicitly load particular group suppose cooltoolset start provide feature ﬁrst split core package coolbrowser present image want load package default coolbrowser present mentioned conditionals achieved metacello using project attribute saw previous section deﬁned project method example conﬁgurationofcoolbrowser project project ifnil constructor bootstrap metacello loaded self class ensuremetacello construct metacello project constructor smalltalk metacelloversionconstructor self project constructor project projectattributes smalltalk cbnode ifabsent nil iftrue cbnotpresent iffalse cbpresent project projectattributes projectattributes project loadtype linear project code check cbnode class class browser present depending set speciﬁc project attribute ﬂexible let deﬁne condition set project attribute wish deﬁne array attribute question use project attribute following baseline managing project metacello conﬁgurationofcooltoolset spec version spec common spec blessing baseline spec repository spec project default spec classname versionstring load ﬁle repository project test copyfrom default spec load spec package package spec requires package spec cbpresent spec group spec cbnotpresent spec package spec requires default notice way use project attribute ing method inside method want ﬁne group dependency case coolbrowser present just add default group present coolbrowser default added dependency case add default group want desired user explicitly load package notice inside free version attribute project version attribute conﬁguration optional attribute author description blessing timestamp let s example new version project conﬁgurationofcoolbrowser spec version import spec common spec blessing release spec description release spec author johnlewis spec timestamp spec package package package package attribute description textual description version include list bug ﬁxes new feature changelog author author created version using tool metacellotoolbox author ﬁeld cally updated reﬂect current author deﬁned image timestamp date time version completed ing tool metacellotoolbox timestamp ﬁeld automatically updated reﬂect current date time note timestamp string end chapter query information trates information deﬁne metacello version queried example evaluate following expression conﬁgurationofcoolbrowser project version blessing conﬁgurationofcoolbrowser project version description conﬁgurationofcoolbrowser project version author conﬁgurationofcoolbrowser project version managing project metacello chapter summary metacello important pharo allow project scale allows control want migrate new version package important architectural backbone metacello memento conﬁgurationofcooltoolset spec called differently just convention version convention used version method spec common pharo spec blessing baseline important identiﬁes baseline spec repository depend project spec project default spec classname optional convention followed versionstring bleedingedge optional version load package group load ﬁle optional class repository project test copyfrom default just reuse information spec load just reuse information internal package dependency spec package package spec requires package spec requires package spec requires spec group default group group group group group conﬁgurationofcoolbrowser spec called differently just convention version import convention baseline version import baseline baseline spec common pharo spec blessing release required release release mean change anymore spec description release spec author spec timestamp spec package package package package chapter summary conﬁgurationofgemtoolsexample development spec note selector symbolicversion development bleedingedge spec common version version development version common platform attribute gemstone pharo conﬁgurationofgemtoolsexample spec version spec common spec blessing required spec repository spec project spec classname versionstring bleedingedge optional version repository project spec classname versionstring stable optional version repository project spec classname versionstring stable repository project spec classname versionstring stable repository spec package spec requires package spec requires package spec requires package spec requires spec group conﬁgurationofgemtoolsexample spec version spec common spec blessing development spec description development version spec author spec timestamp spec project project stable project stable project stable spec package package package package managing project metacello loading load load load method load default group default group deﬁned package loaded load method take parameter package project group collection item conﬁgurationofcoolbrowser project version load conﬁgurationofcoolbrowser project version load addons debugging record record loaddirectives message record doe record default group want speciﬁc group item use record just load conﬁgurationofcoolbrowser project version record loaddirective want recursively access ﬁle version use packagedirectivesdo following example pkgs loader loader smalltalk globals conﬁgurationofmoose project version ignoreimage true record pkgs orderedcollection new loader loaddirective packagedirectivesdo directive add directive spec ﬁle pkgs proposed development process using metacello suggest following development step baseline ﬁrst deﬁne baseline version development version tagged development validate map validated project status arrives desired status version release ready tag version release version development development continues create new version tagged development tagged release baseline architecture structure change new baseline appear version development story continue version releasepart iii frameworkschapter glamour participation tudor girba tudor browser crucial instrument understanding complex system model browser tool navigate interact particular main problem domain accompanied abundance browser created help analyze interpret underlying element issue browser frequently written scratch making expensive create burdensome maintain framework exist ease development user interface general provide limited support simplifying creation browser glamour dedicated framework navigation ﬂow browser thanks declarative language glamour allows quickly deﬁne new browser data chapter ﬁrst creation example browser overview glamour framework second jump detail installation ﬁrst browser install glamour pharo image execute following code gofer new smalltalkhubuser project package load smalltalk conﬁgurationofglamour perform glamour figure file ﬁnder glamour implementation glamour installed ready build ﬁrst browser using glamour s declarative language building apple s ﬁle browser browser built using miller column browsing technique displaying hierarchical element series column principle browser column reﬂects content element selected previous column ﬁrst chosen opening case navigating ﬁle system browser display list particular directory s entry ﬁle directory ﬁrst umn depending user selection appending column figure user selects directory column display entry particular directory user selects ﬁle column display content ﬁle look complex ﬁrst recursion provides intuitive way describing miller browser according glamour s terminology particular browser called ﬁnder referring apple s finder mac o glamour offer behavior class glmfinder class instantiated initialized properly list domain ﬁles browser browser glmfinder new browser listinstallation ﬁrst browser display child browser openon filesystem disk root note stage selecting plain ﬁle raise error stand ﬁx situation soon small piece code list entry ﬁles directory root ﬁle line representing ﬁle directory click directory entry directory column ﬁlesystem navigation facility provided filesystem framework thoroughly discussed chapter code problem line display print string entry probably want typical user expect name entry easily ing list browser list display child format basename way message basename sent entry make ﬁles directores easier read showing ﬁle instead fullname problem code doe distinguish ﬁles directory click ﬁle error browser send message child doe understand ﬁx just avoid displaying list contained entry selected element ﬁle browser list isdirectory display child format basename work user distinguish line ing ﬁle directory ﬁxed example adding slash end ﬁle directory browser list isdirectory display child format basenamewithindicator thing want display content entry ﬁle following give ﬁnal version ﬁle glamour browser browser glmfinder new variablesizepanes title ﬁle browser list isdirectory display child exception array new format basenamewithindicator text isfile display entry entry readstream content exception t display content ﬁle browser openon filesystem disk root code extends previous pane title directory entry access permission handling ﬁle content reading resulting browser presented figure short introduction just presented install glamour use create simple ﬁle browser presentation transmission port section give realistic example detail glamour framework running example following tutorial creating simple smalltalk class igator navigator used smalltalk browser usually consist pane abstractly depicted ﬁgure figure class navigator function follows pane show list tree package package containing class make organizational structure environment package selected pane show list class selected package class selected pane show protocol construct group method known method egories method class shown pane protocol selected pane subset method belong protocolpresentation transmission port figure wireframe representation smalltalk class navigator displayed pane starting browser build browser iteratively gradually introduce new construct glamour start simply want open new browser list package example going involve code ous ﬁle browser going implement code browser dedicated class ﬁrst step create class initial method object subclass instancevariablenames classvariablenames pooldictionaries category class open self new open open self buildbrowser browser openon self organizer organizer rpackageorganizer default buildbrowser browser glmtabulator new executing open open new browser text rpackageorganizer note use glamour glmtabulator class create browser glmtabulator explicit browser allows place pane column row extend browser new pane display list package buildbrowser browser glmtabulator new browser column package browser transmit package andshow self packagesin packagesin constructor constructor list display organizer organizer packagenames sorted format asstring glamour browser composed term pane ﬂow data browser currently pane displaying package ﬂow data speciﬁed mean transmission triggered certain change browser graphical user interface occur item selection list make browser useful displaying class contained selected package figure buildbrowser browser glmtabulator new browser column package column class browser transmit package andshow self packagesin browser transmit package class andshow self classesin classesin constructor constructor list display packagename self organizer packagenamed packagename deﬁnedclasses listing show core language construct glamour want able reference pane later distinct name package class arrange column using column keyword similarly row keyword exists pane organized row transmit keywords create transmission directed nection deﬁnes ﬂow information pane case create link package pane class pane keyword signiﬁes origin transmission thedestination speciﬁc stated glamour assumes origin refers topresentation transmission port figure browser package selected left pane contained class shown right pane theselection speciﬁed pane specify aspect origin pane use multiple origin finally andshow speciﬁes display destination pane connection activated transmitted example want list class contained selected package display keyword simply store supplied block tation block evaluated later presentation displayed explicit display block speciﬁed glamour tempts display object generic way case list tions mean displaystring message sent object retrieve standard string representation previously seen format used change default behavior display possible specify condition limit applicability connection default condition item fact selected display variable argument null presentation far package visually represented ﬂat list package naturally structured corresponding class category exploit structure replace list tree presentation package packagesin constructor constructor tree display organizer self rootpackageson organizer asset sorted child rootpackage organizer self childrenof rootpackage organizer sorted format asstring classesin constructor constructor glamour packagename self organizer includespackagenamed packagename display packagename self organizer packagenamed packagename deﬁnedclasses childrenof rootpackage organizer organizer packagenames select beginswith rootpackage rootpackageson organizer organizer packagenames collect string string readstream upto tree presentation us child argument take selector block specify retrieve child given item tree child package selected tree presentation pas root package hierarchy display argument point add pane list method category ure listing introduces new element discussed buildbrowser browser glmtabulator new browser column package column class column category browser transmit package andshow self packagesin browser transmit package class andshow self classesin browser transmit class category andshow self categoriesin categoriesin constructor constructor list display class class organization category browser resulting change shown ﬁgure ure multiple origin adding list method pane involves slightly machinery method category selected want method belong category category selected allmethods belong current class shown lead method pane depending selection pane class pane category pane multiple origin deﬁned using multiple keywords shown transmission port figure improved class navigator including tree display age list method category selected class buildbrowser browser glmtabulator new browser column package column class column category column method browser transmit package andshow self packagesin browser transmit package class andshow self classesin browser transmit class category andshow self categoriesin browser transmit class category method andshow self methodsin methodsin constructor constructor list display class category class organization listatcategorynamed category sorted constructor list class category class notnil category isnil display class class selector sorted allownil listing show couple new property multiple gin reﬂected number argument block used display clause secondly using show presentation condition match order deﬁned corresponding transmission ﬁred ﬁrst presentation condition match argument glamour deﬁned null default presentation second dition match category undeﬁned class deﬁned presentation displayed presence ﬁned origin necessary use allownil shown omit category display block completed class navigator displayed figure figure complete code navigator method category selected method class displayed method belong category shown port stated transmission connect pane entirely rect precisely transmission connected property pane called port port consist value accommodates particular aspect state pane contained presentation port explicitly speciﬁed user glamour us selection port default result following statement equivalent browser transmit package class andshow browser transmit package port selection class andshow composing interaction reusing browser glamour s strength use browser place primitive tations list tree conveys formidable possibility pose nest interaction subsequent example deﬁnes class editor shown ﬁgure pane equivalent described previously pane show source code method currently selected pane figure wireframe representation smalltalk class editor new class implement editor editor egate presentation pane previously implemented achieve ﬁrst make existing tor return constructed browser buildbrowser new line browser reuse navigator new editor browser shown object subclass instancevariablenames classvariablenames pooldictionaries category class glamour self new open open self buildbrowser browser openon self organizer organizer rpackageorganizer default buildbrowser browser glmtabulator new browser row navigator row source browser transmit navigator andshow self navigatorin navigatorin constructor constructor custom new buildbrowser listing show browser used exactly like use list type presentation fact browser type presentation evaluating open open browser embeds gator upper pane lower source code displayed connection pane far source code obtained wiring navigator text pane need selected method class deﬁned information deﬁned navigator browser ﬁrst export outside world using sendtooutside append following line codenavigator buildbrowser browser transmit class tooutsideport selectedclass browser transmit method tooutsideport selectedmethod browser send selection class method class selectedmethod port containing pane alternatively added line navigatorin method code make difference glamour follows navigatorin constructor alternative way adding outside port need use code previous simultaneously navigator interaction navigator new buildbrowser sendtooutside selectedclass class selection sendtooutside selectedmethod method selection constructor custom navigator consider sensible clearly deﬁne interface code navigator code editor order promote reuse interface extend code editor example follows buildbrowser browser glmtabulator new browser row navigator row source browser transmit navigator andshow self navigatorin browser transmit navigator port selectedclass navigator port selectedmethod source andshow self sourcein sourcein constructor constructor text display class method class sourcecodeat method view source code selected method ated modular browser reusing class navigator written earlier composed browser described listing shown ﬁgure action navigating domain essential ﬁnding useful element having proper set available action essential letting act domain action deﬁned associated tation action block evaluated keyboard shortcut pressed entry context menu clicked action deﬁned viaact sent presentation sourcein constructor constructor text display class method class sourcecodeat method act presentation class method class compile presentation text glamour figure composed browser reuses previously described class navigator source selected method argument passed character speciﬁes keyboard shortcut used trigger action corresponding presentation focus character need combined command control platform speciﬁc doe need speciﬁed act block provides corresponding presentation ﬁrst argument used poll various erties contained text current selection block argument incoming origin deﬁned equivalent argument display action displayed context menu purpose provides message act entitled act entitled ment string displayed entry menu ple following snippet extends example provide context menu entry save current method class act presentation class method class compile presentation text s entitled contextual menu accessible triangle text pane located left hand interaction multiple presentation frequently developer wish provide presentation ciﬁc object code browser example wish class list graphical representation glamour includes support display interact visualization created using themondrian visualization engine presented chapter add second presentation simply deﬁne using block classesin constructor constructor list packagename self organizer includespackagenamed packagename display packagename self organizer packagenamed packagename deﬁnedclasses title list constructor mondrian packagename self organizer includespackagenamed packagename painting view packagename view node self organizer packagenamed packagename deﬁnedclasses view edgesfrom superclass view treelayout title glamour distinguishes multiple presentation pane help tab layout appearance mondrian presentation bedded code editor shown ﬁgure clause title set tab used render presentation figure code editor sporting mondrian presentation addition simple class glamour browser essentially used glmtabulator named ability generate custom layout using aforementioned row column word additional browser provided written user browser implementation subdivided category browser explicit pane declared explicitly browser implicit pane glmtabulator example browser us explicit pane implicit browser declare pane directly browser ate connection internally example browser finder discussed section pane created need use keywords ply specify presentation browser glmfinder new browser list display class class subclass browser openon collection listing creates browser shown ﬁgure open list subclass collection selecting item list browser expands right subclass selected item continue indeﬁnitely long select remains figure subclass navigator using miller column style browsing discover kind browser explore hierarchy glmbrowser summary chapter summary chapter gave short introduction glamour browser framework glamour essentially used build tool enables navigate interact arbitrary domain plain object generic browser widget ordered column row column deﬁned successively sending column symbol argument row deﬁned row data ﬂows transmission set transmit source target transmission source list text pane obtained sending listand textto browser content set display item formatted format port deﬁne component interface browser enables easy reuse embedding interaction deﬁned term action deﬁned sending act widget glamour support multiple presentation glamour build general purpose graphical user face note chapter meant exhaustive overview glamour merely intended introduce reader usage intent approach extensive view glamour concept implementation moose dedicated chapter agile visualization roassal participation vanessa attaching meaning large data challenging equate tool textual output known limited expressiveness support interaction roassal agile visualization engine visualize interact arbitrary data deﬁned term object relationship sal commonly employed produce interactive visualization range application diverse example moose community us roassal visualize software chapter introduces roassal s principle describes expressive api quickly render data end chapter able create interactive visual representation development roassal sponsored information visit roassal website http installation ﬁrst visualization roassal moose installed directly proceed ﬁrst visualization agile visualization roassal installing roassal fresh pharo image easy thanks gofer metacello just open workspace execute gofer new smalltalkhubuser project package load smalltalk conﬁgurationofroassal load roassal known work version pharo ﬁrst visualization ﬁrst visualization represents collection class hierarchy deﬁnes class box connected subclass box display number method number instance variable represented class view roview new classelements roelement forcollection collection withallsubclasses classelements c c width c model instvarnames size c height c model method size c roborder c rodraggable view addall classelements association classelements collect c c model superclass object iffalse view elementfrommodel c model superclass c thenselect assoc assoc isnil edge roedge linesfor association view addall edge rotreelayout new view element view open figure visualization using roassal framework achieve visualization explained chapter chapter detail create using mondrian ﬁrst visualization language dsl using mondrian builder roassal roassal easel roassal easel tool interactively script visualization metaphor used easel turn programmer painter ing work easel creating adjusting erasing just key stroke away roassal easel accessible pharo world menu just look easel independent window render script written textual window accepting pressing accept tor visualization updated keystroke used accepting method browser advantage short feedback loop meaning script keystroke away visualization window contains example visualization cluding tutorial example separated category roexample romondrianexample accessible clicking plesbutton upper visualization window easel provided moose section world menu roassal easel similar easel presented dedicated presentation version moose book http agile visualization roassal figure roassal easel example separated romondrianviewbuilder roexample category romondrianexample category includes example created drian domain speciﬁc language built roassal example primarily use romondrianviewbuilder class make visualization roexample category directly illustrates roassal roassal core model root visualization instance class roview container graphical component rendered nents instance subclass roabstractcomponent typically instance ofroelement roedge usually graphical component hold reference domain object visual property size color directly deduced domain object shortly come point illustrate basic fundamental operation adding element ﬁrst step seeing graphical component add view open view exactly following code snippet core model view roview new element roelement new size view add element view open creates open visualization single element square size pixel executing code appears visualization element effectively added view told element rendered adding shape visual aspect element given shape stance subclass roshape default element let s add shape border element view roview new element roelement new size element addshape roborder added line view add element view open unsurprisingly adding shape element simply carried sending addshape message shape want add frequent operation use achieve effect instead written element roborder example added roborder shape suggests roborder add squared border roelement default color aroborder black shape available including able label circle ﬁlled rectangle shape composed create sophisticated visual aspect notion shape detailed section reacting event currently lonely element make element aware user action clicking keystroking need specify event callback user interface graphical framework action user perform generates event event instance subclass roevent make graphical element responsive event block associated event class attached graphical element element shape instance ronullshape null object design pattern agile visualization roassal example make square responsive user click need add event handler block executed event occurs view roview new element roelement new size element roborder open inspector clicking element romouseclick event event inspect view add element view open clicking square open inspector meantime favor message addshape shorter just informative interaction complex response widely used common graphical framework directly answering user action simple handling complex situation consider happens moving mouse maintaining mouse button pressed common operation quite complex ple mouse movement pixel need projected plan ement visualization need refreshed common eration save programmer using construct like element romousedrag instead provide interaction lightweight anism reuse compose event handler making ment draggable simply element rodraggable method shortcut addinteraction interaction section rodraggable subclass rointeraction root interaction roassal rodraggable allows element react mouse drag small example reﬁned view roview new element roelement new size element roborder add shape rodraggable add interaction view add element view open element interesting visualization likely contain large ber element element added successive invocation ofadd roview shot sending addall consider roassal core model view roview new roelement new size roelement new size element array element el el roborder rodraggable view addall element view open code open window square element gin left corner ﬁrst create element size respectively add view using addall message make element border draggable note ample shape interaction added opening view added rendered graphical nents free modiﬁed element translated sending translateby ortranslateto point parameter parameter representing step position pixel ax deﬁned shown figure increase left right view roview new roelement new size roelement new size element array element el el roborder rodraggable view addall element translateby view open visualization contains element better algorithm automatically position element algorithm called layout roassal provides layout arrange element sitioning space layout roassal subclass rolayout layout described section nesting element aroelement object contain roelement jects refer containment relationship nesting nesting enables element structured tree addition shown following example location child relative parent mean translate parent child translated agile visualization roassal view roview new parent roelement new size roborder child roelement new size roborder red parent add child view add parent translate parent parent translateto view open nesting element stretchable default translating child node parent s bound extended contain element new position view roview new parent roelement new size roborder child roelement new size roborder red parent add child view add parent translate child child translateto view open element resize strategy stored resizestrategy instance able default resize strategy instance roextensibleparent mean parent extend bound ﬁt child element number resize strategy available just look subclass roabstractresizestrategy class subclass deﬁne strategy used element far introduced interaction shape child ements brieﬂy mentioned possibility object domain schematically element representation look like figure core model figure roelement representation translating view s camera view answer translateby translateto message look like view change position camera camera component view represented instance rocamera point view visualization object actually viewed camera section collection hierarchy example example create collection hierarchy visualization seen lier chapter build executing following step add data particular shape case data collection class subclass render class according characteristic add link class superclass arrange element hierarchy layout section start ﬁrst step adding element ing class hierarchy easily sending forcollection message roelement class helper build roelements collection roelement returning value message representation element parameter add border shape make draggable easier manipulation finally apply default layout element view explanation layout work follow agile visualization roassal view roview new classelements roelement forcollection collection withallsubclasses classelements c c roborder c rodraggable view addall classelements rohorizontallinelayout new view element view open figure adding element representing class detailing shape graphical component instance roelement orroedge given shape sending oraddshape message argument subclass roshape instance class similarly message argument class stance order override default value parameter shape attribute color ﬁlled border color individually set class sent parameter element shaped instance class default value attribute shape available label rolabel border roborder box robox circle roellipse default rolabel display printstring value model object domain element possible change setting custom text shown figure applying roborder robox roellipse roelement shape adapted bound element possible set attribute color border color border width shape shown figure figure figure shape roelement new model size rolabel figure rolabel default value roelement new size roborder figure roborder default value roelement new size robox new color color green bordercolor color red borderwidth figure customized robox element roelement new size shape roellipse new color color yellow bordercolor color blue borderwidth element shape figure customized roellipse composing shape create elaborated visual aspect shape composed element shaped roshape send time desired shape figure build chain shape associated element ﬁrst component latest shape added component instance shape ronullshape agile visualization roassal element label border circle element roelement new size label rolabel new text shape border roborder new color color red circle roellipse new color color yellow borderwidth element label element border element circle figure composing shape collection hierarchy example add shape class collection hierarchy ple class representation width representing number instance variable class height representing number method view roview new classelements roelement forcollection collection withallsubclasses classelements c c width c model instvarnames size c height c model method size c roborder c rodraggable view addall classelements rohorizontallinelayout new view element view open figure adding shape classedges linking element edge linking element roassal possible build link element represent tionships link element instance class roedge default edge shaped instance ronullshape shape edge rendered need shaped line shape subclass roabstractline following code illustrates creation edge element ﬁrst create element create edge using rameters shape line instance roline shape ﬁnally add element edge view view roview new start roelement size roborder red end roelement size roborder red end translateby edge roedge start end edge roline view add start add end add edge view open figure simple edge adding shape edge kind line shape use standard like roorthohorizontallineshape subclass roabstractline class including roline example shown figure figure edge roline figure simple agile visualization roassal edge roorthohorizontallineshape figure horizontally oriented orthogonal edge adding arrow line line contain arrow arrow instance subclass roabstractarrow like roarrow rohorizontalarrow add arrow line shape use add message figure figure edge roline new add roarrow new figure arrowed edge edge roorthohorizontallineshape new add rohorizontalarrow new figure orthogonal edge horizontal oriented arrow default arrow located end edge customize position using add offset offset parameter number indicates percent line length arrow example offset arrow set middle line shown figure edge roline new add roarrow new offset figure edge arrow middle line contains arrow setup different offset arrow edge linking element line roline new line add roarrow new offset line add roarrow new offset edge line figure edge arrow collection hierarchy example know make link element following code create edge class superclass ﬁrst need create collection association build edge association represents starting point association key ending point association value example association go roelement representing class roelement represents superclass association create instance roedge ing linesfor message message take parameter collection association return collection edge view roview new classelements roelement forcollection collection withallsubclasses view addall classelements association orderedcollection new classelements c c width c model instvarnames size c height c model method size c roborder c rodraggable c model superclass object iffalse association add view elementfrommodel c model superclass c edge roedge linesfor association view addall edge rohorizontallinelayout new view element view agile visualization roassal figure adding link class superclass class collection hierarchy shape want connected superclass real hierarchy need appropriate layout arrange element view section cover apply layout ments layout layout deﬁnes collection element automatically arranged apply layout use message collection roelement s ter example shown figure use spriteon convenience message create collection roelements size shaped red border draggable apply layout arrange element grid view roview new view addall roelement spriteson rogridlayout view element view open figure rogridlayout applied group roelements figure illustrates layout available roassal layout addition presented subclass ofrolayout layout applied collection element different set ments different layout following example collectionslayouts rogridlayout b rocirclelayout c rotreelayout d rotreemaplayout e roverticallinelayout f rohorizontallinelayout figure layout available applied group element element arranged layout ﬁrst aligns element vertical line second horizontal line ﬁrst ate element vertical line apply roverticallinelayout shape label second group using rohorizontallinelayout spacing avoid agile visualization roassal view verticalelements horizontalelements view roview new verticalelements roelement spriteson roverticallinelayout verticalelements verticalelements el el rolabel horizontalelements roelement spriteson rohorizontallinelayout horizontalelements horizontalelements el el rolabel el translateby spacing view addall horizontalelements addall verticalelements view open figure applying different layout different set element layout nested structure layout nested element relative element s container following example element created child element arranged grid ﬁnally arrange parent element using horizontal line layout view roview new element roelement spriteson element el el addall roelement spriteson arranging child node rogridlayout el view addall element rohorizontallinelayout view element view open figure nested element different layout creating new layout roassal offer number layout time chapter written happen need newlayouts layout accommodate particular representation section dedicate layout jumping creation new layout ﬁrst need understand layout structured layout class inherit rolayout class deﬁnes monly used method apply layout instance class method call executeonelements main method apply layout method shown following code rolayout executeonelements element execute layout element maxinterations element size self doinitialize element self doexecute element asorderedcollection self dopost element executeonelements method invokes hook method method executed beginning layout useful graph ordered need prepared apply layout algorithm element relocated ingly method executed having performed layout deﬁned useful example layout appropriate event emitted action set callback using rolayoutbegin rolayoutend event rolayoutbegin rolayoutend announced doinitialize dopost spectively example use shown following code layout t t layout rohorizontallinelayout new layout rolayoutbegin event t t layout rolayoutend event t t layout applyon roelement forcollection self assert t doexecute method arranges element using particular algorithm method take parameter collection element lay know structure rolayout class deﬁne new layout called rodiagonallinelayout position element diagonal line creating subclass rolayout ﬁrst step rolayout subclass rodiagonallinelayout instancevariablenames agile visualization roassal classvariablenames pooldictionaries category instance variable initialposition deﬁnes virtual line start mean ﬁrst element line located variable set initialize method rodiagonallinelayout initialize super initialize initialposition rodiagonallinelayout initialposition apoint initialposition apoint rodiagonallinelayout initialposition initialposition layout needed execute special action applied overwrite doinitialize ordopost method case method need overwrite doexecute actually doe job translating element virtual diagonal line rodiagonallinelayout doexecute element position position initialposition element el el translateto position position position el extent test layout following code view element view roview new element roelement spriteson view addall element rodiagonallinelayout view element view open figure diagonal line layout applied collection element key point layout roassal consider size ements layout deﬁning new layout remember make algorithm use element collection hierarchy example need hierarchy collection example rotreelayout useful obtaining adequate visualization create element displayed view roview new classelements roelement forcollection collection withallsubclasses view addall classelements association orderedcollection new classelements c make element reﬂect model characteristic c width c model instvarnames size c height c model method size add shape element seen c roborder make draggable mouse c rodraggable create association build edge c model superclass object iffalse association add view elementfrommodel c model superclass c add edge class superclass edge roedge linesfor association view addall edge arrange element hierarchy rotreelayout new view element view open resulting visualization seen figure agile visualization roassal figure collection class hierarchy width representing number instance variable height number method event callback roassal allows visible component visualization including view emit react event kind event deﬁned roassal ﬁrst kind event low level represents user action includes clicking moving mouse pressing key second kind event includes triggered view typically includes movement camera applying layout refreshing view event inherit roevent class event work example visualization reacts mouse click translating element click event class deal mouse event romouseclick romousemove romouseenter romouseleave deal key pressing rokeydown class make visualization react mouse left click using roleftmouseclick event reaction create animation translate element event s interaction hierarchy use message set roassal object react event shown following code ﬁrst parameter class expected event second block deﬁnes action executed event received view roview new el roelement sprite view add el view romouseleftclick event rolinearmove new el event position view open rolinearmove roassal interaction suggests creates animation element translated linear interaction explained following section interaction hierarchy graphical element responds event setting callback interaction presented set callback section interaction root class roassal interaction rointeraction interaction set element sending message subclass rointeraction instance class parameter diverse interaction applied element rodraggable orrogrowable allows element dragged mouse rogrowable make element increase size clicked element interaction example apply rodraggable orrogrowable element following code illustrates click element make bigger drag view view element view roview new element roelement new size element robox rodraggable rogrowable view add element view open interaction complex set like popup element displayed mouse agile visualization roassal available interaction roassal example sented roabstractpopup roabstractpopup allows element react mouse event ing popup kind popups ropopup fault display box printstring value element model ii ropopupview display custom view add popup element just send message ropopup class argument possible set custom text using text message string parameter following example create element sending spriteon message roelement class arbitrary string model resulting element size red border draggable mouse ﬁnally add ropopup element view roview new el roelement spriteon el ropopup custom text ropopup text custom text view add el view open figure ropopup ropopupview slightly complex need deﬁnition view popup interaction created sending view message ropopupview class new view displayed parameter block deﬁnes view mouse element block evaluated using element parameter allowing view dynamically created following example creates view ﬁve element reacts mouse placed displaying popup popup view deﬁned block creates view number node element model mouse example figure show passing mouse node popup gray box interaction hierarchy view roview new element roelement spriteson create view popup viewtopopup el v v roview new add element value represented v addall roelement forcollection el model v elementsdo e e size robox rogridlayout v element v element e e rolabel ropopupview view viewtopopup view addall element rohorizontallinelayout view element view open figure ropopupview creates view number ments model element mouse rodynamicedge recurrent need visualizing data element relation ing outgoing edge mouse point element instead trying right mixture callback entering leaving element interaction rodynamicedge considerably eas task following example make line appear mouse hovers element rawview rawview roview new rawview add robox element size rawview add robox element size rawview add robox element size rocirclelayout array rodraggable rodraggable rodraggable rodynamicedge toall array using roline arrowed color color red rawview agile visualization roassal roanimation animation interaction roassal roanimation subclass ofrointeraction animation subclass roanimation mations allow element translated linearly constant speed rolinearmove acceleration romotionmove following matical function rofunctionmove rozoomoutmove form animation zooming animation number cycle complete executing sending dostep message roanimation allows set block executed animation ﬁnished using message important notice action carried animation ﬁnished set animation triggered executed view roview new element roelement new element size element roellipse color color green view add element element translateby rofunctionmove new nbcycles blocky x x sin element view open figure animating function figure present rolinearmove following code allows ment follow sinus curve using rofunctionmove understanding view s camera view s camera represents point view space ally viewed translateby ortranslateto message sent view actually happens camera move instead view position camera given position message camera s position set manually sending message camera translateby ortranslateto using negated value parameter mean view translated pixel horizontally vertically like understanding view s camera view translateby translate view s camera hand view camera translateby camera extent seeing real extent represents far extent extent view s camera affect way view drawn canvas rendering view point angle shape need drawn plotted according camera s extent transforming absolute position virtual point relative camera s vision example zooming view content extent stretched ﬁll real extent make object bigger extent real extent camera modiﬁed using extent realextent accessors respectively camera store window size visualization camera altitude view computed using extent smaller extent lower camera located versa altitude camera set sending altitude message using number parameter camera rotated translated mean camera perpendicularly looking view figure illustrates just mentioned indicates information regarding view visible visualization given camera s agile visualization roassal camera diagram b camera extent showing actually seen figure component view s camera rozoommove interaction affect extent camera action modiﬁes camera s position extends ﬁt desired gle example zooming focus particular element view rozoommove translates extends camera ﬁt element s bound movement simulated changing camera s altitude using camera build minimap navigation interaction animation model offered roassal support complex behavior consider following code view eltos view roview new view rodraggable view romouserightclick event rozoominmove new view view romouseleftclick event rozoomoutmove new view view s camera elts roelement spriteson elts el el rolabel view addall elts rogridlayout new view element mini map open pressing m view rominimap view open open view labelled element element ordered ing grid layout pressing left mouse button zoom view right mouse button zoom pressing mkey open minimap feature enabled using rominimap interaction rominimap open new window give complete vision sualization eas navigation using original view s camera minimap composed smaller version visualization lupa magnifying glass represents current visible main view s window coming main example interaction simply added sending rominimap message view pressing m open ure figure rominimap applied collection hierarchy example smaller version view displayed using rominimapdisplayer particular shape subclass roviewdisplayer shape display view element essentially used popup view difference rominimapdisplayer us agile visualization roassal different extent view s camera allows view different size magniﬁer size represents visible window sition related view s camera position view translated point magniﬁer follows changing position point senting camera position translated point rominimapdisplayer camera extent view zoomed zoomed extent camera changed increasing decreasing magniﬁer s size pharo roassal designed easily ported smalltalk dialect currently ported visualworks roassal consists main component roassal core set package deﬁne main class like roview roelement roshape rocamera contains test mondrian dsl composed package package dedicated smalltalk dialect roassal ported package class mented main one native canvas class view rendered widget factory class return object tain canvas receive delegate external event ﬁrst subclass roabstractcanvas second subclass ronativewidgetfactory roplatform class deﬁnes bridge core dependent package implemented class deﬁnes instance variable like canvasclass widgetfactory store corresponding class use according package implement platform class subclass roplatform erence implemented platform dependent class internally time class needed core relies current instance roplatform return needed summary chapter summary roassal enables graph object visualized chapter viewed main feature roassal create graphical element shape look desired create edge represent relationship graphical element apply layout arrange collection element automatically make element react event setting callback deﬁned tions visualization point view interacting camera screenshots online example screencast roassal line http acknowledgment thank chris thorgrimsson esug ing development roassal grateful nicolas rosselot urrejola stéphane ducasse review thank emmanuel pietriga tudor girba multiple discussion design scripting visualization mondrian attaching meaning large data challenging adequate tool textual output known limited expression interaction mondrian domain speciﬁc language script visualization est implementation run roassal chapter visualize interact arbitrary data deﬁned term object relationship mondrian commonly employed software ment activity mondrian excels visualizing software source code chapter introduces mondrian s principle describes expressive mands quickly make data detailed information refer dedicated moose book reading able create interactive visual representation installation ﬁrst visualization mondrian based roassal check roassal chapter installation cedures using moose distribution roassal scripting visualization mondrian visualization ﬁrst visualization entering executing following code workspace executing following workspace collection class hierarchy view view romondrianviewbuilder new view shape rectangle width cl cl numberofvariables height numberofmethods linearfillcolor numberoflinesofcode collection withallsubclasses view interaction action browse view node roshape withallsubclasses view edgesfrom superclass view treelayout view open visualization read follows class graphically represented box inheritance indicated edge box superclass subclass width class indicates instance variable height class indicates method deﬁned class taller class method deﬁnes class shading indicates line code class contains class colored black contains line code white class contains smallest quantity line code review mechanism involved tion later starting mondrian aromondrianviewbuilder model mondrian language dsl romondrianviewbuilder internally contains instance roview called raw view accessor raw scripting using romondrianviewbuilder result creating roelement s shape action set script added raw view start visualization builder use following code starting mondrian view romondrianviewbuilder new view open mondrian builder initialized instance roview important understand required builder default create raw view working builder possible use mondrian dsl sending message stance romondrianviewbuilder directly raw view rawview roview new view romondrianviewbuilder view rawview view open add node visualization internally translated roelement later use selector node object want sent default small square drawn element view romondrianviewbuilder new view node view open deﬁne shape use shape message followed desired shape characteristic node node deﬁnition locally deﬁne shape node view romondrianviewbuilder new view shape rectangle size color color red view node view open using node message collection object create scripting visualization mondrian view romondrianviewbuilder new view shape rectangle size color color red view node view open node node nested node use node forit ornodes foreach message add second parameter block add nested node following code show view romondrianviewbuilder new view shape rectangle size color color red view node foreach view shape rectangle size color color yellow view node view open possible create edge using edgesfromassociations message collection association model mondrian view romondrianviewbuilder new view shape rectangle color color red view node view edgesfromassociations array view open similar collection hierarchy example given beginning chapter need appropriate layout default builder applies horizontal line layout need tree layout use treelayout apply view romondrianviewbuilder new view shape rectangle size color color red view node view edgesfromassociations array view treelayout view open collection hierarchy example mondrian dsl allows simpler scripting collection hierarchy visualization constructed chapter setting element edge created necessary create hand view romondrianviewbuilder new view shape rectangle width cl cl instvarnames size height cl cl method size view node collection withallsubclasses view edgesfrom scripting visualization mondrian view treelayout view open essentially way work mondrian using easel view renderer easel tool user interactively incrementally build visualization mean script easel ticularly useful prototyping moviewrenderer enables visualization programmatically built fashion probably want use class embedding visualization application ﬁrst use mondrian easiest way using easel open easel use world menu contain entry mondrian easel execute expression roeaselmorphic open easel just opened panel visualization panel second script panel script panel enter following code press generate button view node pane small box lined left corner just rendered numerical set box represents number interaction quite limited drag drop number tooltip indicates value soon deﬁne interaction let explore basic drawing capability mondrian add edge node drawn add second line view node view edgesfrom v v visualizing collection framework number linked double double visible example double visualization case edge drawn message edgesfrom deﬁnes edge node possible node added visualization edge deﬁned tween node node lookup provided block mondrian contains number layout order node use circle layout view node view edgesfrom v v view circlelayout visualization obtain subsequent section visualize software code illustrate power mondrian visualizing source code employed discover pattern useful assessing code quality visualizing collection framework visualize pharo class remainder section intensively use reﬂective capability pharo introspect tion class hierarchy serve compelling example let s visualize hierarchy class contained collection framework view node collection scripting visualization mondrian view edgesfrom superclass view treelayout used tree layout visualize class hierarchy layout particularly adequate smalltalk oriented tion root class pharo collection framework library message withallsubclasses return list collection subclass class ordered vertically inheritance link superclass subclass reshaping node mondrian visualizes graph object object domain ated graph element node edge graph element aware graphical representation graphical aspect given shape far solely use default shape represent node edge default shape node wide square default shape edge straight gray line number dimension deﬁnes appearance shape width height rectangle size line dash border inner color example reshape node visualization convey information internal structure class visualizing consider view shape rectangle width instvarnames size height numberofmethods view node collection withallsubclasses view edgesfrom superclass view treelayout figure show result class represented box collection class root hierarchy box width class conveys instance variable multiply contrasting result height conveys number od immediately spot class method multiple edge collection sequentiablecollection string compiledmethod class ables runarray sparselargetable figure complexity collection class hierarchy multiple edge message edgesfrom used draw edge node variant edge toall support deﬁnition edge starting given node consider dependency class scripting visualization mondrian view shape rectangle size cl cl referencedclasses size withtext view node arrayedcollection withallsubclasses view shape arrowedline view edge arrayedcollection withallsubclasses toall referencedclasses view circlelayout obtained visualization given figure figure direct reference class string compiledmethod clearly show class contains reference class text make shape contain text mondrian provides set utility method easily create element sider expression colored shape view edgesfrom superclass edgesfrom equivalent edge view edge collection withallsubclasses superclass equivalent view edge collection withallsubclasses superclass colored shape shape colored various way node shape understand sage ﬁllcolor textcolor bordercolor line shape understand color let s color visualization collection hierarchy view shape rectangle size bordercolor cl array match cl iftrue color blue iffalse color black ﬁllcolor cl cl hasabstractmethods iftrue color lightgray iffalse color white view node collection withallsubclasses view edgesfrom superclass view treelayout produced visualization given figure easily help identify abstract class named array one abstract abstract method figure abstract class gray class word abstract scripting visualization mondrian similar height width message deﬁne color symbol block constant value argument argument evaluated domain object represented graphical element double dispatch sends message movalue argument use iftrue iffalse really practicable utility method provided purpose easily pick color particular condition deﬁnition shape simply view shape rectangle size cl array match cl bordercolor color blue cl cl hasabstractmethods ﬁllcolor color lightgray method hasabstractmethods deﬁned behavior metaclass pharo sending hasabstractmethods class return boolean value telling class abstract recall abstract class smalltalk class deﬁnes inherits abstract method contains self subclassresponsibility color color pretty useful designate property gray class stract employed represent continuous distribution example color intensity indicate result metric consider previous script node color intensity conveys number line code view interaction action browse view shape rectangle width instvarnames size height method size linearfillcolor numberoflinesofcode collection withallsubclasses view node collection withallsubclasses view edgesfrom superclass view treelayout figure show resulting picture message linearfillcolor take ﬁrst argument block function return numerical value second argument group element used scale tensity node block function applied element group fading scale white line code black maximum line code maximum intensity given mum numberoflinesofcode subclass collection variant linearfillcolor arelinearxxxfillcolor xxx blue green red y ellow view visualization named complexity polymetric lightweight visual approach reverse engineering transaction software engineering show class number method number instance variable number line code difference size class suggest maintenance activity figure complexity visualization node class height number line method width number variable color veys number line code color assigned object identity using identityfillcolorof argument block symbol evaluated domain object color associated result argument popup view let s jump abstract class example following script indicates abstract class abstract method scripting visualization mondrian view shape rectangle size cl cl method select isabstract size hasabstractmethods ﬁllcolor color lightred cl cl method anysatisfy isabstract ﬁllcolor color red view node collection withallsubclasses view edgesfrom superclass view treelayout figure box class link inheritance relationship abstract method indicated size class red class deﬁnes abstract method pink class solely inherits abstract class figure indicates class abstract inheritance deﬁning abstract method class size indicates abstract od deﬁned popup message enhanced list abstract method putting mouse class doe list abstract method deﬁned class following piece code added beginning view interaction popuptext aclass stream stream writestream string new aclass method select isabstract thencollect selector sel stream nextputall sel nextput cr aclass printstring stream content far seen element shape graphical representation contains interaction contains event handler message popuptext take block argument block evaluated domain object argument block return popup text content case simply list method addition textual content mondrian allows view popped enhance previous example illustrate point mouse enters node new view deﬁned displayed node view interaction popupview element secondview secondview node element forit secondview shape rectangle isabstract ﬁllcolor color red size secondview node element method sortedas isabstract secondview gridlayout gapsize view shape rectangle size cl cl method select isabstract size hasabstractmethods ﬁllcolor color lightred cl cl method anysatisfy isabstract ﬁllcolor color red view node collection withallsubclasses view edgesfrom superclass view treelayout argument popupview argument block ﬁrst parameter block element represented node located mouse second argument new view opened example used sortedas order node representing od method deﬁned collection belongs mondrian example usage sortedas browse corresponding unit test example us message node forit popup view deﬁne subview subviews node view allows graph embedded node embedded view physically bounded encapsulating node embedding realized keywords node foreach node forit following example approximates dependency od linking method method connected method reference selector simple effective way dependency method consider view node roshape withallsubclasses foreach cl view node cl method view edge cl method toall cm cl method select rcm cm message anysatisfy s rcm selector s view treelayout view interaction action browse view edgesfrom superclass view scripting visualization mondrian subview contains layout interaction shape deﬁned subview accessible nesting node figure figure large box class inner box method edge possible invocation forwarding event method visualization given previous section moved simple drag drop wished method ﬁxed position class case message forward sent interaction consider view node roshape withallsubclasses foreach cl view interaction forward view shape rectangle size linesofcode view node cl method view edge cl method toall cm cl method select rcm cm message anysatisfy s rcm selector s view treelayout view interaction action browse view edgesfrom superclass view treelayout moving method class instead convenient drag drop element operating system drian offer multiple selection using ctrl cmd key default havior available node multiple selection allows group node event mouse movement click keyboard keystroke corresponds ticular event mondrian offer rich hierarchy event root hierarchy moevent associate particular action event handler deﬁned object interaction following example clicking class open code browser view shape rectangle width instvarnames size height method size hasabstractmethods ﬁllcolor color lightred cl cl method anysatisfy isabstract ﬁllcolor color red view interaction romouseclick event event model browse view node collection withallsubclasses view edgesfrom superclass view treelayout block handler accepts argument event generated ject triggered event obtained sending modelelement event object interaction mondrian offer number contextual interaction mechanism action object contains number keywords purpose message highlightwhenover take block argument block return list node highlight mouse enters node consider example view interaction highlightwhenover v v v v v view shape rectangle width height withtext view node view gridlayout gapsize entering node highlight node mechanism quite efﬁcient overload connecting edge information shown node compelling application highlightwhenover following example hierarchy class displayed left hand scripting visualization mondrian hand size hierarchy unit test displayed locating mouse pointer unit test highlight class referenced unit test method consider long script complexity collection class view shape rectangle width instvarnames size height method size linearfillcolor numberoflinesofcode collection withallsubclasses view node collection withallsubclasses view edgesfrom superclass view treelayout unit test package collectionstest view shape rectangle withoutborder view node forit view shape label view node test view node test forit testclasses testclasses packageinfo named class reject istrait view shape rectangle width cl cl method inject sumliterals mtd sumliterals mtd allliterals size height cl cl numberoflinesofcode view interaction highlightwhenover cl cl method inject sum el sum el allliterals select v v iskindof association thencollect value asset view node testclasses view edgesfrom superclass view treelayout view verticallinelayout alignleft script contains part ﬁrst ubiquitous complexity collection framework second render test contained collectionstests width class number erals contained height number line code collection test make great use trait reuse code metric scaled mouse placed test unit class collection framework referenced class summary figure interactive complexity chapter summary mondrian enables graph object visualized chapter reviewed main feature mondrian common way deﬁne node node edge edgesfrom edge edge toall range layout offered common layout cessible sending circlelayout treelayout gridlayout view shape deﬁnes graphical aspect element height width commonly set height width respectively shape colored bordercolor ﬁllcolor information popped popuptext popupview subview deﬁned node foreach node forit event forwarded parent forward forward scripting visualization mondrian highlighting available highlightwhenover take block return list node highlight chapter mondrian domain speciﬁc language drian older visualization framework developed tudor girba michael meyer mondrian maintained alexandre bergel acknowledgment grateful nicolas rosselot urrejola review early draft iv languagechapter handling exception participation clément bera application deal exceptional situation arithmetic rors occur division zero unexpected situation arise ﬁle resource exhausted network disk solution operation fail return cialerror code mean client code check return value operation special action handle error lead brittle code help series example shall explore bilities closer look internal mechanic exception exception handler introduction modern programming language including smalltalk offer dedicated mechanism greatly simpliﬁes way ceptional situation signaled handled development ansi smalltalk standard exception handling mechanism existed incompatible pharo s exception handling follows ansi standard embellishment present chapter user perspective basic idea exception handling client code doe ter main logic ﬂow check error code speciﬁes instead exception handler catch exception go wrong instead returning error code method detects exceptional situation interrupt main ﬂow execution signaling exception handling exception thing capture essential information context exception occurred transfer control exception handler written client decides essential information context saved exception object various class exception speciﬁed cover varied exceptional situation arise pharo s mechanism particularly expressive ﬂexible covering wide range possibility exception handler used ensure certain action place go wrong action go wrong like smalltalk exception object respond variety message tion caught handler possible response handler specify alternative action perform ask exception object toresume interrupted operation retry operation pas exception handler reraise completely different tion ensuring execution ensure message sent block make sure block fails raise exception argument block executed anyblock ensure ensuredblock ensuredblock run anyblock fails consider following example creates image ﬁle screenshot taken user writer writer gifreadwriter filestream newfilenamed writer nextputimage form fromuser ensure writer close code ensures writer ﬁle handle closed error occurs form fromuser writing ﬁle work nextputimage method class gifreadwriter convert form instance class form representing bitmap image gif image method writes stream opened ﬁle nextputimage method doe close stream writing sure close stream lem arises writing achieved sending message ensure block doe writing case nextputimage fails control ﬂow block passed ensure doe notfail ensured block executed case sure writer closed use ensure class cursor handling return cursor showwhile ablock evaluating argument ablock make receiver cursor shape oldcursor oldcursor sensor currentcursor self ensure oldcursor argument oldcursor evaluated ablock signal exception note result ensure value receiver argument ensure handling return message ifcurtailed typically used cleaning action similar toensure instead ensuring argument block evaluated receiver terminates abnormally ifcurtailed doe receiver fails return following example receiver ifcurtailed performs early turn following statement reached smalltalk ferred return argument block cuted ifcurtailed transcript transcript following example clearly argument ifcurtailed evaluated receiver terminates abnormally error signal ifcurtailed transcript cr transcript cr open transcript evaluate code workspace debugger window open ﬁrst try selecting proceed abandon note argument ifcurtailed evaluated receiver terminates mally happens select debug example ifcurtailed usage text transcript describes situation ifcurtailed transcript displayed cr handling exception ifcurtailed transcript displayed cr ifcurtailed transcript displayed selecting abandon debugger cr pharo ifcurtailed ensure implemented using marker primitive described end chapter principle ifcurtailed implemented using ensure follows ifcurtailed curtailblock result curtailed curtailed true result self value curtailed false ensure curtailed iftrue curtailblock value result similar fashion ensure implemented using ifcurtailed low ensure ensureblock result result self ifcurtailed ensureblock reach point receiver curtailed ensureblock need evaluated ensureblock value result ensure ifcurtailed useful making sure important cleanup code executed sufﬁcient handling exceptional situation let s look general mechanism handling exception exception handler general mechanism provided message look like ablock exceptionclass handleraction ablock code detects abnormal situation signal tion called protected block block evaluated exception signaled called exception handler deﬁnes class exception handleraction asked handle message return value receiver protected block error occurs return value handleraction block illustrated following expression exception handler zerodivide exception zerodivide exception zerodivide exception raise error beauty mechanism lie fact protected block written straightforward way regard possible error single exception handler responsible taking care wrong consider following example want copy content ﬁle thing wrong exception handling simply write method deﬁne single exception handler transaction source destination fromstream tostream source destination fromstream filestream oldfilenamed filesystem workingdirectory source tostream filestream newfilenamed filesystem workingdirectory destination tostream nextputall fromstream content ensure tostream close ensure fromstream close filestreamexception ex uimanager default inform failed ex description exception concerning filestreams raised handler block block executed exception object argument handler code alert user copy failed delegate exception object exthe task providing detail error note nested us ensure make sure ﬁle stream closed exception occurs important understand block receiver sage deﬁnes scope exception handler handler used receiver protected block completed completed exception handler used handler associated exclusively kind exception speciﬁed ﬁrst ment previous example filestreamexception speciﬁc variant thereof handled buggy solution study following code handling exception source destination fromstream tostream source destination fromstream filestream oldfilenamed filesystem workingdirectory source tostream filestream newfilenamed filesystem workingdirectory destination tostream nextputall fromstream content filestreamexception ex uimanager default inform failed ex description fromstream ifnotnil fromstream close tostream ifnotnil tostream close exception filestreamexception happens ﬁles properly closed error code don t exception bad way handle method fail duce expected result introduce explicit error code possible return value fact language like c code littered check ror code obscure main application logic error code fragile face evolution new error code added client adapted new code account using ceptions instead error code programmer freed task plicitly checking return value program logic stay uncluttered exception class new exceptional situation discovered subclassed old client work provide exception handling newer client smalltalk did provide support tiny example saw previous section written like using error code pseudo luckily smalltalk doe work like beneﬁt exception handling check error code operation source destination success deﬁne constant error code failure fromstream filestream oldfilenamed filesystem workingdirectory source fromstream ifnil uimanager default inform failed open source failure terminate block error code tostream filestream newfilenamed filesystem workingdirectory destination tostream ifnil fromstream close uimanager default inform failed open exception handled figure small pharo exception hierarchy failure content fromstream content content ifnil fromstream close tostream close uimanager default inform failed source ﬁle content failure result tostream nextputall content result iffalse fromstream close tostream close uimanager default inform failed write destination failure fromstream close tostream close success mess exception handling explicitly check sult operation proceeding check error code point wrong prepared cleanup operation performed point abort rest code specifying exception handled smalltalk exception course object pharo ception instance exception class erarchy exception class example exception filedoesnotexistexception fileexistsexception cannotdeletefileexception special kind filestreamexception represented subclass handling exception filestreamexception shown figure notion specialization let associate exception handler general exceptional situation allowing write different expression depending level granularity want error filestreamexception filedoesnotexistexception class filestreamexception add information class exception characterize speciﬁc abnormal situation describes speciﬁcally filestreamexception deﬁnes ﬁlename instance variable contains ﬁle signaled exception root exception class hierarchy exception direct subclass object key message involved exception handling seen sent block set exception handler signal sent subclass exception signal exception curred catching set exception far used catch just single class exception handler invoked exception signaled speciﬁed exception class imagine situation like catch multiple class exception easy just specify list class separated comma shown following example result warning signal warning zerodivide ex ex resume wondering work look implementation ofexception class exception class anotherexception create exception set new add self add anotherexception rest magic occurs class exceptionset ingly simple implementation object subclass exceptionset instancevariablenames classvariablenames pooldictionaries signaling exception category exceptionset initialize super initialize exception orderedcollection new exceptionset anexception self add anexception exceptionset add anexception exception add anexception exceptionset handle anexception exception ex ex handle anexception iftrue message handle deﬁned single exception return receiver handle exception signaling exception signal need create instance exception class send message signal orsignal textual description class exception class provides convenience method signal creates signal exception equivalent way signal zerodivide exception zerodivide new signal zerodivide signal convenience method doe wonder necessary create instance exception order signal having exception class responsibility creating instance important encapsulates information context exception signaled exception instance describing context different exception exception signaled exception handling mechanism search execution stack exception handler associated class signaled exception handler encountered sage stack implementation check exceptionclass superclass signaled exception executes handleraction raise throw exception vital message called signal use terminology exclusively handling exception exception sole argument shortly way handler use exception object signaling exception possible provide information ciﬁc situation just encountered illustrated code example ﬁle opened doe exist ﬁle recorded exception object standardfilestream class oldfilenamed ﬁlename open existing ﬁle given reading writing directory default directory assumed ﬁle doe exist exception signaled ﬁle exists prior content modiﬁed replaced ﬁle truncated close fullname fullname self fullname ﬁlename self isafilenamed fullname iftrue self new open fullname forwrite true iffalse file doe exist filedoesnotexistexception new ﬁlename fullname signal exception handler make use information recover abnormal situation argument exin exception handler ex instance filedoesnotexistexception subclass exception queried ﬁlename missing ﬁle sending message ﬁlename result result standardfilestream oldfilenamed contentsofentirefile filedoesnotexistexception ex ex ﬁlename available transcript result cr exception default description used ment tool report exceptional situation clear comprehensible manner make description available exception object respond message description default description changed sending message messagetext adescription signaling exception using signal adescription example signaling occurs doesnotunderstand nism pillar reﬂective capability smalltalk object sent message doe understand vm eventually send message doesnotunderstand argument representing offending message default implementation doesnotunderstand deﬁned class object simply signal messagenotunderstood exception causing debugger opened point execution doesnotunderstand method illustrates way speciﬁc information receiver message handler derstood stored exception available debugger object doesnotunderstand amessage handle fact attempt send given message receiver receiver doe understand message typically sent machine message sent receiver method deﬁned selector messagenotunderstood new message amessage receiver self signal amessage sentto self completes description exception used der chapter discusses exception implemented add detail relevant deﬁne exception finding handler look exception handler fetched execution stack exception signaled need understand control ﬂow program internally represented virtual machine point execution program execution stack program represented list activation context activation text represents method invocation contains information needed execution receiver argument local variable contains reference context triggered creation tivation context associated method execution sent message created context pharo class methodcontext superclass iscontextpart model information reference activation context link chain chain activation context issmalltalk s execution stack suppose attempt open filestream ﬁle adoit filedoesnotexistexception signaled execution stack contain methodcontext s doit oldfilenamed signal shown ure object smalltalk expect method text object smalltalk implementation use native c execution stack virtual machine avoid creating object time current pharo virtual machine doe actually use smalltalk object time speed recycles old method context object ing new handling exception figure pharo execution stack send ablock exceptionclass actionhandler intend sociate exception handler actionhandler given class exception exceptionclass activation context protected block ablock information used identify execute actionhandler tion appropriate class signaled actionhandler ing stack starting recent ing downward context sent message exception handler stack message defaultaction sent contextpart handlesignal undeﬁnedobject handlesignal associated stack deﬁned low undeﬁnedobject handlesignal exception handler context left sender chain get called return signal default action exception resumeunchecked exception defaultaction message handlesignal sent exception signal exception eis signaled identiﬁes fetch corresponding exception handler searching stack follows look current activation context handler test handler canhandlesignal handler stack stack return step handler stack send defaultaction default implementation error class lead opening exception handler send value nested exception exception handler outside scope mean exception signaled exception dler nested exception separate handler set catch nested exception example message receiver second catch error signaled handler ﬁrst ber result protected block value handler action block value result error signal exception error signal exception ex ex description error second handler nested exception caught debugger invoked alternative specify second handler ﬁrst result error signal exception error signal exception ex ex description error subtle important point study carefully handling exception exception signaled handler choice handle particular abandon execution protected block simply specifying alternative result protocol used similar return ii return alternative result protected block sending return avalue exception object handling exception iii retry protected block sending retry try different block sending retryusing iv resume protected block failure point sending resume resume v pas caught exception enclosing handler sending pas vi resignal different exception sending resignalas exception brieﬂy look ﬁrst possibility closer look remaining one abandon protected block ﬁrst possibility abandon execution protected block follows answer result error signal result evaluated error ex handler take point error signaled code following original block evaluated return value return block return value statement block regardless block protected situation result need returned handler block message return avalue sent exception effect returning avalue value protected block result error signal error ex ex return ansi standard clear regarding difference using ex ex ex return return value suggest use return expression equivalent exception variant return message return return nil note case control notreturn protected block passed enclosing context error signal error ex ex return retry computation retry retryusing want change circumstance led tion retry protected block sending retry orretryusing exception object important sure condition caused exception changed retrying protected block inﬁnite loop result error signal error ex ex retry loop endlessly example protected block modiﬁed environment themeaningoflife properly initialized result themeaningoflife error themeaningoflife nil error ex themeaningoflife ex retry message retryusing anewblock enables protected block placed anewblock new block executed protected handler original block x result fails error ex x x ex retryusing x fails succeeds following code loop endlessly arithmeticerror ex ex retryusing signal error arithmeticerror ex ex retryusing error signal example mind ﬁle handling code saw earlier printed message transcript ﬁle instead prompt ﬁle handling exception standardfilestream oldfilenamed contentsofentirefile filedoesnotexistexception ex ex retryusing filelist modalfileselector contentsofentirefile resuming execution method signal exception isresumable resumed place immediately following signal exception handler perform action resume execution ﬂow behavior achieved sending resume exception handler argument value used place expression signaled exception following example signal catch myresumabletesterror deﬁned category result log log orderedcollection new log addlast log addlast myresumabletesterror signal log addlast log addlast myresumabletesterror signal log addlast log myresumabletesterror ex ex resume orderedcollection clearly value myresumabletesterror signal value argument resume message message resume equivalent resume nil usefulness resuming exception illustrated following functionality load package installing package warning signaled considered fatal error simply ignore warning continue installing class packageinstaller doe exist sketch ble implementation packageinstaller installquietly packagenamecollection self install warning ex ex resume situation resumption useful want ask user example suppose deﬁne class resumableloader following method handling exception resumableloader readoptionsfrom astream option astream atend whilefalse option self parseoption astream nil invalid option isnil iftrue invalidoption signal iffalse self addoption option invalid option encountered signal invalidoption exception context sends readoptionsfrom set suitable handler resumableloader readconﬁguration stream stream self optionstream self readoptionsfrom stream invalidoption ex uimanager default conﬁrm option line continue loading iftrue ex resume iffalse ex return stream close note sure close stream stream close guarded ensure invocation depending user input handler readconﬁguration return nil resume exception causing signal message send readoptionsfrom return parsing option stream continue note invalidoption resumable sufﬁces deﬁne class exception look sender resume used passing exception illustrate remaining possibility handling exception ing exception look implement generalization perform method send perform asymbol object cause message named asymbol sent object perform factorial factorial variant method exist example perform witharguments perform method useful accessing interface ically message sent determined handling exception message missing sends cascade unary message given receiver simple naive implementation object performall selectorcollection selectorcollection self perform abort ﬁrst error method used follows morph new performall activate betransparent beunsticky complication selector tion object doe understand activate like ignore selector continue sending remaining message following implementation reasonable object performall selectorcollection selectorcollection self perform messagenotunderstood ex ex return ignores internal error closer examination notice problem handler catch ignore message understood original receiver message sent understood method message understood hide programming error method intent address need handler analyze exception caused attempt perform current selector correct implementation method object performall object performall selectorcollection selectorcollection self perform messagenotunderstood ex ex receiver self ex message selector iftrue ex return iffalse ex pas pas internal error effect passing messagenotunderstood error rounding context list message forming pas message pas exception applicable handler execution stack handler stack defaultaction message sent exception instance pas action doe modify sender chain way handler control like message discussed section pas special return outer pas goal section demonstrate power exception clear exception code result easy understand simpler way effect exception method page better way implement performall resending exception suppose performall example longer want ignore selector understood receiver instead want consider rence selector error want signaled exception let s say invalidaction generic messagenotunderstood word want ability resignal signaled exception different solution simply signal new ception handler block handler block implementation performall ex ex receiver self ex message selector iftrue invalidaction signal signal wrong context iffalse ex pas closer look reveals subtle problem solution original intent replace occurrence messagenotunderstood invalidaction replacement effect validaction signaled place program original messagenotunderstood exception solution signal invalidaction ent location difference location lead difference applicable handler solve problem resignaling exception special action dled purpose provides message resignalas correct implementation handler block performall example ex ex receiver self ex message selector iftrue ex resignalas invalidaction resignals original context iffalse ex pas comparing outer pas ansi protocol speciﬁes outer behavior method outer similar pas sending outer exception evaluates enclosing handler action difference outer handler resume handling exception exception control returned point outer sent original point exception signaled passresume warning signal resume warning ex ex pas warning ex ex resume resume original signal point outerresume warning signal warning ex ex outer resume warning ex ex resume resume outer sent exception ensure tion saw exception work present interplay exception ensure ifcurtailed semantics exception handler executed ensure orifcurtailed block executed ensure argument executed ifcurtailed argument executed receiver execution led unwound stack following example show behavior print ﬁrst error followed curtailed return ifcurtailed transcript curtailed cr error e transcript ﬁrst error cr e return raise division zero error error handled exception handler print ﬁrst message return value receiver raised error argument ifcurtailed message evaluated print second message note ifcurtailed doe change return value expressed error handler ifcurtailed argument following expression show stack unwound expression value simply returned handler executed returned exception ensure interaction ifcurtailed transcript cr doe display error e transcript cr doe display e return ifcurtailed watchdog reacts abnormal stack behavior ple add return statement receiver previous expression argument ifcurtailed message raised return statement invalid deﬁned method ifcurtailed transcript show curtailed cr error e transcript cr doe display e return following example show ensure executed systematically error raised message ensure played returned value ensure transcript ensure cr error e transcript cr doe display e return following expression show error occurs handler associated error executed ensure argument expression print error ﬁrst ensure turn ensure transcript ensure cr error e transcript error ﬁrst cr e return finally expression show error executed closest farthest error ensure argument ensure displayed ensure transcript ensure cr error transcript cr e pas error e transcript cr e return handling exception example deprecation deprecation offer case study mechanism built using resumable tions deprecation software pattern allows mark method deprecated meaning disappear future release used new code pharo method marked deprecated follows utility class convertcrtolf ﬁlename convert given ﬁle lf line ending result ﬁle extention self deprecated filestream convertcrtolf ﬁlename instead july filestream convertcrtolf ﬁlename message convertcrtolf sent setting raisewarning istrue window displayed notiﬁcation programmer resume application execution shown figure setting explained detail chapter course method recated ﬁnd current pharo distribution look sender deprecated figure sending deprecated message deprecation implemented pharo just step deﬁne deprecation subclass warning instance variable contain information deprecation pharo areexample halt implementation methodreference explanationstring deprecationdate versionstring need deﬁne initialization method variable instance creation method sends corresponding message deﬁne new exception class consider overriding isresumable description defaultaction case inherited tations ﬁrst method ﬁne inherited exception answer true inherited exception answer adequate textual description necessary override implementation defaultaction want depend particular setting pharo s implementation deprecation defaultaction log ifnotnil log add self self showwarning iftrue transcript nextputall self messagetext cr ﬂush self raisewarning iftrue super defaultaction ﬁrst preference simply cause warning message written thetranscript second preference asks exception signaled accomplished super defaultaction need implement convenience method object like object deprecated anexplanationstring date version deprecation method thiscontext sender method explanation anexplanationstring date version signal example halt implementation discussed debugger chapter pharo example usual way setting breakpoint smalltalk method insert self halt code method halt implemented object us exception open debugger location breakpoint deﬁned handling exception object halt typical message use inserting breakpoints debugging behaves like halt doe halt order avoid putting message stack halt especially useful breakpoint message arbitrary halt signal haltis direct subclass exception haltexception resumable mean possible continue execution haltis signaled haltoverrides defaultaction method speciﬁes action form exception caught exception handler halt execution stack halt defaultaction handled error chance decide debug handle open debugger unhandederror unhandlederror signalforexception self code signal new exception unhandlederror conveys idea handler present defaultaction ofunhandlederror open bugger unhandlederror defaultaction current computation terminated cause error logged reported user program operating interactive debugging environment computation suspended debugger activated uimanager default unhandlederrordefaultaction self exception morphicuimanager unhandlederrordefaultaction anexception smalltalk tool debugerror anexception message later debugger open process debug context title title bool smalltalk tool debugger openon self context context label title content nil fullview bool speciﬁc exception class exception pharo direct subclass shown figure ﬁrst thing notice ﬁgure exception hierarchyspeciﬁc exception bit mess expect detail change pharo improved figure pharo exception hierarchy second thing notice large error notiﬁcation error tell program fallen kind abnormal situation contrast notiﬁcations tell event occurred assumption abnormal notiﬁcation handled program continue execute important subclass ofnotiﬁcation iswarning warning used notify part user abnormal behavior property resumable largely orthogonal location exception hierarchy general error s resumable subclass areresumable example messagenotunderstood subclass oferror resumable testfailure s resumable expect resumabletestfailure s resumability controlled private exception method isresumable example exception new isresumable true error new isresumable false notiﬁcation new isresumable true halt new isresumable true messagenotunderstood new isresumable handling exception turn roughly exception resumable exception allsubclasses size exception allsubclasses select new isresumable size declare new subclass exception look protocol isresumable method override appropriate semantics exception situation make sense resume exception case signal subclass existing creation situation ok resume exception handler having fact give way characterizing notiﬁcation notiﬁcation resumable exception safely resumed ﬁrst modifying state safe resume exception state ﬁrst modiﬁed way signal resumable exception clear expect exception handler resume exception deﬁning new exception difﬁcult decide worth deﬁning new exception instead reusing existing heuristic evaluate adequate solution exceptional situation need speciﬁc default behavior exceptional situation handled need store information handle exception case use exception just pharo exception handling conclude appropriate use stated introduction chapter said exception handling exceptional situation ﬁrst rule using exception notto use situation reasonably expected occur normal execution course writing library normal depends context library used make concrete let s look dictionary example adictionary akey signal error ifakey present write handler error logic application possibility key dictionary instead use akey ifabsent remedial action implementation fact dictionary implemented using dictionary ifabsent tect apredicateblock similar possibility predicate satisﬁed use acollection detect apredicateblock ifnone remedial action write method signal exception consider provide alternative method take remedial block additional argument evaluates normal action pleted technique used programming language support closure smalltalk us closure allits control structure particularly natural use smalltalk way avoiding exception handling test precondition exception sending message signal example method sent message object using perform handled themessagenotunderstood error ensue simpler alternative check message understood executing perform method object performall revisited performall selectorcollection selectorcollection self respondsto iftrue self perform primary objection method efﬁciency implementation ofrespondsto s lookup sin target s method dictionary ﬁnd swill understood answer yes perform look ﬁrst lookup implemented smalltalk virtual machine code loop issue collection message come user interaction speed performall problem exception implementation presented use exception really ing depth implemented note need know exception implemented use simply skip section ﬁrst reading curious really want know implemented section mechanism quite simple making worthwhile know operates contrary mainstream language exception plemented language virtual machine support using reiﬁcation runtime stack linked list context method closure activation record let s look exception implemented use context store handling exception storing handler need understand exception class associated handler stored information let s look deﬁnition central method deﬁned class blockclosure blockclosure exception handleraction evaluate receiver scope exception handler handleractive primitive handleractive true value code tell thing firstly method implemented primitive usually mean primitive operation virtual chine executed method invoked case exception primitive pragma primitive operation primitive index used mark method doe execute code virtual chine primitive fail change implementation mark differently method example adding extra bytecode end designed primitive bit reserved primitive number apis set compiled method implementation primitive just marker real primitive operation fall code pragma executed code simply set temporary variable handleractive true evaluates receiver course block surprisingly simple somewhat puzzling ments method stored answer let s look nition class methodcontext instance represent method closure activation record described chapter context called activation record context reiﬁcation stack frame notable ferences represents speciﬁc point execution hold program counter point instruction execute previous context argument receiver contextpart variablesubclass methodcontext instancevariablenames closureornil receiver classvariablenames pooldictionaries category instance variable store exception class dler place superclass store note methodcontext deﬁned variablesubclass mean addition named instance variable instance class indexed slot methodcontext indexed slot used store amongexceptions implementation argument temporary variable method invocation represents case interest argument message stored indexed variable stack execution instance verify evaluate following piece code exception handler thiscontext explore self halt exception thiscontext sender handler thiscontext sender error ex exception handler explore protected block query context represents protected block execution using thiscontext sender execution triggered message execution line explores array tains exception class exception handler strange result using haltand inspect inside protected block note method executed state context ject change method return context terminated setting nil ﬁelds opening explorer thiscontext context sender effectively execution method note execute following code thiscontext sender explore error obtain explorer exception class handler stored ﬁrst second variable instance variable method context object method context represents execution stack ment execution store exception class handler method context note speciﬁc message execution store argument corresponding context finding handler know information stored let s look runtime discussed primitive used fails primitive fails smalltalk body executed presence primitive used marker source code primitive interpreter primitivemarkhandlermethod vmmaker squeaksource handling exception figure explore method context ﬁnd exception class handler primitivemarkhandlermethod primitive mark method exception handling primitive fail marking context regular code run self inline false primitivefail know context corresponding method marked context direct reference instance variable method activated know context tion handler checking method activated hold primitive s s method ishandlercontext doing code methodcontext ishandlercontext context method marked primitive exception signaled stack assuming stack growing method signal search stack ﬁnd appropriate handler following code doing exception signal ask contexthandlers sender chain handle signal default execute return defaultaction signalcontext thiscontext contexttag thiscontext nexthandlercontext handlesignal selfexceptions implementation contextpart nexthandlercontext self sender ﬁndnexthandlercontextstarting method ﬁndnexthandlercontextstarting implemented primitive number body describes doe walk linked list context current context look context method marked primitive ﬁnds context answer introduction section said implementation ceptions fully language level primitive implemented virtual machine note primitive just performance fact virtual machine heavily mizes context allocating object represent needed context present form machine stack primitive faster creates context object method marked theon primitive fallback code requires context jects error signaling context error handling context created primitive present performance primitive optional remove primitive pharo runtime work ﬁne exception slower primitive enforces use primitive mark exception handler want edit implementation exception use marker primitive number mark exception handler context need remove primitive rely fallback code contextpart ﬁndnexthandlercontextstarting return handler marked context returning nil search start self proceeds nil ctx primitive ctx self ctx ishandlercontext iftrue ctx ctx sender nil whilefalse method context supplied ﬁndnexthandlercontextstarting tains information examined exception class suitable handling current exception associated handler executed continue implemented handlesignal method contextpart handlesignal exception sent handler context exception class ﬁrst arg handle exception execute handle block second arg forward message handler context left execute exception defaultaction nil handlesignal handling exception value self exceptionclass handle exception self exceptionhandlerisactive iffalse self nexthandlercontext handlesignal exception exception privhandlercontext self contexttag disable self executing handle block self exceptionhandlerisactive false value self exceptionhandlerblock cull exception ensure self exceptionhandlerisactive true return self directed handle block self return value contextpart exceptionclass handlercontext access temporary blockclosure tempat exceptionhandlerblock handlercontext access temporary blockclosure tempat exceptionhandlerisactive handlercontext access temporary blockclosure tempat exceptionhandlerisactive aboolean handlercontext access temporary blockclosure self tempat aboolean notice method us tempat access exception class ask handle exception tempat temporary variable handleractive method checking handleractive istrue setting false ensures handler asked handle exception signal return message sent ﬁnal action ofhandlesignal responsible unwinding stack removing context exception signaler context exception handler executing unwind block block created ensure summarize signal method optional assistance tual machine performance ﬁnds context correspond message appropriate exception class execution stack linked list context object manipulated just like object stack shortened time superb example ﬂexibility s implementation ensure s implementation propose look implementation method ensure need understand unwind block stored information let s look deﬁnition central method ensure deﬁned class blockclosure ensure ablock evaluate termination block evaluating receiver regardless receiver evaluation completes method implemented primitive primitive fails vm us prim context method mark ensure activation complete returnvalue primitive returnvalue self valuenocontextswitch complete ifnil complete true ablock value returnvalue primitive work way primitive saw previous section fails presence mark method way easily detected context activating method unwind block stored way exception class associated handler explicitly stored context ensure method execution accessed block thiscontext sender tempat case block doe fail doe turn ensure message implementation executes block store result returnvalue variable executes argument block lastly return result block previously stored complete variable prevent argument block executed twice ensuring failing block ensure message execute argument block block fails following example ensurewithondo message return executes subsequent section carefully look block actually returning order block executed bexp ensurewithondo error signal ensure error let s quick example looking implementation deﬁne block method ensure failing handling exception bexp mainblock self tracecr start self failingblock ensure self ensureblock self tracecr end bexp failingblock self tracecr start error signal self tracecr end bexp ensureblock self tracecr value ensureblockvalue bexp exceptionhandlerblock self tracecr value exceptionhandlerblockvalue bexp start re self tracecr start re self mainblock error self exceptionhandlerblock self tracecr end self tracecr result re re executing bexp new start print following added indentation stress calling ﬂow start start mainblock start failingblock start exceptionhandlerblock value ensureblock value start end result exceptionhandlerblockvalue important thing failing block main block fully executed signal message secondly exception block executed ensure block lastly start method return result exception handler block understand work look end tion implementation ﬁnish previous explanation handlesignal method contextpart handlesignal exception sent handler context exception class ﬁrst arg handle exception execute handle block second arg forward thisensure s implementation message handler context left execute exception defaultaction nil handlesignal value self exceptionclass handle exception self exceptionhandlerisactive iffalse self nexthandlercontext handlesignal exception exception privhandlercontext self contexttag disable self executing handle block self exceptionhandlerisactive false value self exceptionhandlerblock cull exception ensure self exceptionhandlerisactive true return self directed handle block self return value example pharo execute failing block look handler context marked primitive regular tion pharo ﬁnds exception handler context run dlerblock method handlesignal ﬁnishes return method let s look contextpart return value unwind thiscontext self return value self sender execute unwind block unwinding assumes self sender thiscontext sender ifnil self cannotreturn value sender sender resume value return message check context sender send acannotreturn exception sender context resume message resume value unwind thiscontext self resume value result send execute unwind block unwinding assumes self sender thiscontext self resume value thiscontext ﬁndnextunwindcontextupto self contextpart resume value ﬁrstunwindcontext unwind thiscontext self resume value result send execute unwind block unwinding assumes self sender thiscontext context unwindblock self isdead iftrue self cannotreturn value self context handling exception context isnil whilefalse context unwindcomplete ifnil context unwindcomplete true unwindblock context unwindblock thiscontext terminateto context unwindblock value context context ﬁndnextunwindcontextupto self thiscontext terminateto self method argument block ensure executed method look unwind context context method resume self sender context case context start method ﬁnds unwound context unwound block executed lastly trigger terminateto message contextpart terminateto previouscontext terminate context previouscontext previouscontext context stack make previouscontext sender currentcontext sendingcontext primitive self hassender previouscontext iftrue currentcontext sender currentcontext previouscontext whilefalse sendingcontext currentcontext sender currentcontext terminate currentcontext sendingcontext sender previouscontext basically method terminates context thiscontext self sender context case context start sender thiscontext self sender context case context start implemented primitive performance primitive optional fallback code behavior let s summarize happens figure represents execution method ensurewithondo deﬁned previously ensuring non local return method resume called performing non local return case non local return stack unwound similar way exception virtual machine performing non local return send message abouttoreturn active context changed implementation tion language ensure s implementation contextpart resume valueself resume value thiscontext ﬁndnextunwindcontextupto self context class signal signalcontext thiscontext contexttag signaler ifnil signaler self receiver signalcontext nexthandlercontext handlesignal self blockclosure ensure complete returnvalue primitive returnvalue self valuenocontextswitch complete ifnil complete true ablock returnvalueblockclosure exception handleraction handleractive primitive handleractive true valuebexp error signal ensure error contextpart handlesignal exception val self exceptionclass handle exception self exceptionhandlerisactive iffalse self nexthandlercontext handlesignal exception privhandlercontext self exceptionhandlerisactive self exceptionhandlerblock cull exception ensure self exceptionhandlerisactive true return val contextpart return value sender ifnil self cannotreturn value sender resume value contextpart resume value context unwindblock isdead iftrue self cannotreturn value self ﬁrstunwindcontext context isnil whilefalse context unwindcomplete ifnil context unwindcomplete context terminateto value context ﬁndnextunwindcontextupto self terminateto context newcontext error signal ensure context error signal context context xxxxx figure context handling exception context method class context method context method body context numberreceiver context methodwhen method look context arrow show context method foundxwhile looking context method deletes context doe ﬁt figure legend ﬁgure chapter summary chapter saw use exception signal handle abnormal situation arising code use exception mechanism reserve notiﬁcations abnormal situation consider providing method block argument alternative signaling exception use protectedblock ensure actionblock ensure actionblock performed protectedblock terminates abnormally use protectedblock ifcurtailed actionblock ensure actionblock performed ifprotectedblock terminates abnormally exception object exception class form hierarchy class exception root hierarchy use protectedblock exceptionclass handlerblock catch exception instance exceptionclass subclass dlerblock exception instance sole argument exception signaled sending message signal orsignal signal take descriptive string argument description exception obtained sending message description set breakpoint code inserting self halt signal resumable haltexception default open debugger point breakpoint occurs exception signaled runtime search execution stack looking handler speciﬁc class tion defaultaction exception formed case debugger opened summary exception handler terminate protected block sending return signaled exception value protected block argument supplied return exception handler retry protected block sending retry signaled exception handler remains effect exception handler specify new block try sending retryusing signaled exception new block argument handler remains effect notiﬁcations subclass exception property safely resumed handler having speciﬁc tion acknowledgment gratefully acknowledge vassili bykov raw material provided thank paolo bonzini smalltalk plementations ensure ifcurtailed thank hernan wilkinson lukas renggli christopher oliver camillo bruni hernan wilkinson carlos ferro comment block detailed analysis participation clément bera block closure block short powerful sential feature pharo difﬁcult small compact syntax use block key conditionals loop library message hardcoded language syntax say block work extremely message passing syntax pharo addition block effective improve readability reusability efﬁciency code ﬁne dynamic runtime semantics block documented example block presence return ments behave like escaping mechanism lead ugly code used extreme important understand chapter learn central notion context object represent point program execution capture variable block creation time learn block return change program ﬂow finally understand block program execute particular present context called activation record resent given execution state context used block execution chapter complement exception chapter pharo example book presented write use block contrary chapter focus deep aspect runtime block detailed analysis basic block block lambda expression capture close environment later mean exactly imagine block anonymous function method block piece code execution frozen kicked using message block deﬁned square bracket execute print result following code block did ask block value just block got block evaluated sending value message cisely block evaluated using value argument tory value block requires argument value value ments value value value valuewitharguments anarray argument message basic historical api block ation presented pharo example book value x x value handy extension value message pharo includes handy message cull friend support evaluation block presence value necessary cull raise error receiver requires argument provided valuewithpossibleargs message similar tocull take array parameter pas block argument block requires argument provided valuewithpossibleargs ﬁll nil cull cull cull x x cull x x cull cull x y x y cull cull x y x y cull error block need argument x y x y valuewithpossibleargs error y nil doe accept nil message message useful proﬁle evaluation formation chapter bench return time receiver block evaluated second durationtorun answer duration instance class duration taken uate receiver block timetorun answer number millisecond taken evaluate block message related error handling explained ter ensure terminationblock evaluate termination block evaluating receiver regardless receiver s evaluation completes ifcurtailed onerrorblock evaluate receiver evaluation doe complete evaluate error block evaluation receiver ﬁnishes normally error block evaluated exception catchblock evaluate receiver exception exception raised evaluate catch block exception fork catchblock evaluate receiver exception exception raised fork new process handle error nal process continue running receiver evaluation ﬁnished answered nil expression like self error error ror fork ex answer nil original process context stack starting context sent message receiver stack transferred forked process catch block eventually catch block evaluated forked process message related process scheduling list tant one chapter concurrent programming pharo deep fork create schedule process evaluating receiver forkat apriority create schedule process evaluating receiver given priority answer newly created process newprocess answer process evaluating receiver process block detailed analysis variable block block temporary variable variable initialized block execution local block later variable kept question want make clear happening block refers variable block close external variable us mean block executed later environment doe lexically contain variable used block block access variable execution later present local variable implemented stored using context pharo private variable self instance variable method poraries argument lexically scoped expression method access variable visible method expression method class access variable scope expression visible expression runtime variable block access bound value associated context block contains deﬁned context block evaluated mean block evaluated access variable scope visible block block created traditionally context block deﬁned named block home context block home context represents particular point execution program execution created block ﬁrst place notion block home context represented object represents program execution context object pharo essence context called stack frame activation record language represents information current evaluation step context current executed byte code executed temporary variable value context pharo execution stack element important come later concept block created inside context object sent point execution little experiment let s experiment bit understand variable bound block deﬁne class named bexp blockexperiment object subclass bexp instancevariablenames variable block classvariablenames pooldictionaries category experiment variable lookup variable looked block nition context deﬁne method deﬁnes variable tand set block t tracecr deﬁnes new variable executes block deﬁned bexp setvariableanddeﬁneblock t t self evaluateblock t tracecr bexp evaluateblock ablock t t nil ablock value bexp new setvariableanddeﬁneblock executing bexp new setvariableanddeﬁneblock expression print transcript message tracecr value temporary variable ﬁned setvariableanddeﬁneblock method used deﬁned inside method evaluateblock block evaluated execution method variable ti looked context block creation context created execution method setvariableanddeﬁneblock context block tion method evaluateblock let s look figure show execution expression bexp new setvariableanddeﬁneblock execution method setvariableanddeﬁneblock variable ti deﬁned assigned block created block refers method activation context hold temporary ables step method evaluateblock deﬁnes local variable twith block variable used block evaluated executing method evaluateblock block evaluated step execution expression t tracecr variable ti looked home context block method context created block context currently executed block detailed analysis figure variable looked method activation context block created evaluated variable looked home context block method context created block context executing block experiment changing variable value let s continue experiment method show variable value changed evaluation block executing bexp new print value variable bexp t t self evaluateblock t t tracecr bexp new experiment accessing shared variable block share variable modify value able different moment let deﬁne new method follows variable block bexp t t self evaluateblock t tracecr t t tracecr self evaluateblock t tracecr t t tracecr self evaluateblock t tracecr bexp new bexp new print block t t tracecr t t tracecr access variable t modify ﬁrst execution method evaluateblock current value printed value changed printed similar situation occurs second example show block share location variable stored block doe copy value captured variable just refers location variable block refer location experiment variable lookup execution time following example show value variable looked runtime copied block creation add instance variable block class bexp object subclass bexp instancevariablenames classvariablenames pooldictionaries category initial value variable ti block created stored instance variable block value ti changed block evaluated value tively printed looked executing bexp new print bexp t t block t tracecr t t self evaluateblock block detailed analysis bexp new experiment method argument expect method ments bound context deﬁning method let s illustrate point deﬁne following method bexp testarg self testarg bexp testarg arg block arg tracecr self evaluateblockandignoreargument bexp evaluateblockandignoreargument arg block value executing bexp new testarg print method evaluateblockandignoreargument temporary argis redeﬁned fact method invocation value argument experiment self binding wonder self captured test need class let s simply deﬁne new class couple method add instance variable xto class bexp deﬁne initialize method follows object subclass bexp instancevariablenames x classvariablenames pooldictionaries category bexp initialize super initialize x deﬁne class named object subclass instancevariablenames x classvariablenames pooldictionaries category initialize super block x evaluateblock ablock ablock value deﬁne method invoke method deﬁned bexp evaluateblock ablock new evaluateblock ablock bexp evaluateblock self evaluateblock self crtrace tracecr x bexp new evaluateblock execute bexp new evaluateblock printed transcript showing block capture selftoo instance executed block printed object self original bexp instance accessible block creation time conclusion block capture variable reached context block deﬁned executed block reference variable location shared tiple block variable saw previously block lexical closure connected place deﬁned following illustrate connection showing block local variable allocated execution context link creation difference variable local block method figure block allocation implement following method blocklocaltemp bexp blocklocaltemp collection collection orderedcollection new index temp temp index collection add temp collection collect value block detailed analysis figure blocklocaltemp execution left blockoutsidetemp execution right let s comment code create loop store current index block argument temporary variable temp created loop store block access variable collection loop execute accessing block return collection value execute method collection result show block collection refers different temp variable fact execution context created block creation loop step block temp stored context method allocation let create new method blocklocaltemp variable temp method variable instead block variable bexp blockoutsidetemp collection temp collection orderedcollection new index temp index collection add temp collection collect value execute method blockoutsidetemp collection result show block collection refers single variable temp allocated blockoutsidetemp context leading fact temp shared outlive deﬁning method variable outlive deﬁning method local variable referred block continue accessible shared expression method execution terminated say variable outlive method execution deﬁned let s look example sharing start simple example showing variable shared method block previous ments fact deﬁne following method foowhich deﬁnes temporary variable bexp foo value bexp new foo execute bexp new foo nil value shared method body block inside method body access variable value set block evaluation method block body access temporary variable let s make slightly complicated deﬁne method twoblockarray follows bexp twoblockarray method twoblockarray deﬁnes temporary variable set value ofato zero return array ﬁrst element block setting value ato second element block just returning value temporary variable store array returned twoblockarray evaluate block stored array following code snippet doing re re bexp new twoblockarray re second value re ﬁrst value re second value block detailed analysis deﬁne code follows open transcript result re re bexp new twoblockarray re second value tracecr re ﬁrst value re second value tracecr let step look important point previous code snippet expression re second value re ﬁrst value executed method twoblockarray ﬁnished execution execution stack anymore temporary variable acan cessed set new value experiment show variable referred block live longer method created block refers say variable outlive execution deﬁning method example temporary variable stored activation context implementation bit subtle block implementation need referenced variable structure execution stack life heap compiler performs analysis detects variable outlive creation context allocates variable structure allocated execution stack returning inside block section explain good idea return statement inside block pas store instance variable block explicit return statement called returning block let start illustrating basic point ﬁrst basic return default returned value method receiver message self return expression expression starting character allows return different value receiver message addition execution return statement exit currently executed method return caller ignores expression following return statement experiment return s exiting behavior deﬁne following method executing bexp new testexplicitreturn print printreturning inside block printed method testexplicitreturn returned bexp testexplicitreturn self tracecr iszero iftrue self tracecr self self tracecr printed note return expression statement block body escaping behavior return return expression behaves like escaping mechanism ecution ﬂow directly jump current invoking method let deﬁne new method jumpingout follows illustrate behavior bexp jumpingout self tracecr printstring iftrue bexp new jumpingout example following expression bexp new jumpingout return reached expression deeply nested execution jump level return method caller old code predating introduction exception pass turning block leading complex ﬂows difﬁcult maintain code strongly suggest using style lead complex code bug subsequent section carefully look return actually returning understanding return return really escaping current execution let build slightly complex ﬂow deﬁne method deﬁneblock creates escaping block arg evaluates block evaluatingblock executes block note stress escaping behavior return deﬁned evaluatingblock endlessly loop evaluating argument bexp start re block detailed analysis self tracecr start re self deﬁneblock self tracecr end re bexp deﬁneblock re self tracecr start re self arg self tracecr start iszero iffalse self tracecr end self tracecr end re bexp arg ablock re self tracecr start re self evaluateblock ablock self tracecr end re bexp evaluateblock ablock re self tracecr start re self evaluateblock ablock value self tracecr loop print re executing bexp new start print following indentation added stress calling ﬂow start start deﬁneblock start arg start evaluateblock start block start start end calling method start fully executed method deﬁneblock completely executed escaping block ecuted call away method evaluateblock evaluation block return block home context sender context invoked method creating block return statement block executed method evaluateblock execution discard pending computation return method execution point created home context block block deﬁned method deﬁneblock home context block activation context represents deﬁnition method deﬁneblock inside block figure block return execution return method execution activated block home context frame represent context dashed frame represent block different execution point return expression return start method execution just ter deﬁneblock execution pending execution arg evaluateblock discarded execution method start end shown figure return sender home text home context context represents execution method deﬁneblock return result method start step represents execution invocation method deﬁneblock trace start printed step represents execution block creation step start printed home context block thedeﬁneblock method execution block detailed analysis step represents execution invocation method evaluateblock start printed step represents execution block evaluation start printed step represents execution block condition start printed step represents execution return statement step represents execution return statement return sender block home context just invocation method deﬁneblock method start execution continues end get printed non local return return sender block home context method execution point called created block return method return value sender method stop executing method containing turn return doe block executed method accessing information manually verify ﬁnd home context block following add expression thiscontext home inspect block method deﬁneblock add expression thiscontext closure home inspect access closure current execution text get home context note case block evaluated execution method evaluateblock home text block method deﬁneblock note expression executed block evaluation bexp deﬁneblock re self tracecr start re self arg thiscontext home inspect self tracecr start iszero iffalse self tracecr end self tracecr end resreturning inside block verify execution end use expression thiscontext home sender copy inspect return method context pointing assignment method start couple example following example escaping block jump sender home context previous example show method start fully executed deﬁne valuepassingescapingblock class blockclosure follows blockclosure valuepassingescapingblock self value deﬁne simple assert method raise error argument false bexp assert aboolean aboolean iffalse error signal deﬁne following method bexp testvaluewithexitbreak val break val iftrue break value valuepassingescapingblock val tracecr self assert val method deﬁnes block argument break evaluated soon step loop reached variable vali printed make sure value executing bexp new testvaluewithexitbreak form raising error print transcript loop stopped value printed assert validated change valuepassingescapingblock message sent value nil testvaluewithexitbreak method trace cause execution method testvaluewithexitbreak exit block evaluated case calling valuepassingescapingblock alent calling value home context escaping block nil different original valuepassingescapingblock home context block nil isvaluepassingescapingblock method testvaluewithexitcontinue evaluated escaping block change execution ﬂow valuepassingescapingblock message method testvaluewithexitbreak similarly previous example ﬂow came just invocation deﬁneblock message self halt assert convince case reach halt case block detailed analysis return block block evaluated home text possible attempt return method execution returned runtime error condition trapped vm bexp returnblock self bexp new returnblock value exception execute returnblock method return block caller level execution evaluating block method deﬁning terminated block ing return expression normally return sender block home context error signaled conclusion block expression return sender block home context context representing execution led block creation context representing method execution saw block refer home context looking variable look context context represent program execution pharo execution engine represents current execution state lowing information compiledmethod bytecodes executed location bytecode executed compiledmethod interpreter s program pointer receiver argument message invoked compiledmethod temporary variable needed compiledmethod stack pharo class methodcontext represents execution information amethodcontext instance hold information speciﬁc execution point thiscontext give access current execution representing method execution figure method context access value rary variable temp given point execution interacting context let look example deﬁne following method execute using bexp new ﬁrst bexp ﬁrst arg temp temp arg thiscontext copy inspect temp inspector shown figure note copy current context obtained using thiscontext virtual machine limit memory consumption reusing context methodcontext doe represent activation context method tion one block let look value current context point previous context led creation rent executed expression context ated context sender current point currently executing method reference latest executed instruction value instruction referred double click method instance variable select bytecodes ﬁeld situation depicted figure show instruction executed pop instruction block detailed analysis deﬁnes depth stack variable context case value number stored temporary variable including argument certain case example message send depth stack increased receiver pushed argument lastly message send executed depth stack go previous value hold reference currently executing closure nil message receiver class methodcontext superclass deﬁne method information particular context example ues argument sending argument message value particular temporary variable sending tempnamed block nesting context let look case block nesting impact home context fact block point context created outer context depending situation outer context block home context complex block created inside text block s outer context outer context direct context block created home context method level block nested outer context block home context block nested inside block execution outer text refers block execution context block execution s context home context outer context step nesting level figure pc variable hold bytecode instruction executed message send inspect execution let s look following example execute just press ok dialog popping homecontext homecontext thiscontext self assert thiscontext closure self assert outercontext homecontext self assert home homecontext self assert thiscontext closure self assert outercontext closure outercontext homecontext self assert home homecontext value value set homecontext context block creation homecontext home context block deﬁned execution closure show context inside execution block pointer outer context homecontext new deﬁned execution starting assignment home context outer context inside current context point closure outer context closure deﬁned point homecontext finally home context point show nested block separate outer context share home context message execution virtual machine represents execution state context object method block currently executed word activated used pharo method block execution represented methodcontext stance rest chapter survey context method execution block closure execution sending message send message receiver vm class receiver using receiver object s block detailed analysis lookup method class method dictionary method repeat lookup superclass class superclass chain understand message vm sends sage doesnotunderstand receiver error handled manner appropriate object appropriate method check primitive associated method reading method header b primitive execute c primitive completes successfully return result object message sender d primitive primitive fails continue step create new context set program counter stack pointer home context copy argument receiver message ing context s stack new stack activate new context start executing instruction new method execution state message send remembered cause instruction message send executed message return state saved using context context time context represents current state execution called active context message send happens active context active context suspended new context created activated suspended context retains state associated original compiled method context active context remember context suspended suspended context resumed result returned suspended context called new context s sender figure represents relation compiled method context method point currently executed method program counter point instruction compiled method sender point context previously active sketch implementation temporary argument block handled way od argument passed stack temporary held corresponding context block access variable thanmessage execution figure relation context compiled method method block refer argument temporary ing method seen block passed freely activated time case block access modify variable method deﬁned let consider example shown figure temp variable used block examplereadinblock method remote variable temp initialized changed method body later read block actual value variable stored block context deﬁning method context known home context typical implementation home context block accessed closure approach work object object including method block context block evaluated outside home text refer remote variable home context outlive method activation implementation previously mentioned approach block context disadvantage point view method block text normal object mean garbage collected block detailed analysis figure ﬁrst understanding closure point combined typical coding practice using small method object pharo generate lot context efﬁcient way deal method context create vm level using real stack frame method text easily mapped stack frame method create new frame return method delete current frame matter pharo different mean return method method context stack frame ately removed garbage collection needed using stack get complicated support block mentioned method context used home context outlive activation method context work explained check time home context stack frame removed come big performance penalty step using stack context make sure method context safely removed return method figure show variable longer directly stored home context separate remote array heap allocated chapter conclusion chapter learned use block called lexical closure implemented saw use block thechapter conclusion figure vm store remote variable continue leave method return method deﬁning returned block access variable non local variable instance variable temporary argument deﬁning method saw block terminate method return value sender say block ing block care taken avoid error block terminate method returned finally context play important role block creation execution thiscontext pseudo variable use information executing context potentially change thank eliot miranda exploring little number manipulate number time chapter propose little journey way integer mapped binary tions open box language implementor perspective explore small integer represented start simple math reminder math basic digital world look small integer encoded commonly forgotten time goal aid refreshing knowledge power number let s start simple math digital world information coded power really new smalltalk raising number power performed sending message raisedto number example figure show power raisedto raisedto raisedto using sequence power encode number example encode number higher order power sequence shown figure encoded encode number sequence power exploring little number figure power numerical equivalence sequence called bit encoded bit corresponding sequence bit represents binary notation number signiﬁcant bit located left bit sequence right rightmost bit figure binary notation pharo syntax representing number different base write indicates base radix rest number expressed base note write notation follows convention signiﬁcant bit rightmost printstringbase integer readfrom base note message printstringbase readfrom base handle internal encoding negative number later printstringbase return internal number tation known s complement message just number given base radix notation used specify number different base viously written decimal base return base return illustrated following shifting multiplying power bit shifting multiplying power integer represented sequence bit shift bit given obtain integer shifting bit equivalent performing figure illustrates point smalltalk offer message shift bit apositiveinteger apositiveinteger bitshift aninteger divide receiver multiply power following example use divide printstringbase multiply message bitshift equivalent us negative positive integer indicate shift direction positive argument offer behavior multiplying receiver power negative similar figure multiplying dividing exploring little number bitshift bitshift course shift bit time divide printstringbase multiply previous example bit shifting number bit constraint level complete sequence bit shifted shown figure raisedto raisedto figure time right far really special learned basic math lecture good walk hill ing manipulation access bit manipulation access pharo offer common boolean operation bit manipulation send message bitand bitor bitxor number apply bit bit associated boolean operation bitand bitand bitand bitand used select number example bitand selects ﬁrst bit bitand bitand bitand bitand bitand using bitand combined bitshift select number imagine encode number bit let s say ber encoded bit number noted xxx zzzyyyyxxx number encoded bit noted yyyy zzzyyyyxxx ﬁnally encoded bit noted zzz zzzyyyyxxx following expression handy manipulate number accessing second number simply using bitshift number present bitshift return like solution use bitand clear number bitshift bitshift clear number bitand argument adapted select right encoding bitshift bitand bitand bitshift bitshift bitand exploring little number bit access smalltalk let access bit information message bitat turn value bit given position follows pharo convention collection index start bitat bitat bitat bitat bitat pharo access environment learn tem implementation method bitat integer class integer bitat aninteger answer bit position aninteger set self considered inﬁnite sequence bit aninteger strictly positive integer bit position signiﬁcant bit negative number naive implementation reﬁned subclass speed self bitshift bitand shift right integer minus bitand know zero location imagine bitat shift doing bitand select bit return zero value doing bitand equivalent tell signiﬁcant bit really special refresh memory number internally encoded pharo using s complement start understanding s complement look s s complement number s complement number fully understand s complement worth work decimal number obvious usage s complement point want complement replacement tion subtraction adding complement b equivalent subtracting b s complement positive decimal integer ni power k minus n ki number digit decimal representation n example complement complement composed digit calculated following way replace digit dof number add resulting number example s complement using rule compute s complement correctly follows deﬁnition result s complement let s verify compute s complement number perform digit add result book propose equivalent way computing s plement zero end number remain zero rightmost digit dof number replaced digit dis replaced computer scientist probably prefer ﬁrst way regular adding cheaper making test subtraction work key point complement technique convert subtraction ditions let check example suppose want perform subtraction transform subtraction addition using s exploring little number s complement add drop carry obtained addition obtain fact idea let s compute s complement say drop carry perform compute s complement sum s complement sum negate result s complement negate look replacing number s complement based imagine want perform following expression equal s complement take advantage fact s complement ﬁrst subtraction expressed getting s complement look negative number resentation negative number know value positive number simple just add power given binary representation explained beginning chapter getting value negative number quite simple count sign bit negative one positive sign bit signiﬁcant bit bit represents largest value figure example bit representation associated weight let illustrate represented bit encoding s complement number figure negative number bit value bit representation simply add represented bit encoding value bit representation simple add following principle check value scribed figure let count bit bit representation encode positive integer fact encode generally nbits encode value s complement number piece puzzle know encode positive negative number know use complement turn subtraction addition let s complement used negate number perform subtraction s complement common method represent signed integer advantage addition subtraction implemented having check sign operand s complement representation zero avoiding negative zero adding number ent sign encoded using s complement doe require special ing sign result determined automatically s complement positive number represents negative form exploring little number s complement show computed taking difference digit largest number available base decimal base adding case binary largest number fact computing s complement number exactly ﬂipping s s vice versa adding let s look number encoded bit shown figure ﬂipped add difference given signiﬁcant bit conveys integer sign figure overview s complement bit try following expression pharo experiment compute direct inversion bitwise add remember wise turning conversely use bitstring message obtain bit representation number check length printed result notice bit long instead pharo smalltalk implementation small integer specially encoded encoding requires bit bitstring bitinvert bitstring bitinvert bitstring bitstring s complement number note s complement negative number corresponding positive value shown following expression complement compute direct inversion bitwise add bitstring bitinvert bitstring bitinvert bitstring bitstring negating number computing s complement give binary representation bitinvert bitstring return negated bitstring return exception given number bit let s say bit figure compute negative number computing s complement ﬂipping bit adding negative number bit representation negative number inverting adding result encode bit signed convention carry eaten sign bit subtracting subtract number just add ond number s s complement ﬁrst want compute compute s complement add add correct let test pharo exploring little number bitstring bitstring negated bitstring case result negative number handled example want compute let encoded s complement carry smallintegers pharo pharo small integer use s complement arithmetic bit numeral represent integer range bit pharo system small integer value range remember pharo integer special object marking requires bit bit bit small signed integer course automatic coercion really concern end programmer language implementation perspective let s check encoding bit occasion say smallinteger maximum value encoding pharo s small integer coded bit internal representation requires bit smallest small integer negative integer smallinteger maxval negated exception negative integer negate maximum number encoded small integer smallinteger maxval negated obtain small integer smallinteger maxval negated class smallinteger adding maximum number encoded small integer get large positive integer smallintegers pharo smallinteger maxval class largepositiveinteger smallest negative negated largest positive small integer smallinteger maxval negated smallinteger maxval negated class smallinteger understanding method want know number bit used represent smallinteger just evaluate smallinteger maxval highbit return smallinteger maxval highbit tell highest bit used sent positive smallinteger account sign bit integer positive negative let explore bit raisedto class smallinteger raisedto class largepositiveinteger class smallinteger class smallinteger class maxval return raisedto raisedto raisedto smallinteger exploring little number true hexadecimal ﬁnish chapter talking hexadecimal pharo us syntax hexadecimal binary indicates fis encoded base hexadecimal equivalent number using message hex using message printstringhex number printed mal radix notation hex printstringhex f printit following snippet list equivalence number hexadecimal representation doing bit manipulation shorter use hexadecimal notation binary bitand binary notation readable printstringbase bitand bitand chapter summary pharo us s complement encoding internal small integer tation support bit manipulation internal representation thischapter summary useful want speed algorithm using simple encoding reviewed following point numerical value use complement encode negative value shifting bit left multiple equivalent multiply ulo maximum value encoding size opposite shifting bit right divide bit operation performed numerical value complement useful turn addition subtraction plifying operation smallinteger coded bit pharo note pharo support large number limit size mainly memory fun float participation nicolas cellier float inexact nature confuse programmer chapter introduces problem present practical solution basic message float inexact fast number note situation described chapter quences float structured hardware tied pharo problem programming language test equality ﬂoats ﬁrst basic principle compare ﬂoat equality let s simple case addition ﬂoats equal ﬂoat representing sum example equal false hey unexpected did learn school did behavior surprising s normal ﬂoats inexact bers important understand way ﬂoats printed inﬂuencing understanding approach print simpler sentation reality early version pharo printing printing print change guided idea better lie user showing inexactness ﬂoat better hiding day deeply bitten fun float printstring printstring presence different number looking hexadecimal value hex hex method storestring conveys presence ent number storestring storestring closeto way know ﬂoats probably close look like number use message closeto closeto true closeto true method closeto verify compared number difference source code closeto num number close num isnumber iffalse self num iferror false self iftrue ab num iftrue ab num asfloat self ab self ab max num ab scaled decimal solution absolutely need exact ﬂoating point number scaled decimal exact number exhibit behavior float true execute following line expression equal asscaleddecimal asscaleddecimal asscaleddecimal false different execute example fraction created scratch asfraction return message asscaleddecimal different behavior asscaleddecimal represents exactly number ﬂoat asscaleddecimal asfraction turn value asfraction return false course expect scaled decimal expression return false dissecting float understand operation involved addition know ﬂoats internally represented computer pharo s float format wide spread standard computer ieee ble precision bit http detail format float represented base formula sign represented bit exponent represented bit mantissa fractional number base leading fore decimal point binary digit fraction point pharo method obtain mantissa float signiﬁcand vide example following chapter example series bit mean mantissa represents following fraction mantissa value included excluded normal fun float detectsum raisedto reciprocal asfloat building float let construct mantissa detectsum raisedto reciprocal asfloat let multiply non null exponent detectsum raisedto reciprocal asfloat raisedto using method timestwopower detectsum raisedto reciprocal asfloat timestwopower pharo retrieve information sign signiﬁcand exponent pharo message directly handle normalized mantissa instead possible handle mantissa integer bit shift left good reason operating integer easier arithmetic exact result includes leading bit long normal number s ﬂoat precision signiﬁcandasinteger signiﬁcandasinteger printstringbase size signiﬁcandasinteger highbit float float precision retrieve exact fraction corresponding internal resentation float astruefraction detectsum raisedto reciprocal raisedto ve retrieved exact input ve injected float float operation exact hem played fraction having power denominator bit numerator condition met won t ﬁnd exact float representation number example possible represent ﬁnite number binary digit consequently decimal fraction like represented exactly representation asfloat false false let fractional bit lay division fun float cycle euclidean division quotient remainder mean need inﬁnite series bit pattern represent base let pharo dealt convert float asfloat signiﬁcandasinteger printstringbase asfloat exponent s bit pattern expected bit rounded upper default rounding mode float round nearest understand represented inexactly chine s mantissa exponent signiﬁcand signiﬁcand exponent exponent entered didn t exactly stead got astruefraction astruefraction s story let inspect bit pattern tion check span bit pattern position highest bit set leftmost position lowest bit set rightmost printstringbase highbit lowbit printstringbase ﬂoats printing inexact denominator power expect need bit precision store numerator float provides rounding error ﬁt float representation astruefraction astruefraction asfloat astruefraction astruefraction false astruefraction astruefraction asfloat signiﬁcandasinteger summarize happened including conversion decimal sentation float representation asfloat inexact rounded upper asfloat inexact rounded upper asfloat inexact rounded upper inexact operation occurred bad luck rounding operation upper did cumulate annihilate interpreting causing single rounding error asfloat understand expect exercise ﬂoats printing inexact biggest trap learned example despite fact printed exact s absprintexactlyon base used internally printstring bit confusing doe print exactly print shortest decimal representation rounded float read pharo convert decimal representation nearest float message exists print exactly need use printshowingdecimalplaces instead ﬁnite float represented internally fraction denominator power ﬁnite float decimal representation ﬁnite number decimal digit just multiply numerator denominator adequate power ll digit astruefraction denominator highbit mean fraction denominator need decimal digit decimal point really print internal representation fun float printshowingdecimalplaces retrieve digit astruefraction numerator raisedto just check result raisedto astruefraction true printing exact representation implemented machine possible cumbersome try printing convinced float rounding inexact ﬂoat equality known evil pay attention aspect ﬂoats let illustrate point following example truncateto roundto surprising false truncateto doe return truncateto roundto perform operation ﬂoats inexact operation inexact number lead mulative rounding error saw s just happens perform operation exactly round nearest float result inexact initial inexact representation astruefraction roundto astruefraction asfloat using let example appear work truncateto inexact representation roundto s just case luck fact inexact cause surprise illustrated truncateto true truncating float world absolutely unsafe using scaleddecimal rounding unlikely cause discrepancy playing digit fun inexact representation add nail cofﬁn let s play bit inexact representation let try difference different number astruefraction roundto astruefraction predecessor ab astruefraction roundto astruefraction ab astruefraction roundto astruefraction successor ab detectmin e e key following expression return mean astruefraction roundto astruefraction asfloat successor remember astruefraction roundto astruefraction successor interpreted nearest float astruefraction roundto astruefraction successor want know far idea astruefraction roundto astruefraction successor astruefraction asfloat fun float chapter summary float approximation real number able support wide range decimal value chapter reviewed following point use compare ﬂoats return false use closeto instead closeto return true ﬂoat number represented base sign xmantissa roundto work truncating ing ﬂoat roundto return thing know ﬂoats vanced good idea check link wikipedia page computer scientist know arithmetic http v toolschapter proﬁling application beginning software engineering programmer faced issue related application performance great improvement programming environment support better faster development process addressing performance issue programming requires quite dexterity principle optimizing application particularly difﬁcult general idea make slow frequently called method faster frequently called note optimizing application usually iﬁes application recommended optimize application requirement understood addressed term optimize application sure supposed kent beck famously formulated make work make right make fast doe proﬁling mean proﬁling application term commonly employed refers ing dynamic information controlled program execution obtained information intended provide important hint improve program execution hint usually numerical measurement easily comparable program execution chapter consider measurement related method tion time memory consumption note kind information extracted program execution particular method graph interesting observe program execution usually follows proﬁling application universal rule total method let s say consume largest available resource memory cpu consumption optimizing application essentially matter tradeoff chapter use available tool quickly identify method measure progress coming program enhancement bring experience show having unit test essential ensure break program semantics optimizing replacing algorithm ought make sure program supposed simple example consider method collection select thencollect given collection method selects element using predicate applies block function selected element ﬁrst sight behavior implies run collection provided user select thencollect intermediate contains selected element mediate collection indispensable selection function application performed run method timetorun program execution usually fully identify understand optimized ing different proﬁled execution deﬁnitely fruitful message timetorun sent bloc obtain time millisecond took evaluate block meaningful representative measurement need amplify proﬁling loop result coll coll asorderedcollection timesrepeat coll select collect timetorun calling select collect m coll coll asorderedcollection timesrepeat coll select thencollect timetorun calling select thencollect m difference execution millisecond opting method instead signiﬁcantly slow application code proﬁling pharo let s scrutinize deﬁnition select thencollect naive optimized implementation collection remember collection root class pharo collection library efﬁcient tion deﬁned orderedcollection take account structure ordered collection efﬁciently perform operation collection select selectblock thencollect collectblock utility method improve readability self select selectblock collect collectblock orderedcollection select selectblock thencollect collectblock utility method improve readability create intermediate newcollection newcollection self copyempty ﬁrstindex lastindex index element element array index selectblock value element iftrue newcollection addlast collectblock value element newcollection probably guessed collection setand dictionary beneﬁt optimized version leave cise efﬁcient implementation abstract data type community effort forget submit contribution pharo come optimized better version select thencollect method pharo team really value effort method bench sent block bench message estimate time block evaluated second example expression factorial bench say factorial executed approximately time second code proﬁling pharo timetorun method useful tell long expression take executed really adequate understand execution time distributed computation triggered evaluating expression pharo come messagetally code proﬁler precisely analyze time distribution proﬁling application figure messagetally action messagetally messagetally implemented unique class having ing quite simple message spyon need sent messagetally block expression argument obtained detailed execution si evaluating messagetally spyon expression open window contains following information hierarchy list showing method executed associated execution time expression execution leaf method execution leaf method method doe invoke method primitive accessors statistic memory consumption garbage collector ment point described later proﬁling pharo figure timeproﬁler us messagetally navigates executed od figure show result expression messagetally spyon timesrepeat transcript factorial printstring message spyon cutis provided block new process analysis focus cess executes block proﬁle message spyallon proﬁles process active execution useful analyze distribution computation process tool bit crude messagetally istimeproﬁlebrowser show implementation executed method addition figure timeproﬁlebrowser understand message spyon mean low source code messagetally replaced timeproﬁlebrowser obtain better user interface integration programming environment shown previously proﬁler directly invoked sending spyon spyallon messagetally class accessed number additional way world menu world menu obtained clicking outside pharo window offer proﬁling facility proﬁling application figure start proﬁling process creates block text selection invokes spyallon entry start proﬁling ui proﬁles user interface process quite handy debugging user interface figure access menu test runner size application grows unit test usually good candidate code proﬁling running test tedious time run getting long test runner pharo offer button run proﬁled figure pressing button run selected unit test generates message tally report read interpret result message tally proﬁler essentially provides kind information execution time represented using tree representing proﬁled code execution tree node tree annotated time spent leaf method leaf memory activity contains memory consumption memory garbage collector usage gc illustration purpose let consider following scenario string character cumulatively appended time initial interpret result figure button generate message tally testrunner messagetally spyon timesrepeat str str timesrepeat str str complete result tally msec tree process nil primitive bytestring sequenceablecollection copyreplacefrom primitive bytestring class string class new leaf bytestring sequenceablecollection smallinteger integer timesrepeat bytestring sequenceablecollection copyreplacefrom bytestring class string class new undeﬁnedobject proﬁling application memory old byte young byte used byte free byte gc totalling uptime incr totalling uptime avg tenure root table overﬂows ﬁrst line give overall execution time number plings called tally come sampling end chapter tree cumulative information tree section represents execution tree process tree tell time pharo interpreter spent method tell different invocation using graph different execution ﬂows kept separated according process executed process priority displayed help distinguishing different process example tell tree process nil primitive bytestring sequenceablecollection copyreplacefrom primitive bytestring class string class new tree show interpreter spent time ing primitive total execution time spent method sequenceablecollection copyreplacefrom method called concatenating character string using message comma indirectly invoking new virtual machine primitive execution take execution time mean terpreter effort shared process invocation chain code primitive relatively short reaching hundred nested call exception application optimize example later interpret result primitive listed tree leaf correspond different primitive unfortunately messagetally doe tell exactly tive invoked leaf leaf method leaf list leaf method code block proﬁled leaf method method doe method exactly method mfor method invoked mhave detected case variable accessors point x primitive method method quickly executed previous example leaf bytestring sequenceablecollection smallinteger integer timesrepeat bytestring sequenceablecollection copyreplacefrom bytestring class string class new undeﬁnedobject doit memory statistical memory consumption tell observed change quantity memory allocated garbage collector usage fully understand information need mind pharo s garbage collector gc scavenging gc relying principle old object greater change live longer designed following fact old object probably kept referenced future contrary young object greater change quickly dereferenced memory zone considered migration young ject space dedicated old object qualiﬁed tenured following metaphor american academic scientist permanent position obtained example memory analyze realized messagetally memory old byte young byte used byte free byte messagetally describes memory usage using value oldvalue grow memory space dedicated old object object qualiﬁed old physical memory tion old memory space happens proﬁling application collector triggered object survivor cording threshold speciﬁed virtual machine ory space cleaned garbage collection incremental gc doe reduce size increase old memory space likely memory leak virtual machine unable release memory promoting young jects old young value tell increase memory space dedicated young object object created physically located memory space size memory space change frequently used value total used memory freevalue remaining memory available example object created execution promoted old byte used current process located young memory space available memory reduced accordingly gc gc provides statistic garbage collector example garbage collector report gc totalling uptime incr totalling uptime avg tenure avg root table overﬂows value available fullvalue total garbage collection time took garbage collection frequent result allocating large memory chunk incris incremental garbage collection incremental gc usually frequent time second quickly performed m wise time spent mental gc number tenure tell object migrated old memory space migration happens size young memory space given threshold typically happensillustrative analysis launching application necessary object haven t created referenced root table overﬂows root object used garbage collector navigate image navigation happens tem running short memory need collect object evant future program execution overﬂow value identiﬁes rare situation number root used incremental gc greater internal table situation force gc promote object tenured example incremental gc used subsequently created object quite relevant want optimize performance illustrative analysis understanding result obtained proﬁling ﬁrst step want optimize application probably started feel understanding computation costly trivial based number example comparing different proﬁling result greatly help identify costly message call method known slow creates new character string copy receiver argument using stream niﬁcant faster approach concatenate character string nextput nextputall carefully employed using stream string concatenation ﬁrst glance think creating stream costly frequently used relatively slow input output network socket disk access transcript replacing string concatenation employed previous example stream operation time faster easily understandable concatenating time character string creates ately object ﬁlled content using stream simply append character iteration messagetally spyon timesrepeat str str writestream string new timesrepeat str nextput proﬁling application tally msec tree process nil leaf smallinteger integer timesrepeat undeﬁnedobject doit memory old byte young byte used byte free byte gc totalling uptime incr totalling uptime avg tenure root table overﬂows string preallocation using orderedcollection preallocation collection known costly time collection content copied larger collection carefully choosing preallocation impact using ordered collection message new anumber used instead new messagetally spyon timesrepeat str str writestream string new timesrepeat str nextput example possible improve script using method atallput script take couple millisecond messagetally spyon timesrepeat str str new str atallput experiment doing benchmark shine different execution compared previous piece code replacing value iscounting message valuable time taken iteration time slower using string concatenation using method instead stream widens gap factor experiment clearly illustrates importance using appropriate tool concatenate string time proﬁled execution important quality factor result messagetally employ sampling technique proﬁle code default messagetally sample current executing thread millisecond default necessary method involved computation executed fair time appear result report application proﬁle short millisecond executing number time help improving accuracy report counting message proﬁling realized far focused method execution time advantage method stack sampling relatively low impact execution disadvantage relatively imprecision result obtained result sufﬁcient case approximation real execution messagetally allows proﬁling based program interpretation idea use bytecode interpreter instead execution sampler main advantage exactness result information obtained message tallysends indicates time method involved computation executed figure give result obtained executing messagetally tallysends timesrepeat printstring downside tallysend time taken execute provided block block proﬁle executed interpreter written pharo slower virtual machine piece code proﬁled tallysends time slower interpreter available method contextpart runsimulated ablock contextateachstep memorized fibonacci small application technique seen consider fibonacci function fib n fib fib study version recursive version memorized version memoizing consists introducing cache avoid redundant computation consider following deﬁnition close mathematical proﬁling application figure executed message execution integer ﬁbslow self assert self self iftrue self self ﬁbslow self ﬁbslow method ﬁbslow relatively inefﬁcient recursion implies plication computation result computed twice branch recursion efﬁcient slightly complicated version obtained using cache keep intermediary computed value advantage duplicate computation value computed classical way optimizing program called memoizing integer ﬁbspacetally memory consumption class self ﬁbwithcache array new self integer ﬁblookup cache re re cache self re ifnil cache self self ﬁbwithcache cache integer ﬁbwithcache cache self iftrue self self ﬁblookup cache self ﬁblookup cache exercise proﬁle ﬁbslow ﬁb convinced gain memoizing spacetally memory consumption class important know instance memory sumption given class class spacetally offer functionality expression spacetally new printspaceanalysis run class gather code size stance total memory space taken instance result sorted total memory space taken instance stored ﬁle named located pharo image surprising string compiled method bitmap represents largest pharo memory proportion piled code string bitmap platform diverse application spacetally s output structured follows class code space instance inst space percent inst average size bytestring bitmap compiledmethod array bytesymbol line represents memory analysis pharo class class ordered space occupy class bytestring describes string frequent string consume memory code space give byte used class metaclass doe include space used class variable value given method behavior spaceused proﬁling application instance column give instance result behavior instancecount inst space column byte sumed instance including object header result behavior instancessizeinmemory percentage memory occupation given column percent column give average size instance running spacetally class take minute spacetally executed reduced set class increase analysis time sider spacetally new spacetally array textmorph point assortedcollection b spaceforinstances b spaceforinstances method spacetally spacetally analyzes memory consumed class argument return list instance spacetallyitem advice seen number strategy measure optimize program example used relatively small optimizing program easy task identifying method candidate inserting cache simple efﬁcient know invalidate cache ii aware impact overall execution inserting code general valuable understand overall algorithm trying optimize leaf method way data structured vide opportunity optimization example using ordering tion linked list appropriated represent acyclic graph ing set offer better performance dictionary case hash value reasonably distributed memory consumption play important role overall performance signiﬁcantly decrease garbage collector licited recycling object avoiding unnecessary object creation help reducing solicitation garbage collector messagetally implemented messagetally gorgeous example use pharo s reﬂecting bilities method spyevery millisecs ablock contains proﬁling logic method indirectly called spyon millisecs value millisecond sample set default block proﬁled ablock summary essence proﬁling activity given following code cerpt observedprocess processor activeprocess timer true whiletrue starttime starttime time millisecondclockvalue mydelay wait self tally processor preemptedprocess suspendedcontext observedprocess processor preemptedprocess iftrue observedprocess iffalse nil time millisecondclockvalue millisecs nil newprocess timer priority processor timingpriority timer new process set high priority charge monitoring ablock process scheduler favorably active timingpriority process priority process creates inﬁnite loop wait necessary millisecond mydelay snapshooting method stack process observe observedprocess process message spyevery millisecs ablock sent idea proﬁling associate method context counter association realized instance class messagetally class deﬁnes variable class method process regular interval mydelay counter stack frame cremented elapsed millisecond stack frame obtained sending suspendedcontext process just empted method tally context aprocess count increment stack frame millisecond given count memory statistic given differentiating sumed memory proﬁling smalltalk instance class smalltalkimage contains accessing method query available memory chapter summary chapter basic proﬁling pharo presented functionality messagetally introduced number principle sorbing performance bottleneck method timetorun bench offer simple benchmarking proﬁling application sent block messagetally code proﬁler evaluating messagetally spyon expression executes provided block display report accuracy gained increasing execution time proﬁled block pharo programming environment give convenient way proﬁle counting message slow accurate proﬁling technique memoization common efﬁcient code pattern speed cution spacetally report memory petitparser building modular parser participation jan kurs kurs guillaume larcheveque lukas renggli renggli building parser analyze transform data common task ware development chapter present powerful parser framework called petitparser petitparser combine idea various parsing technology model grammar parser object ured dynamically petitparser written lukas renggli work helvetia used standalone library writing parser petitparser petitparser parsing framework different popular parser generator petitparser make easy deﬁne parser smalltalk code dynamically reuse compose transform extend grammar reﬂect resulting grammar modify petitparser ﬁts better dynamic nature smalltalk furthermore petitparser based table smacc antlr instead us combination alternative parser gy scannerless parser parser combinators parsing expression grammar packrat parser petitparser powerful petitparser building modular parser parse let s quick look parser methodology scannerless parser combine usually independent tool scanner parser make writing grammar simpler avoids common problem grammar posed parser combinators building block parser modeled graph composable object modular maintainable changed recomposed transformed reﬂected parsing expression grammar peg provide notion ordered choice unlike parser combinators ordered choice peg way follows ﬁrst matching alternative ignores tives valid input result exactly result parse ambiguous packrat parser linear guarantee avoid common lem peg loading petitparser talking let s started petitparser developed pharo version java dart available ready image load petitparser existing image evaluate lowing gofer expression script installing petitparser gofer new smalltalkhubuser project package load smalltalk conﬁgurationofpetitparser perform loaddefault information petitparser chapter petit parser moose writing simple grammar writing grammar petitparser simple writing smalltalk code example deﬁne grammar parses identiﬁers starting letter followed zero letter digit deﬁned used follows parser petitparser identiﬁer letter word figure syntax diagram representation identiﬁer parser deﬁned script script creating ﬁrst parser parse identiﬁers identiﬁer letter asparser word asparser star identiﬁer parse j l k j graphical notation figure present syntax diagram identiﬁer parser box resents parser arrow box represent ﬂow input consumed rounded box elementary parser terminal squared box shown ﬁgure parser composed parser non terminal inspect object identiﬁer previous script ll notice instance ppsequenceparser dive object notice following tree different parser object script composition parser used identiﬁer parser ppsequenceparser accepts sequence parser pppredicateobjectparser accepts single letter pppossessiverepeatingparser accepts zero instance parser pppredicateobjectparser accepts single word character root parser sequence parser comma operator ate sequence letter parser zero word character parser root parser ﬁrst child predicate object parser created letter asparser expression parser capable parsing single letter deﬁned character isletter method second child repeating parser created starcall parser us child parser icate object parser possible input greedy parser child parser predicate object parser created word asparser pression parser capable parsing single digit letter deﬁned character isdigit character isletter petitparser building modular parser parsing input actually parse string stream use method ppparser parse follows script parsing input string identiﬁer parser identiﬁer parse y e h identiﬁer parse f odd nested array character return value default decomposition input parse tree ll customized try parse invalid instance ppfailure answer script parsing invalid input result failure identiﬁer parse letter expected parsing result failure ﬁrst character letter instance ppfailure object answer true send message ispetitfailure alternatively use ppparser parse onerror throw exception case error identiﬁer parse onerror msg po self error msg interested given string stream match use following construct script checking input identiﬁers identiﬁer match true identiﬁer match false identiﬁer match true result surprising parenthesis digit letter speciﬁed word asparser expression fact identiﬁer parser match foo ppparser match return true result similar use parse return f o o want sure complete input matched use sage ppparser end follows script ensuring input matched using ppparser end identiﬁer end match falsewriting parser petitparser ppparser end message creates new parser match end input able compose parser easily important parser match end input default interested ﬁnd place parser match using message ppparser matchesskipin ppparser matchesin script finding match input identiﬁer matchesskipin orderedcollection f o o b r identiﬁer matchesin orderedcollection f o o o o o b r r r ppparser matchesskipin method return collection array ing matched function avoids parsing character twice method ppparser matchesin doe similar job return tion possible element evaluating identiﬁer matchesin return collection element similarly ﬁnd matching range index ﬁrst character index character given input use ppparser matchingskiprangesin orppparser matchingrangesin shown script low script finding matched range input identiﬁer matchingskiprangesin orderedcollection identiﬁer matchingrangesin orderedcollection different kind parser petitparser provide large set parser compose consume transform arbitrarily complex language terminal parser simple one ve seen deﬁned protocol table class pppredicateobjectparser provides lot factory method used build complex terminal parser use send message ppparser asparser symbol containing factory method punctuation asparser set parser used combine parser deﬁned protocol table petitparser building modular parser terminal parser description asparser parses character abc asparser parses string abc asparser parses character digit asparser parses digit letter asparser parses letter z z word asparser parses digit letter blank asparser parses space tabulation newline asparser parses carriage return line feed character space asparser parses white space character including new line tab asparser parses tab character lowercase asparser parses lowercase character uppercase asparser parses uppercase character nil asparser parses table petitparser multitude terminal parser parser combinators description parses followed sequence parses doesn t work parses p star parses zero p plus parses p optional parses p possible p parses p doe consume input p negate parses p succeeds p fails p parses p succeeds p fails doe consume input p end parses p succeeds end input p time n parses p exactly n time p min n max m parses p n time m time p starlazy q like star stop consumming q ceeds table petitparser multitude parser combinators simple example parser combination following deﬁnition parser equivalent previous deﬁnition identiﬁer script different way express identiﬁer parser letter asparser letter asparser digit asparser parser petitparser letter letter digit figure syntax diagram representation parser deﬁned script parser action deﬁne action transformation parser use sage ppparser ppparser ﬂatten ppparser token ppparser trim deﬁned protocol table action parser description p ﬂatten creates string result p token similar ﬂatten return pptoken detail p trim trim white space p trim trimparser trim trimparser parse comment p ablock performs transformation given ablock table petitparser multitude action parser return string parsed identiﬁer instead getting array matched element conﬁgure parser sending message ppparser ﬂatten script using ﬂatten parsing result string identiﬁer letter asparser letter asparser digit asparser star identiﬁer parse j k identiﬁer ﬂatten parse message ppparser token similar ﬂatten return pptoken provide contextual information like collection ken located position collection sending message ppparser trim conﬁgures parser ignore white space beginning end parsed result following using ﬁrst parser input lead error parser doe accept space second parser space ignored removed petitparser building modular parser number digit figure syntax diagram representation number parser deﬁned script script using ppparser trim ignore space identiﬁer letter asparser word asparser star ﬂatten identiﬁer parse ajka letter expected identiﬁer trim parse ajka sending message trimis equivalent calling ppparser trim space asparser parameter mean trim useful ignore data input source code comment example script using ppparser trim ignore comment identiﬁer comment ignorable line identiﬁer letter asparser word asparser star ﬂatten comment asparser newline asparser negate star ignorable comment space asparser line identiﬁer trim ignorable line parse comment oneidentiﬁer comment message ppparser let specify block executed parser match input section present example simple way number string representation script parsing integer number digit asparser plus ﬂatten str str asnumber number parse table show basic element build parser documented tested factory method operator tocols ppparser want know factory method browse protocol interesting separatedby answer new parser parses input time separation ﬁed parser writing complicated grammar write complicated grammar evaluating simple arithmetic expression grammar number actually integer deﬁnedwriting parser petitparser step deﬁne production addition cation order precedence note instantiate production ppdelegateparser upfront recursively refer method setparser resolve recursion following script deﬁnes parser addition multiplication parenthesis figure related syntax diagram script parsing arithmetic expression term ppdelegateparser new prod ppdelegateparser new prim ppdelegateparser new term setparser prod asparser trim term node node ﬁrst node prod prod setparser prim asparser trim prod node node ﬁrst node prim prim setparser asparser trim term asparser trim node node second number term parser deﬁned prod followed lowed term prod case action block asks parser compute arithmetic addition value ﬁrst node prod node term prod parser similar term parser prim parser interesting accepts left right thesis term action block simply ignores understand precedence production figure root tree ﬁgure term production tried ﬁrst term prod term production come ﬁrst lowest priority mathematics make sure parser consumes input wrap end parser start production start term end s test parser script trying arithmetic expression evaluator start parse start parse petitparser building modular parser term prod prod prod prim prim prim term number figure syntax diagram representation term prod prim parser deﬁned script term prod prim parens number figure explains understand precedence production expression term sum production necessary recognize sum ﬁrst lowest priority production multiplication primitive primitive parenthesised expression number composite grammar petitparser previous section saw basic principle petitparser gave introductory example section going present way deﬁne complicated grammar continue left arithmetic expression grammar writing parser script did previously cumbersome especially grammar production mutually recursive refer complicated way furthermore grammar speciﬁed grammar petitparser gle script make unnecessary hard reuse speciﬁc part grammar luckily ppcompositeparser rescue deﬁning grammar example let s create composite parser using expression grammar built section time deﬁne inside class subclass ppcompositeparser script creating class hold arithmetic expression grammar ppcompositeparser subclass expressiongrammar instancevariablenames classvariablenames pooldictionaries category start grammar integer number deﬁne method number follows script implementing ﬁrst parser method expressiongrammar number digit asparser plus ﬂatten trim str str asnumber production expressiongrammar speciﬁed method turn parser similarly deﬁne production term prod mul prim production refer reading respective instance variable petitparser take care initializing instance variable automatically let pharo automatically add sary instance variable refer ﬁrst time obtain following class deﬁnition script creating class hold arithmetic expression grammar ppcompositeparser subclass expressiongrammar instancevariablenames prod term mul prim parens number classvariablenames pooldictionaries category script deﬁning expression grammar parser time ated action expressiongrammar term add prod expressiongrammar add prod asparser trim petitparser building modular parser expressiongrammar prod mul prim expressiongrammar mul prim asparser trim prod expressiongrammar prim parens number expressiongrammar parens asparser trim term asparser trim contrary previous implementation deﬁne tion action previously did using ppparser factor part addition add multiplication mul parenthesis parens separate production better reusability later example subclass override method produce slightly different production output usually production method categorized protocol named grammar reﬁned speciﬁc protocol name necessary grammar deﬁne starting point expression grammar overriding ppcompositeparser start expressiongrammar class script deﬁning starting point expression grammar parser expressiongrammar start term end instantiating expressiongrammar give expression parser turn default tree script testing parser simple arithmetic expression parser expressiongrammar new parser parse parser parse writing dependent grammar easily reuse parser deﬁned grammar example ine want create new grammar reuses deﬁnition number theexpressiongrammar just deﬁned declare dependency expressiongrammar composite grammar petitparser script reusing number parser expressiongrammar grammar ppcompositeparser subclass mynewgrammar instancevariablenames classvariablenames pooldictionaries category mynewgrammar class dependency answer collection ppcompositeparser class parser directly dependends expressiongrammar mynewgrammar number answer parser expressiongrammar number self dependencyat expressiongrammar number deﬁning evaluator deﬁned grammar reuse deﬁnition ment evaluator create subclass ofexpressiongrammar called expressionevaluator script separating grammar evaluator creating subclass expressiongrammar subclass expressionevaluator instancevariablenames classvariablenames pooldictionaries category redeﬁne implementation add muland parens uation semantics accomplished calling super implementation adapting returned parser shown following method script reﬁning deﬁnition parser evaluate arithmetic sion expressionevaluator add super add node node ﬁrst node expressionevaluator mul super mul node node ﬁrst node expressionevaluator parens super parens node node second evaluator ready petitparser building modular parser script testing evaluator simple arithmetic expression parser expressionevaluator new parser parse parser parse deﬁning reuse grammar example deﬁne simple pretty printer easy subclassing expressiongrammar script separating grammar pretty printer creating subclass expressiongrammar subclass expressionprinter instancevariablenames classvariablenames pooldictionaries category expressionprinter add super add node node ﬁrst node expressionprinter mul super mul node node ﬁrst node expressionprinter number super number num num printstring expressionprinter parens super parens node node second pretty printer tried shown following sion script testing pretty printer simple arithmetic expression parser expressionprinter new parser parse parser parse easy expression ppexpressionparser petitparser proposes powerful tool create expression ppexpressionparser parser conveniently deﬁne expression grammar preﬁx ﬁx inﬁx operator deﬁned descending grammar script expressiongrammar previously deﬁned implemented line expression parens number expression ppexpressionparser new parens asparser token trim expression asparser token trim node node second number digit asparser plus ﬂatten trim str str asnumber expression term parens number expression group g g left asparser token trim op b b g left asparser token trim op b b group g g left asparser token trim op b b g left token trim op b script parser able manage subtraction division expression parse decide create subclass ppcompositeparser instantiate ppexpressionparser hand instantiate ppexpressionparser want small parser small task hand grammar s composed parser subclass ppcompositeparser testing grammar petitparser contains framework dedicated testing grammar testing grammar subclassing ppcompositeparsertest follows script creating class hold test arithmetic expression mar ppcompositeparsertest subclass expressiongrammartest instancevariablenames classvariablenames pooldictionaries category important test case class reference parser class overriding ppcompositeparsertest parserclass method expressiongrammartest petitparser building modular parser script linking test case class parser expressiongrammartest parserclass expressiongrammar writing test scenario implementing new method expressiongrammartest script implementing test arithmetic expression grammar expressiongrammartest testnumber self parse rule number expressiongrammartest testadd self parse rule add test ensure expressiongrammar parser parse pressions using speciﬁed production rule testing evaluator pretty printer similarly easy script testing evaluator pretty printer expressiongrammartest subclass expressionevaluatortest instancevariablenames classvariablenames pooldictionaries category expressionevaluatortest parserclass expressionevaluator expressionevaluatortest testadd super testadd self assert result equal expressionevaluatortest testnumber super testnumber self assert result equal expressiongrammartest subclass expressionprintertest instancevariablenames classvariablenames pooldictionaries category expressionprintertest parserclass expressionprinter expressionprintertest testadd super study json parser self assert result equal expressionprintertest testnumber super testnumber self assert result equal case study json parser section illustrate petitparser development json parser json lightweight format deﬁned http going use speciﬁcation website deﬁne json parser json simple format based nested pair array following script give example taken wikipedia http script example json ﬁrstname john lastname smith age address streetaddress street city new y ork state ny postalcode phonenumber type home number type fax number json consists object deﬁnitions curly brace array square bracket object deﬁnition set pair array list value previous json example represents object person pair person s ﬁrst age address person sented object phone number represented array object deﬁne grammar subclass ppcompositeparser let ppjsongrammar script deﬁning json grammar class ppcompositeparser subclass ppjsongrammar instancevariablenames petitparser building modular parser object member member pair pair string token value figure syntax diagram representation json object parser ﬁned script classvariablenames pooldictionaries category deﬁne charactertable class variable later use parse string parsing object array syntax diagram json object array figure ure petitparser deﬁned json object following code script deﬁning json parser object represented figure ppjsongrammar object asparser token trim member optional asparser token trim ppjsongrammar member pair separatedby asparser token trim ppjsongrammar pair stringtoken asparser token trim value new thing ppparser separatedby nience method answer new parser parses receiver value time separated parameter parser comma array simpler parse depicted script script deﬁning json parser array represented figure ppjsongrammar array asparser token trim case study json parser array element element value figure syntax diagram representation json array parser ﬁned script element optional asparser token trim ppjsongrammar element value separatedby asparser token trim parsing value json value string number object array boolean trueorfalse null value parser deﬁned represented figure script deﬁning json parser value represented figure ppjsongrammar value stringtoken numbertoken object array truetoken falsetoken nulltoken string requires quite work parse string start end inside sequence ters character escape character octal character normal character escape character composed backslash ately followed special character new line string octal character composed backslash immediately followed letter u immediately followed hexadecimal digit finally normal character character double quote used end string backslash used introduce escape character script deﬁning json parser string represented figure ppjsongrammar stringtoken string token trim ppjsongrammar string asparser char star asparser ppjsongrammar petitparser building modular parser value string token number object array true false null figure syntax diagram representation json value parser ﬁned script charescape charoctal charnormal ppjsongrammar charescape asparser pppredicateobjectparser anyof string withall charactertable key ppjsongrammar charoctal asparser hex asparser min max ppjsongrammar charnormal pppredicateobjectparser anyexceptanyof special character allowed slash meaning ﬁned charactertable dictionary initialize initialize class method note initialize method class called class loaded just created initialize method class loaded method execute shoud evaluate ppjsongrammar initialize workspace script deﬁning json special character meaning ppjsongrammar class initialize charactertable dictionary new charactertable b character backspace f character newpage n character lf case study json parser string char charescape char charoctal charnormal charescape quotation mark backslash slash b backspace f formfeed n newline r carr return t tabulation charoctal hex digit charnormal character figure syntax diagram representation json string parser ﬁned script r character cr t character tab parsing number slightly simpler number positive negative integral decimal additionally decimal number expressed ﬂoating number syntax script deﬁning json parser number represented figure ppjsongrammar petitparser building modular parser number digit digit digit e e digit figure syntax diagram representation json number parser deﬁned script number token trim ppjsongrammar number optional asparser digit asparser plus asparser digit asparser plus optional e asparser e asparser asparser optional digit asparser plus optional attentive reader noticed small difference tax diagram figure code script number json contain leading zero string represent valid number syntax diagram make particularly explicit allowing digit code rule implicit relying fact parser combinator ordered parser right tried parser left fails asparser digit asparser plus deﬁnes number just sequence digit starting parser fairly trivial script deﬁning missing json parser ppjsongrammar falsetoken asparser token trim ppjsongrammar nulltoken asparser token trim ppjsongrammar truetoken asparser token trim piece missing start parser script deﬁning json start parser value figure following ppjsongrammar start value endpetitparser browser figure petitparser browser window petitparser browser petitparser shipped powerful browser help develop plex parser petitparser browser provides graphical visualization bugging support refactoring support feature discussed later chapter feature useful developing parser pay attention glamour loaded load glamour open petitparser simply evaluate expression script opening petitparser browser ppbrowser open petitparser browser overview figure ppbrowser window left panel named parser contains list parser expressiongrammar subclass ppjsongrammar deﬁned earlier chapter selecting parser pane vates browser rule selected parser prim tab related rule source show source code rule code updated saved window add new rule simply deﬁning new method petitparser building modular parser graph show graphical representation rule updated rule source changed prim visual representation figure figure graph visualization prim rule example show automatically generated example based tion rule figure example prim rule corner reload button generates new example rule figure automatically generated ple prim rule time parenthesized expression figure automatically generated example prim rule case prim example number figure automatically generated example prim rule having clicked reload button case prim example sized expression show set terminal parser activated directly rule started figure ﬁrst set prim digit opening parenthesis mean start parsing prim input continue digit use ﬁrst set grammar speciﬁed rectly example ﬁrst set prim thing wrong deﬁnitions prim rule ment start binary browser terminal parser parser doe delegate parser don t parens inprim ﬁrst set parens delegate parser trimming sequence parser script ﬁrst set parens state number rule creates action parser delegating trimming parser gating ﬂattening parser delegating repeating parser delegating digit parser script digit parser terminal parser digit expected ﬁrst set general tation ﬁrst set complex ppbrowser computes information figure ﬁrst set prim rule script prim rule expressiongrammar expressiongrammar prim parens number expressiongrammar parens asparser trim term asparser trim expressiongrammar number digit asparser plus ﬂatten trim str str asnumber follow show set terminal parser activated directly rule ﬁnished figure follow set prim closing bracket character parser star character parser plus ter parser parser state string word ﬁnished parsing prim rule input continue input completely sumed use follow set grammar speciﬁed correctly example follow set wrong deﬁnition grammar prim rule lowed binary operator closing bracket opening bracket general computation follow complex computation ﬁrst ppbrowser computes information browser related particular parsing input specify input sample ﬁlling text area petitparser building modular parser figure follow set prim rule tab parse input sample clicking playibutton pressing gain insight parse result inspecting tab pane result show result parsing input sample inspected clicking inspect orexplore button figure figure show result parsing figure result parsing sample expression debugger show tree view step performed ing useful don t know exactly happening parsing selecting step subset input highlighted input parsed particular step example inspect expressiongrammar work rule called order depicted figure grey rule rule failed usually happens choice parser example prod rule deﬁnition script parser parsing parser tried parse mulrule ﬁrst option prod mulrequired star character position present mulfailed instead prim value parsed script prod rule expressiongrammar expressiongrammar prod mul prim expressiongrammar mul prim asparser trim prod compare happens parsing change rule applied know fails second debugger output figure browser figure debugger output expressiongrammar input figure debugger output expressiongrammar input tally show time particular parser got called ing percentage show number call total number call ratio useful optimizing performance parser figure proﬁle show time spent particular parser ing input percentage show ratio time total time useful optimizing performance parser figure progress visually show parser consumes input sent character read input sample ranging left margin number character input right margin represents time ranging beginning parsing process margin end margin line going figure petitparser building modular parser figure tally expressiongrammar input figure proﬁle expressiongrammar input parser completed task reading character input sample best case scenario parsing linear length input word input ncharacters parsed nsteps multiple line visible mean parser previously read character input sample try different rule seen figure example parser time correctly parse input sample input parsed n step bad ward jump grammar reconsider order choice parser restructure grammar use memoized parser detailed look backtracking issue following browser figure progress petit parser parses input linear step figure progress petit parser lot backtracking debugging example exercise try improve backtrackingparser script backtrackingparser designed accept input corresponding ular expression c parser give correct result problem performance backtrackingparser doe tracking script parser accepting backtracking ppcompositeparser subclass backtrackingparser instancevariablenames ap c p classvariablenames pooldictionaries category backtrackingparser ab b asparser asparser ab backtrackingparser petitparser building modular parser figure progress backtrackingparser forinput b c asparser backtrackingparser p ab ap c backtrackingparser start p backtrackingparser ap asparser p let overview better understand happening try parse input andinput progress depicted figure input bi parsed linear time backtracking progress depicted figure look bad input ci parsed lot backtracking time compare tally output input input bandinput c figure figure case input b total invocation count parser bi invocation count parser ai invocation parser band invocation parser ain case input problem input don t know problem debugger window hint let look debugger window input ba depicted figure step consumed parser abis invoked reach b debugger window input ca depicted figure look different progress ploop parser abfails repetition loop parser abfails having read string end seen b localized cause backtracking know problem try update backtrackingparser arepetitparser browser figure progress backtrackingparser forinput figure tally output backtrackingparser forinput figure tally output backtrackingparser forinput parsed similar way modiﬁcation script script slightly better parser accepting c ppcompositeparser subclass backtrackingparser instancevariablenames ac classvariablenames pooldictionaries category backtrackingparser petitparser building modular parser figure debugging output backtrackingparser forinput figure debugging output backtrackingparser forinput b asparser asparser ab backtrackingparser ac c asparser asparser ac backtrackingparser start ab ac check new metric input cin figure ure signiﬁcant improvement input c tally show invocation parser band invocation parser good improvement compared invocation parser band browser figure progress backtrackingparser forinput cafter ﬁrst update figure tally backtrackingparser forinput cafter ﬁrst update invocation parser ain original version backtrackingparser figure try better backtracking pening input happens parser abtries recognize b input fails backtracks parser accan recognize try consume choose end modiﬁcation backtrackingparser script case progress backtracking input ca depicted figure hand number parser invocation input bincreased table summarizes total number invocation version backtrackingparser developer decide grammar suitable need better use second proved version case probability input expect input ﬁrst version better script better parser accepting c ppcompositeparser subclass backtrackingparser instancevariablenames classvariablenames pooldictionaries category petitparser building modular parser figure progress backtrackingparser second update input figure tally backtrackingparser second update input invocation version input binput c original improvement second improvement table number parser invocation input bandinput cdepending version backtrackingparser backtrackingparser abc b asparser c asparser asparser abc backtrackingparser start abcpackrat parser packrat parser beginning chapter mentioned parser gy packrat parser claimed packrat parsing give linear parse time debugging example saw original sion backtrackingparser parsed input cof length step try parse longinput length original parser need step progress linear petitparser framework doe use packrat parsing default need send memoized message enable packrat parsing ized parser ensures parsing particular position input particular parser performed result remembered dictionary future use second time parser want parse input result looked dictionary way lot unnecessary parsing avoided disadvantage petitparser need memory remember result possible parser possible position example packrat parser let return backtrackingparser script analyzed problem parser abthat constantly failed ap ploop trick memoize parser abby updating method aba script memoization applied progress figure total number invocation input cand invocation longinput minor modiﬁcation ofbacktrackingparser got linear parsing time related length input factor script memoized version parser ab backtrackingparser ab b asparser asparser ab memoized chapter summary concludes tutorial petitparser reviewed following point parser composition multiple smaller parser combined combinators parse string use method parse petitparser building modular parser figure progress memoized version backtrackingparser know string match grammar use method match method ﬂatten return string result parsing method performs transformation given block given parameter compose parser create grammar subclassing ppcompositeparser test parser subclassing ppcompositeparsertest extensive view petitparser concept tion moose lukas renggli s dedicated ter biography alexandre assistant professor ment computer science pleiad laboratory university chile santiago alexandre obtained phd university berne land phd awarded prestigious prize phd completed ﬁrst postdoc lero trinity college dublin ireland second institute germany alexandre collaborator carry research software engineering software quality ically code proﬁling testing data visualization alexandre thored article published international peer reviewed tiﬁc forum including competitive conference journal ﬁeld software engineering alexandre participated program committee international event alexandre strong applying research result industry research prototype turned product damien associate professor maître conférences university lille france member rmod research group inria lifl main goal research solve problem faced developer everyday browsing complex source code decomposing large commits joining rmod damien cassou got computer science university bordeaux thesis bringing biography ming tool dedicated domain speciﬁc architecture description language programming framework generator developer pharo collaborated pharo example book stéphane directeur recherche ria scientiﬁc deputee inria lille nord europe research center lead rmod http team expert domain language design reengineering worked trait composable group method work got impact trait introduced ambianttalk racket perl php variant scala fortress sun tems developer pharo expert software quality program understanding program visualization reengineering metamodeling developer moose software analysis platform http stéthane work synectique http company building dedicated tool advanced software analysis jannik associate professor telecom institute mine douai france received doctorate degree computer science university lille france june thesis software quality visualization ing us moose software analysis http mine douai work software engineering embedded system particularly modularity tool tems main developer phratch visual gramming language pharo http us phratch teaching robotics software engineering engineer dent