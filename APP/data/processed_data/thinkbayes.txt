think ba y e ba y esian statistic simple v ersion ba y e ba y esian statistic simple v ersion allen wney green t ea press needham massac h usettscop yrigh t allen wney green t ea press w ash burn v e needham ma p ermission gran ted cop y distribute mo dify cumen t term creativ e common e ternational license whic h v ailable http la t e x source b o ok v ailable http thinkbayes theory whic h premise b o ok b o ok think x series y ou kno w ho w program y ou use skill learn topic b o ok ba y esian statistic use mathematical notation presen t idea term mathematical concept lik e calculus b o ok us python instead math discrete appro ximations instead tin uous ematics result w ould b e tegral math b o ok b ecomes summation op erations probabilit y distribution simple lo ops think presen tation easier understand p eople gramming skill general b ecause w e mak e mo deling decision w e c ho ose appropriate mo del w orrying o m uc h ab mo del lends v en tional analysis pro vides smo oth dev elopmen t path simple example w orld problem chapter o d example start simple example v olving dice staple basic probabilit y f rom pro ceeds small step lo comotiv e problem whic h b orro w ed mosteller chal lenging pr oblems pr ob ability solution german tank problem famously successful application ba y esian metho d w orld w ar mo deling appro ximation c hapters b o ok motiv ated b y orld problem v olv e degree mo deling w e apply ba y esian metho d y analysis w e ha v e mak e decision ab whic h part w orld include mo del whic h detail w e abstract w y chapter preface f example chapter motiv ating problem predict winner ho c k ey game mo del p oisson pro cess whic h implies goal equally lik ely y p oin t game exactly true probably o d mo del purp os chapter motiv ating problem terpreting sa t score sa t standardized test used college admission united state start simple mo del assumes sa t question equally di cult fact designer sa t delib erately include question relativ ely easy relativ ely hard presen t second mo del accoun t asp ect design sho w e ha v e big result think imp ortan t include mo deling explicit problem solving b ecause reminds think ab mo deling error error simpli cation assumption mo del man y metho d b o ok based discrete distribution whic h mak e p eople w orry ab n umerical error orld problem n umerical error alw y smaller mo deling error f urthermore discrete approac h allo w b etter mo deling decision w ould ha v e appro ximate solution o d mo del exact solution bad mo del hand tin uous metho d yield p erformance adv example b y replacing tion constan solution recommend general pro cess step y ou exploring problem start simple mo dels plemen t clear readable demonstrably correct f o cu y atten tion o d mo deling decision optimization y ou ha v e simple mo del w orking iden tify biggest source error y ou migh t need increase n um b er v alues discrete appro ximation increase n um b er iteration mon te carlo sim ulation add detail mo del p erformance y solution o d y application y ou migh t ha v e y optimization y ou t w o approac he consider y ou review y lo ok optimization example y ou cac previously computed result y ou migh t b e able v oid redundan t computation y ou lo ok analytic metho d yield computational w orking vii b ene t pro cess step tend b e fast y ou explore sev eral alternativ e mo dels b efore v esting hea vily y b ene t y ou step y ou b e starting reference implemen tation lik ely b e correct whic h y ou use regression testing c hec king optimized yield result appro ximately w orking sound sample used b o ok v ailable http git v ersion trol allo w y ou k eep trac k le mak e pro ject collection le git trol called github hosting service pro vides storage git rep ositories v enien t w eb terface github homepage m y rep ository pro vides sev eral w y w ork y ou create cop y m y rep ository github b y pressing f o rk button y ou ha v e github accoun t y ou need create forking y ou ha v e y o wn rep ository github y ou use k eep trac k y ou write w orking b o y ou clone rep o whic h mean y ou cop y le y computer y ou clone m y rep ository y ou need github accoun t y ou w o b e able write y c hanges bac k github y ou w t use git y ou wnload le zip le using button lo w t corner github page rst edition b o ok w orks python y ou using python y ou migh t w t use dated http instead dev elop ed b o ok using anaconda tin uum analytics whic h free python distribution includes pac k age y ou need run lot anaconda easy install default e el installation el y ou need administrativ e ileges y ou wnload anaconda http y ou w t use anaconda y ou need follo wing pac k age viii chapter preface numpy basic n umerical computation http scipy scien ti c computation http matplotlib visualization http commonly used pac k age included python installation b e hard install en vironmen t y ou ha v e trouble installing recommend using anaconda python distribution include pac k age man y example b o ok use class function ned use whic h pro vides p er function pyplot whic h matplotlib st yle exp erienced python programmer notice b o ok e comply pep whic h common st yle guide python http sp eci cally pep call lo w ercase function name underscore b t w een w ords b o ok accompan ying function metho d name b egin capital letter use camel case likethis brok e rule b ecause dev elop ed w visiting scien tist ogle follo w ed ogle st yle guide whic h deviate pep place got used ogle st yle lik ed p oin t w ould b e o m uc h trouble c hange topic st yle write y e s ap trophe whic h preferred st yle guide deprecated ha v e strong preference c ho ose c hose nally t yp ographical note b o ok use pmf cdf mathematical concept probabilit y mass function cum ulativ e distribution function pmf cdf refer python ob jects use represen t prerequisite sev eral excellen t mo dules doing ba y esian statistic python including pymc op enbugs c hose use b o ok b prerequisite ix y ou need fair amoun t bac kground kno wledge started mo dules w t k eep prerequisite minimal y ou kno w python little bit ab probabilit y y ou ready start b o chapter ab probabilit y ba y e theorem ter tro duce pmf thinly disguised python dictionary use represen t probabilit y mass function pmf chapter tro duce suite kind pmf pro vides framew ork doing ba y esian date later c hapters use analytic distribution including sian normal distribution exp onen tial p oisson distribution b eta distribution chapter break diric hlet tribution explain y ou familiar distribution y ou read ab wikip edia y ou read companion b o ok think stats tro ductory statistic b o ok afraid tak e mathematical approac h particularly helpful practical purp os tributor list y ou ha v e suggestion correction send email downey al om mak e c hange based y feedbac k add y ou tributor list unless y ou ask b e omitted y ou include sen tence error app ear mak e easy searc p age section n um b er ne o easy w ork thanks ha v e ac kno wledge da vid macka y excellen t b o ok information ory infer enc e l e arning lgorithms whic h rst came understand ba y esian metho d p ermission use sev eral problem b o ok example b o ok b ene ted m y teractions sanjo y maha jan esp ecially fall audited class ba y esian inference olin college wrote part b o ok pro ject nigh t boston python user group w ould lik e thank compan y pizza olivier yiptong sen t sev eral helpful suggestion y uriy p asic hn yk sev eral error kristopher ov erholt sen t long list correction suggestion max hailp erin suggested clari cation chapter chapter preface markus dobler p oin ted dra wing okies b o wl replacemen t unrealistic scenario spring studen t m y class computational ba y esian statistic man y helpful correction suggestion kai austin claire barnes kari bender rac hel bo y kat mendoza arjun iy er ben kro op nathan lin tz kyle mcconnaugha y alec radford brendan ritter ev simpson greg marra matt aasted help ed clarify discussion pric e r ight problem marcus ogren p oin ted original statemen t lo comotiv e lem w biguous jasmine k wit yn dan f auxsmith medium pro ofread b o ok man y opp ortunities impro v emen linda p escatore t yp o helpful suggestion t omasz o sen t man y excellen t correction suggestion p eople sp otted t yp o small error include t om p ollard p aul giannaros jonathan edw ards george purkins rob ert marcus ram lim bu james la wry ben kahle la w alv aro sanc preface v theory whic h v mo deling appro ximation v w orking vii st yle viii prerequisite viii ba y e theorem conditional probabilit y conjoin t probabilit y okie problem ba y e theorem diac hronic terpretation m m problem mon t y hall problem discussion computational statistic distribution okie problem ba y esian framew ork t mon t y hall problem encapsulating framew ork m m problem discussion exercise estimation dice problem lo comotiv e problem ab prior alternativ e prior credible terv al cum ulativ e distribution function german tank problem discussion exercise estimation euro problem summarizing p osterior sw amping prior optimization b eta distribution discussion exercise t xiii odds ddends odds o dd form ba y e theorem oliv er blo o d ddends maximum mixture discussion decision analysis pric e r ight problem prior probabilit y densit y function represen ting pdf s mo deling testan t lik eliho o d date optimal bidding discussion prediction boston bruin problem p oisson pro cesses p osteriors distribution goal probabilit y winning sudden death discussion exercise t observ er bias red line problem mo del w ait time predicting w ait time estimating arriv al rate incorp orating uncertain t y decision analysis discussion exercise t w o dimension p ain tball suite t rigonometry lik eliho o d join t distribution conditional distribution credible terv al discussion exercise appro ximate ba y esian computation v ariabilit y hyp othesis mean standard deviation date p osterior distribution cv o w t xv eliho o d little optimization abc robust estimation v ariable discussion exercise hyp othesis t esting bac k euro problem making fair comparison triangle prior discussion exercise evidence terpreting sa t score scale prior p osterior b etter mo del calibration p osterior distribution e cacy predictiv e distribution discussion t sim ulation kidney t umor problem simple mo del general mo del implemen tation cac hing join t distribution conditional distribution serial correlation discussion hierarc hical mo del geiger coun ter problem start simple mak e hierarc hical little optimization extracting p osteriors discussion exercise dealing dimension belly button bacteria lion tiger b ear hierarc hical v ersion random sampling optimization collapsing hierarc h y problem w e y et t xvii b elly button data predictiv e distribution join t p osterior v erage discussion tschapter bayes theorem conditional probabilit y fundamen tal idea b ehind ba y esian statistic ba y e theorem whic h surprisingly easy deriv e pro vided y ou understand conditional bilit y w e start probabilit y conditional probabilit y ba y e theorem ba y esian statistic probabilit y n um b er b et w een including b oth represen t degree b elief fact prediction v alue represen t certain t y fact true prediction come true v alue represen t certain t y fact false termediate v alues represen t degree certain t y v alue written mean predicted outcome lik ely happ en f example probabilit y tossed coin land face v ery close conditional probabilit y probabilit y based bac kground tion f example w t kno w probabilit y ha v e heart tac k y ear ccording cdc ery y ear ab icans ha v e rst coronary attac http p opulation ab million probabilit y randomly c hosen american ha v e heart attac k y ear roughly randomly c hosen american epidemiologist ha v e iden ti ed man y factor risk heart attac k dep ending factor m y risk migh t b e higher lo w er v chapter ba y e theorem male y ear old ha v e b orderline high c holesterol factor increase m y c hances ho w ev er ha v e lo w blo o d pressure smok e factor decrease m y c hances plugging ev erything online calculator http nd m y risk heart attac k y ear ab national v erage v alue tional probabilit y b ecause based n um b er factor mak e m y usual notation conditional probabilit y p ajb whic h bilit y ofa giv en thatb true example represen t prediction ha v e heart attac k y ear b set condition listed conjoin t probabilit y conjoin t probabilit y fancy w y sa y probabilit y t w o thing true write p aandb mean probabilit y andb b oth true y ou learned ab probabilit y text coin toss dice y ou migh t ha v e learned follo wing form ula p aandb p p b w arning alw y true f example toss t w o coin mean rst coin land face b mean second coin land face p p b sure p aandb p p b form ula w orks b ecause case andb indep enden t kno wing outcome rst ev en t e c hange probabilit y second formally p bja b t example ev en t indep enden supp ose thata mean rain da y b mean rain tomorro kno w rained da y lik ely rain tomorro w p bja p b general probabilit y conjunction p aandb p p bja ya andb c hance rain y giv en da y c hance rain t w o consecutiv e da y probably bit okie problem okie problem w e ba y e theorem w t motiv ate example called okie ose t w o b o wls okies bo wl tains v anilla okies c ho colate okies bo wl tains eac w supp ose y ou c ho ose b o wls random lo oking select okie random okie v anilla probabilit y came bo wl conditional probabilit y w e w t p bo wl v anilla ob vious ho w compute ask ed t probabilit y v anilla okie giv en bo wl w ould b e easy p v anillaj bo wl sadly p ajb p bja w y ba y e theorem ba y e theorem t p oin t w e ha v e ev erything w e need deriv e ba y e theorem w e start observ ation conjunction comm utativ e p aandb p banda y ev en t andb w e write probabilit y conjunction p aandb p p bja w e ha v e said ything ab andb mean c hangeable terc hanging yield p banda p b p ajb w e need pulling piece w e p b p ajb p p bja example http longer chapter ba y e theorem whic h mean t w o w y compute conjunction y ou ha v e p y ou m ultiply b y conditional probabilit y p bja y ou w y y ou kno w p b y ou m ultiply b y p ajb w y y ou thing finally w e divide b y p b p ajb p bja p b ba y e theorem migh t lo ok lik e m uc h turn b e surprisingly p o w erful f example w e use solv e okie problem write h yp othesis okie came bo wl v v anilla okie plugging ba y e theorem w e p p p v term left w e w t probabilit y bo wl giv en w e c hose v anilla okie term righ t probabilit y w e c hose bo wl unconditioned b y kind okie w e got problem sa y w e c hose b o wl random w e assume p probabilit y getting v anilla okie bo wl whic h v probabilit y dra wing v anilla okie b o wl w e equal c hance c ho osing b o wl b o wls tain n um b er okies w e c hance c ho osing y okie bet w een t w o b o wls v anilla c ho colate okies p v putting w e ha v e p whic h reduces v anilla okie evidence fa v h yp si w e c hose bo wl b ecause v anilla okies lik ely come bo wl diac hronic terpretation example demonstrates use ba y e theorem pro vides strategy p bja ajb strategy useful case lik e okie problem easier compute term righ t ba y e theorem term left diac hronic terpretation w y think ba y e theorem giv e w y date probabilit y h yp othesis h ligh t b o dy data d w y thinking ab ba y e theorem called diac hronic pretation mean happ ening o v er time case probabilit y h yp otheses c hanges o v er time w e new data rewriting ba y e theorem h andd yield p hjd h p djh p d terpretation eac h term h probabilit y h yp othesis b efore w e data called prior probabilit y just prior hjd w e w t compute probabilit y h yp othesis w e data called p osterior djh probabilit y data h yp othesis called lik eliho o d d probabilit y data y h yp othesis called normalizing constan t w e compute prior based bac kground information f example okie problem sp eci e w e c ho ose b o wl random equal probabilit y case prior sub jectiv e reasonable p eople migh t agree b ecause use t bac kground information b ecause terpret information tly lik eliho o d usually easiest compute okie problem w e kno w whic h b o wl okie came w e nd probabilit y v anilla okie b y coun chapter ba y e theorem normalizing constan t b e tric ky supp osed b e probabilit y seeing data y h yp othesis general case hard nail wn mean w e simplify thing b y sp ecifying set h yp otheses mutually exclusiv e t h yp othesis set b e true collectiv ely exhaustiv e p ossibilities h yp otheses b e true use w ord suite set h yp otheses prop erties okie problem t w o h yp okie came bo wl bo wl m utually exclusiv e collectiv ely exhaustiv case w e compute p d using la w total probabilit y whic h sa y t w o exclusiv e w y migh t happ en y ou add probability lik e p d p p p p plugging v alues okie problem w e ha v e p d whic h w e computed earlier b y men tally com bining t w o b o wls m m problem m m small c ho colates come v ariet y color mar whic h mak e m m c hanges mixture color time time tro duced blue m m color mix bag plain m m w bro wn y ello w red green orange t afterw ard w blue green orange y ello w red bro wn supp ose friend t w o bag m m tell w o tell whic h whic h giv e m m eac h bag y ello w green probabilit y y ello w came bag m m problem problem similar okie problem t wist dra w sample eac h b o problem giv e c hance demonstrate table metho d whic h useful solving problem lik e pap er c hapter w e solv e computationally rst step en umerate h yp otheses bag y ello w m m came bag bag h yp otheses bag whic h implies bag b bag bag w w e construct table ro w eac h h yp othesis column eac h term ba y e theorem prior lik eliho o d p osterior p h p djh p h p djh p hjd b rst column prior based statemen t problem reasonable c ho ose p p b second column lik eliho o d whic h follo w information problem f example true y ello w m m came bag probabilit y green came bag probabilit y b true y ello w m m came bag probabilit y green came bag probabilit y selection indep enden t w e conjoin t probabilit y b y m ultiplying column just pro duct previous t w sum umn normalizing constan t o column whic h tains p osteriors w e divide column b y normalizing constan simple righ t w ell y ou migh t b e b othered b y write p djh term p cen tages probability whic h mean b y factor cancel w e divide b y normalizing constan t e result set h yp otheses m utually exclusiv e collectiv ely exhaustiv e y ou m ultiply lik eliho o d b y y factor v enien t long y ou apply factor en tire chapter ba y e theorem mon t y hall problem mon t y hall problem migh t b e tious question history probabilit y scenario simple correct answ er coun tuitiv e man y p eople just ca accept man y smart p eople ha v e em barrassed themselv e just b y getting wrong b y arguing wrong aggressiv ely public mon t y hall w original host game sho w l et make al mon t y hall problem based regular game sho y ou sho w happ en mon t y sho w y ou closed or tell y ou prize b ehind eac h prize car t w o v aluable prize lik e p ean ut butter fak e nger nail prize arranged random ob ject game guess whic h car y ou guess righ t y ou k eep car y ou pic k whic h w e w e or b op ening y ou c hose mon t y increase susp ense b y op ening b c whic hev er e ha v e car car actually b ehind mon t y safely op en b c c ho os random mon t y y ou option stic k y original c hoice switc h remaining unop ened question y ou e mak e p eople ha v e strong tuition mak e t w o or left reason c hance car b ehind wrong fact c hance winning y ou stic k y ou switc h y c hances applying ba y e theorem w e break problem simple piece ma yb e vince ourselv e correct answ er fact correct t o start w e mak e careful statemen t data case d consists t w o part mon t y c ho os b car mon t y hall problem w e ne h yp otheses b andc represen t h yp othesis car b ehind b let apply table metho d prior lik eliho o d p osterior p h p djh p h p djh p hjd b c filling prior easy b ecause w e told prize arranged random whic h suggests car equally lik ely b e b ehind y figuring lik eliho o d tak e t reasonable care w e b e den t w e ha v e righ t car actually b ehind mon t y safely op en or b probabilit y c ho os b car actually b ehind probabilit y car b ehind b car actually b ehind b mon t y op en c abilit y op en b finally car b ehind c mon t y op en b probabilit y nd car probabilit y w hard o v er rest just arithmetic sum column dividing yield p ajd andp cjd y ou b etter switc hing man y v ariations mon t y hall problem strength ba y esian approac h generalizes handle v ariations f example supp ose mon t y alw y c ho os b c ho os c b ecause car b ehind b case revised table prior lik eliho o d p osterior p h p djh p h p djh p hjd b c c hange p dja car b ehind mon t y c ho ose op en b v ariation alw y c ho os b p dja result lik eliho o d andc p osteriors p ajd p cjd case fact mon t y c chapter ba y e theorem b rev eals information ab lo cation car e matter testan t stic k switc he hand op ened c w e w ould kno w p bjd included mon t y hall problem c hapter b ecause think fun b ecause ba y e theorem mak e complexit y problem little manageable t ypical use ba y e theorem y ou confusing w orry discussion f man y problem v olving conditional probabilit y ba y e theorem vides strategy p ajb hard compute hard measure exp erimen tally c hec k migh t b e easier compute term ba y e theorem p bja p andp b mon t y hall problem y idea fun ha v e collected n b er similar problem article called y ba y e b elong whic h y ou read http computational statistic distribution statistic distribution set v alues corresp onding bilities f example y ou roll die set p ossible v alues n um b er probabilit y asso ciated eac h v alue example y ou migh t b e terested ho w man y time eac h w ord app ear common english usage y ou build distribution includes eac h w ord ho w man y time app ear t o represen t distribution python y ou use dictionary map eac h v alue probabilit y ha v e written class called pmf us python dictionary exactly w y pro vides n um b er useful metho d called class pmf reference probabilit y mass function whic h w y represen t distribution mathematically pmf ned python mo dule wrote accompan y b o ok y ou wnload http f information section t o use pmf y ou imp ort lik e thinkbayes import pmf follo wing build pmf represen t distribution outcome die pmf pmf x x chapter computational statistic pmf creates empt y pmf v alues set metho d set probabilit y asso ciated eac h v alue example coun t n um b er time eac h w ord app ear sequence pmf pmf word word incr increase asso ciated eac h w ord b y w ord pmf added quote b ecause example probability normalized add true probability example w ord coun t prop ortional probability w e coun t w ords w e compute probability b y dividing b y total n um b er w ords pmf pro vides metho d normalize e exactly y ou ha v e pmf ob ject y ou ask probabilit y asso ciated y v alue print w ould prin t frequency w ord fraction w ords list pmf us python dictionary store v alues probability v alues pmf b e y hashable t yp probability b e y n umerical t yp e usually oin t n um b er t yp e float okie problem text ba y e theorem natural use pmf map eac h h yp othesis probabilit y okie problem h yp otheses python represen t string pmf pmf bowl bowl distribution whic h tains prior eac h h yp othesis called w ait prior distribution ba y esian framew ork t o date distribution based new data v anilla okie w e m ultiply eac h prior b y corresp onding lik eliho o lik eliho o d dra wing v anilla okie bo wl lik eliho o d bo wl bowl bowl mult e y ou w ould exp ect get probabilit y giv en h p othesis m ultiplies b y giv en lik eliho o date distribution longer normalized b ecause h yp otheses m utually exclusiv e collectiv ely exhaustiv e w e malize result distribution tains p osterior probabilit y eac h h yp othesis whic h called w ait w p osterior distribution finally w e p osterior probabilit y bo wl print bowl answ er y ou wnload example http f information section ba y esian framew ork w e problem w t rewrite previous section mak e general ne class encapsulate related problem class cookie pmf def self hypo self hypo hypo hypo okie ob ject pmf map h yp otheses probability metho d giv e eac h h yp othesis prior probabilit y previous section t w o h yp otheses hypo bowl bowl pmf cookie hypo cookie pro vides update metho d tak e data parameter date chapter computational statistic def update self data hypo like data hypo hypo like update lo ops eac h h yp othesis suite m ultiplies probabilit y b y lik eliho o d data h yp othesis whic h computed b y likelihood mix bowl dict bowl dict def likelihood self data hypo mix hypo like mix data return like likelihood us mix whic h dictionary map b o wl mix okies b o wl date lo ok lik e vanilla w e prin t p osterior probabilit y eac h h yp othesis hypo prob print hypo prob result bowl bowl whic h w e got b efore complicated w e sa w previous section adv tage generalizes case w e dra w okie b o wl replacemen t dataset vanilla chocolate vanilla data dataset data adv tage pro vides framew ork solving man y similar problem section w e solv e mon t y hall problem tionally part framew ork section v ailable http py f information section mon t y hall problem mon t y hall problem t o solv e mon t y hall problem ne new class class monty pmf def self hypo self hypo hypo hypo far monty cookie exactly creates pmf o name h yp otheses hypo abc pmf monty hypo calling update prett y m uc h data b data implemen tation update exactly def update self data hypo like data hypo hypo like requires w ork likelihood def likelihood self data hypo hypo data return elif hypo return return finally prin ting result hypo prob print hypo prob answ er b c chapter computational statistic example writing likelihood little complicated framew ork ba y esian date simple section v ailable http f information section encapsulating framew ork w w e elemen t framew ork w e sulate ob suite pmf pro vides update print class suite pmf represents suite hypothesis probability def self initializes distribution def update self data update hypothesis based data def print self print hypothesis probability implemen tation suite t o use suite y ou write class inherits pro vides likelihood f example solution mon t y hall problem rewritten use suite thinkbayes import suite class monty suite def likelihood self data hypo hypo data return elif hypo return return us class suite monty abc b y ou wnload example http f information section m m problem m m problem w e use suite framew ork solv e m m problem w riting likelihood function tric ky ev erything straigh tforw ard need enco color mix b efore dict dict ha v e enco h yp otheses hypoa dict hypob dict hypoa represen t h yp othesis bag bag hypob w y map h yp othesis represen tation hypothesis dict nally write likelihood case h yp othesis hypo string b data tuple sp eci e bag color def likelihood self data hypo bag color data mix hypo bag like mix color return like creates suite date suite ab yellow green chapter computational statistic result b p osterior probabilit y appro ximately whic h w e got b efore section v ailable http py f information section discussion c hapter presen t suite class whic h encapsulates ba y esian date framew ork suite abstract t yp e whic h mean ne terface suite supp osed ha v e e pro vide complete implemen tation suite terface includes update likelihood suite class pro vides implemen tation update likelihood concrete t yp e class extends abstract paren t class vides implemen tation missing metho d f example monty extends suite inherits update pro vides likelihood y ou familiar design pattern y ou migh t recognize example template metho d pattern y ou read ab pattern http example follo wing c hapters follo w pattern eac h problem w e ne new class extends suite inherits update pro vides likelihood case w e o v erride update usually impro v e p erformance exercise exercise section said solution okie problem generalizes case w e dra w m ultiple okies replacemen lik ely scenario w e eat okies w e dra w lik eliho o d eac h dra w dep end previous dra w mo dify solution c hapter handle selection replacemen hin t add instance v ariables cookie represen t h yp othetical state exercise b o wls mo dify likelihood accordingly y ou migh t w t ne bowl ob chapter computational statisticschapter estimation dice problem supp ose ha v e b o x dice tains die die die die die y ou ha v e ev er pla y ed ge ons dr agon y ou kno w talking ab supp ose select die b o x random roll probabilit y rolled eac h die let suggest strategy approac hing problem lik e cho ose represen tation h yp otheses cho ose represen tation data w rite lik eliho o d function previous example used string represen t h yp otheses data die problem use n um b er sp eci cally use tegers represen t h yp otheses suite dice tegers data represen tations mak e easy write lik eliho o d function class dice suite def likelihood self data hypo hypo data return return chapter estimation ho w likelihood w orks hypo data mean roll greater n um b er side die ca happ en lik eliho o d question en hypo side c hance rolling data answ er regardless data statemen t e date roll p osterior distribution w e roll probabilit y die lik ely alternativ e die c hance die w e roll time roll roll data die eliminated die quite lik ely result w probabilit y w e rolling die die dice problem based example sa w sanjo y maha jan class ba y esian inference y ou wnload section http f information section lo comotiv e problem lo comotiv e problem f rederic k mosteller chal lenging pr oblems pr ob ability solution v er lo comotiv e problem number figure p osterior distribution lo comotiv e problem based uniform prior railroad n um b er lo comotiv e order da y y ou lo comotiv e n um b er estimate ho w man y lo comotiv e railroad based observ ation w e kno w railroad lo comotiv e ho w man y t o apply ba y esian reasoning w e break problem t w o step did w e kno w ab n b efore w e sa w data f y giv en v alue n lik eliho o d seeing data lo comotiv e n um b er answ er rst question prior answ er second lik eliho o w e ha v e m uc h basis c ho ose prior w e start simple consider alternativ e let assume n equally lik ely b e y v alue hypo xrange w w e need lik eliho o d function h yp othetical eet n lo motiv e probabilit y w e w ould n um b er w e assume erating compan y w e care ab w e equally lik ely y lo comotiv e c hance seeing y particular lo comotiv e lik eliho o d chapter estimation class train suite def likelihood self data hypo hypo data return return migh t lo ok familiar lik eliho o d function lo comotiv e problem dice problem iden tical date suite train hypo o man y h yp otheses prin t plotted result figure surprisingly v alues n b elo w ha v e b een eliminated lik ely v alue y ou guess migh t lik e v ery o d guess c hances y ou just happ ened train highest n um b er nev ertheless y ou w t maximize c hance getting answ er exactly righ t y ou guess ma yb e righ t goal alternativ e compute mean p osterior distribution def mean suite total hypo prob total hypo prob return total print mean suite y ou use v ery similar metho d pro vided b y pmf print mean p osterior migh t b e o d guess y ou w ted minimize error y ou pla y ed guessing game o v er o v er using mean p osterior y estimate w ould minimize mean squared error o v er long run http error y ou wnload example http f information section ab prior ab prior t o mak e y progress lo comotiv e problem w e mak e assumption w ere prett y arbitrary particular w e c hose uniform prior m uc h justi cation c ho osing c ho osing uniform distribution crazy b eliev e railroad compan y migh t op erate lo tiv e reasonable p erson migh t guess er w e migh t w onder p osterior distribution sensitiv e assumption little observ probably recall uniform prior mean p osterior upp er b ound w e p osterior mean upp er b ound p osterior mean bad t w o w y pro ceed data bac kground information data p osterior distribution based t prior tend v erge f example supp ose addition train w e train w e date distribution lik e data data data mean p osteriors upp er p osterior bound mean smaller alternativ e prior data v ailable option impro v e prior b y ering bac kground information probably reasonable assume erating compan y lo comotiv e just lik ely compan y chapter estimation number power law figure p osterior distribution based p o w er la w prior compared uniform prior w e probably nd list company op erate lo comotiv e area observ ation w e terview exp ert rail shipping gather information ab t ypical size company ev en getting sp eci c railroad economics w e mak e educated guess eld man y small company er company t w o v ery large company fact distribution compan y size tends follo w p o w er la w rob ert axtell rep orts scienc e http la w suggests company er lo tiv e migh t b e company lo comotiv e company p ossibly compan y lo comotiv e mathematically p o w er la w mean n um b er company giv en size v ersely prop ortional size pmf x pmf x probabilit y mass function x parameter near w e construct p o w er la w prior lik e class train dice credible terv al def self hypo self hypo hypo hypo hypo construct prior hypo range suite train hypo upp er b ound arbitrary p o w er la w prior p osterior sensitiv e c hoice figure sho w new p osterior based p o w er la w compared p osterior based uniform prior using bac kground information represen ted p o w er la w prior w e eliminate v alues n greater w e start prior observ e train mean p osteriors upp er p osterior bound mean w m uc h smaller fact arbitrarily large upp er b ound mean v erges p o w er la w prior realistic b ecause based general mation ab size company b eha v e b etter practice y ou wnload example section http f information section credible terv al y ou ha v e computed p osterior distribution useful rize result single p oin t estimate terv al f p oin t estimate common use mean median v alue maxim um lik eliho o f terv al w e usually rep ort t w o v alues computed c hance unkno wn v alue fall b et w een y probabilit y v alues ne credible terv al chapter estimation simple w y compute credible terv al add probability p osterior distribution record v alues corresp ond probability w ords p ercen tile thinkbayes pro vides function computes p ercen tile def percentile pmf percentage p percentage total val prob total prob total p return val us interval percentile suite percentile suite print interval f previous lo comotiv e problem p o w er la w prior credible terv al width range suggests correctly w e quite uncertain ab ho w man y lo comotiv e cum ulativ e distribution function previous section w e computed p ercen tile b y iterating v alues probability pmf w e need compute p ercen tile e cien t use cum ulativ e distribution function cdf cdfs pmfs equiv alen t sense tain tion ab distribution y ou alw y v ert adv tage cdf y ou compute p ercen tile e cien tly thinkbayes pro vides cdf class represen t cum ulativ e distribution function pmf pro vides metho d mak e corresp onding cdf cdf cdf pro vides function named percentile interval v erting pmf cdf tak e time prop ortional n um b er v alues len pmf cdf store v alues probability sorted list lo oking probabilit y corresp onding v alue tak e time prop ortional logarithm n um b er v alues lo german tank problem v alue corresp onding probabilit y logarithmic cdfs e cien t man y calculation example section http f information section german tank problem w orld w ar economic w arfare division american bassy london used statistical analysis estimate german pro duction tank equipmen w estern ally captured log b o ok v en tory repair record included c hassis engine serial n um b er individual tank analysis record indicated serial n um b er w ere allo cated b y ufacturer tank t yp e blo c k n um b er n um b er eac h blo c k w ere used sequen tially n um b er eac h blo c k w ere used problem estimating german tank pro duction b e reduced eac h blo c k n um b er form lo comotiv e problem based insigh t american british analyst pro duced estimate stan tially lo w er estimate form telligence w ar record indicated w ere substan tially accurate p erformed similar analysis tire truc k ro c k ets men t yielding accurate actionable economic telligence german tank problem historically teresting nice example orld application statistical estimation far man y example b o ok ha v e b een y problem b e long b efore w e start solving real problem think adv tage ba y esian analysis esp ecially computational approac h w e taking pro vides suc h short path basic tro duction researc h fron tier discussion ba y esians t w o approac he c ho osing prior distribution recommend c ho osing prior b est represen t bac kground mation ab problem case prior said b e informativ e bro die empirical approac h economic telligence w orld w ar journal meric statistic al asso ciation v ol marc h chapter estimation problem using informativ e prior p eople migh t use en t bac kground information terpret tly informativ e prior sub jectiv alternativ e uninformativ e prior whic h tended b e unrestricted p ossible order let data sp eak themselv e case y ou iden tify unique prior desirable prop ert y lik e represen ting minimal prior information ab estimated quan tit y uninformativ e prior app ealing b ecause ob jectiv generally fa v using informativ e prior wh y ba y esian analysis alw y based mo deling decision cho osing prior decision migh t ev en b e sub jectiv ev en uninformativ e prior ob jectiv e en tire analysis sub jectiv practical problem y ou lik ely b e t w o regime y ou ha v e lot data v ery m uc y ou ha v e lot data c hoice prior e matter v ery m uc h informativ e uninformativ e prior yield result w e example lik e c hapter lo comotiv e problem y ou ha v e m uc h data using ev t bac kground information lik e p o w er la w distribution mak e big german tank problem y ou ha v e mak e sion based y result y ou probably use information y disp osal main taining illusion ob jectivit y b y pretending kno w y ou exercise exercise t o write lik eliho o d function lo comotiv e problem w e answ er question railroad n lo comotiv e probabilit y w e n um b er answ er dep end sampling pro cess w e use w e observ e lo comotiv c hapter resolv ed biguit y b y sp ecifying erating compan y w e care ab supp ose instead man y company t n um b er train supp ose y ou equally lik ely y train op erated b exercise y compan y case lik eliho o d function t b ecause y ou lik ely train op erated b y large compan y exercise implemen t lik eliho o d function v ariation lo comotiv e problem compare chapter estimationchapter estimation euro problem information ory infer enc e l e arning lgorithms da vid macka y p os problem statistical statemen t app eared guardian f rida y uary spun edge time belgian coin came head time tail lo ok v ery suspicious said barry bligh t statistic lecturer london sc ho ol economics coin w ere biased c hance getting result extreme w ould b e data giv e evidence coin biased fair t o answ er question w e pro ceed t w o step rst estimate probabilit y coin land face second ev aluate data supp ort h yp othesis coin biased y ou wnload section http f information section y giv en coin probabilit y x landing head spun edge reasonable b eliev e v alue x dep end ph ysical c haracteristics coin primarily distribution w eigh chapter estimation figure p osterior distribution euro problem uniform prior coin p erfectly balanced w e exp ect x b e close lopsided coin x migh t b e substan tially w e use ba y e theorem observ ed data estimate x let ne h yp otheses hx h yp othesis probabilit y head x v alues start uniform prior probabilit y hx x w e come bac k later consider prior lik eliho o d function relativ ely easy hx true probabilit y head probabilit y tail class euro suite def likelihood self data hypo x hypo data h return return mak e suite date suite euro xrange dataset h t data dataset data result figure summarizing p osterior summarizing p osterior sev eral w y summarize p osterior distribution option nd lik ely v alue p osterior distribution thinkbayes pro vides function e def maximumlikelihood pmf return value highest probability prob val max prob val val prob return val case result whic h observ ed p ercen tage head suggests correctly observ ed p ercen tage maxim um lik eliho o d estimator p opulation w e migh t summarize p osterior b y computing mean median print mean print median suite mean median finally w e compute credible terv al print ci suite result w getting bac k original question w e w ould lik e kno w coin fair w e observ e p osterior credible terv al e include whic h suggests coin fair exactly question w e started macka y ask ed data giv e evidence coin biased fair t o answ er question w e ha v e b e precise ab mean sa y data constitute evidence h yp othesis sub ject c hapter b efore w e w t address p ossible source confusion w e w t kno w coin fair migh t b e tempting ask probabilit y x print result v alue meaningless decision ev aluate h yp otheses w arbitrary w e ha v e divided range er piece w e probabilit y y giv en h yp othesis w ould b e greater chapter estimation triangle figure uniform triangular prior euro problem triangle figure p osterior distribution euro sw amping prior sw amping prior w e started uniform prior migh t b e o d c hoice b eliev e coin lopsided x migh t deviate substan tially unlik ely belgian euro coin im balanced x migh t b e reasonable c ho ose prior giv e higher probabilit y v alues ofx near lo w er probabilit y extreme v alues example constructed triangular prior sho wn figure construct prior def triangleprior suite euro x range x x x range x figure sho w result uniform prior comparison dating prior dataset yield p osterior distribution sho wn figure ev en substan tially t prior p osterior distribution v ery similar median credible terv al iden tical mean b y example sw amping prior data p eople start t prior tend v erge p osterior optimization ha v e sho wn far mean t b e easy read v ery e cien general lik e dev elop demonstrably correct c hec k fast m y purp os need optimize f example w e care ab run time sev eral w y w e sp eed rst opp ortunit y reduce n um b er time w e normalize suite original w e update eac h spin dataset h head t tail data dataset data chapter estimation update lo ok lik e def update self data hypo like data hypo hypo like return eac h date iterates h yp otheses call normalize whic h iterates h yp otheses w e sa v e time b y doing date b efore normalizing suite pro vides metho d called updateset e exactly def updateset self dataset data dataset hypo like data hypo hypo like return ho w w e v ok e dataset h head t tail dataset optimization sp eeds thing run time prop ortional amoun t data w e sp eed thing ev en b y rewriting likelihood pro cess en tire dataset spin time original v ersion data string enco de head tail def likelihood self data hypo x hypo data h return x return alternativ e w e enco dataset tuple t w o tegers n um b er head tail case likelihood lo ok lik e def likelihood self data hypo x hypo head tail data like x head tail return like w e update lik e b eta distribution head tail head tail w e ha v e replaced rep eated m ultiplication exp onen tiation v sion tak e time y n um b er spin b eta distribution optimization solv e problem ev en faster far w e ha v e used pmf ob ject represen t discrete set v alues x w w e use tin uous distribution sp eci cally b eta distribution http b eta distribution ned terv al including b oth natural c hoice describing prop ortions probability w ait get b etter turn y ou ba y esian date binomial lik eliho o d function whic h w e did previous section b eta distribution conjugate prior mean prior distribution x b eta distribution p osterior b eta distribution w ait get ev en b etter shap e b eta distribution dep end t w o parameter written alpha beta prior b eta distribution parameter alpha beta w e data h head t tail p osterior b eta distribution parameter w ords w e date t w o addition great w orks w e nd b eta distribution o d c hoice prior f ortunately man y realistic prior b eta distribution o d appro ximation uniform prior p erfect matc b eta distribution uniform let ho w w e tak e adv tage pro vides class represen t b eta distribution class beta object def self alpha chapter estimation default mak e uniform distribution update p erforms ba y esian date def update self data head tail data head tail data pair tegers represen ting n um b er head tail w e ha v e y et w y solv e euro problem beta print beta pro vides mean whic h computes simple function alpha beta def mean self return float f euro problem p osterior mean whic h result w e got using pmfs beta pro vides evalpdf whic h ev aluates probabilit y densit y function pdf b eta distribution def evalpdf self x return x finally beta pro vides makepmf whic h us evalpdf generate discrete appro ximation b eta distribution discussion c hapter w e solv ed problem t w o t prior large dataset prior sw amp ed t w o p eople start t prior b eliefs generally nd data p osterior distribution v erge t p oin t b et w een distribution small practical happ en reliev e w orry ab ob jectivit y discussed previous c hapter man y orld problem ev en stark prior b eliefs ev en tually b e reconciled b y data alw y case remem b er ba y esian analysis based mo deling decision y ou c ho ose mo exercise w e migh t terpret data tly ev en data w e w ould compute t lik eliho o d p osterior b eliefs migh t v erge notice ba y esian date w e m ultiply eac h prior probabilit y b y lik eliho o d p h p hjd regardless d euro problem y ou vinced x y ou assign probabilit y h yp otheses amoun t data vince y ou observ ation basis crom w ell rule whic h tion y ou v oid giving prior probabilit y y h yp othesis ev en remotely p ossible http rule crom w ell rule named oliv er crom w ell wrote b eseec h y ou b o w el christ think p ossible y ou ma y b e mistak f ba y esians turn b e o d advice ev en little o v erwrough t exercise exercise supp ose instead observing coin toss directly y ou sure outcome using instrumen t alw y correct sp eci cally supp ose probabilit y y actual head rep orted tail actual tail rep orted head w rite class estimate bias coin giv en series outcome v alue y ho w e spread p osterior distribution dep end y exercise exercise inspired b y question p osted b y named dominosci reddit statistic http reddit online forum man y terest group called subreddits user called redditors p ost link online t w eb page redditors v ote link giving v y link wn v link bad irrelev problem iden ti ed b y dominosci redditors reliable reddit e tak e accoun c hallenge devise redditor cast v ote estimated qualit y link dated accordance reliabilit y chapter estimation redditor estimated reliabilit y redditor dated accordance qualit y link approac h mo del qualit y link probabilit y garnering v ote mo del reliabilit y redditor probabilit y correctly giving v ote y item w rite class nitions redditors link date function date b oth ob jects whenev er redditor cast v odds addend odds w y represen t probabilit y n um b er b et w een w y y ou ha v e ev er b et fo otball game horse race y ou ha v e probably encoun tered represen tation probabilit y called o dd y ou migh t ha v e heard expression lik e o dd y ou migh t kno w mean o dd fa v ev en t ratio probabilit y o ccur probabilit y think m y team c hance winning w ould sa y o dd fa v b ecause c hance winning time c hance losing y ou write o dd decimal form common write ratio tegers written probability lo w common rep ort o dd o dd fa v f example think m y horse c hance winning w ould sa y o dd probability o dd t represen tations information giv en probabilit y y ou compute o dd lik e def odds p return p giv en o dd fa v decimal form y ou v ert probabilit y lik e chapter odds ddends def probability o return o y ou represen t o dd n umerator denominator y ou v ert probabilit y lik e def yes return yes yes w ork o dd m y head nd helpful picture p eople trac think m y horse win o dd fa v o dd m y horse v e p eople think lose probabilit y winning o dd form ba y e theorem chapter wrote ba y e theorem probabilit y form p hjd h p djh p d w e ha v e t w o h yp otheses andb w e write ratio p osterior probability lik e p ajd p bjd p dja p b p djb notice normalizing constan t p d drop equation ifa andb m utually exclusiv e collectiv ely exhaustiv e mean p b w e rewrite ratio prior ratio p osteriors o dd w riting o o dd fa v w e o ajd o p dja p djb w ords sa y p osterior o dd prior o dd time lik ho o d ratio o dd form ba y e theorem form v enien t computing ba y esian date pap er y head f example let bac k okie problem supp ose t w o b o wls okies bo wl tains v anilla okies c ho colate okies bo wl tains eac oliv er blo o d w supp ose y ou c ho ose b o wls random lo oking select okie random okie v anilla probabilit y came bo wl prior probabilit y prior o dd just lik ho o d ratio p osterior o dd whic h corresp onds probabilit y oliv er blo o d problem macka y information ory infer enc e l e arning lgorithms t w o p eople ha v e left trace o wn blo o d scene crime susp ect oliv er tested ha v e t yp e o blo o blo o d group t w o trace b e t yp e o common t yp e lo cal p opulation ha ving frequency t yp e ab rare t yp e frequency data trace scene giv e evidence fa v prop osition oliv er w p eople left blo o d scene t o answ er question w e need think ab mean data giv e evidence fa v h yp othesis tuitiv ely w e migh t sa y data fa v h yp othesis h yp othesis lik ely ligh t data w b efore okie problem prior o dd probabilit y p osterior o dd probabilit y w e sa y v anilla okie evidence fa v bo wl o dd form ba y e theorem pro vides w y mak e tuition precise o ajd o p dja p djb dividing b y o o ajd o dja p djb term left ratio p osterior prior o dd term righ t lik eliho o d ratio called ba y e factor chapter odds ddends ba y e factor v alue greater mean data w ere lik ely b o dd ratio greater mean o dd greater ligh t data w ere b efore ba y e factor mean data w ere lik ely b o dd fa v wn finally ba y e factor exactly data equally lik ely h yp othesis o dd c hange w w e bac k oliv er blo o d problem oliv er p eople left blo o d crime scene accoun t o sample probabilit y data just probabilit y random mem b er p opulation t yp e ab blo o d whic h oliv er did lea v e blo o d scene w e ha v e t w o sample accoun t w e c ho ose t w o random p eople p opulation c hance nding t yp e o t yp e ab w ell t w o w y migh t happ en rst p erson w e c ho ose migh t ha v e t yp e o second ab w y total probabilit y lik eliho o d data sligh tly higher oliv er p eople left blo o d scene blo o d data actually evidence oliv er guilt example little triv ed example coun terin tuitiv e result data c onsistent h yp othesis necessarily favor h yp othesis result coun terin tuitiv e b y ou w y thinking migh t help data consist common ev en t t yp e o blo o d rare ev en t t yp e ab blo o oliv er accoun t common ev en t lea v e rare ev en t unexplained oliv er e accoun t o blo o d w e ha v e t w o c hances nd p opulation ab blo o factor t w o mak e ddends fundamen tal op eration ba y esian statistic update whic h tak e prior distribution set data pro duce p osterior distribution solving real problem usually v olv e n um b er op erations including scaling addition arithmetic op erations max min ddends c hapter presen t addition max presen t op erations w e need rst example based dunge ons dr agon ying game result pla y er decision usually determined b y rolling dice fact b efore game pla y start pla y er generate eac h attribute c telligence wisdom dexterit y constitution c y rolling dice adding y ou migh t b e curious kno w distribution sum t w o w y y ou migh t compute sim ulation giv en pmf represen t distribution single die y ou dra w random sample add accum ulate distribution sim ulated sum en umeration giv en t w o pmfs y ou en umerate p ossible pair v alues compute distribution sum thinkbayes pro vides function b oth example rst proac ne class represen t single die pmf class die def self side self x xrange x w create die die use generate sample roll dice dice samplesum tak e list distribution pmf cdf ob jects ple size n generates n random sum return distribution pmf ob ject def samplesum dists n pmf makepmffromlist randomsum dists xrange n return pmf samplesum us randomsum chapter odds ddends def randomsum dists total sum dist dists return total randomsum v ok e random eac h distribution add result dra wbac k sim ulation result appro ximately correct n get larger get accurate course run time increase w ell approac h en umerate pair v alues compute sum probabilit y eac h pair implemen ted class pmf def self pmf pmf return pmf self pmf course b e pmf ything vides item result new pmf time run dep end n um b er item self prop ortional len self len ho w used y ou apply op erator pmf python v ok e example v ok ed t wice figure sho w appro ximate result generated b y sim ulation exact result computed b y en umeration based assumption random selection eac h pmf indep enden example rolling sev eral dice assumption prett y o case w e w ould ha v e extend metho d use conditional probability section v ailable http f information section maximum sum exact figure appro ximate exact distribution sum dice sum figure distribution maxim um roll chapter odds ddends maximum y ou generate dunge ons dr agon c haracter y ou particularly terested c haracter b est attribute y ou migh t lik e kno w distribution maxim um attribute w y compute distribution maxim um sim ulation giv en pmf represen t distribution single tion y ou generate random sample nd maxim um m ulate distribution sim ulated maximum en umeration giv en t w o pmfs y ou en umerate p ossible pair v alues compute distribution maxim um exp onen tiation w e v ert pmf cdf simple e cien t algorithm nding cdf maxim um sim ulate maximum iden tical sim ulating sum def randommax dists total max dist dists return total def samplemax dists n pmf makepmffromlist randommax dists xrange n return pmf did w replace en umeration iden tical o def pmfmax re max return re fact y ou generalize function b y taking appropriate op erator parameter problem algorithm eac h pmf m v alues run time prop ortional w e w t maxim um k selection tak e time prop ortional maximum w e v ert pmfs cdfs w e calculation m uc h faster k ey remem b er nition cum ulativ e distribution function cdf x p wherex random v ariable mean v alue c hosen randomly example cdf probabilit y v alue distribution equal dra wx fromcdf andy fromcdf compute maxim um max x y c hance z equal w ell case b othx andy m ust b e equal selection x andy indep enden t cdf cdf wherecdf distribution z c hose v alue b ecause think mak e form ulas easy read w e generalize y v alue z cdf z z cdf z sp ecial case w e dra w k v alues distribution cdfk z z k nd distribution maxim um k v alues w e en umerate probability giv en cdf raise k th p o w er cdf pro vides metho d e just class cdf def max self k cdf p k p return cdf max tak e n um b er selection k return new cdf represen t distribution maxim um k selection run time metho d prop ortional m n um b er item cdf e thing pmfs little w ork v ert pmf cdf run time prop ortional mlogm b etter quadratic finally example computes distribution c haracter b est chapter odds ddends figure distribution outcome random die b o ned previous section w e prin t result w e c hance generating c haracter attribute ab figure sho w distribution mixture let example dunge ons dr agon supp ose ha v e b o x dice follo wing v en tory dice dice dice dice die c ho ose die b o x roll distribution outcome y ou kno w whic h die answ er easy die n side yield uniform distribution n including b oth w e kno w whic h die resulting distribution mixture uniform distribution t b ounds general kind ture e t y simple mathematical mo del straigh tforw ard compute distribution form mixture alw y option sim ulate scenario generate random sample compute pmf sample approac h simple generates appro ximate solution quic kly w e w t exact solution w e need t approac let start simple v ersion problem t w o dice side w e mak e pmf represen t eac h die die die w e create pmf represen t mixture mix die outcome prob outcome prob rst lo op en umerates dice second en umerates outcome probability inside lo op add tributions t w o distribution assumes t w o dice equally lik ely generally w e need kno w probabilit y eac h die w e w eigh t outcome accordingly w e create pmf map eac h die probabilit y selected die die die die die w e need general v ersion mixture algorithm mix die weight outcome prob outcome weight prob w eac h die w eigh t asso ciated whic h mak e w eigh ted die supp ose w e add eac h outcome mixture probabilit y m ultiplied b y weight figure sho w result exp ected v alues lik ely b ecause y die pro duce v alues ab o v e unlik ely b ecause chapter odds ddends die b o x pro duce e half time thinkbayes pro vides function named makemixture encapsulates algorithm w e ha v e written mix w e use makemixture chapter discussion o dd form ba y e theorem c hapter sp eci cally ba y esian ba y esian analysis ab distribution imp ortan t understand concept distribution w ell f rom computational p oin t view distribution y data structure represen t set v alues p ossible outcome random pro cess probability w e ha v e seen t w o represen tations distribution pmfs cdfs represen tations equiv alen t sense tain mation y ou v ert primary b et w een p erformance op erations faster easier pmf faster cdf goal c hapter tro duce op erations act butions lik e w e use op erations later tro duce w encourage y ou think distribution fundamen tal unit computation just tainer v alues decision analysis pric e r ight problem v em b er testan t named letia nathaniel app eared pric e r ight american game sho comp eted game called showc ase ob jectiv e guess price sho w case prize testan t come closest actual price sho w case going o v er win prize nathaniel w en t rst sho w case included dish w asher wine cabinet laptop computer car bid letia sho w case included pin ball mac hine video arcade game p o ol table cruise bahamas bid actual price nathaniel sho w case w bid w o high lost actual price letia sho w case w w b y w sho w case b ecause bid w b y w nathaniel sho w case f ba y esian think er scenario suggests sev eral question seeing prize prior b eliefs testan t ha v e ab price sho w case seeing prize ho w testan t date b eliefs based p osterior distribution testan t bid chapter decision analysis price showcase figure distribution price sho w case pric e r ight question demonstrates common use ba y esian analysis decision analysis giv en p osterior distribution w e c ho ose bid maximizes testan t exp ected return problem inspired b y example cameron da b o ok bayesian metho d hacker wrote c hapter v able http read data le y ou wnload http http f information tion prior t o c ho ose prior distribution price w e tak e adv tage data previous episo de f ortunately fan sho w k eep detailed record corresp onded da ab b o ok sen t data collected b y stev e gee http includes price eac h sho w case season bid b y testan t figure sho w distribution price sho w case common v alue b oth sho w case rst sho w case second mo near second sho w case o ccasionally w orth distribution based actual data ha v e b een smo probabilit y densit y function b y gaussian k ernel densit y estimation kde w e w t tak e detour talk ab probabilit y densit y function kde probabilit y densit y function far w e ha v e b een w orking probabilit y mass function pmf pmf map eac h p ossible v alue probabilit y m y implemen tation pmf ob ject pro vides metho d named prob tak e v alue return probabilit y kno wn probabilit y mass probabilit y densit y function pdf tin uous v ersion pmf p ossible v alues mak e tin uous range discrete set mathematical notation pdf s usually written function example pdf gaussian distribution mean standard deviation f x f giv en v alue x function computes probabilit y densit y densit y similar probabilit y mass sense higher densit y indicates v alue lik ely densit y probabilit y densit y b e y p ositiv e v alue b ounded lik e probabilit y b et w een y ou tegrate densit y o v er tin uous range result probabilit y application b o ok w e seldom ha v e instead w e primarily use probabilit y density lik eliho o d function w e example represen ting pdf s t o represen t pdf s python pro vides class named pdf pdf abstract t yp e whic h mean ne terface pdf supp osed ha v e e pro vide complete implemen tation pdf terface includes t w o metho d density makepmf class pdf object def density self x chapter decision analysis raise unimplementedmethodexception def makepmf self x pmf pmf x x x x return pmf density tak e v alue x return corresp onding densit y makepmf mak e discrete appro ximation pdf pdf pro vides implemen tation makepmf density whic h b e pro vided b y c hild class concrete t yp e c hild class extends abstract t yp e pro vides implemen tation missing metho d f example gaussianpdf extends pdf pro vides density class gaussianpdf pdf def self mu sigma mu sigma def density self x return x tak e mu sigma whic h mean standard deviation distribution store attribute density us function ev aluate gaussian pdf function called b ecause gaussian distribution called distribution gaussian pdf ned b y simple mathematical function easy ev aluate useful b ecause man y quan tities real w orld ha v e distribution appro ximately gaussian real data guaran tee distribution gaussian y simple mathematical function case w e use sample estimate pdf p opulation f example pric e r ight data w e ha v e price rst sho w case w e think v alues sample p opulation p ossible sho w case represen ting pdf s sample includes follo wing v alues order sample v alues app ear b et w een reason think v alues imp ossible based bac kground information w e exp ect v alues range b e equally lik ely w ords w e exp ect pdf b e fairly smo oth kernel densit y estimation kde algorithm tak e sample nd appropriately smo oth pdf t data y ou read detail http scipy pro vides implemen tation kde thinkbayes pro vides class called estimatedpdf us class estimatedpdf pdf def self sample sample def density self x return x tak e sample computes k ernel densit y estimate result ob ject pro vides evaluate metho density tak e v alue call return ing densit y finally outline used generate figure price readdata pdf price low high n x low high n pmf x pdf pdf ob ject estimated b y kde pmf pmf ob ject appro ximates pdf b y ev aluating densit y sequence equally spaced v alues linspace stand tak e range low high n um b er p oin t n return new numpy arra y n elemen t equally spaced b et w een low high including b oth w bac k pric e r ight chapter decision analysis diff player figure cum ulativ e distribution cdf b et w een testan t bid actual price mo deling testan t pdf s figure estimate distribution p ossible price y ou w ere testan t sho w y ou use distribution quan tify y prior b elief ab price eac h sho w case b efore y ou prize t o date prior w e ha v e answ er question data w e consider ho w w e quan tify w e compute lik eliho o d function eac h h yp othetical v alue price w e compute conditional lik eliho o d data t o answ er question going mo del testan t guessing instrumen t kno wn error c haracteristics w ords testan t see prize guess price eac h ideally taking consideration fact prize sho w add price let total guess mo del question w e ha v e answ er actual price price lik eliho o d testan t estimate w ould b e guess w e ne error price mo deling testan t w e ask lik eliho o d testan t estimate b y error t o answ er question w e use historical data figure sho w cum ulativ e distribution diff b et w een testan t bid actual price sho w case nition diff price bid diff negativ e bid o high aside w e use distribution compute probabilit y testan t o v erbid rst testan t o v erbids time second testan t o v erbids time w e bid biased lik ely b e o lo w o high mak e sense giv en rule game finally w e use distribution estimate reliabilit y tan t guess step little tric ky b ecause w e actually kno w testan t guess w e kno w bid w e ha v e mak e assumption sp eci cally assume tribution error gaussian mean v ariance diff player class implemen t mo del class player object def self price bid diffs price diffs mu sigma diffs mu sigma price sequence sho w case price bid sequence bid diffs sequence diff price bid smo othed pdf price estimated b y kde cum ulativ e distribution diff whic h w e sa w figure pdf c haracterizes distribution error error price guess chapter decision analysis w e use v ariance diff estimate v ariance error estimate p erfect b ecause testan t bid strategic example pla y er think pla y er o v erbid pla y er migh t mak e v ery lo w bid case diff e ect error happ en lot observ ed v ariance diff migh t o v erestimate v ariance error nev ertheless think reasonable mo deling decision alternativ e preparing app ear sho w estimate o wn distribution error b y w atc hing previous sho w recording guess actual price lik eliho o d w w e ready write lik eliho o d function usual ne new class extends class price def self pmf player self pmf player pmf represen t prior distribution player pla y er ob ject describ ed previous section likelihood def likelihood self data hypo price hypo guess data error price guess like error return like hypo h yp othetical price sho w case data testan t b est guess price error like lik eliho o d data giv en h yp othesis errordensity ned player class player def errordensity self error return error date price posterior figure prior p osterior distribution pla y er based b est guess errordensity w orks b y ev aluating giv en v alue error result probabilit y densit y really probabilit y mem b er likelihood e need compute probabilit y compute pr op ortional probabilit y long constan t prop ortionalit y lik eliho o d get canceled w e normalize p osterior distribution probabilit y densit y p erfectly o d lik eliho o date player pro vides metho d tak e testan t guess computes p osterior distribution class player def makebeliefs self guess pmf price pmf self guess pmfprice generates discrete appro ximation pdf price whic h w e use construct prior pmfprice us makepmf whic h ev aluates sequence v chapter decision analysis class player n n def pmfprice self return t o construct p osterior w e mak e cop y prior v ok e update whic h v ok e likelihood eac h h yp othesis m ultiplies prior b y lik eliho o d renormalizes let bac k original scenario supp ose y ou pla y er y ou y sho w case y b est guess total price prize figure sho w prior p osterior b eliefs ab actual price p terior shifted left b ecause y guess lo w end prior range lev el result mak e sense lik ely v alue prior y b est guess mean p osterior b et w een lev el y ou migh t nd result bizarre b ecause suggests y ou think price y ou b elieve price t o resolv e apparen t parado x remem b er y ou com bining t w o source information historical data ab past sho w case guess ab prize y ou w e treating historical data prior dating based y guess w e equiv alen tly use y guess prior date based historical data y ou think w y ma yb e surprising lik ely v alue p osterior y original guess optimal bidding w w e ha v e p osterior distribution w e use compute optimal bid whic h ne bid maximizes exp ected return http optimal bidding going presen t metho d section wn whic h mean sho w y ou ho w used b efore sho w y ou ho w w ork y ou unfamiliar metho d w orry nition b e shortly t o compute optimal bid wrote class called gaincalculator class gaincalculator object def self player opponent player opponent player opponent player ob jects gaincalculator pro vides expectedgains whic h computes sequence bid exp ected gain eac h bid def expectedgains self bid low high n gain bid bid bid return bid gain low high sp ecify range p ossible bid n n um b er bid try expectedgains call expectedgain whic h computes exp ected gain giv en bid def expectedgain self bid suite total price prob sorted gain bid price total prob gain return total expectedgain lo ops v alues p osterior computes gain eac h bid giv en actual price sho w case w eigh t eac h gain corresp onding probabilit y return total expectedgain v ok e gain whic h tak e bid actual price return exp ected gain def gain self bid price bid price return chapter decision analysis bid gain player player figure exp ected gain v ersus bid scenario pla y er b est guess pla y er b est guess diff price bid prob diff diff return price prob return price prob y ou o v erbid y ou w e compute b et w een y bid price whic h determines y probabilit y winning diff y ou win b oth sho w case f simplicit y assume b oth sho w case ha v e price outcome rare e mak e m uc h finally w e ha v e compute probabilit y winning based diff def probwin self diff prob diff return prob y opp onen t o v erbids y ou win y ou ha v e hop e y opp onen t b y diff player pro vides metho d compute b oth probability class player def proboverbid self discussion return def probworsethan self diff return diff migh t b e confusing b ecause computation w p oin t view opp onen t computing probabilit y o v erbid probabilit y m y bid b y diff answ er based cdf diff opp onen t diff equal y ou win opp onen t diff w orse y y ou win y ou lose finally computes optimal bid class player def optimalbid self guess opponent guess calc gaincalculator self opponent bid gain gain bid max zip gain bid return bid gain giv en guess opp onen t optimalbid computes p osterior tion instan tiates gaincalculator computes exp ected gain range bid return optimal bid exp ected gain whew figure sho w result b oth pla y er based scenario pla y er b est guess pla y er b est guess f pla y er optimal bid yielding exp ected return case whic h turn b e usual optimal bid actually higher testan t b est guess f pla y er optimal bid yielding exp ected return t ypical case optimal bid b est guess discussion feature ba y esian estimation result come form p osterior distribution classical estimation usually generates single p oin t estimate dence terv al whic h su cien t estimation chapter decision analysis step pro cess y ou w t use estimate input subsequen t analysis p oin t estimate terv al m uc h help example w e use p osterior distribution compute optimal bid return giv en bid asymmetric discon tin uous y ou o v erbid y ou lose w ould b e hard solv e problem analytically relativ ely simple computationally new comer ba y esian thinking tempted summarize p rior distribution b y computing mean maxim um lik eliho o d estimate summary b e useful y ou need y ou probably need ba y esian metho d rst place ba y esian metho d useful y ou carry p osterior bution step analysis p erform kind decision analysis w e did c hapter kind prediction w e c prediction boston bruin problem national ho c k ey league nhl final m y b elo v ed boston in pla y ed b en c hampionship series despised v ancouv er uc k boston lost rst t w o game w t w o game t p oin t series probabilit y boston win game probabilit y winning c hampionship alw y answ er question lik e w e need mak e assumption reasonable b eliev e goal scoring ho c k ey appro imately p oisson pro cess whic h mean equally lik ely goal b e scored y time game second w e assume particular opp onen t eac h team v erage goal p er game giv en assumption m y strategy answ ering question use statistic previous game c ho ose prior distribution use score rst game estimate eac h team use p osterior distribution compute distribution goal eac h team distribution goal tial probabilit y eac h team win game compute probabilit y eac h team win chapter prediction t o c ho ose prior distribution got statistic http sp eci cally v erage goal p er game eac h team season distribution roughly gaussian mean standard deviation gaussian distribution tin uous w e appro ximate crete pmf thinkbayes pro vides makegaussianpmf exactly def makegaussianpmf mu sigma pmf pmf low mu sigma high mu sigma x low high n p x mu sigma x p return pmf mu sigma mean standard deviation gaussian tion n um b er standard deviation ab o v e b elo w mean pmf span n n um b er v alues pmf w e use mak e arra y n equally spaced v alues b et w een low high including b oth ev aluates gaussian probabilit y densit y function pdf getting bac k ho c k ey problem nition suite h p otheses ab v alue class hockey def self pmf self pmf prior distribution gaussian mean standard deviation span sigma ab o v e b elo w mean alw y w e ha v e decide ho w represen t eac h h yp othesis case represen t h yp othesis oin t v alue x p oisson pro cesses mathematical statistic pro cess sto c hastic mo del ph ysical c mean mo del kind randomness f p osteriors example bernoulli pro cess mo del sequence ev en t called trial whic h eac h trial t w o p ossible outcome lik e success failure bernoulli pro cess natural mo del series coin ip series shot goal p oisson pro cess tin uous v ersion bernoulli pro cess ev en t o ccur y p oin t time equal probabilit y p oisson pro cesses b e used mo del customer arriving store bus arriving bus stop goal scored ho c k ey game man y real system probabilit y ev en t c hanges o v er time customer lik ely store certain time da y bus supp osed arriv e xed terv al goal lik ely t time game mo dels based simpli cation case mo deling ho c k ey game p oisson pro cess reasonable c hoice heuer mller ner analyze scoring german ccer league come conclusion http b ene t using mo del w e compute distribution goal p er game e cien tly w ell distribution time b et w een goal sp eci cally v erage n um b er goal game lam distribution goal p er game giv en b y p oisson pmf def evalpoissonpmf k lam return lam k k distribution time b et w een goal giv en b y exp onen tial pdf def evalexponentialpdf x lam return lam x use v ariable lam b ecause lambda reserv ed k eyw ord python function p osteriors w w e compute lik eliho o d team h yp othetical v alue lam score k goal game class hockey def likelihood self data hypo lam hypo k chapter prediction goal canuck figure p osterior distribution n um b er goal p er game like k lam return like eac h h yp othesis p ossible v alue data observ ed n um b er goal k lik eliho o d function place w e mak e suite eac h team date score rst game hockey bruin hockey canuck figure sho w resulting p osterior distribution lam based rst game lik ely v alues lam uc k bruin distribution goal t o compute probabilit y eac h team win game w e need compute distribution goal eac h team w e knew v alue lam exactly w e use p oisson distribution thinkbayes pro vides metho d computes truncated appro ximation p oisson distribution goal canuck figure distribution goal single game def makepoissonpmf lam high pmf pmf k xrange p evalpoissonpmf k lam k p return pmf range v alues computed pmf high v alue lam w ere exactly w e w ould compute lam lam c hose upp er b ound b ecause probabilit y scoring goal game quite lo simple far problem w e kno w v alue lam exactly instead w e ha v e distribution p ossible v alues lam f eac h v alue lam distribution goal p oisson o v erall bution goal mixture p oisson distribution w eigh ted according probability distribution lam giv en p osterior distribution lam mak e bution goal def makegoalpmf suite metapmf lam prob chapter prediction game canuck figure distribution time b et w een goal pmf lam pmf prob mix metapmf return mix f eac h v alue lam w e mak e p oisson pmf add b ecause pmf tains pmfs v alues w e use makemixture compute mixture w e sa w makemixture section figure sho w resulting distribution goal bruin uc k bruin lik ely score goal er game lik ely score probabilit y winning t o probabilit y winning rst w e compute distribution goal tial makegoalpmf makegoalpmf diff subtraction op erator v ok e whic h en umerates pair v alues computes subtracting t w o distribution adding whic h w e sa w section sudden death goal tial p ositiv e bruin win negativ e uc k win tie distribution previous section ev en t tie end pla y team pla y o v ertime p erio d til team score game end immediately rst goal scored o v ertime format kno wn sudden death t o compute probabilit y winning sudden death o v ertime p ortan t statistic goal p er game time til rst goal assumption p oisson pro cess implies time b t w een goal exp onen tially distributed giv en lam w e compute time b et w een goal lik e lam lam high upp er b ound distribution case c hose b ecause probabilit y going t w o game scoring small n n um b er v alues pmf w e kno w lam exactly w e instead w e ha v e p osterior distribution p ossible v alues w e did distribution goal w e mak e compute mixture pmfs def makegoaltimepmf suite metapmf lam prob pmf lam pmf prob mix metapmf return mix figure sho w resulting distribution f time v alues p erio d game bruin lik ely score time til uc k score lik ely b e chapter prediction set n um b er v alues n fairly high order minimize n um b er tie p ossible b oth team score sim ultaneously w w e compute probabilit y bruin score rst makegoaltimepmf makegoaltimepmf f bruin probabilit y winning o v ertime finally total probabilit y winning c hance winning end regulation pla y plus probabilit y winning o v ertime f bruin o v erall c hance winning game t o win series bruin win t w o game split t w o win w e compute total probabilit y win split win bruin c hance winning series did discussion alw y analysis c hapter based mo deling decision mo deling alw y iterativ e pro cess general y ou w t start simple yield appro ximate answ er iden tify lik ely source error lo ok opp ortunities impro v emen example w ould consider option c hose prior based v erage goal p er game eac h team statistic v eraged opp onen t particular opp onen t w e migh t exp ect v ariabilit y f example team b est pla y team w orst defense exp ected goal p er game migh t b e sev eral standard deviation ab o v e exercise f data used rst game c hampionship series team pla y ed eac h regular season use result game w ell complication p osition team c hanges season trade injury migh t b e b est giv e w eigh t recen t game t o tak e adv tage v ailable information w e use result regular season game estimate eac h team goal scoring rate p bly adjusted b y estimating additional factor eac h pairwise matc approac h w ould b e complicated feasible f rst option w e use result regular season estimate v ariabilit y pairwise matc thanks dirk hoag http w able n um b er goal scored regulation pla y o v ertime eac h game regular season t eams t conference pla y eac h t w o time regular season fo cused pair pla y ed eac h time f eac h pair computed v erage goal p er game whic h estimate plotted distribution estimate mean estimate standard deviation substan tially higher w e got computing estimate eac h team w e run analysis ariance prior probabilit y bruin win series substan tially higher result lo ariance prior turn result sensitiv e prior whic h mak e sense considering ho w little data w e ha v e w ork based b t w een lo ariance mo del ariable mo del w orth getting prior righ data c hapter v ailable http http f information section exercise exercise bus arriv e bus stop ev ery min ute y ou arriv e bus stop random time y w ait time til bus arriv e uniformly distributed min chapter prediction realit y v ariabilit y time b et w een bus supp ose y ou w aiting bus y ou kno w historical distribution time b et w een bus compute y distribution w ait time hin t supp ose time b et w een bus min ute equal probabilit y probabilit y y ou arriv e min ute terv al solv e v ersion problem c hapter exercise supp ose passenger arriving bus stop w mo deled b y p oisson pro cess parameter y ou arriv e stop nd p eople w aiting y p osterior distribution time bus arriv ed solv e v ersion problem c hapter exercise supp ose y ou ecologist sampling insect p opulation new en vironmen y ou deplo y trap test area come bac k da y c hec k y ou nd trap ha v e b een triggered trapping insect inside trap trigger trap insect til b een reset y ou reset trap come bac k t w o da y ho w man y trap y ou exp ect nd triggered compute p osterior predictiv e distribution n um b er trap exercise supp ose y ou manager apartmen t building ligh t bulb common area y resp onsibilit y replace ligh t bulb break jan uary bulb w orking y ou insp ect f ebruary y ou nd ligh t bulb y ou come bac k april ho w man y ligh t bulb y ou exp ect nd brok en previous exercise y ou reasonably assume ev en t equally lik ely y time f ligh t bulb lik eliho o d failure dep end age bulb sp eci cally old bulb ha v e increasing failure rate ev ap oration lamen problem op y ou ha v e mak e mo deling decision y ou migh t w t read ab w eibull distribution http y ou migh t w t lo ok information ab ligh t bulb surviv al curv observer bias red line problem massac h usetts red line sub w y connects cam bridge boston w w orking cam bridge ok red line kendall square south station caugh t comm uter rail needham rush hour red line train run ev ery min ute v erage arriv ed station estimate time til train based n um b er passenger platform w ere p eople inferred just missed train exp ected w ait ab min ute w ere passenger exp ected train arriv e oner w ere large n um b er passenger susp ected train w ere running sc hedule w ould bac k street lev el taxi w w aiting train t ab ho w ba y esian estimation help predict m y w ait time decide giv e tak e taxi c hapter presen t analysis came c hapter based pro ject b y brendan ritter kai austin ok class olin college c hapter v ailable http used collect data http f information section mo del w e analysis w e ha v e mak e mo deling decision treat passenger arriv al p oisson pro cess whic h mean assume chapter observ er bias time min zb figure pmf gap b et w een train based collected data smo othed b y kde z actual distribution zb biased distribution seen b y passenger passenger equally lik ely arriv e y time arriv e unkno wn rate measured passenger p er min ute observ e passenger short p erio d time time ev ery da y assume constan hand arriv al pro cess train p oisson t rain boston supp osed lea v e end line alewife station ev ery min ute p eak time b y time kendall square time b et w een train v aries b et w een min ute t o gather data time b et w een train wrote script wnloads data http lects ound train arriving kendall square record arriv al time database ran script ev ery w eekda y da y recorded ab arriv al p er da y computed time b t w een consecutiv e arriv al distribution gap sho wn figure lab eled z y ou sto o d platform recorded time b et w een train distribution y ou w ould y ou arriv e random time regard train sc hedule y ou w ould t bution v erage time b et w een train seen b y random passenger substan tially higher true v erage wh y passenger lik e arriv e large terv al small consider simple example supp ose time b et w een train w ait time min ute min ute equal probabilit y case v erage time b et w een train min ute passenger lik ely arriv e min ute gap min ute gap fact t wice lik ely w e surv ey ed arriving passenger w e w ould nd arriv ed min ute gap min ute gap v erage time b et w een train seen b y arriving passenger min ute kind observ er bias app ear man y text studen t think class bigger b ecause big class airline passenger think plane fuller b ecause igh t eac h case v alues actual distribution o v ersampled prop ortion v alue red line example gap t wice big t wice lik ely b e observ ed giv en actual distribution gap w e compute distribution gap seen b y passenger biaspmf e computation def biaspmf pmf x p x x return pmf actual distribution biased distribution inside lo op w e m ultiply probabilit y eac h v alue x b y lik eliho o d b e observ ed whic h prop ortional x w e normalize result figure sho w actual distribution gap lab eled z distribution gap seen b y passenger lab eled zb w ait time w ait time whic h y time b et w een arriv al passenger arriv al train elapsed time whic h x time b et w een arriv al previous train arriv al passenger c hose nitions zb x y chapter observ er bias time min zb y figure cdf z zb w ait time seen b y passenger y giv en distribution zb w e compute distribution y start simple case generalize supp ose previous example zb min ute probabilit y min ute probabilit y w e arriv e random time min ute gap y uniform min ute w e arriv e min ute gap y uniform o v erall distribution mixture uniform distribution w eigh ted according probabilit y eac h gap follo wing function tak e distribution zb computes bution y def pmfofwaittime metapmf gap prob uniform makeuniformpmf gap uniform prob metapmf return pmfofwaittime mak e map eac h uniform distribution probabilit y us makemixture whic h w e sa w section compute mixture pmfofwaittime us makeuniformpmf ned def makeuniformpmf low high pmf w ait time x makerange x return pmf low high range uniform distribution b oth end included finally makeuniformpmf us makerange ned def makerange low high return range low skip makerange ne set p ossible v alues w ait time expressed second default divide range second terv al t o encapsulate pro cess computing distribution created class called waittimecalculator class waittimecalculator object def self biaspmf pmf parameter biased distribution z biased distribution gap time seen b y passenger distribution w ait time distribution elapsed time whic h distribution w ait time t o wh y remem b er particular v alue zp distribution y uniform zp x zp y distribution x uniform zp figure sho w distribution z zb y based data collected red line w eb site t o presen t distribution switc hing pmfs cdfs p eople familiar pmfs think cdfs easier terpret y ou used y ou w t plot sev eral distribution ax cdfs w y mean z min ute mean zb min ute ab higher mean y half mean zb chapter observ er bias time min x posterior x pred y figure prior p osterior x predicted y aside red line sc hedule rep orts train run ev ery min ute p eak time close v erage zb higher v erage z exc hanged email represen tativ e mbt rmed rep orted time b et w een train delib erately conserv ativ e order accoun t v ariabilit y predicting w ait time let bac k motiv ating question supp ose arriv e platform p eople w aiting ho w long exp ect w ait til train arriv e alw y let start easiest v ersion problem w ork w y supp ose w e giv en actual distribution z w e kno w passenger arriv al rate passenger p er min ute case w e use distribution z compute prior distribution zp time b et w een train seen b y passenger w e use n um b er passenger estimate distribution x elapsed time train finally w e use relation y zp x distribution y rst step create waittimecalculator encapsulates butions zp x y prior taking accoun t n um b er predicting w ait time wtc waittimecalculator giv en distribution gap time step mak e elapsedtimeestimator ned b elo w whic h encapsulates p osterior distribution x predictiv e distribution y ete elapsedtimeestimator wtc parameter waittimecalculator passenger arriv al rate lam expressed passenger p er second observ ed n um b er passenger let sa y nition elapsedtimeestimator class elapsedtimeestimator object def self wtc lam elapsed lam predictwaittime prior p osterior distribution elapsed time predictiv e distribution w ait time elapsedtimeestimator us elapsed predictwaittime ned b elo elapsed suite represen t h yp othetical distribution x prior distribution x come straigh t waittimecalculator w e use data whic h consists arriv al rate lam n um b er passenger platform compute p osterior distribution nition elapsed class elapsed def likelihood self data hypo x hypo lam k data like k lam x return chapter observ er bias alw y likelihood tak e h yp othesis data computes lik ho o d data h yp othesis case hypo elapsed time train data tuple lam n um b er passenger lik eliho o d data probabilit y getting k arriv al x time giv en arriv al rate lam w e compute using pmf p oisson distribution finally nition predictwaittime def predictwaittime removenegatives return distribution gap b et w een train distribution elapsed time based observ ed n um b er passenger y zb x w e compute subtraction op erator v ok e whic h en umerates pair zb x computes add result resulting pmf includes negativ e v alues whic h w e kno w imp sible f example y ou arriv e gap min ute y ou ca w ait min ute removenegatives remo v e imp ossible v alues distribution renormalizes def removenegatives pmf val val val figure sho w result prior distribution x distribution y figure p osterior distribution x sho w seeing passenger platform w e b eliev e time train probably min ute predictiv e distribution y indicates w e exp ect train min ute ab dence estimating arriv al rate analysis far b een based assumption w e kno w distribution gap passenger arriv al rate w w e ready relax second estimating arriv al rate arrival rate passenger min posterior figure prior p osterior distribution lam based v e da y passenger data supp ose y ou just mo v ed boston y ou kno w m uc h ab passenger arriv al rate red line da y comm uting y ou mak e guess qualitativ ely little y ou quan titativ ely eac h da y y ou arriv e platform y ou note time n um b er passenger w aiting platform o big y ou c ho ose sample area y ou record y w ait time n um b er new arriv al y ou w aiting v e da y y ou migh t ha v e data lik e y n um b er passenger w aiting y ou arriv e y y w ait time min ute n um b er passenger arriv e y ou w aiting ov er course w eek y ou w aited min ute sa w passenger arriv e y ou w ould estimate arriv al rate passenger p er min ute f practical purp os estimate o d sak e chapter observ er bias pleteness compute p osterior distribution sho w ho w use distribution rest analysis arrivalrate suite represen t h yp otheses ab alw y likelihood tak e h yp othesis data computes lik eliho o d data h yp othesis case h yp othesis v alue data pair y k y w ait time k n um b er passenger arriv ed class arrivalrate def likelihood self data hypo lam hypo y k data like k lam y return like likelihood migh t lo ok familiar iden tical section h yp othesis x elapsed time h yp othesis lam arriv al rate b oth case lik eliho o d probabilit y seeing k arriv al p erio d time giv en lam arrivalrateestimator encapsulates pro cess estimating rameter list y tuples table ab o v class arrivalrateestimator object def self low high n hypo low high n arrivalrate hypo y y build hypo whic h sequence h yp othetical v alues lam build prior distribution lo op date prior data yielding p osterior distribution incorp orating uncertain t y wait time min figure predictiv e distribution y p ossible v alues lam figure sho w prior p osterior distribution exp ected mean median p osterior near observ ed rate passenger p er min ute spread p osterior distribution capture uncertain t y ab based small sample incorp orating uncertain t y whenev er uncertain t y ab input analysis w e tak e accoun t b y pro cess lik e implemen t analysis based deterministic v alue uncertain parameter case compute distribution uncertain parameter run analysis eac h v alue parameter generate set predictiv e distribution compute mixture predictiv e distribution using w eigh t distribution parameter w e ha v e step wrote class called waitmixtureestimator handle step class waitmixtureestimator object def self wtc chapter observ er bias lam prob sorted ete elapsedtimeestimator wtc lam prob wtc waittimecalculator tains distribution zb arrivaltimeestimator tains distribution lam rst line mak e map eac h p ossible distribution y probabilit y f eac h v alue lam w e use elapsedtimeestimator compute corresp onding distribution y store w e use makemixture compute mixture figure sho w result shaded line bac kground distribution y eac h v alue lam line thic kness represen t lik eliho o dark line mixture distribution case w e v ery similar result using single p oin t estimate lam w necessary practical purp os include uncertain t y estimate general imp ortan t include v ariabilit y resp onse linear small c hanges input cause big c hanges output case p osterior v ariabilit y lam small resp onse appro ximately linear small p erturbations decision analysis t p oin t w e use n um b er passenger platform predict distribution w ait time w let second question stop w aiting train catc h taxi remem b er original scenario trying south station catc h comm uter rail supp ose lea v e o ce time w ait min ute mak e m y connection south station case w ould lik e kno w probabilit y y exceeds min ute function easy use analysis section run range problem analysis sensitiv e frequency long dela y b ecause long dela y rare hard estimate frequency decision analysis num y min figure probabilit y w ait time exceeds min ute function n um b er passenger platform ha v e data w eek longest dela y observ ed w min ute ca estimate frequency longer dela y accurately ho w ev er use previous observ ations mak e coarse estimate comm uted b y red line y ear sa w long dela y caused b y signaling problem p o w er outage olice activit stop estimate ab ma jor dela y p er y ear remem b er m y observ ations biased lik ely observ e long dela y b ecause large n um b er passenger w e treat m y observ ations sample zb z ho w w e m y y ear comm uting ok red line home ab time tak e observ ed gap time generate sample gap compute pmf n n bias distribution zb dra w sample add dela y min ute expressed second biaspmf n e cien t usually faster v ert pmf cdf b efore chapter observ er bias use sample zb estimate pdf using kde v ert pdf pmf x makerange x finally bias distribution zb distribution z whic h use create waittimecalculator unbiaspmf wtc waittimecalculator pro cess complicated step op erations w e ha v e seen b efore w w e ready compute probabilit y long w ait def problongwait minute ete elapsedtimeestimator wtc lam prob minute giv en n um b er passenger platform problongwait mak e elapsedtimeestimator extract distribution w ait time computes probabilit y w ait time exceeds minute figure sho w result n um b er passenger w e infer op erating normally probabilit y long dela y small passenger w e estimate b een min ute train longer normal dela y w e infer wrong exp ect longer dela y w e willing accept c hance missing connection south station w e sta y w ait long er passenger tak e taxi tak e analysis step w e quan tify cost missing connection cost taking taxi c ho ose threshold minimizes exp ected cost discussion analysis far b een based assumption arriv al rate passenger ev ery da y f comm uter train rush hour migh t b e bad assumption ob vious exception f example sp ecial ev en t nearb y large n um b er p eople migh exercise arriv e time case estimate lam w ould b e o lo w estimate x y w ould b e o high sp ecial ev en t common ma jor dela y w ould b e imp ortan t include mo del w e b y extending distribution lam include o ccasional large v alues w e started assumption w e kno w distribution z nativ e passenger estimate z w ould b e easy passenger y ou observ e y o wn w ait time y unless y ou skip rst train w ait second y ou observ e gap b et w een train z ho w ev er w e mak e inference ab zb w e note n um b er passenger w aiting w e arriv e w e estimate elapsed time train x w e observ e y w e add p osterior distribution x observ ed y w e distribution represen t p osterior b elief ab observ ed v alue zb w e use distribution date b eliefs ab distribution zb finally w e compute v erse biaspmf distribution zb distribution z lea v e analysis exercise reader suggestion y ou read chapter rst y ou nd outline solution http f information section exercise exercise exercise macka y information ory infer enc e l e arning lgorithms unstable particle emitted source deca y tancex real n um b er exp onen tial probabilit y bution parameter deca y ev en t b e observ ed o ccur windo w extending cm cm n deca y observ ed lo cation cm p osterior distribution y ou wnload solution exercise http chapter observ er biaschapter t wo dimension p ain tball p ain tball sp ort whic h comp eting team try sho ot eac h gun pain lled p ellets break impact lea ving colorful mark target usually pla y ed arena decorated barrier ob jects b e used v er supp ose y ou pla ying pain tball indo arena foot wide foot long y ou standing near fo ot w alls y ou susp ect y opp onen t tak en v er nearb y w y ou sev eral pain t spatter color y ou think y opp onen t red recen tly spatter foot measured lo w corner ro om based data y ou think y opp onen t hiding figure sho w diagram arena using lo w corner ro om origin denote unkno wn lo cation sho oter nates alpha beta lo cation spatter lab eled x angle opp onen t sho ots theta p ain tball problem mo di ed v ersion ligh thouse problem common example ba y esian analysis notation follo w presen tation problem sivia data nalysis bayesian t utorial se c ond edition oxford y ou wnload c hapter http f information section chapter t w o dimension   xshooter wall figure diagram la y pain tball problem suite t o started w e need suite represen t set h yp otheses ab lo cation opp onen eac h h yp othesis pair ordinate alpha beta nition p ain tball suite class paintball def self alpha beta location location pair alpha beta alpha alpha beta beta self pair paintball inherits suite whic h w e ha v e seen b efore joint whic h explain alpha list p ossible v alues alpha beta list v alues beta pair list alpha beta pair location list p ossible lo cation w stored use likelihood ro om foot wide foot long creates suite alpha range t rigonometry alpha beta figure p osterior cdf s alpha beta giv en data beta range location range suite paintball alpha beta location prior distribution assumes lo cation ro om equally lik ely giv en map ro om w e migh t c ho ose detailed prior w e start simple t rigonometry w w e need lik eliho o d function whic h mean w e ha v e gure lik eliho o d hitting y sp ot w giv en lo cation opp onen simple mo del imagine opp onen t lik e rotating turret equally lik ely sho ot y direction case lik ely hit w lo cation alpha lik ely hit w far w y alpha little trigonometry w e compute probabilit y hitting y sp ot w imagine sho oter re shot angle p ellet w ould hit w lo cation x chapter t w o dimension beta beta figure pmf lo cation giv en sev eral v alues beta solving equation yield giv en lo cation w w e nd t aking deriv ativ e rst equation resp ect yield dx deriv ativ e ng sp whic h sp eed target lo cation w increase probabilit y hitting giv en p oin t w v ersely related stra ng sp eed w e kno w ordinate sho oter lo cation w w e compute stra ng sp eed def strafingspeed alpha beta x theta x alpha beta speed beta theta return speed alpha beta ordinate sho oter x lo cation spatter result deriv ativ e x resp ect theta w w e compute pmf represen t probabilit y hitting y lo cation w makelocationpmf tak e alpha beta ordinate sho oter location list p ossible v alues x lik eliho o d def makelocationpmf alpha beta location pmf x location prob strafingspeed alpha beta x x prob return pmf makelocationpmf computes probabilit y hitting eac h lo cation whic h v ersely related stra ng sp eed result pmf lo cation probability figure sho w pmf lo cation alpha range v alues beta f v alues b eta lik ely spatter lo cation x beta increase e spread pmf lik eliho o d w w e need lik eliho o d function w e use makelocationpmf compute lik eliho o d y v alue x giv en ordinate opp onen def likelihood self data hypo alpha beta hypo x data pmf makelocationpmf alpha beta like x return like alpha beta h yp othetical ordinate sho oter x lo cation observ ed spatter pmf tains probabilit y eac h lo cation giv en ordinate sho oter f rom pmf w e select probabilit y observ ed lo cation w e t o date suite w e use updateset whic h inherited suite result distribution map eac h alpha beta pair p osterior probabilit y chapter t w o dimension join t distribution eac h v alue distribution tuple v ariables called join t distribution b ecause represen t distribution v ariables join t distribution tains distribution v ariables w ell information ab relationship giv en join t distribution w e compute distribution eac h v ariable indep enden tly whic h called marginal distribution pro vides metho d computes marginal distribution class joint def marginal self pmf pmf v prob v prob return pmf index v ariable w e w t example indicates distribution alpha indicates distribution beta extract marginal distribution figure sho w result v erted cdf s median v alue alpha near cen ter mass observ ed spatter f beta lik ely v alues close w b ey ond foot distribution uniform whic h indicates data distinguish strongly b et w een p ossible lo cation giv en p osterior marginals w e compute credible terv al eac h ordinate indep enden tly print alpha ci print beta ci credible terv al alpha beta data pro vide evidence sho oter near ro om strong evidence credible terv al v er ro om conditional distribution marginal distribution tain information ab v ariables indep den tly capture dep endence b et w een v ariables y conditional distribution beta beta figure p osterior distribution alpha conditioned sev eral v alues beta w y visualize dep endence b y computing conditional distribution pro vides metho d e def conditional self j val pmf pmf v prob v j val continue v prob return pmf index v ariable w e w t j index conditioning v ariable val conditional v alue result distribution th v ariable condition j th v ariable val f example follo wing computes conditional distribution alpha range v alues beta beta beta beta cond beta figure sho w result whic h w e fully describ e osterior ditional marginal whew chapter t w o dimension figure credible terv al ordinate opp onen v ariables w ere indep enden t conditional distribution w ould b e t w e tell v ariables dep enden f example w e kno w someho w beta conditional distribution alpha fairly narro f larger v alues beta distribution alpha wider credible terv al w y visualize p osterior join t distribution compute credible terv al w e lo ok ed credible terv al section skipp ed o v er subtle p oin t giv en distribution man y terv al lev el credibilit y f example y ou w t credible terv al y ou c ho ose y set v alues probabilit y add v alues common c ho ose cen tral credible terv al example cen tral credible terv al tains v alues b et w een p ercen tile m ultiple dimension ob vious righ t credible terv al b b est c hoice migh t dep end text common c hoice maxim um lik eliho o d credible terv al whic h tains lik ely v alues add p ercen tage pro vides metho d computes maxim um lik eliho o d credible terv al class credible terv al def maxlikeinterval self interval total t prob val val prob prob val t val total prob total break return interval rst step mak e list v alues suite sorted descending order b y probabilit y w e tra v erse list adding eac h v alue terv al til total probabilit y exceeds percentage result list v alues suite notice set v alues necessarily tiguous t o visualize terv al wrote function eac h v alue according ho w man y terv al app ear def makecredibleplot suite d dict pair pair percentage p percentage interval p pair interval d pair return d d dictionary map eac h v alue suite n um b er terv al app ear lo op computes terv al sev eral p ercen tages mo di e d figure sho w result credible terv al dark est region near b ottom w f higher p ercen tages credible terv al bigger course sk ew ed w ard righ t ro chapter t w o dimension discussion c hapter sho w ba y esian framew ork previous c hapters b e extended handle t w parameter space eac h h yp othesis represen ted b y tuple parameter presen ted joint whic h paren t class pro vides metho d apply join t distribution marginal conditional makelikeinterval ob ted term joint mixin http lot new v o cabulary c hapter let review join t distribution distribution represen t p ossible v alues m ultidimensional space probability example c hapter t w space ordinate alpha beta join t distribution represen t probabilit y eac h alpha beta pair marginal distribution distribution parameter join t bution treating parameter unkno wn f example ure sho w distribution alpha beta indep enden tly conditional distribution distribution parameter join t tribution conditioned parameter figure sho w sev eral distribution alpha conditioned t v alues beta giv en join t distribution y ou compute marginal conditional butions conditional distribution y ou join t distribution appro ximately giv en marginal distribution y ou join t distribution b ecause y ou ha v e lost information ab dep endence b et w een v ariables n p ossible v alues eac h t w o parameter op erations join t distribution tak e time prop ortional d parameter run time prop ortional nd whic h quic kly b ecomes impractical n um b er dimension increase y ou pro cess million h yp otheses reasonable amoun t time y ou handle t w o dimension v alues eac h parameter dimension v alues eac h dimension v alues eac y ou need dimension v alues p er dimension mizations y ou try presen t example chapter exercise y ou wnload c hapter http f information section exercise exercise simple mo del opp onen t equally lik ely sho ot y direction exercise let consider impro v emen t mo del analysis c hapter suggests sho oter lik ely hit closest w realit y opp onen t close w unlik ely sho ot w b ecause unlik ely target b et w een w design impro v ed mo del tak e b eha vior accoun t ry nd mo del realistic o chapter t w o dimensionschapter approximate bayesian computation v ariabilit y hyp othesis ha v e soft sp ot crank science recen tly visited norum b ega t o w er whic h enduring mon umen t crac kp ot theory eb en norton horsford v en tor baking p o wder fak e history c hapter ab c hapter ab v ariabilit y hyp othesis whic h originated early nineteen th cen tury johann mec k el argued male ha v e greater range abilit y female esp ecially telligence w ords b eliev ed genius men tally retarded p eople men considered male b e erior animal mec k el concluded female lac k v ariation w sign inferiorit y f rom http hypothesis particularly lik e b ecause susp ect turn w omen actually v ariable mec k el w ould tak e sign orit y yw y y ou b e surprised hear evidence v ariabilit y hyp othesis w eak nev ertheless came m y class recen tly w e lo ok ed data cdc beha vioral risk f actor surv eillance brfss sp eci cally orted heigh t adult american men w omen dataset includes resp onses men w omen w e chapter appro ximate ba y esian computation v erage heigh t men cm v erage heigh t w omen cm men taller v erage surprise f men standard deviation cm w omen cm absolute term men heigh t v ariable compare v ariabilit y b et w een group meaningful use e cien t v ariation cv whic h standard deviation divided b y mean dimensionless measure v ariabilit y relativ e scale f men cv w omen v ery close w e conclude dataset pro vides w eak dence v ariabilit y hyp othesis w e use ba y esian metho d mak e conclusion precise answ ering question giv e c hance demonstrate tec hniques w orking large datasets pro ceed step w e start simplest implemen tation w orks datasets smaller v alues computing probability log transform w e scale size dataset computation get slo finally w e sp eed thing substan tially appro ximate ba y esian computation kno wn abc y ou wnload c hapter http f information section mean standard deviation chapter w e estimated t w o parameter sim ultaneously using join t bution c hapter w e use metho d estimate parameter gaussian distribution mean mu standard deviation sigma f problem ne suite called height represen t map eac h mu sigma pair probabilit y class height def self mu sigma pair mu sigma mean standard deviation mu mu sigma sigma self pair mu sequence p ossible v alues mu sigma sequence v alues sigma prior distribution uniform o v er mu sigma pair lik eliho o d function easy giv en h yp othetical v alues mu sigma w e compute lik eliho o d particular v alue x evalgaussianpdf e w e ha v e use class height def likelihood self data hypo x data mu sigma hypo like x mu sigma return like y ou ha v e studied statistic mathematical p ersp ectiv e y ou kno w y ou ev aluate pdf y ou probabilit y densit y order probabilit y y ou ha v e tegrate probabilit y density o v er range purp os w e need probabilit y w e just need prop ortional probabilit y w e w probabilit y densit y e job nicely hardest problem turn b e c ho osing appropriate range mu sigma range o small w e omit p ossibilities probabilit y wrong answ er range o big w e righ t answ er w aste computational p o w er opp ortunit y use classical estimation mak e ba y esian tec niques e cien sp eci cally w e use classical estimator nd lik ely lo cation mu sigma use standard error mate c ho ose lik ely spread true parameter distribution w e tak e sample ofn v alues estimator sample mean m estimator sample standard v ariance s standard error estimated standard error compute chapter appro ximate ba y esian computation def findpriorranges x compute m s n len x m x s x compute range m s s n mu makerange m s sigma makerange s return mu sigma x dataset desired n um b er v alues range width range eac h estimate n um b er standard error return v alue pair sequence mu sigma makerange def makerange estimate stderr spread stderr array return array mak e arra y equally spaced elemen t b et w een including b oth date finally mak e date suite mu sigma findpriorranges x suite height mu sigma x print pro cess migh t b ogus b ecause w e use data c ho ose range prior distribution use data date general using data t wice fact b p osterior distribution cv case really w e use data c ho ose range prior v oid computing lot probability w ould ha v e b een v ery small yw y range big v er v alues lik eliho o making bigger result prior uniform o v er v alues mu sigma tational e ciency w e ignore v alues matter p osterior distribution cv w e ha v e p osterior join t distribution mu sigma w e compute distribution cv men w omen probabilit y exceeds t o compute distribution cv w e en umerate pair mu sigma def coefvariation suite pmf mu sigma p p return pmf w e use compute probabilit y men v ariable analysis simple t w o issue w e ha v e deal size dataset increase w e run series computational problem limitation oin t arithmetic dataset tains n um b er extreme v alues tainly error w e need mak e estimation pro cess robust presence outlier follo wing section explain problem solution o w w e select rst v alues brfss dataset run analysis just describ ed run error w e p osterior distribution lo ok chapter appro ximate ba y esian computation w e select rst v alues run program w e error valueerror total probability zero problem w e using probabilit y density compute lik eliho o d density tin uous distribution tend b e small y ou tak e small v alues m ultiply result v ery small case small ca b e represen ted b y oin t n um b er get rounded wn zero whic h called o w probability distribution distribution y p ossible solution renormalize pmf eac h date eac h batc h w ould w ork w ould b e slo b etter alternativ e compute lik eliho o d log transform w y instead m ultiplying small v alues w e add log lik eliho o d pmf pro vides metho d log logupdateset exp mak e pro cess easy log computes log probability pmf class pmf def log self m x p p x x applying log transform log us maxlike nd m highest probabilit y pmf divide probability b y m highest bilit y get normalized whic h yield log log probability negativ y v alues pmf probabilit y remo v ed pmf log transform w e ca use update updateset normalize result w ould b e nonsensical y ou try pmf raise exception instead w e ha v e use logupdate logupdateset implemen tation logupdateset class suite def logupdateset self dataset data dataset data eliho o d logupdateset lo ops data call logupdate class suite def logupdate self data hypo like data hypo hypo like logupdate just lik e update call loglikelihood instead likelihood incr instead mult using eliho o d v oids problem o w pmf log transform m uc h w e w e ha v e use exp v ert transform class pmf def exp self m x p x eliho o d large negativ e n um b er resulting lik eliho o d migh t o exp nd maxim um eliho o d m shift lik eliho o d b y m resulting distribution maxim um lik eliho o d pro cess v ert log transform minimal loss precision eliho o d w w e need loglikelihood class height def loglikelihood self data hypo x data mu sigma hypo loglike x mu sigma return loglike computes eliho o d gaussian pdf date pro cess lo ok lik e x chapter appro ximate ba y esian computation t o review log put suite log transform logupdateset call logupdate whic h call loglikelihood logupdate us b ecause adding eliho o d m ultiplying b y lik eliho o date eliho o d large negativ e n um b er exp shift b efore v erting transform whic h ho w w e v oid o suite transformed bac k probability whic h mean w e use normalize using algorithm w e pro cess en tire dataset o w slo m y computer migh t tak e hour w e b etter little optimization section us math computational optimization sp eed thing b y factor follo wing section presen t algorithm ev en faster y ou w t righ t o d feel free skip section call logupdate eac h data p oin w e sp eed b y computing eliho o d en tire dataset w e start gaussian pdf compute log dropping constan t term giv en sequence v alues xi total eliho o d x pulling term dep end w e little optimization whic h w e translate python class height def logupdatesetfast self data x tuple data n len x hypo mu sigma hypo total summation x mu loglike sigma total sigma hypo loglike w ould b e small impro v emen t creates opp ortunit y bigger notice summation dep end mu sigma w e ha v e compute eac h v alue mu t o v oid recomputing factor function computes summation memoize store previously computed result dictionary http def summation x mu try return cache x mu keyerror d x x total sum d cache x mu total return total cache store previously computed sum try statemen t return result cac p ossible computes summation cac he return result catc h w e ca use list k ey cac b ecause hashable t yp wh y logupdatesetfast v ert dataset tuple optimization sp eeds computation b y ab factor cessing en tire dataset men w omen min ute m y chapter appro ximate ba y esian computation abc ma yb e y ou ha v e kind time case appro ximate ba y esian computation abc migh t b e w y motiv ation b ehind abc lik eliho o d y particular dataset v ery small esp ecially large datasets whic h wh y w e use log transform exp ensiv e compute whic h wh y w e m uc h optimization really w e w t yw y w e really care ab lik eliho o d seeing exact dataset w e sa esp ecially tin uous v ariables w e care ab lik eliho o d seeing y dataset lik e w e sa f example euro problem w e care ab order coin ip total n um b er head tail lo comotiv e problem w e care ab whic h particular train w ere seen n um b er train maxim um serial n um b er similarly brfss sample w e really w t kno w probabilit y seeing particular set v alues esp ecially h undreds thousand relev t ask w e sample p eople p opulation h yp othetical v alues w ould b e c hance collecting sample observ ed mean v ariance f sample gaussian distribution w e answ er question e cien tly b ecause w e nd distribution sample statistic analytically fact w e did w e computed range prior y ou dra w n v alues gaussian distribution parameter compute sample mean m distribution m gaussian parameter similarly distribution sample standard deviation s gaussian parameter w e use sample distribution compute lik eliho o d sample statistic m ands giv en h yp othetical v alues new v ersion logupdateset e robust estimation def logupdatesetabc self data x data n len x compute sample statistic m x s x hypo sorted mu sigma hypo compute log likelihood m given hypo sigma n loglike evalgaussianlogpdf m mu compute log likelihood s given hypo sigma loglike evalgaussianlogpdf s sigma hypo loglike m y computer function pro cesses en tire dataset ab second result agrees exact result ab digit precision robust estimation w e ready lo ok result w e ha v e problem deal n um b er outlier dataset certainly error f example adult rep orted heigh t cm whic h w ould place shortest living adult w orld t end w omen rep orted heigh t cm just short tallest w omen w orld imp ossible v alues correct unlik ely whic h mak e hard kno w ho w deal w e ha v e righ t b ecause extreme v alues ha v e disprop ortionate estimated v ariabilit y abc based summary statistic en tire dataset w e mak e robust b y c ho osing summary statistic robust presence outlier f example use sample mean chapter appro ximate ba y esian computation mean height cm cm joint distribution figure tour plot p osterior join t distribution mean standard deviation heigh t men mean height cm cm joint distribution figure tour plot p osterior join t distribution mean standard deviation heigh t w omen robust estimation standard deviation w e use median range iqr whic h b et w een p ercen tile generally w e compute ercen tile range ipr span y giv en fraction distribution p def medianipr x p cdf x median alpha ipr alpha return median ipr x sequence v alues p desired range example yield range medianipr w orks b y computing cdf x extracting median b et w een t w o p ercen tile w e v ert ipr estimate sigma using gaussian cdf compute fraction distribution v ered b y giv en n um b er standard deviation f example w wn rule th um b gaussian distribution fall standard deviation mean whic h lea v e eac h tail w e compute range b et w een p ercen tile w e exp ect result b e sigma w e estimate sigma b y computing ipr dividing b y generally w e use y n um b er sigma median p erforms general v ersion computation def median x median ipr medianipr x s ipr return median s x sequence v alues n um b er standard viations result b e based result median whic h estimate s whic h estimate finally logupdatesetabc w e replace sample mean standard deviation median s prett y m uc h e migh t o dd w e using observ ed p ercen tile estimate example exibilit y ba y esian approac w e chapter appro ximate ba y esian computation coefficient male female figure p osterior distribution cv men w omen based robust estimator asking en h yp othetical v alues sampling pro cess c hance tro ducing error lik eliho o d generating giv en set sample statistic w e free c ho ose y sample statistic w e lik e p oin t determine lo cation spread distribution w e need c ho ose statistic capture c haracteristics f example w e c hose p ercen tile w e w ould v ery little information ab spread w ould lea v e estimate relativ ely unconstrained b y data v alues sigma w ould ha v e nearly lik eliho o d pro ducing observ ed v alues p osterior distribution sigma w ould lo ok lot lik e prior v ariable finally w e ready answ er question w e started e cien t v ariation greater men w omen using abc based median ipr computed p osterior join t distribution mu sigma figure sho w result tour plot mu sigma probabilit y f eac h join t distribution computed p osterior distribution cv ure sho w distribution men w omen mean men w omen o v erlap b et w een discussion tions w e conclude near certain t y w omen v ariable heigh t men end v ariabilit y hyp othesis sadly turn result dep end c hoice ercen tile range w e conclude w omen v ariable w e conclude equal dence men v ariable reason men short stature distance mean greater ev aluation v ariabilit y hyp othesis dep end terpretation ariabilit y w e fo cu p eople near mean w e increase w e giv e w eigh t extreme t o decide whic h emphasis appropriate w e w ould need precise men t h yp othesis v ariabilit y hyp othesis ma y b e o v ague ev aluate nev ertheless help ed demonstrate sev eral new idea hop e y ou agree mak e teresting example discussion t w o w y y ou migh t think abc terpretation suggests appro ximation faster compute exact v alue remem b er ba y esian analysis alw y based mo deling decision whic h implies solution f y teresting ph ysical man y p ossible mo dels eac h mo del yield t result t o terpret result w e ha v e ev aluate mo dels terpretation abc represen t alternativ e mo del lik eliho o w e compute p djh w e asking lik eliho o d data giv en h yp othesis f large datasets lik eliho o d data v ery small whic h hin t w e migh t b e asking righ t question w e really w t kno w lik eliho o d y outcome lik e data nition y et mo deling decision underlying idea abc t w o datasets alik e yield summary statistic case lik e example c hapter ob vious whic h summary statistic c ho chapter appro ximate ba y esian computation y ou wnload c hapter http f information section exercise exercise statistic tended measure b et w een t w o group http f example w e use data brfss estimate heigh t b et w een men w omen sampling v alues p osterior distribution w e generate p osterior distribution migh t b e b etter use dimensionless measure size measured cm option use divide b y standard deviation similar w e did e cien t v ariation parameter group parameter group dimensionless size w rite function tak e join t distribution mu sigma t w o group return p osterior distribution size hin t en umerating pair t w o distribution tak e o long sider random hypothesis t esting bac k euro problem section presen ted problem macka y information ory infer enc e l e arning lgorithms statistical statemen t app eared guardian f rida y uary spun edge time belgian coin came head time tail lo ok v ery suspicious said barry bligh t statistic lecturer london sc ho ol economics coin w ere biased c hance getting result extreme w ould b e data giv e evidence coin biased fair w e estimated probabilit y coin w ould land face w e did really answ er macka y question data giv e evidence coin biased chapter prop osed data fa v h yp othesis data lik ely h yp othesis alternativ e equiv alen tly ba y e factor greater euro example w e ha v e t w o h yp otheses consider use f h yp othesis coin fair b h yp othesis biased coin fair easy compute lik eliho o d data p djf fact w e wrote function e chapter hyp othesis t esting def likelihood self data hypo x hypo head tail data like x head tail return like t o use w e create euro suite v ok e likelihood suite euro likelihood data p djf whic h e tell m uc h probabilit y seeing y particular dataset v ery small tak e t w o lik eliho o d mak e ratio w e ha v e compute p djb ob vious ho w compute lik eliho o d b b ecause ob vious mean p ossibilit y c heat lo ok data b efore w e ne h yp othesis case w e w ould sa y mean probabilit y head likelihood data v ersion b lik eliho o d lik eliho o d ratio w e w ould sa y data evidence fa v v ersion b using data form ulate h yp othesis ob viously b ogus nition y dataset w ould b e evidence fa v b unless observ ed p ercen tage head exactly making fair comparison t o mak e legitimate comparison w e ha v e ne b lo oking data let try t nition y ou insp ect belgian euro coin y ou migh t notice prominen t y ou migh t exp ect shap e ha v e x b e unsure mak e head lik ely y ou migh t sa y think coin biased thatx sure whic w e think v ersion whic h h yp othesis t w o yp otheses w e compute lik eliho o d eac h yp othesis compute v erage lik eliho o making fair comparison data data likelihood lik eliho o d ratio ba y e factor whic h mean data pro vide w eak evidence fa v generally supp ose y ou susp ect coin biased y ou ha v e clue ab v alue x case y ou migh t build suite whic h represen t yp otheses euro xrange initialize v alues remo v ed yp othesis thatx b ecause x coin fair result y ou remo v e t o compute lik eliho o d w e compute lik eliho o d eac h yp othesis accum ulate w eigh ted v erage def suitelikelihood suite data total hypo prob like data hypo total prob like return total lik eliho o d ratio whic h mean data w eak evidence compared f y ou think ab computation p erformed b y suitelikelihood y ou migh t notice similar date t o refresh y memory update function def update self data hypo like data hypo hypo like return normalize def normalize self total factor total x chapter hyp othesis t esting x factor return total return v alue normalize total probability suite whic h v erage lik eliho o d yp otheses w eigh ted b y prior probability update pass v alue instead using suitelikelihood w e compute lik eliho o d lik e likelihood data triangle prior chapter w e considered ed prior giv e higher probabilit y v alues x near w e think prior suite yp otheses w e compute lik eliho o d lik e triangleprior likelihood data lik eliho o d ratio compared f w e w ould sa y data w eak evidence b follo wing table sho w prior w e ha v e considered lik eliho o d eac h lik eliho o d ratio ba y e factor relativ e f hyp othesis lik eliho o d ba y e actor f dep ending whic h nition w e c ho ose data migh t pro vide evidence h yp othesis coin biased case relativ ely w eak evidence summary w e use ba y esian h yp othesis testing compare lik ho o d andb w e ha v e w ork sp ecify precisely b mean sp eci cation dep end bac kground information ab coin b eha vior spun p eople reasonably disagree ab righ t nition presen tation example follo w da vid macka y discussion come conclusion y ou wnload used c hapter http f information section discussion discussion ba y e factor whic h mean data pro vide evidence h yp othesis compared f previous section c haracterized evidence eak did sa y wh y p art answ er historical harold early prop onen t ba y esian statistic suggested scale terpreting ba y e factor ba y e strength f actor barely w orth men tioning substan tial strong v ery strong decisiv e example ba y e factor fa v fa v whic h w ould consider w orth men author ha v e suggested v ariations w ording t o v oid arguing ab adjectiv e w e think ab o dd instead y prior o dd y ou evidence ba y e factor y p osterior o dd term probabilit y data c hanged y degree b elief f real w orld problem c hange w ould b e small relativ e mo deling error source uncertain t y hand y ou seen evidence ba y e factor y p osterior o dd w ould b e y ou agree suc h evidence e certainly strong exercise exercise p eople b eliev e existence p tion esp example abilit y p eople guess v alue unseen pla ying card probabilit y b etter c hance y prior degree b elief kind esp y ou think lik ely exist y ou sk eptical ab w rite wn y prior o dd w compute strength evidence w ould tak e vince y ou esp lik ely exist ba y e factor w ould b e needed mak e y ou sure esp exists chapter hyp othesis t esting exercise supp ose y answ er previous question evidence ba y e factor fa v esp w ould b e su cien t c hange y mind w supp ose y ou read pap er resp ectable p ed scien ti c journal presen t evidence ba y e factor fa v esp w ould c hange y mind ho w y ou resolv e apparen t tradiction y ou migh t nd helpful read ab da vid hume article miracle http evidence terpreting sa t score supp ose y ou dean dmission small engineering college sac h usetts y ou considering t w o candidate alice bob quali cation similar man y w y exception alice got higher score math p ortion sa t standardized test tended measure preparation el w ork mathematics alice got bob got p ossible y ou migh t w t kno w evidence alice b etter prepared bob strength evidence w realit y b oth score v ery o d b oth candidate probably w ell prepared college math real dean dmission w ould probably suggest w e c ho ose candidate b est demonstrates skill attitude w e lo ok studen t example ba y esian h yp esis testing let stic k narro w er question w strong evidence alice b etter prepared bob t o answ er question w e need mak e mo deling decision start simpli cation kno w wrong w e come bac k impro v e mo del pretend temp orarily sa t question equally di cult ctually designer sa t c ho ose question range di cult y b ecause impro v e abilit y measure statistical b et w een er w e c ho ose mo del question equally di cult w e ne c haracteristic eac h er whic h probabilit y answ ering y question correctly simpli cation mak e easy compute lik eliho o d giv en chapter evidence scale order understand sa t score w e ha v e understand scoring scaling pro cess eac h er get ra w score based n um b er correct incorrect question ra w score v erted scaled score range w ere question math sa ra w score eac h er n um b er question answ ered correctly min p enalt y p oin t eac h question answ ered incorrectly college board whic h administers sa t publishes map ra w score scaled score ha v e wnloaded data wrapp ed terp olator ob ject pro vides forw ard lo okup ra w score scaled rev erse lo okup scaled score ra w y ou wnload example http f information section prior college board publishes distribution scaled score tak er w e v ert eac h scaled score ra w score divide b y n um b er question result estimate w e use distribution ra w score mo del prior distribution read pro cesses data class exam object def self readscale score readranks dict score max dividevalues exam encapsulates information w e ha v e ab exam readscale readranks read le return ob jects tain data interpolator v ert ra w scaled score bac k score list score frequency pair pmf scaled score pmf ra w score pmf prior figure prior distribution sa t er figure sho w prior distribution distribution appro ximately gaussian compressed extreme design sa t p o w er discriminate b et w een er t w o standard deviation mean p o w er outside range f eac h er ne suite called sat represen t distribution nition class sat def self exam score self exam score start prior distribution prob prob update based exam score score tak e exam ob ject scaled score mak e cop y prior distribution date based exam score usual w e inherit update suite pro vide likelihood def likelihood self data hypo chapter evidence posterior figure p osterior distribution alice bob hypo score data k score n like k n return like hypo h yp othetical v alue data scaled score t o k eep thing simple terpret ra w score n um b er correct sw er ignoring p enalt y wrong answ er simpli cation lik eliho o d giv en b y binomial distribution whic h computes y ofk correct resp onses n question p osterior figure sho w p osterior distribution alice bob based exam score w e o v erlap p ossible actually higher bob unlik ely whic h brings bac k original question w strong evidence alice b etter prepared bob w e use p osterior distribution answ er question t o form ulate question term ba y esian h yp othesis testing ne t w o h yp p osterior higher alice bob higher bob alice t o compute lik eliho o d w e en umerate pair v alues p osterior distribution add total probabilit y case higher alice bob w e ha v e function e w e ne suite computes p osterior probability andb class toplevel def update self data data b usually w e ne new suite w e inherit update pro vide likelihood case o v erride update b ecause easier ev aluate lik eliho o d b oth h yp otheses time data passed update sat ob jects represen t p osterior butions total probabilit y higher alice probabilit y higher bob probabilit y equalit y artifact decision mo del set discrete v alues w e use v alues smaller extreme tin uous zero treat kind error split ev enly b et w een creates toplevel date chapter evidence exam exam sat exam sat exam toplevel ab lik eliho o d lik eliho o d b lik eliho o d ratio ba y e factor whic h mean test score evidence alice b etter bob answ ering sa t question w e b eliev ed b efore seeing test score andb w ere equally lik ely seeing score w e b eliev e probabilit y whic h mean c hance bob actually b etter prepared b etter mo del remem b er analysis w e ha v e far based simpli cation sa t question equally di cult realit y easier whic h mean b et w een alice bob migh t b e ev en smaller ho w big mo deling error small w e conclude rst mo simpli cation question equally di o d large w e need b etter mo del section dev elop b etter mo del disco v er sp oiler alert mo deling error small y ou satis ed simple mo del y ou skip c hapter y ou w t ho w realistic mo del w orks read assume eac h er degree efficacy whic h sures abilit y answ er sa t question assume eac h question lev el difficulty finally assume c hance er answ er question rectly related efficacy difficulty according function def probcorrect efficacy difficulty return efficacy difficulty b etter mo del function simpli ed v ersion curv e used item resp onse ory whic h y ou read ab http efficacy difficulty considered b e scale probabilit y getting question righ t dep end b et w een efficacy difficulty equal probabilit y getting question righ t efficacy increase probabilit y approac he decrease difficulty increase probabilit y approac he giv en distribution efficacy er distribution difficulty question w e compute exp ected distribution ra w score w e t w o step p erson giv en efficacy w e compute distribution ra w score def pmfcorrect efficacy difficulty p probcorrect efficacy diff diff difficulty pmfs binarypmf p p p dist sum pmfs return dist difficulty list di culties eac h question p list probability pmfs list t w alued pmf ob jects function mak e def binarypmf p pmf p return pmf dist sum pmfs remem b er section w e add pmf ob jects result distribution sum order use python sum add pmfs w e ha v e pro vide whic h iden tit y pmfs pmf alw y pmf w e kno w p erson e cacy w e compute distribution ra w score f group p eople t e cacies resulting distribution ra w score mixture computes mixture class exam def makerawscoredist self efficacy chapter evidence raw model figure ctual distribution ra w score mo del t pmfs efficacy prob score pmfcorrect efficacy score prob mix pmfs return mix makerawscoredist tak e efficacy whic h pmf represen t tribution e cacy er assume gaussian mean standard deviation c hoice arbitrary probabilit y getting question correct dep end b et w een e cacy di cult y w e c ho ose unit e cacy calibrate unit di cult y accordingly pmfs tains pmf eac h lev el e cacy map fraction er lev el makemixture tak e computes distribution mixture section calibration w e w ere giv en distribution di cult y w e use makerawscoredist compute distribution ra w score problem w y w e giv en distribution ra w score w e w t infer distribution di cult y assume distribution di cult y uniform parameter p osterior distribution e cacy width makedifficulties mak e list di culties ters def makedifficulties center width n low high return low high n trying com binations yield distribution ra w score similar actual data sho wn ure assuming distribution di cult y uniform range pro ximately giv en e cacy gaussian mean standard deviation follo wing table sho w range probcorrect er t lev el e cacy di cult y e cacy e cacy t w o standard deviation ab o v e mean c hance answ ering easiest question exam c hance answ ering hardest end range t w o standard deviation b elo w mean c hance answ ering easiest question p osterior distribution e cacy w mo del calibrated w e compute p osterior distribution e cacy alice bob v ersion sat class us new mo del class def self exam score exam chapter evidence posterior figure p osterior distribution e cacy alice bob start gaussian prior efficacy self efficacy update based exam score score update v ok e likelihood whic h computes lik eliho o d giv en test score h yp othetical lev el e cacy def likelihood self data hypo efficacy hypo score data raw score pmf efficacy like raw return like pmf distribution ra w score er giv en e cacy like probabilit y observ ed score figure sho w p osterior distribution e cacy alice bob exp ected lo cation alice distribution farther righ t o v erlap using toplevel w e compare h yp othesis alice e cacy higher b h yp othesis bob higher lik eliho o d ratio bit smaller w e got simple mo del mo predictiv e distribution indicates data evidence fa v little w eak er previous estimate prior b elief andb equally lik ely ligh t evidence w e w ould giv e p osterior probabilit y lea ving c hance bob e cacy higher predictiv e distribution analysis w e ha v e far generates estimate alice bob e cacy e cacy directly observ able hard v alidate result t o giv e mo del predictiv e p o w er w e use answ er related question alice bob tak e math sa t c hance alice b etter w e answ er question t w o step w e use p osterior distribution e cacy generate predictiv e distribution ra w score eac h er w e compare t w o predictiv e distribution compute y alice get higher score w e ha v e w e need t o compute predictiv e butions w e use makerawscoredist exam exam sat exam sat exam w e nd lik eliho o d alice e b etter second test bob e b etter tie probabilit y alice e b etter second exam whic h mean bob c hance doing w ell b etter notice w e ha v e dence ab alice e cacy w e ab outcome test p osterior o dd alice e cacy higher alice b etter chapter evidence bob figure join t p osterior distribution alice bob discussion w e started c hapter question w strong evidence alice b etter prepared bob face sound lik e w e w t test t w o h yp otheses alice prepared bob order compute lik eliho o d h yp otheses w e ha v e solv e estimation problem f eac h er w e ha v e nd p osterior distribution efficacy v alues lik e called n uisance parameter b ecause w e care w e ha v e estimate answ er question w e care ab w y visualize analysis w e did c hapter plot space parameter tak e t w o pmfs computes join t distribution return join t pmf eac h p ossible pair v alues probabilit y def makejoint joint joint return joint function assumes t w o distribution indep enden figure sho w join t p osterior distribution alice bob diagonal line indicates space discussion alice bob t o righ t line alice prepared left bob prepared w e compute lik eliho o d andb w e add probabilit y mass eac h line f cell fall line w e add total mass split b et w een andb pro cess w e used c n uisance parameter order ev aluate lik eliho o d comp eting h yp common ba y esian approac h problem lik e chapter evidencechapter simulation c hapter describ e m y solution problem p osed b y patien t kidney tumor think problem imp ortan t relev t patien t tumor ctors treating think solution teresting b ecause ba y esian approac h problem use ba y e theorem implicit presen t solution m y end c hapter explain ba y esian y ou w t tec hnical presen t y ou read m y pap er w ork http kidney t umor problem frequen t reader o ccasional tributor online statistic rum http v em b er read follo wing message ha v e stage iv kidney cancer trying determine cancer formed b efore retired military giv en date retiremen t detection p ossible determine w c hance dev elop ed disease p ossible determine probabilit y retiremen t date tumor w cm x cm detection grade tacted author message got information learned v eterans t b ene t lik ely tumor formed w ere military service consideration chapter sim ulation rdt volume doubling year rdt model data figure cdf rdt doubling p er y ear renal tumor gro w slo wly cause symptom left treated result ctors observ e rate gro wth treated tumor b y comparing scan patien t t time sev eral pap er ha v e rep orted gro wth rate collected data pap er b y zhang et tacted author ra w data refused ground medical priv acy nev ertheless w able extract data needed b y prin ting graph measuring ruler rep ort gro wth rate recipro cal doubling time rdt whic h unit doubling p er y ear tumor rdt double v olume eac h y ear withrdt quadruple time rdt halv e figure sho w distribution rdt patien t square data p oin t pap er line mo del t data p ositiv e tail t exp onen tial distribution w ell used mixture t w o exp onen tials simple mo del usually o d idea start simple mo del b efore trying c hallenging simple mo del su cien t problem hand y ou use v alidate complex mo del et al distribution renal t umor gro wth rate determined b y using serial v olumetric ct measuremen t jan uary r adiolo gy simple mo del f m y simple mo del assume tumor gro w constan t doubling time sense maxim um linear measuremen t double v olume m ultiplied b y eigh learned m y corresp onden t time b et w een disc harge military diagnosis w da y ab y ear m y rst calculation w tumor grew median rate ho w big w ould ha v e b een date disc harge median v olume doubling time rep orted b y zhang et al da y suming geometry doubling time linear measure time longer time discharge diagnosis day interval doubling time linear measure doubling time volume dt number doubling discharge doubling interval dt big tumor time discharge diameter cm doubling y ou wnload c hapter http f information section result ab cm tumor formed date c harge m ust ha v e gro wn substan tially faster median rate fore concluded lik ely tumor formed b efore date disc harge addition computed gro wth rate w ould b e implied tumor formed date disc harge w e assume initial size cm w e compute n um b er doubling nal size cm assume initial linear measure cm doubling doubling chapter sim ulation linear doubling time doe imply dt interval doubling compute volumetric doubling time rdt vdt dt rdt vdt dt linear doubling time vdt v olumetric doubling time rdt recipro cal doubling time n um b er doubling linear measure whic h implies rdt data zhang et al tumor grew fast p erio d observ ation concluded lik ely tumor formed prior date disc harge calculation su cien t answ er question p osed b half m y corresp onden t wrote letter explaining m y conclusion v eterans bene t dministration later told friend oncologist ab m y result w surprised b y gro wth rate observ ed b y zhang et al b y imply ab age tumor suggested result migh t b e teresting researc ctors order mak e useful w ted general mo del relationship b et w een age size general mo del giv en size tumor time diagnosis w ould b e useful kno w probabilit y tumor formed b efore y giv en date w ords distribution age t o nd run sim ulations tumor gro wth distribution size ditioned age w e use ba y esian approac h distribution age conditioned size sim ulation start small tumor run step cho ose gro wth rate distribution rdt compute size tumor end terv al record size tumor eac h terv general mo del tumor age year cm log scale simulation tumor growth figure sim ulations tumor gro wth size time rep eat til tumor exceeds maxim um relev t size f initial size c hose cm b ecause carcinoma smaller lik ely b e v asiv e lik ely ha v e blo o d supply needed rapid gro wth http c hose terv al da y ab mon th b ecause median time b et w een measuremen t data source f maxim um size c hose cm data source range observ ed size cm w e extrap olating b ey ond observ ed range eac h end b y far w y lik ely ha v e strong result sim ulation based big simpli cation gro wth rate c hosen indep enden tly eac h terv al e dep end age size gro wth rate previous terv al section review assumption consider detailed mo dels rst let lo ok example figure sho w size sim ulated tumor function age dashed line cm sho w range age tumor size wing tumor get y ear slo w est tak e presen ting result term linear measuremen t calculation term v olume t o v ert use v olume sphere giv en chapter sim ulation implemen tation k ernel sim ulation def makesequence seq age rdt age interval final seq extendsequence age seq rdt interval final vmax break return seq iterator yield random v alues cdf gro wth rate initial v olume ml interval time step y ear vmax nal v olume corresp onding linear measuremen t cm volume v ert linear measuremen t cm v olume ml based simpli cation tumor sphere def volume diameter return factor extendsequence computes v olume tumor end terv al def extendsequence age seq rdt interval initial seq doubling rdt interval final initial doubling seq final age rdt return final age age tumor end terv al seq tuple tains v olumes far rdt gro wth rate terv al doubling p er y ear interval size time step y ear return v alues final v olume tumor end terv al new tuple taining v olumes seq plus new v olume final record age size eac h tumor end eac h terv al explained cac hing join t distribution cm log scale figure join t distribution age tumor size cac hing join t distribution ho w cac w orks class cache object def self joint join t pmf record frequency eac h pair appro ximates join t distribution age size t end eac h sim ulated terv al extendsequence call add class cache def add self age seq final seq cm diameter final bucket round cmtobucket cm age bucket age age tumor seq sequence v olumes far adding new data join t distribution w e use diameter v ert v olume diameter cen timeters def diameter volume return factor volume exp cmtobucket v ert cen timeters discrete buc k et n um b chapter sim ulation tumor age year age diameter cm cm cm cm figure distribution age conditioned size def cmtobucket x return factor x buc k ets equally spaced log scale using yield reasonable n um b er buc k ets example cm map buc k et cm map buc k et running sim ulations w e plot join t distribution color plot eac h cell represen t n um b er tumor observ ed giv en pair figure sho w join t distribution sim ulations conditional distribution taking v ertical slice join t distribution w e tion size y giv en age taking horizon tal slice w e distribution age conditioned size read join t distribution build conditional distribution giv en size class cache def conditionalcdf self bucket pmf bucket cdf return serial correlation diameter cm log scale age year interval age v diameter figure p ercen tile tumor age function size bucket teger buc k et n um b er corresp onding tumor size computes pmf age conditioned bucket result cdf age conditioned bucket figure sho w sev eral cdf s range size t o summarize distribution w e compute p ercen tile function size percentile bucket cdf conditionalcdf bucket p p p percentile figure sho w p ercen tile eac h size buc k et data p oin t computed estimated join t distribution mo del size time discrete whic h tribute n umerical error sho w square t eac h sequence p ercen tile serial correlation result far based n um b er mo deling decision let review consider whic h one lik ely source error t o v ert linear measure v olume w e assume tumor appro ximately spherical assumption probably ne tumor cen timeters v ery large chapter sim ulation distribution gro wth rate sim ulations based tin uous mo del w e c hose t data rep orted b y zhang et al whic h based patien t t appro ximate imp ortan tly larger sample w ould yield t distribution gro wth mo del e tak e accoun t tumor subt yp e grade assumption consisten t conclusion zhang et al wth rate renal tumor t size subt yp e grade represen t wide range o v erlap substan tially larger sample migh t b ecome apparen distribution gro wth rate e dep end size tumor assumption w ould b e realistic v ery small v ery large tumor gro wth limited b y blo o d supply tumor observ ed b y zhang et al ranged cm statistically signi t relationship b et w een size gro wth rate relationship lik ely b e w eak size range sim ulations gro wth rate eac h terv al indep enden t previous gro wth rate realit y plausible tumor ha v e gro wn quic kly past lik ely gro w quic kly w ords probably serial correlation gro wth rate rst problematic v estigate serial correlation rst come bac k spherical geometry t o sim ulate correlated gro wth wrote yield correlated series giv en cdf ho w algorithm w orks generate correlated v alues gaussian distribution easy b ecause w e compute distribution v alue conditioned previous v alue t ransform eac h v alue cum ulativ e probabilit y using gaussian cdf t ransform eac h cum ulativ e probabilit y corresp onding v alue using giv en cdf lo ok lik e y ou familiar python generator http generator serial correlation def correlatedgenerator cdf rho x yield transform x sigma rho true x x rho sigma yield transform x cdf desired cdf rho desired correlation v alues x gaussian transform v ert desired distribution rst v alue x gaussian mean standard deviation f subsequen t v alues mean standard deviation dep end previous v alue giv en previous x mean v alue x rho v ariance rho transform map eac h gaussian v alue x v alue giv en cdf y def transform x p x y p return y gaussiancdf computes cdf standard gaussian distribution x returning cum ulativ e probabilit y map cum ulativ e probabilit y corresp onding v alue cdf dep ending shap e cdf information b e lost transformation actual correlation migh t b e lo w er rho f example generate v alues distribution gro wth rate actual correlation w e guessing righ t correlation yw y close remem b er makesequence tak e iterator argumen face allo w w ork t generator iterator uncorrelatedgenerator cdf makesequence iterator iterator correlatedgenerator cdf rho makesequence iterator example dra wn distribution v alues uncorrelated v alues correlated e cien t appro ximately rho chapter sim ulation serial diameter p ercen tile age correlation cm t able p ercen tile tumor age conditioned size w w e serial correlation result follo ing table sho w p ercen tile age cm tumor using uncorrelated generator correlated generator target correlation mak e fastest gro wing tumor faster slo w est slo w er range age wider mo dest lo w p ercen tile p ercen tile y ear t o compute p ercen tile precisely w e w ould need b etter estimate actual serial correlation ho w ev er mo del su cien t answ er question w e started giv en tumor linear dimension cm probabilit y formed y ear ago class cache def probolder self cm age bucket cmtobucket cm cdf bucket p age return cm size tumor age age threshold y ear probolder v ert size buc k et n um b er get cdf age conditioned buc k et computes probabilit y age exceeds giv en v alue serial correlation probabilit y cm tumor older y ear certain correlation wing tumor lik ely probabilit y ev en correlation probabilit y lik ely source error assumption tumor appro ximately spherical f tumor linear dimension x cm assumption probably v alid lik ely tumor size relativ ely migh t ha v e v olume cm sphere smaller v olume correlation probabilit y age greater discussion ev en taking accoun t mo deling error unlik ely suc h large tumor ha v e formed y ear prior date diagnosis discussion w ell w e got c hapter using ba y e theorem suite class encapsulates ba y esian date happ ened w y think ab ba y e theorem algorithm v erting conditional probability giv en p bja w e compute p ajb pro vided w e kno w p andp b course algorithm useful reason easier compute p bja p ajb example running sim ulations w e estimate tion size conditioned age p sizejage harder distribution age conditioned size p agejsize lik e p erfect opp ortunit y use ba y e theorem reason did computational e ciency t o estimate p sizejage y giv en size y ou ha v e run lot sim ulations w y y ou end computing p sizejage lot size fact y ou end computing en tire join t distribution size age p size age y ou ha v e join t distribution y ou really need ba y e rem y ou extract p agejsize b y taking slice join t distribution demonstrated conditionalcdf w e ed ba y e w chapter sim ulationchapter hierarchical model geiger coun ter problem got idea follo wing problem t om campb k etts author maxim um en trop y blog http com got idea ja ynes author classic pr ob ability ory l o gic scienc e supp ose radioactiv e source emits particle w ard geiger coun ter v erage rate r particle p er second coun ter register fraction f particle hit f coun ter register particle second terv al p osterior distribution n actual n um b er particle hit coun ter r v erage rate particle emitted t o started problem lik e think ab c hain causation start parameter end observ ed data source emits particle v erage rate r y giv en second source emits n particle w ard coun ter n particle n um b er k coun ted probabilit y atom deca y y p oin t time dioactiv e deca y w ell mo deled b y p oisson pro cess giv en r distribution ofn p oisson distribution parameter r w e assume probabilit y detection eac h particle p enden t distribution k binomial distribution parameter n andf chapter hierarc hical mo del number particle n figure p osterior distribution n v alues r giv en parameter w e nd distribution data w e solv e called forw ard problem w w e w t w y giv en data w e w t distribution parameter called v erse problem y ou solv e forw ard problem y ou use ba y esian metho d solv e v erse problem start simple let start simple v ersion problem w e kno w v alue r w e giv en v alue f w e ha v e estimate n ne suite called detector mo dels b eha vior detector estimatesn class detector def self r f pmf r high self pmf r f v erage emission rate r particle p er second distribution n p oisson parameter r high step determine upp er b ound n step size b et w een h yp othetical v alues w w e need lik eliho o d mak e hierarc hical class detector def likelihood self data hypo k data n hypo p return k n p data n um b er particle detected hypo h yp othetical n um b er particle emitted n actually n particle probabilit y detecting y isf probabilit y detecting k particle giv en b y binomial distribution detector w e try range v alues r f k r suite detector r f k print figure sho w p osterior distribution n sev eral giv en v alues r mak e hierarc hical previous section w e assume r kno wn w let relax assumption ne suite called emitter mo dels b eha vior emitter estimate r class emitter def self r detector detector r f r r self detector r sequence h yp othetical v alue r detector sequence detector ob jects eac h v alue r v alues suite detector emitter suite tains suite v chapter hierarc hical mo del t o date emitter w e ha v e compute lik eliho o d data eac h h yp othetical v alue r eac h v alue r represen ted b y detector tains range v alues n t o compute lik eliho o d data giv en detector w e lo op v alues n add total probabilit y k suitelikelihood e class detector def suitelikelihood self data total hypo prob like data hypo total prob like return total w w e write lik eliho o d function emitter class emitter def likelihood self data hypo detector hypo like data return like eac h hypo detector w e v ok e suitelikelihood lik ho o d data h yp othesis w e date emitter w e ha v e date eac h detector o class emitter def update self data self data detector mo del lik e m ultiple lev el suite called hierarc hical little optimization y ou migh t recognize suitelikelihood w e sa w section t time p oin ted w e did really need b ecause total probabilit extracting p osteriors emission r posterior n figure p osterior distribution n andr computed b y suitelikelihood exactly normalizing constan t computed returned b y update instead dating emitter dating detector w e b oth step time using result lik eliho o d emitter streamlined v ersion class emitter def likelihood self data hypo return data v ersion likelihood w e use default v ersion update v ersion er line run faster b ecause e compute normalizing constan t t wice extracting p osteriors w e date emitter w e p osterior distribution r b y lo oping detector probability class emitter def distofr self item prob detector prob return item chapter hierarc hical mo del item list v alues r probability result pmf r t o p osterior distribution n w e ha v e compute mixture detector w e use whic h tak e map eac h distribution probabilit y exactly emitter class emitter def distofn self return self figure sho w result surprisingly lik ely v alue n giv en f andn exp ected coun t giv enf andk exp ected v alue n whic h particle emitted second lik ely v alue r particle p er second p osterior distribution r cen tered p osterior distribution r andn similar w e sligh tly certain ab n general w e b e certain ab emission rate r ab n um b er particle emitted y particular second n y ou wnload c hapter http f information section discussion geiger coun ter problem demonstrates connection b et w een causation hierarc hical mo deling example emission rate r causal n um b er particle n whic h causal particle coun t k hierarc hical mo del ect structure cause b ottom t lev el w e start range h yp othetical v alues r f eac h v alue r w e ha v e range v alues n prior distribution n dep end r exercise w e date mo del w e b w e compute p rior distribution n eac h v alue r compute p osterior distribution r causal information o w wn hierarc h y inference o w exercise exercise exercise inspired b y example ja ynes pr ob bility ory supp ose y ou buy mosquito trap supp osed reduce p opulation mosquito e near y house eac h w eek y ou empt y trap coun t n um b er mosquito e captured rst w eek y ou coun t mosquito e second w eek y ou coun t mosquito e estimate p ercen tage c hange n um b er mosquito e y y ard t o answ er question y ou ha v e mak e mo deling decision suggestion supp ose eac h w eek large n um b er mosquito e n bred w etland near y home w eek fraction w ander y y ard fraction caugh t trap y solution tak e accoun t y prior b elief ab ho w m uc h n lik ely c hange w eek y ou b y adding lev el hierarc h y mo del p ercen t c hange n chapter hierarc hical mo delchapter dealing dimension belly button bacteria belly button bio div ersit y citizen science pro ject goal iden tifying bacterial sp ecies b e h uman na v el http pro ject migh t sical increasing terest h uman microbiome set micro organism liv e h uman skin part b o dy pilot study researc collected sw ab na v el v olun teers used m ultiplex p yrosequencing extract sequence fragmen t rdna iden ti ed sp ecies gen fragmen t came eac h iden ti ed fragmen t called w e use data answ er sev eral related question based n um b er sp ecies observ ed w e estimate total n um b er sp ecies en vironmen t w e estimate prev alence eac h sp ecies fraction total p opulation b elonging eac h sp ecies w e planning collect additional sample w e predict ho w man y new sp ecies w e lik ely disco v er ho w man y additional read needed increase fraction serv ed sp ecies giv en threshold question mak e called unseen sp ecies problem chapter dealing dimension lion tiger b ear start simpli ed v ersion problem w e kno w exactly sp ecies let lion tiger b ear supp ose w e visit wild animal preserv e lion tiger b ear w e ha v e equal c hance observing y animal preserv e n um b er eac h sp ecies w e v erned b y m ultinomial distribution prev alence lion tiger b ear lik eliho o d seeing lion tiger b ear prop ortional approac h tempting correct use b eta distribution section describ e prev alence eac h sp ecies separately f example w e sa w lion w e think p osterior distribution beta print maxim um lik eliho o d estimate observ ed rate ilarly mles t w o problem w e ha v e implicitly used prior eac h sp ecies uniform w e kno w sp ecies prior correct righ t prior ha v e mean b e zero lik eliho o d y sp ecies prev alence distribution eac h sp ecies indep enden t b ecause prev alences ha v e add t o capture dep endence w e need join t distribution prev alences w e use diric hlet distribution solv e b oth problem http w y w e used b eta distribution describ e distribution bias coin w e use diric hlet distribution describ e join t distribution diric hlet distribution m generalization b eta distribution instead t w o p ossible outcome lik e head tail diric hlet distribution handle y n um b er outcome example sp lion tiger b ear n outcome diric hlet distribution describ ed b y n parameter written n nition class represen t diric let distribution class dirichlet object def self n n n n n um b er dimension initially parameter use numpy arra y store parameter tak e adv tage arra y op erations giv en diric hlet distribution marginal distribution eac h prev alence b eta distribution whic h w e compute lik e def marginalbeta self alpha return beta alpha index marginal distribution w e w sum parameter alpha parameter giv en sp ecies example prior marginal distribution eac h sp ecies beta w e compute prior mean lik e dirichlet range beta print exp ected prior mean prev alence eac h sp ecies t o date diric hlet distribution w e add observ ations parameter lik e def update self data m len data m data data sequence coun t order params example b e n um b er lion tiger b ear data b e shorter params case sp ecies ha v e b een observ ed date dirichlet observ ed data computes p osterior marginal chapter dealing dimension tiger bear figure distribution prev alences sp ecies data data range beta pmf print figure sho w result p osterior mean prev alences hierarc hical v ersion w e ha v e solv ed simpli ed v ersion problem w e kno w ho w man y sp ecies w e estimate prev alence eac w let bac k original problem estimating total n um b er sp ecies t o solv e problem ne whic h suite tains suite h yp otheses case el suite tains h yp otheses ab n um b er sp ecies b ottom lev el tains h yp otheses ab prev alences class nition class specie def self n hierarc hical v ersion hypo n n n self hypo tak e list p ossible v alues n mak e list diric hlet ob jects creates el suite n range suite specie n n list p ossible v alues n w e ha v e seen sp ecies ha v e b e man y c hose upp er b ound reasonable w e c hec k later probabilit y exceeding b ound lo initially w e assume y v alue range equally lik ely t o date hierarc hical mo del y ou ha v e date lev el usually y ou ha v e date b ottom lev el rst w ork case w e date lev el rst class specie def update self data self data hypo data v ok e update paren t class lo ops yp otheses date w w e need lik eliho o d function class specie def likelihood self data hypo dirichlet hypo like range like data return like data sequence observ ed coun t hypo diric hlet ob ject call time return total wh y time e actually compute lik eliho o d data diric hlet chapter dealing dimension instead dra w sample h yp othetical distribution computes lik eliho o d data sampled set prev alences lo ok lik e class dirichlet def likelihood self data m len data m return x data p q p m x return length data n um b er sp ecies observ ed w e sp ecies w e t existed lik eliho o d w e select random set prev alences p compute m mial pmf whic h n pi prev alence th sp ecies xi observ ed n um b er rst term cx m ultinomial e cien t lea v e computation b ecause m ultiplicativ e factor dep end data h yp othesis get normalized w y http m n um b er observ ed sp ecies w e need rst m elemen t p xi sopxi w e lea v e pro duct random sampling t w o w y generate random sample diric hlet bution use marginal b eta distribution case y ou ha v e select time scale rest add http ob vious faster w y select v alues n gamma distribution normalize b y dividing b y total random sampling number figure p osterior distribution n class dirichlet def random self p return p w w e ready lo ok result extract p osterior distribution n def distofn self pmf hypo prob prob return pmf distofn iterates el h yp otheses accum ulates abilit y eac h n figure sho w result lik ely v alue v alues reasonably lik ely probability drop quic kly probabilit y sp ecies lo w b e negligible w e c hose higher b ound w e w ould nearly result remem b er result based uniform prior n w e ha v e bac kground information ab n um b er sp ecies en vironmen t w e migh t c ho ose t chapter dealing dimension optimization ha v e admit proud example unseen sp ecies problem easy think solution simple clear tak e surprisingly line ab far problem slo o d example observ ed sp ecies o d b elly button data sp ecies sample section presen t series optimization w e need mak e solution scale w e detail road map rst step recognize w e date diric hlet distribution data rst m parameter n um b er h yp othetical unseen sp ecies w e really need n diric hlet ob jects w e store parameter lev el hierarc h y implemen t optimization us set random v alues h p otheses sa v e time generating random v alues second b ene t turn b e imp ortan t b y giving h yp otheses selection sample space w e mak e comparison b et w een h yp otheses fair tak e er iteration v erge ev en c hanges ma jor p erformance problem n um b er observ ed sp ecies increase arra y random prev alences get bigger c hance c ho osing appro ximately righ t b ecomes small v ast ma jorit y iteration yield small lik eliho o d tribute m uc h total discriminate b et w een h yp otheses solution date sp ecies time simple implemen tation strategy using diric hlet ob jects represen t yp otheses finally com bine yp otheses lev el us numpy arra y op erations sp eed thing y ou terested detail feel free skip section w e lo ok result b elly button collapsing hierarc h y collapsing hierarc h y b el diric hlet distribution dated data rst m parameter w e eliminate merge parameter el suite implemen t optimization class object def self n n len n n list h yp othetical v alues n probs list corresp onding probability params sequence diric hlet parameter initially date b oth lev el hierarc h y rst probabilit y eac h v alue n diric hlet parameter class def update self data like len range like data like m len data m data samplelikelihood return arra y lik eliho o d eac h v alue n like accum ulates total lik eliho o d sample m tiplied b y total lik eliho o d normalized t w o line whic h date parameter w let lo ok samplelikelihood t w o opp ortunities mization h yp othetical n um b er sp ecies n exceeds observ ed n b er m w e need rst m term m ultinomial pmf rest chapter dealing dimension n um b er sp ecies large lik eliho o d data migh t b e o small oin t safer compute lik eliho o d m ultinomial pmf n eliho o d whic h fast easy compute cx h yp otheses w e drop class def samplelikelihood self data gamma m len data row gamma m col gamma n p row col term data p like coefs n m n like coefs return like gamma arra y v alues gamma distribution length largest h yp othetical v alue n row just rst m elemen t gamma elemen t dep end data one w e problem f eac h v alue n w e need divide row b y total rst n v alues gamma cumsum computes cum ulativ e sum store col lo op iterates v alues n accum ulates list lik eliho o d inside lo op p tains ro w probability normalized appropriate cum ulativ e sum term tains term summation xilogpi tains sum lo op w e w t v ert eliho o d linear lik eliho o d rst o d idea shift largest eliho o d w y linear lik eliho o d o small finally b efore w e return lik eliho o d w e ha v e apply correction factor whic h n um b er w y w e ha v e observ ed m sp ecies total n um b er sp ecies n binomialcoefficient computes c ho ose whic h happ en optimized v ersion readable original reason think o d idea start simple v ersion w e use regression testing plotted result b oth v ersions rmed appro ximately equal v erge n um b er iteration increase problem w e optimize problem w e need x rst n um b er observ ed sp ecies increase v ersion get noisier tak e iteration v erge o d answ er problem prev alences w e c ho ose diric hlet tion p appro ximately righ t lik eliho o d observ ed data close zero equally bad v alues n tions pro vide y useful tribution total lik eliho o n um b er observ ed sp ecies m get large probabilit y c ho osing p lik eliho o d get small really small f ortunately solution remem b er y ou observ e set data y ou date prior distribution en tire dataset y ou break series date subset data result w y chapter dealing dimension f example k ey p erform date sp ecies time w y w e generate random set p computed lik eliho o d c hance c ho osing o d m uc h b etter new v ersion date sp ecies time class specie def update self data m len data range m data self v ersion inherits specie represen t h yp otheses list diric hlet ob jects unlik e update lo ops observ ed sp ecies mak e arra y zero sp ecies coun call update paren t class whic h computes lik eliho o d date yp otheses running example w e date rst lik e ha v e seen second ha v e seen t w o tiger additional ha v e seen b ear lion new v ersion likelihood class def likelihood self data hypo dirichlet hypo like range like data correct number unseen specie new m len data m like return like factor correction necessary b ecause eac h time w e sp w e y et rst time w e ha v e consider w ere n um b er unseen sp ecies w e migh t ha v e seen f larger v alues n unseen sp ecies w e ha v e seen whic h increase lik eliho o d data subtle p oin t ha v e admit did righ t rst time w able v alidate v ersion b y comparing previous v ersions w e y et p erforming date sp ecies time solv e problem creates eac h date tak e time prop ortional km wherek n um b er h yp otheses m n um b er observ ed sp ecies w e m date total run time prop ortional w e sp eed thing using tric k w e used section w e rid diric hlet ob jects collapse t w o lev el hierarc h y single ob ject y et v ersion specie class def update self data m len data range m data data v ersion inherits us n probs represen t distribution n params represen t parameter diric hlet distribution update similar w e sa w previous section lo ops observ ed sp ecies call updateone class def updateone self count like len range like count n like chapter dealing dimension like function similar t w o c hanges terface instead dataset w e index observ ed sp ecies count ho w man y sp ecies w e v e seen w e ha v e apply correction factor n um b er unseen sp ecies w e date lik eliho o d arra y m ultiplication finally samplelikelihood class def samplelikelihood self count gamma sum gamma p gamma sum p count like return like similar eac h date includes single sp ecies w e need lo op run time function prop ortional n um b er h yp otheses k runsm time run time date prop ortional km n um b er iteration w e need accurate result usually small b elly button data ab lion tiger b ear let bac k b elly ton t o sense data lo ok lik e consider sub ject sample read yielded sp ecies follo wing coun b elly button data dominan t sp ecies mak e large fraction man y sp ecies yielded single read n um b er suggests lik ely b e unseen sp ecies example lion tiger w e assume eac h animal preserv e equally lik ely b e observ ed similarly b elly button data w e assume eac h bacterium equally lik ely yield read realit y eac h step pro cess migh t tro duce bias sp ecies migh t b e lik ely b e pic k ed b y sw ab yield iden ti able amplicons w e talk ab prev alence eac h sp ecies w e remem b er source error ac kno wledge using term lo osely bacterial sp ecies w ell ned second read iden tify ular sp ecies iden tify gen t o b e precise sa y erational taxonomic otu w let pro cess b elly button data ne class called subject represen t information ab eac h sub ject study class subject object def self code code eac h sub ject string lik e list coun t sp ecies pair sorted increasing order b y coun subject pro vides sev eral metho d mak e easy access coun t sp ecies name y ou detail http f information section subject pro vides metho d named process creates date suite whic h represen t distribution n prev alences pro vides distofn whic h return p osterior distribution n class def distn self chapter dealing dimension number figure distribution n sub ject item zip pmf item return pmf figure sho w distribution n sub ject probabilit y exactly sp ecies unseen sp ecies nearly zero lik ely v alue credible terv al t high end unlik ely man y sp ecies w e compute p osterior distribution prev alence eac h sp ecies pro vides distofprevalence class def distofprevalence self index metapmf n prob zip beta n index pmf pmf prob mix metapmf return metapmf mix index indicates whic h sp ecies w e w f eac h n w e ha v e t p rior distribution prev alence lo op iterates p ossible v alues n probability f eac h v alue n get beta ob ject represen ting marginal distribution predictiv e distribution figure distribution prev alences sub ject indicated sp ecies remem b er beta ob jects tain parameter alpha beta ha v e v alues probability lik e pmf pro vide makepmf whic h generates discrete appro ximation tin uous b eta distribution metapmf tains distribution prev alence tioned n makemixture com bine mix whic h com bine conditional distribution single distribution prev alence figure sho w result v e sp ecies read prev alen t sp ecies accoun t read certainly unseen sp ecies lik ely estimate prev alence credible terv al b et w een predictiv e distribution tro duced hidden sp ecies problem form related question w e ha v e answ ered rst t w o b y computing p osterior distribution n prev alence eac h sp ecies t w o question w e planning collect additional read w e predict ho w man y new sp ecies w e lik ely disco v er ho w man y additional read needed increase fraction serv ed sp ecies giv en threshold chapter dealing dimension specie figure sim ulated rarefaction curv e sub ject t o answ er predictiv e question lik e w e use p osterior distribution sim ulate p ossible future ev en t compute predictiv e distribution n um b er sp ecies fraction total w e lik ely k ernel sim ulations lo ok lik e cho ose n p osterior distribution cho ose prev alence eac h sp ecies including p ossible unseen sp ecies using diric hlet distribution generate random sequence future observ ations compute n um b er new sp ecies function n b er additional read k rep eat previous step accum ulate join t distribution k runsimulation run single sim ulation class subject def runsimulation self m seen n observation curve k ob enumerate observation predictiv e distribution ob len seen m return curve n um b er additional read sim ulate m n um b er seen sp ecies seen set string unique eac h sp ecies n random v alue p osterior distribution observation random sequence sp ecies name eac h time lo op w e add new observ ation seen record n um b er read n um b er new sp ecies far result runsimulation rarefaction curv e represen ted list pair n um b er read n um b er new sp ecies w e result let lo ok getseenspecies generateobservations class subject def getseenspecies self name m len name seen set speciesgenerator name m return m seen getnames return list sp ecies name app ear data le man y sub jects name unique use speciesgenerator extend eac h serial n um b er def speciesgenerator name num name yield d num yield d giv en lik e corynebacterium speciesgenerator yield list name exhausted yield name lik e generateobservations chapter dealing dimension class subject def generateobservations self n prevalence name speciesgenerator name n d dict zip prevalence cdf d observation return n observation n um b er additional read generate n prevalence sample p osterior distribution cdf cdf ob ject map sp ecies name including unseen m ulativ e probability using cdf mak e e cien t generate random sequence sp ecies name finally def sampleposterior self pmf n prevalence n return n prevalence sampleprevalences whic h generates sample prev alences conditioned n class def sampleprevalences self n params n gamma params gamma return gamma w e sa w algorithm generating random v alues diric hlet tion section figure sho w sim ulated rarefaction curv e sub ject curv e shifted eac h curv e b y random w ould o v erlap insp ection w e estimate read w e lik ely nd new sp join t p osterior new figure distribution n um b er new sp ecies conditioned n um b er additional read join t p osterior w e use sim ulations estimate join t distribution k w e distribution conditioned y v alue k def makejointpredictive curve joint curve curve k curve k return joint makejointpredictive mak e join t ob ject whic h pmf v alues tuples curve list rarefaction curv e created b y runsimulation eac h curv e tains list pair k resulting join t distribution map eac h pair probabilit y o ccurring giv en join t distribution w e use distribution conditioned k section tak e list k computes conditional distribution eac h k result list cdf ob jects def makeconditionals curve k joint makejointpredictive curve chapter dealing dimension fraction specie figure complemen tary cdf v erage range additional read cdfs k k pmf k d k cdf cdf return cdfs figure sho w result read median predicted n um b er new sp ecies credible terv al read w e exp ect new sp ecies v erage question w e w t answ er w man y additional read needed increase fraction observ ed sp ecies giv en threshold t o answ er question w e need v ersion runsimulation computes fraction observ ed sp ecies n um b er new sp ecies class subject def runsimulation self m seen n observation v erage curve k ob enumerate observation ob len seen float n return curve w e lo op eac h curv e mak e dictionary d map n um b er additional read k list fracs list v alues v erage ac hiev ed k read def makefraccdfs self curve d curve curve k frac curve k frac cdfs k fracs cdf fracs cdfs k cdf return cdfs eac h v alue k w e mak e cdf fracs cdf represen t distribution v erage k read remem b er cdf tell y ou probabilit y falling b elo w giv en threshold c omplementary cdf tell y ou probabilit y exceeding figure sho w complemen tary cdf s range v alues k t o read gure select lev el v erage y ou w t ac hiev e x example c ho ose w y ou read c hart nd probabilit y ac hieving v age k read f example read y ou ha v e ab c hance getting v erage read y ou ha v e c hance getting v erage w e ha v e answ ered question mak e unseen sp ecies problem t o v alidate algorithm c hapter real data deal detail c hapter o long w o discus chapter dealing dimension y ou read ab problem ho w addressed http y ou wnload c hapter http f information section discussion unseen sp ecies problem area activ e researc h b eliev e algorithm c hapter v el tribution er page w e ha v e basic probabilit y researc h fron tier v ery happ y ab goal b o ok presen t related idea ba y esian thinking foundation ba y esian analysis idea using probabilit y distribution represen t uncertain b eliefs using data date distribution using result mak e prediction inform decision computational approac h premise b o ok easier understand ba y esian analysis using computation math easier implemen t ba y esian metho d reusable building blo c k b e rearranged solv e orld problem quic kly iterativ e mo deling orld problem v olv e mo deling cisions b et w een realism complexit y p ossible kno w ahead time factor b e included mo del whic h b e abstracted w y b est approac h ate starting simple mo dels adding complexit y gradually using eac h mo del v alidate idea v ersatile p o w erful applicable problem ev ery area science engineering simple example topic curren t researc y ou far y ou b e prepared apply ols new problem relev t y w ork hop e y ou nd useful let kno w ho w e index abc abstract t yp e anaconda vii appro ximate ba y esian computation arriv al rate axtell rob ert bacteria ba y e factor ba y e theorem deriv ation o dd form ba y esian framew ork beha vioral risk f actor surv eillance b elly button bernoulli pro cess b eta distribution beta ob ject biased coin binomial e cien t binomial distribution binomial lik eliho o d function bio div ersit y b ogus boston boston bruin brfss buc k et bus stop problem cac calibration campb k etts t om causation cdc cdf cen ters disease trol cen tral credible terv al classical estimation clone vii e cien t v ariation coin toss collectiv ely exhaustiv e college board complemen tary cdf concrete t yp e conditional distribution conditional probabilit y conjoin t probabilit y conjugate prior conjunction tin uous distribution tributors ix v ergence okie problem y correlated random v alue v erage crank science credible terv al crom w ell rule crom w ell oliv er cum ulativ e distribution function cum ulativ e probabilit y index cum ulativ e sum da cameron decision analysis degree b elief densit y dep endence diac hronic terpretation dice dice problem dice problem diric hlet distribution distribution op erations doubling time dungeon dragon e cacy en umeration error esp euro problem evidence exception exp onen tial distribution exp onen tiation p erception fair coin fork vii forw ard problem gamma distribution gaussian distribution gaussian pdf gee stev e geiger coun ter problem generator german tank problem vii github vii gro wth rate heart attac k heigh t heuer andreas hierarc hical mo del hoag dirk ho c k ey horse racing horsford eb en norton hume da vid h yp othesis testing implemen tation indep endence informativ e prior insect sampling problem installation viii range terface tuition v erse problem iqr item resp onse theory iterativ e mo deling iterator ja ynes join t join t distribution join t ob ject join t pmf kde k ernel densit y estimation kidney tumor problem square t ligh t bulb problem lik eliho o d lik eliho o d lik eliho o d function lik eliho o d ratio linspace lion tiger b ear lo comotiv e problem log scale log transform eliho o d logarithm m m problem macka y da vid mak emixture marginal distribution matplotlib viii maxim um maxim um lik eliho o d mean squared error mec k el johann median memoization microbiome mixture mo deling v mo deling error mon t y hall problem mosteller f rederic k mult m ultinomial e cien t m ultinomial distribution m utually exclusiv e national ho c k ey league v el nhl normal distribution normalize normalizing constan t n uisance parameter numpy viii n ump y ob jectivit y observ er bias o dd olin college oliv er blo o d problem op erational taxonomic unit optimization otu o v ertime p ain tball problem parameter pdf pdf pep viii p ercen tile pmf pmf class pmf metho d p oisson distribution p oisson pro cess vi p osterior p osterior distribution p o w er la w predictiv e distribution prev alence price righ t prior index prior distribution prob probabilit y conditional conjoin t probabilit y densit y probabilit y densit y function probabilit y mass function pro cess pseudo color plot p yrosequencing radioactiv e deca y random sample rarefaction curv e ra w score rdna red line problem reddit regression testing vii renormalize rep ository vii robust estimation sample bias sample statistic sa t scaled score scipy viii scip y serial correlation sho w case sim ulation sivia sp ecies sphere standardized test stic k stra ng sp eed sub jectiv e prior sub jectivit y sudden death suite class summary statistic sw amping prior switc h table metho d template metho d pattern total probabilit y triangle distribution trigonometry tumor t yp e tuple uncertain t y o w uniform distribution uniform distribution uninformativ e prior unseen sp ecies problem date v ancouv er uc k v ariabilit y hyp othesis v eterans bene t dministration v olume w eibull distribution w ord frequency