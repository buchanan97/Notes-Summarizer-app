operating system middleware supporting controlled interaction max hailperin gustavus adolphus college revised edition july c max hailperin work licensed creative common unported license view copy license visit http send letter creative common second street suite san francisco california usa cover cover photo show treasury coming view end siq le leading ancient nabatean city petra jordan siq narrow winding passage cut deep sandstone primarily natural geological force improved nabateans petra thriving spice trading city prosperity linked factor including location important trade route access water sophisticated hydraulic engineering easily defensible character siq played important role aspect water conduit built wall siq oor siq just wide le merchant caravan camel remaining narrow serve route attack operating system middleware provide conducive environment application program interact controlled manner petra served spice merchant year ago access communication resource remain important doe provision tightly controlled interface ensure security photo rhys davenport released creative mon attribution generic license photo available web http www familyivcontents preface xi introduction chapter overview operating middleware objective book multiple computation computer interaction computation supporting interaction time supporting interaction space security thread introduction example multithreaded program reason using concurrent thread switching thread preemptive multitasking security thread scheduling introduction thread state scheduling goal throughput response time urgency importance resource allocation scheduling vvi content scheduling earliest deadline scheduling decay usage scheduling scheduling security scheduling synchronization deadlock introduction race need mutual exclusion mutexes monitor mutex application programming interface monitor structured interface mutexes underlying mechanism mutexes synchronization pattern bounded bu er lock barrier condition variable semaphore deadlock deadlock problem deadlock prevention resource ordering ex post facto deadlock detection immediate deadlock detection interaction priority inversion convoy phenomenon nonblocking synchronization security synchronization atomic transaction introduction example application transaction database system system journaled file system mechanism ensure atomicity serializability locking failure atomicity undo logging transaction durability logging vii additional transaction mechanism increased transaction concurrency reduced isolation coordinated transaction participant mit security transaction virtual memory introduction us virtual memory private storage controlled sharing flexible memory allocation sparse address space persistence program loading zero filling substituting disk storage ram mechanism virtual memory interface linear page table multilevel page table hashed page table segmentation policy virtual memory fetch policy placement policy replacement policy security virtual memory process protection introduction posix process management api protecting memory foundation protection processor mode mainstream multiple address space system alternative single address space system representing access right fundamental access right capability access control list credential content alternative granularity protection protection process protection entire simulated machine security protection file persistent storage introduction disk storage technology posix file api file descriptor mapping file virtual memory reading writing file speci ed position sequential reading writing disk space allocation fragmentation locality allocation policy mechanism metadata data location metadata access control metadata metadata directory indexing file directory versus database index using index locate file file linking directory index data structure metadata integrity polymorphism file implementation security persistent storage networking introduction network internet protocol layer principle networking role operating system ware application software application layer web typical example ix domain application layer frastructure distributed file system application viewed operating system transport layer socket apis tcp dominant transport protocol evolution tcp network layer ip version routing label switching network address translation end link physical layer network security security protocol layer firewall intrusion detection system cryptography messaging rpc web service introduction messaging system remote procedure principle operation rpc example using java rmi web service security communication middleware security introduction security objective principle user authentication password capture using spoo ng phishing checking password storing password multiple independent system authentication access control virus worm security assurance security monitoring key security best practice content stack storage concept representing stack memory using stack procedure activation bibliography index suppose sit computer check email message includes attached document edit click attachment open window start ing document realize need leave trip save document partially edited state shut computer save energy gone returning boot computer open document continue editing scenario illustrates computation interact fact strates kind interaction computation case computation provides data email program retrieves new mail server using internet bridge space ond email program provides attachment word processor using operating service couple application gram invocation word processor running trip provides partially edited document invocation running return using disk storage bridge time book learn kind interaction case interesting software technique needed order bring computation contact arm length compromise reliability exciting challenge supporting controlled interaction includes support computation share single computer interact email word processing program includes support data storage network communication book describes kind support provided operating system additional software layered operating system known middleware xixii preface audience computer science student want stand contemporary operating system middleware product work work way book book nd form balance application programmer view focused service software provides balanced perspective focused mechanism used provide service timeless concept balanced concrete example concept embodied range currently popular system gramming balanced intellectual activity scienti c measurement performance strategic consideration tem security human business context programming language used example balanced example java c limited portion language used example serve learning opportunity bling block system used example example book drawn dominant family operating system microsoft window unix family including especially linux mac o using range system mote student exibility allows comprehensive array concept concretely illustrated system embody fundamentally di erent approach problem scheduling processor time tracking le disk space example drawn stable core portion operating system equally applicable range ci c version microsoft window mentioned speci cation material apply window nt window window xp window server window vista window dows window window window linux example version material applies version actual linux source code shown ne tail matter reason speci c subversion mentioned note mac o x example originated version known tiger applicable xiii book discusses protection process memory additional operating brought mix example order illustrate comprehensive range alternative design ibm iseries known embodies interesting approach protection wider application current student time giving process address space linux window mac o x iseries allows process share single address space hold varying access permission individual object space middleware system used example cle database used illustrate deadlock detection recovery use atomic transaction messaging system appear application atomic transaction important form communication middleware supporting distributed application ci c messaging example drawn ibm websphere mq mqseries java message service jms interface java enterprise edition communication dleware example java rmi remote method invocation organization text chapter provides overview text explaining operating middleware sort support system provide controlled interaction chapter work variety controlled tion exempli ed scenario beginning preface teraction concurrent computation email program word processor interaction time word processor trip word processor trip interaction space email program service provider email server rst topic controlled interaction tions operating time particular computer interaction make sense need understand single computer running program email program window word processing program chapter explains fundamental mechanism dividing computer attention concurrent computation known thread chapter continues related topic scheduling computer dividing itsxiv preface time computation need decide one work moment concurrent computation explained chapter introduces trolled interaction explaining synchronization control thread relative timing example chapter explains email program sends document word processor word processor constrained read document email program writes particularly important form tion atomic transaction topic chapter atomic transaction group operation place indivisible unit commonly supported middleware playing increasing role operating system synchronization main way operating system trol interaction computation controlling access memory chapter explains achieved using technique known virtual memory chapter explains objective technique serve virtual memory serf foundation chapter topic process process fundamental unit computation protected access just thread fundamental unit computation concurrency process group thread share protection environment particular share access virtual memory chapter outside limitation single puter operating single session consider document stored trip available chapter explains persistent storage mechanism focusing particularly le storage ing system provide second consider interaction email program service provider email server chapter provides overview networking including service operating system make available program email client server chapter tends discussion sophisticated form support provided communication middleware messaging system rmi web service finally chapter focus security security pervasive issue preceding chapter provide information speci cally nal section chapter point way curity relates chapter particular topic coverage distributed book chapter speci cally security needed primarily elevate technical particular talk general principle human organizational context surroundingpreface xv computer technology best way use chapter consecutive order chapter omitted minor harm chapter chapter omitted student familiar networking relationship computer science curriculum operating system traditionally subject course required computer science major recent year increasing idea course centered particular artifact operating system cutting concept particular computing curriculum interim revision computer science curriculum vide encouragement approach option college university retain relatively traditional operating system course book steer middle course moving tion concern retaining familiarity broadly adoptable following table indicates placement text knowledge unit computer science body knowledge knowledge unit designated core unit listed italic book cover core operating system o unit elective o unit overall coverage unit ommended speci c subtopics quite correspond exactly outside o area book substantial erage computing nc major topic transaction processing come information management im row listed chapter contain bulk knowledge unit coverage thoughxvi preface topic knowledge unit italic indicates core unit chapter s partial coverage partial coverage partial coverage partial coverage feedback welcome comment suggestion bug report welcome send email max use github issue tracker bug report earn bounty apiece token gratitude great computer scientist donald knuth started tradition given close publication work purpose reward nition bug simple result comment author chooses make change pointed bug change need suggested bug need technical nature unclear writing quali e example feature text chapter concludes ve standard element numbered tion chapter devoted security matter related chapter topic come di erent list opportunity active participation student exercise programming project ration project finally chapter end historical bibliographic note distinction exercise programming project ration project need explanation exercise completed nopreface xvii outside resource paper pencil need just textbook mind doe mean exercise cut dried think creatively answer rect programming project require nontrivial programming require making small easily identi ed change existing program programming project involve activity programming involve scienti c ment performance e ect example exploratory aspect dominate programming aspect exploration project hand experiment performed real programming change designated line isting program category exploration project doe just include experimental work includes project require research internet using library resource supplemental resource author text making supplemental resource available website additionally publisher earlier rst edition commissioned additional resource independent supplement author available publisher website largely apply revised edition author website http contains following material text revised edition code java c program shown text le gures text link book github site includes issue tracker erratum list revised edition course technology published rst edition book january october assigned copyright author giving opportunity make freely available revised edition closely follows rst edition thorough update aimed narrow goal xviii preface erratum reported rst edition corrected variety minor improvement appear clari ed explanation additional exercise project chapter note focused area received substantial update explanation linux scheduler completely replaced correspond newer fair scheduler cf including group scheduling feature new section added nonblocking synchronization focusing limited goal key objective maintain compatibility rst edition possible page bering changed number stayed new exercise project added end corresponding list son newly added section near end chapter changed section number old section synchronization chapter did gure number change hope join making update improvement text releasing creative common license allows just free copying freedom make cation long modi ed version released term order make modi cation practical just releasing book pdf form collection l atex source le edited run pdflatex program bibtex makeindex source le collection includes pdf le artwork gures course technology released right artwork contracted redrawn github site produce modi ed version text creative common license allows considerable exibility make modi ed version available urge contribute using request main github bene t having central repository progress separate material supplement text welcome category occurs animation screencasts static gures text limited worthwhile project transform text form xix acknowledgment book possible nancial logistical support employer gustavus adolphus college moral support family like acknowledge contribution publishing team cially developmental editor jill batistick product manager alyssa pratt grateful student doing fair share teaching particularly appreciate extensive comment received following individual reviewed chapter dan cosley university minnesota twin city allen downey franklin olin college engineering michael goldweber xavier university ramesh karne towson university manimaran iowa state university alexander manov illinois institute technology peter reiher university nia los angeles rich salz datapower technology dave schulz wisconsin lutheran college sanjeev setia george mason university jon man university minnesota twin city did adopt suggestion did ignore appreciate preparing revised edition took advantage suggestion reader like thank managed lose track apologize thank joel adam michael brackney jack briner justin delegard ben follis minchan kim finn kuusisto matt lindner milo martin gabe schmidt fritz sieker alex wauck initial release revised edition user suggestion continued drive progress github issue tracker pull request history valuable prefacechapter introduction chapter overview book cover lot ground explain basic principle underlie broad range system concrete example principle play speci c system internal working infrastructure build application infrastructure make use service book draw material encountered branch computer science ing engage activity ranging mathematical proof experimental measurement performance consideration system used abused social context book cover ground chapter designed quick view terrain know getting especially important topic cover interrelated carefully designed order presentation going confront occasional forward reference nd introductory chapter give overview topic wo mysti ed chapter make reference section explain operating tion middleware section know general topic studying section give reason studying topic explaining role hope book serve broad overview provided initial section chapter introduction remaining section chapter somewhat focused sponds later chapter explains important egory service provided operating system middleware section explains single computer run computation concurrently topic addressed depth chapter section explains interaction concurrent computation kept control topic chapter section extend range interacting computation time space respectively mechanism le system networking preview chapter chapter finally section introduces topic security topic revisit end chapter focus chapter operating anoperating software us hardware resource puter provide support execution software ically operating provides following service operating allows multiple computation place currently single computer divide hardware time computation handle shift focus computation keeping track leaf o later correctly resume operating control interaction concurrent computation enforce rule forbidding computation modifying data structure computation accessing structure provide isolated area memory private use di erent computation operating provide support controlled interaction computation run concurrently particular operating system provide le system allow computation read data le written earlier computation feature optional embedded computer controlling washing machine case run operating provide le operating operating provide support controlled interaction computation spread di erent computer system using networking standard feature ating system service illustrated figure programmed computer pc workstation server probably encountered computer running operating did allow tiple computation ongoing example boot computer chance run linux microsoft window mac o x run multiple application program individual window display screen operating system serve primary example book illustrate computer run single program erating consider embedded system typical embedded keyboard display screen instead temperature pressure sensor output control fuel jectors car alternatively primitive keyboard display microwave oven dedicated running single program sophisticated embedded system run multiple ating program use operating system mundane ded system simpler form single program directly executed embedded processor program contains instruction read input sensor carry appropriate computation write output device sort embedded illustrates possible operating serve point reference contrast nition operating alternative nition popular alternative nition operating vides application programmer abstract view underlying ware resource taking care detail application programmed simply example programmer write simple statement output string concern detail making character appear display screen counter remarking abstraction provided operating linking application program separately written library supporting procedure example program output string using standard mechanism programming language java application programmer need chapter introduction application operating systemapplication fileapplication application operating systemnetworking b figure operating computer directly execute single program shown b show ating computer support concurrent computation control interaction suggested dashed line allow communication time space way le networking hardware running operating program linked library performed output appropriately manipulating microwave oven display panel running oven embedded processor library cation code single program sequence instruction directly execute application mer standpoint detail successfully hidden summarize argument library routine operating satis e rst nition doe use underlying hardware support execution software doe provide support controlled action computation fairness alternative viewpoint historically grounded originally piece software called operating supporting controlled interaction language evolved nition closely ect current usage address alternative view operating system likely view formed experience using computer likely think operating software interact order carry task running application program depending user interface accustomed think operating allows click program icon run think operating interprets command operating element truth perception operating doe provide service executing selected application program operating provides service human user clicking icon typing command program running computer including handle icon click command entry operating allows program running start program running just service operating provides running program example service writing output le sum total feature operating make available application programmer use program called tion programming interface api element api ability run program reason click program icon type command run program operating system come bundled program us operating api run program response mouse keyboard input marketing level program treated operating given prominent available separate purchase example microsoft window come user interface known file explorer provides feature start menu ability click icon program named window explorer prior window experienced window user heard file explorer microsoft chosen low pro le treating integral microsoft window environment technical level distinct operating proper order make distinction explicit true operating called kernel kernel fundamental portion microsoft window provides api supporting computation controlled interaction similar distinction kernel user interface applies linux linux kernel provides basic operating service api shell program bash tcsh interpret typed command desktop environment program kde k desktop environment gnome handle graphical interaction book explain working operating kernel true operating system opposed gram reason program constructed fundamentally di erent way normal application program chapter introduction reason operating need sort user interface consider case embedded trols automotive fuel injection sophisticated include operating main control program run specialized program ability user start arbitrary program running shell desktop ment book draw example system familiar emphasize principle apply context middleware know operating turn egory software covered book middleware middleware software occupying middle position application program operating system explain section operating system middleware common software used support software application program run provide similar range service centered trolled interaction like operating middleware enforce rule designed computation interfering example rule computation modify shared data structure time like operating middleware bring putations di erent time contact persistent storage support interaction computation di erent computer viding network communication service operating system middleware rely di erent underlying provider service ing provides service api making use feature supported hardware example provide api service reading writing named le making use disk drive ability read write numbered block data dleware hand provides service api making use feature supported underlying operating example middleware provide api service updating relational database table making use operating ability read write le contain database layering middleware operating illustrated figure explains middleware middle middleware stack application program operating viewed horizontally vertically middleware middle teractions di erent application program possibly running di erent computer system provides mechanism support controlled interaction coordination persistent storage naming communication mentioned relational database system example dleware system provide sophisticated form persistent age le supported operating system use oracle primary source example regarding relational database system middleware use example book includes java form enterprise edition ibm websphere mq system provide support keeping computation largely isolated undesirable interaction allowing communicate running di erent computer marketing nition middleware doe correspond actly technical nition particular middleware fundamental importance distributed ing bundle separate middleware product example operating system come equipped mechanism translating internet hostnames numerical address mechanism typically outside ating kernel provide general supporting service application program nition middleware normally labeled application application middleware operating systemapplication middleware operating systemdatabase table figure middleware us service operating turn provides service application program support controlled chapter introduction objective book work way book gain knowledge skill notice did say reading book working way book chapter book concludes exercise programming project exploration project bibliographic historical note achieve objective book need work exercise carry project occasionally venture trail pointed note exploration project speci cally direct research outside source internet library experimental work measuring performance consequence particular design choice going invest kind time e ort deserve idea stand gain explain following paragraph knowledgeable skilled nishing book gain general knowledge contemporary ing system middleware work idea work way knowledge interesting right tical application recall system provide supporting apis application programmer use payo program application positioned make e ective use supporting apis true wo expert particular api instead big picture service apis provide payo role need alter guration operating middleware product order tune performance make best serve particular context book wo speci c knowledge need particular general background make sense specialized reference signi payo learning detail today system context reason design better position learn tomorrow system able way di erent way fundamentally able new feature context new solution old problem just variant existing solution really excited learn book use knowledge foundation advanced study people develops tomorrow multiple computation computer second addition knowledge system learn skill applicable outside context operating system middleware important skill come exploration project example project seriously practice conducting experiment writing report describing experiment result serve context provided opportunity develop pro ciency using professional literature documentation paper published conference proceeding source depth book programming project gain skill writing gram interacting component operating concurrently interaction control velop skill writing program interact internet case master programmer case laying foundation skill relevant range development project environment example skill acquire ability look security ramus cation design decision security section chapter security chapter end book want develop habit asking security issue question relevant outside realm operating system middleware hope studying operating system middleware provide wide range bene t particularly engage active participant spectator motivation tour service operating system middleware provide tour detailed section detailed chapter multiple computation computer single fundamental service operating provides allow multiple computation going time forcing wait previous run completion allows desktop computer juggle multiple task busy human seated screen allows server computer responsive request originating di erent client computer internet responsiveness concern concurrent computation chapter introduction make use computer resource example computation stalled waiting input arrive computation making productive use processor variety word used refer computation underway computer called thread process task job book use word word important explain di erence athread fundamental unit concurrency sequence programmed action thread executing program create multiple thread program call independent sequence action run concurrently execution program creates single thread normal case typical running thread ongoing program execution internal part operating start program running creating thread creating process process container hold thread thread started running protects unwanted interaction unrelated thread running computer example thread running process accidentally overwrite memory use di erent process human user normally start new process running time want make new computation happen tempting think process unit concurrent execution temptation ed fact older operating system required process exactly thread kind object spondence important distinguish book consistently make distinction referring ability set independent sequence programmed action motion write creating thread referring ability protect thread write creating process order support thread operating apis include feature ability create new thread kill o existing thread operating mechanism switching computer attention various thread operating suspends execution thread order thread chance make progress operating store tion rst thread able successfully resume execution later chapter address issue thread runnable particular time waiting event arrival input interaction computation operating confronted multiple runnable thread choose one run moment problem scheduling thread execution solution surveyed chapter scheduling problem interesting generated solution involves balancing user competing interest value individual scheduling approach make happy time focus explaining di erent scheduling approach t di erent context usage achieve di ering goal addition explain apis allow programmer exert control scheduling example indicating thread higher priority controlling interaction tations running multiple thread interesting thread need interact execute completely independently example thread producing data thread consumes thread writing data memory ing data want reader ahead writer start reading location written illustrates broad family control interaction control relative timing thread execution reading step place responding writing step general control thread timing issynchronization chapter explains common synchronization pattern ing keeping consumer outstripping corresponding producer explains mechanism commonly used provide nization supported directly operating system require modest middleware java runtime environment chapter explains particularly important arise use synchronization synchronization force thread wait second thread happens ing rst sort cyclic waiting known deadlock discussion way cope deadlock introduces signi middleware database system provide interesting example deadlock handling chapter expand theme synchronization chapter introduction explaining transaction commonly supported middleware atransaction unit computational work intermediate state middle computation visible concurrent action isolated seeing intermediate storage tionally transaction fail storage left transaction started computer ically crash middle transaction execution storage rebooting ect partial transaction prevents result transaction visible transaction ibly useful designing reliable information system widespread commercial deployment provide good example matical reasoning used help design practical system chapter prominently expect understand proof thread reason interact accidentally interact running computer sharing memory example thread accidentally write memory used reason operating system provide virtual memory topic chapter virtual memory refers technique modifying address way processor memory address actually used storing value memory di erent appearing processor load store instruction general mechanism provided combination hardware operating software explain di erent goal mechanism serve simple isolating thread process directing memory access di erent region memory having broached topic providing process isolated virtual memory devote chapter process chapter explains api creating process focus protection mechanism building chapter introduction virtual memory explaining form protection used protect process protect operating process protection mechanism used protect just storage value memory data storage le network communication channel chapter lay groundwork later treatment topic chapter provides opportunity clarify point thread left open chapter showing operating system vide protective boundary running application process explain thread fall relative boundary ticular thread contained entirely supporting interaction time kernel contained entirely application cess cross boundary providing support kernel concurrent activity application process natural discus category thread chapter chapter thread really need wait chapter order make sense distinction managed introductory paragraph computation run concurrently single computer hard supporting controlled interaction interaction trol example earlier example pair thread produce data consumes situation great mystery data ow using computer memory hard regulating use shared memory stand contrast interaction time space address section producer consumer run di erent time di erent computer operating middleware need pain convey data supporting interaction time general purpose operating system support mechanism putations leave result storage retrieved later computation storage persists shut started known persistent age normally operating system provide persistent storage form named le organized hierarchy directory folder form persistent storage relational database table ned persistent object generally supported ware chapter focus le system explain connection middleware example compare storage le directory database index comparison particularly important area converging underlying nisms similar le system starting support indexing service like provided database system general category le apis cover chapter le process virtual ory space accessible normal load store instruction treated separately external entity read write chapter introduction operation kind le api provides relatively simple interface quite signi mechanism hidden operating chapter provides survey mechanism example simple interface sophisticated mechanism application programmer make le larger simply writing additional data end le operating hand choose location new data stored disk used space allocation strong uence performance physical reality disk drive operate job le track data le located keep track c information access permission le store le data store metadata data describing data mechanism similar used middleware pose allocating space hold database table operating system middleware store information le directory database index used locate data data structure used naming indexing purpose designed access just like used track allocation space stored object make job operating system middleware lenging persistent storage structure expected survive crash signi loss integrity example acceptable crash speci c storage space listed available allocation listed allocated le confused state occur crash happened just le created deleted chapter build chapter explanation atomic transaction outlining mechanism used protect integrity metadata directory index persistent storage crucially important internet age prior time server hold huge amount data use client world nonetheless persistent storage longer play unique role did time computer system way process communicated persistent storage today unthinkable munication span internet explain section operating system provide support networking middleware provides support construction distributed supporting interaction space supporting interaction space order build coherent software system component operating di ering computer programmer need solve lot problem consider example data owing stream delivered order sent varying route interconnected network message delivery incorporated guarantee provided transaction luckily application programmer need solve problem appropriate supporting service provided operating system middleware divide coverage service chapter chapter vides foundation regarding networking book stand previously studied networking chapter cover service commonly provided operating system close tion operating system distributed le system chapter contrast explains service middleware provides communication form messaging web service chapter introduces example apis use application programmer general principle speci c apis networking system explain chapter generally partitioned layer layer make use service provided layer order provide additional service layer stack physical layer concerned matter copper ber optic radio wave voltage wavelength thelink layer provides service transmitting chunk data computer local network point erating involved building foundation operating provides service network layer transport layer network layer arranges data relayed nected network arrive computer world transport layer build basic data transmission provide useful nication channel example transport layer typically us sequence numbering retransmission provide application service delivery stream data level common operating api provides socket endpoint connection layer application layer specialized layer service distributed le system integrated chapter introduction system software web browser email program written application programmer tions built directly operating socket api exchange stream byte comply standardized protocol chapter illustrate possibility showing web browser web server communicate alternatively programmer distributed application make use middleware work higher level sending byte socket basic approach chapter messaging remote dure call rpcs web service particular approach standardizing kind application communication used rpcs messaging application program request delivery message messaging delivers message level networking accomplish provides additional service example messaging integrated transaction processing successful transaction retrieve message incoming message queue update database response message send response message outgoing queue transaction fails change happen request message remain incoming queue database remain unchanged response message queued delivery common service provided ing system deliver message number recipient subscribed receive message particular kind sender need aware actual receiver middleware provide mechanism remote procedure rpc communication client server look like ordinary programming language procedure invoking method object di erence object question located di erent computer return involve network communication middleware hide complexity tion programmer work largely object local chapter explain concept fully mention used form web service web service entity program communicate using standardized protocol similar human use browse security security operating system middleware target attack versaries trying defeat security attack aimed application program relate operating system middleware particular easily misused feature operating system middleware root cause vulnerability hand ing system middleware provide feature helpful constructing secure system secure provides acceptably low risk adversary prevent achieving owner objective chapter explain think risk icting objective owner adversary particular explain common objective owner fall category dentiality integrity availability accountability provides dentiality prevents inappropriate disclosure information integrity prevents inappropriate modi cation destruction information availability prevents inappropriate interference legitimate usage provides accountability provides way check authorized user exercised authority rely authentication ability verify identity user people narrow view security think feature exist security issue clearly logging password better form authentication component security equally clearly having permission read le component security graphic protocol used protect network communication interception view security dangerously incomplete need mind design component operating security consequence part design dominated consideration ect proactive consideration security consequence overall insecure fact important principle extends operating include application software human operate make habit addressing security issue chapter end book speci cally chapter concludes section pointing key security issue ciated chapter topic provide coherent treatment security concluding book chapter devoted exclusively security chapter take holistic approach chapter introduction security human factor play important role technical one exercise di erence operating middleware operating system middleware common relationship thread process way operating isolate thread wanted interaction way middleware way operating provide persistent storage way middleware way operating support network nication way middleware topic previewed chapter looking forward learning programming project write test debug program language choice carry task choose write list service suspect operating providing order support execution sample program think program relying middleware service list exploration project look title paper presented recent ferences hosted usenix association advanced ing system association nd conference proceeding better idea individual paper click title abstract short summary paper based title abstract pick paper think make interesting supplementary reading security way book write list showing graphic information paper selected near estimate book table content appropriate read conduct simple experiment action computer observe response choose action wish computer appropriate access observe quantitative result long response take output produced qualitative result form response arrives try replicating experiment result similar one factor need controlled order result approximately repeatable example consistent time need reboot trial prevent people using consistent output need make sure input le kept unchanged action involves physical device printer control variable printer stocked paper finally write careful report explain experiment tried result observed explain repeatable result proved limit repeatability hardware software guration replicate experiment likely similar result note idea operating isolate computation wanted interaction support desirable interaction long itage paper o daggett daley point erent user program simultaneously core memory interfere supervisor program form memory protection mode available operating user program paper go say care went making user independent user useful extension case computer support group work war chapter introduction middleware general public operating tems commercial developer lost attempt introduce middleware somewhat broader audience bernstein survey article usenix association mentioned exploration project ne professional society holding conference related subject matter book reason speci cally recommended looking proceeding tend particularly cessible student usenix focus bringing practitioner academic paper generally matic super cial text available thread introduction computer program consist instruction computer carry quences computational step speci ed instruction sequence computational step strung thread simplest program write instruction executed single sequence section learn write program produce thread execution independent sequence tational step ordering constraint step thread multiple thread come existence running multiple program running program note distinction program thread program tains instruction thread consists execution instruction program distinction matter program contains loop short program rise long thread execution running program time rise thread executing program figure summarizes thread arise program thread lifetime extending time rst tion execution occurs time instruction execution thread overlapping lifetime illustrated figure say areconcurrent fundamental goal operating tem allow multiple thread run concurrently computer waiting rst thread completed chapter thread program multiple program multiple run program program spawnthread thread thread thread bthread b thread thread b figure program rise thread sequential thread concurrent thread running simultaneously processor concurrent thread gap execution interleaved processor figure sequential concurrent example multithreaded program second thread run possible divide computer tion computer hardware includes multiple processor naturally possible run thread concurrently cessor operating user want run concurrent thread hardware processor reason described section operating need divide cessor attention multiple thread introductory textbook limit case thread needing run single processor explicitly indicate place address general case order make concept concurrent thread concrete section show write program spawn multiple thread time program run know create thread explain tion reason desirable run multiple thread currently o er typical example us thread rst section explain application programmer view thread programmer use concurrent thread set question doe operating support application programmer desire concurrently executing thread section examine doe ter consider fundamental processor attention switched thread related issue address chapter include deciding thread run point ter controlling interaction thread chapter explained chapter wait chapter explain protection boundary surrounding operating need wait chapter distinguish thread reside entirely boundary thread provided inside boundary use outside thread residing entirely outside boundary known thread microsoft window bers finally chapter concludes standard feature book brief discussion security issue followed exercise programming exploration project note example multithreaded program program initially start running computer carry program instruction single thread program chapter thread tended run multiple thread original thread need point spawn o child thread doe action parent thread continues thread program repeat step programming language application programming interface api thread includes way create child thread section use java api api c called pthreads posix thread book posix comprehensive speci cation system including apis just thread creation realistic multithreaded programming requires control thread teractions using technique chapter example chapter quite simple just spawning thread demonstrate independence thread parent child thread respond timer sleep second print message sleep ve second print message thread execute concurrently second message appear approximately second rst programming project write somewhat realistic program thread responds user input timer figure show java version program main program rst creates thread object called childthread runnable object ciated child thread runmethod sleep second pressed millisecond print message runmethod start running main procedure invokes cause runmethod separate thread main thread continue subsequent step sleeping ve second millisecond printing message figure equivalent program c using pthreads api child procedure sleep second print message main dure creates running child procedure sleep ve second print message signi di erence java api creates child thread start running java separate step addition portable apis java pthreads apis system provide apis example microsoft dows api procedure createthread andsleep programming project modify program figure use example multithreaded program public class public static void main string args thread childthread new thread new runnable public void run sleep child sleeping second sleep parent sleeping second private static void sleep int millisecond try millisecond catch interruptedexception e ignore exception wo happen figure simple multithreaded program chapter thread include include include static void child void ignored sleep printf child sleeping return null int main int argc char argv int code code null child null code fprintf stderr failed code code sleep printf parent sleeping return figure simple multithreaded program reason using concurrent thread reason using concurrent thread seen single execution program result thread presumably somewhat familiar generating multiple thread running multiple program running program multiple time regardless thread come faced question desirable computer execute multiple thread concurrently waiting nish starting fundamentally us concurrent thread serve goal responsiveness allowing computer respond quickly thing external human user puter thread midst long computation thread respond external agent example gram section illustrated responsiveness parent child thread responded timer resource utilization keeping hardware resource busy time thread need particular piece ware able make productive use general theme variation explore remainder section reason programmer use concurrent thread tool modularization complex decomposed group interacting thread let start considering responsiveness web server vides client computer speci c web page request internet client computer make network connection server sends sequence byte contain desired web page server program respond need read byte typically using loop continues reading byte network connection see end request suppose client connecting using slow network connection hap modem server read rst request wait considerable length time rest request arrives network happens client meantime unacceptable website grind halt unable serve client just waiting slow client nish issuing request way web server avoid unacceptable situation using multiple thread client connection chapter thread thread waiting data client thread continue interacting client figure illustrates unacceptable web server realistic multithreaded client web browser illustrate need sponsiveness suppose start loading large web page take considerable time download happy computer froze download nished probably expect able work spreadsheet di erent window scroll rst web page read downloaded click stop button download handled having thread tied loading web page network thread responsive action keyboard mouse web browser scenario let foreshadow later portion textbook concerning controlled interaction thread note sketched di erent thing want web page downloaded rst case work spreadsheet concurrent thread erating job allowing run concurrently consist isolating bug web browser doe overwrite spreadsheet example ally encapsulating thread separate protection environment known process discus chapter system process task use task synonym thread hand continue using browser user interface download continues concurrent thread closely related part web serverslow client blocked web serverslowclient client figure multithreaded web reason using concurrent thread single application operating need isolate thread need provide mechanism regulating interaction example coordination downloading thread thread needed ensure scroll page downloaded coordination thread known synchronization topic chapter turning utilization hardware resource obvious nario computer case ran thread time half processing capacity used human user computer doe task carry useful housekeeping work second processor busy example operating system asked allocate memory application program use store zero memory rst holding memory allocation zeroing operating thread tively zero unused memory needed ready housekeeping work zeroing memory demand slow real work using concurrent thread utilize available hardware fully performance improved example illustrates thread need come user program thread operating example thread zeroing unused memory resource utilization consideration justify using concurrent thread remember computer contains hardware resource disk drive processor suppose task complete pc want scan le disk virus want complicated rendering scene including solid object shadow cast partially transparent smoke cloud experience know hour hour instead running virus scanner window run graphic ing program pleasantly surprised nd job hour half explanation saving elapsed time virus scanning program spends time using disk drive read le modest burst processor activity time disk completes read request rendering program spends time doing processing little disk activity illustrated figure chapter thread sequence leaf computer hardware idle time running concurrently keep processor disk drive busy improving overall course assumes operating scheduler smart let virus scanner processor attention brie y disk request completes making wait rendering program address issue chapter seen thread come multiple source serve multiple role internal portion operating example zeroing memory user application software case dividing work multithreaded process web server web browser example come multiple independent process web browser run window spreadsheet regardless variation typical reason running thread concurrently remain unchanged provide increased responsiveness improve fully utilizing hardware basic mechanism used divide processor attention multiple thread remains di erent case mechanism section course case require additional protection mechanism provided process discus chapter necessary leave o work thread pick work switching thread order operating thread underway processor need mechanism switching attention thread particular need way leave o middle thread sequence instruction work thread pick original thread right left o order explain thread switching simply possible initially assume thread executing code contains explicit instruction temporarily switch thread understand mechanism build realistic case thread contains explicit point automatically interrupted thread switch suppose thread b use forth name instruction execution step constitute switching thread idle virus scanninggraphics thread processor hr thread processor disk figure overlapping activity similarly case possible execution sequence shown figure explain subsequently thread executes switchfromto b computer start executing instruction thread realistic example thread run step switch overall occasionally new thread starting existing thread exiting goal step thread form coherent execution sequence perspective thread execution di erent occurred consecutively interruption similarly thread b step suppose example step load value memory register add placing sum register double register content twice sum case want make sure really doe double sum computed doubling value thread b step happen store register switching thread simply matter jump instruction transferring control appropriate instruction thread minimum save register memory restore thread resume execution value register order focus essential let aside issue thread start exit instead let focus just normal case thread progress put hold switch thread chapter thread thread thread b switchfromto b switchfromto b switchfromto b switchfromto b switchfromto b figure switching switching thread thread left o switch preceding example support switching thread operating need information thread point thread resume execution information stored block memory thread use address memory area refer thread block memory containing information thread called thread control block ortask control block tcb way saying use address block say use pointer thread control block refer thread fundamental mechanism switchfromto procedure take thread control block pointer eters specifying thread switched specifying thread switched running example aandbare pointer variable pointing thread control block use alternately role outgoing thread thread example program thread contains code tion switch atob program thread b contains code instruction switch btoa course assumes thread know identity identity thread switch later unrealistic assumption eliminated let write switchfromto procedure switchfromto b save current execution status formation structure pointed read previously saved information structure pointed b resume thread b left o saw execution status information save includes position program called program counter pc instruction pointer ip content register critical execution status program compiled higher level language compiler portion memory used store stack stack pointer register indicates position memory current stack likely encountered form storage prior organization programming language ples introduction computer science appendix provides information need proceeding remainder chapter thread resume execution nd stack way left example suppose thread push item stack hold thread b executes thread resume execution nd item pushed chapter thread thread b did pushing gotten popping arrange giving thread stack setting aside separate portion memory thread executing stack pointer sp register pointing thread stack area indicating area occupied time switching thread b need save away stack pointer just like register load thread b stack pointer way thread b executing stack pointer b stack area accordance b push pop having discovered need separate stack switch stack pointer simplify saving register pushing stack switching popping o stack ing shown figure use approach outline code switching outgoing thread thread using outgoing pointer thread control block switching atob outgoing aand later ing btoa outgoing band use sp ip refer slot structure pointed outgoing slot used save stack pointer used save instruction pointer assumption code following general form push register outgoing thread stack store stack pointer sp load stack pointer sp store label l address ip load ip jump address l pop register resumed outgoing thread stack note code label l time switching away outgoing thread code label later resuming execution thread switch original code store outgoing thread stack pointer away restores thread stack pointer later code used switch count original thread stack pointer restored control jump label register popped popped original thread stack matching push beginning switching thread register s resumption ip spa s tcb b s resumption ip spb s tcba s saved registersa s stack b s saved registersb s stacka s data b s data s dataip sp register s ip sp b s ip sp s ip sp figure saving register thread control block stack general pattern play real looking code linux operating architecture architecture known popular processor architecture used standard personal computer processor intel core xeon atom family amd fx opteron family want real code skip ahead paragraph block assembly code familiar assembly language ought able code match preceding pattern real code extracted linux kernel peripheral complication left stack pointer register named esp code start running register known ebx esi contain outgoing andnext pointer respectively pointer address thread control block location o set tcb contains thread instruction pointer location o set contains thread stack pointer memory location contain instruction pointer stack pointer use resuming thread execution code surrounding thread switch doe important value register special ag register register named ebp need saved restored background code explanatory comment pushfl push flag outgoing stack pushl ebp push ebp outgoing chapter thread movl ebx store outgoing stack pointer movl esi esp load stack pointer movl ebx store label address outgoing resume pushl esi push instruction address resume ret pop jump address popl ebp later resuming outgoing restores ebp popfl restores flag having seen core idea processor switched running thread running eliminate assumption thread switch contains explicit name outgoing thread want away having thread binswitchfromto b easy know thread switched away just track time currently running thread example storing pointer control block global variable called current leaf question thread selected run operating track thread sort data structure list procedure choosenextthread consults data structure using scheduling policy decides thread run chapter explain scheduling black box using tool write procedure yield performs following step outgoing current choosenextthread current global variable right switchfromto outgoing time thread decides want break let thread run just invoke yield essentially approach taken real system linux complication multiprocessor current thread need recorded basis thread switching called context switching switch execution context thread thread author use phrase context switching di erently refer switching process protection topic preemptive multitasking chapter distinction matter clearest choice avoid ambiguous term context switching use speci c thread switching orprocess switching thread switching common form dispatching thread causing processor execute way thread dispatched thread switch processor idle preemptive multitasking point explained thread switching system employ cooperative multitasking thread program contains explicit code point thread switch occur realistic operating system use called preemptive titasking program code need contain thread switch thread switch automatically performed time time reason prefer preemptive multitasking mean buggy code thread hold consider example loop expected iterate time safe cooperative multitasking thread switch loop body bug easily turn loop nite hog processor forever preemptive multitasking thread run forever time time hold thread allowed progress reason prefer preemptive multitasking allows thread switch performed best achieve goal responsiveness resource utilization example operating preempt thread input available waiting thread ware device fall idle preemptive multitasking occasionally useful thread voluntarily way thread run long allowed preemptive system normally provide yield varies depending api yield example pthreads api us exception naming pattern api microsoft window us switchtothread equivalent yield preemptive multitasking doe need fundamentally di erent thread switching mechanism simply need addition hardware interrupt mechanism case familiar interrupt work chapter thread rst moment review aspect hardware organization normally processor execute consecutive instruction deviating sequential ow directed explicit jump instruction variant retinstruction used linux code thread switching mechanism external hardware disk drive network interface signal need attention hardware timer set demand attention periodically millisecond device timer need attention interrupt occurs procedure instruction forcibly inserted currently ecuting instruction moving program instruction processor jump o special procedure called interrupt handler interrupt handler operating deal hardware device executes return interrupt instruction jump instruction execute interrupt occurred course order program execution continue expected interrupt handler need careful save register start restore returning using interrupt mechanism operating provide emptive multitasking interrupt occurs interrupt handler rst save register current thread stack take care diate need accepting data network interface controller updating idea current time millisecond simply restoring register executing return rupt instruction interrupt handler check good time preempt current thread switch example interrupt signaled arrival data thread long waiting make sense switch thread interrupt timer current thread executing long time make sense thread chance policy decision related scheduling topic chapter case operating decides preempt current thread interrupt handler switch thread using mechanism theswitchfromto procedure switching thread includes switching new thread stack interrupt handler restores register returning restoring new thread register viously running thread register value remain safely stack thread security thread security thread premise book topic raise security issue multithreading exception section quite brief material covered chapter present security problem connected multithreading solution divide problem solution section provides thumbnail sketch leaving consideration problem solution chapter introduce necessary tool security issue arise thread unable execute hogging computer attention security issue arise cause unwanted interaction thread unwanted interaction include thread writing storage thread trying use reading storage thread considers dential problem likely arise programmer time understanding thread interact security section chapter address problem thread monopolizing computer security section chapter address problem controlling thread interaction ters strong emphasis design approach make interaction easy understand minimizing risk arise incomplete understanding exercise based example section di erence tween sleep procedure posix api method java api example given text useful run concurrent thread puter computer number processor indicate example t general reason use concurrency listed text suppose thread go loop time time performing disk operation taking millisecond tation taking millisecond disk operation progress thread make use processor thread b run second purely processor lisecond processor time spent time processor chapter thread thread switching cost problem processor working thread b thread tions processor disk drive contend memory access bandwidth example suppose processor disk work purely thread completion processor switch thread b run thread total elapsed time b suppose processor start working thread time thread performs disk operation processor switch b operation disk operation completion total elapsed time consider uniprocessor arrival input external source trigger creation execution new thread completion produce output interested response time triggering input resulting output input arrives time second second forth arrival trigger thread take onds run thread run created dispatched take millisecond average response time input b second source input added input arriving time second second second forth input trigger thread millisecond run need millisecond create dispatch input arrives resulting new thread created patched processor idle average response time second class input combined age response time class c suppose change way second class input handled input arrives new thread immediately created dispatched preempt running thread new thread completes preempted thread resume execution millisecond thread switching delay average response time class input combined average control switch away thread later switch thread thread resume execution left o security thread larly procedure call subroutine later subroutine turn execution pick left o calling procedure given similarity essential di erence thread switching subroutine saw thread separate stack area memory necessary subroutine invocation programming project program c read documentation ing information model provided figure page write program initial main thread creates second thread main thread read input keyboard ing user press enter key point kill o second thread print message reporting second thread nite loop time sleeping ve second printing sage try running program sleeping thread print periodic message main thread waiting keyboard main thread read input kill sleeping thread print message sleeping thread early sleep program java read documentation stop method thethread class ignore information deprecated make sense read chapter book write program described programming project java use program shown figure page model read api documentation programming language c java nd spawn o thread sleep write program language equivalent java c example program figure page equivalent programming project using language chosen program c microsoft window use native api instead portable pthreads api read mentation createthread sleep modify program figure page use chapter thread exploration project try experiment running process intensive process concurrently write report carefully explaining did hardware software context did replicate result report elapsed time concurrent execution pared time sequential execution sure multiple trial reboot run eliminate fects come keeping disk data memory nd documentation tool provide information percentage cpu time used number disk operation second include information report early version microsoft window mac o used cooperative multitasking use web source information nd switched preemptive multitasking nd summarize example written change time frequently doe switch thread nd linux using vmstat program read man page forvmstat run nd number context switch second write report carefully explain did hardware software context did replicate result note idea executing multiple thread concurrently occurred people concurrently late did use word thread example article codd et al stated second form parallelism shall nonlocal provides concurrent execution instruction need neighbor instruction stream belong entirely separate unrelated program beginning author aware reason using concurrency emphasized resource utilization responsiveness article codd et example report object concurrently running task security thread belong di erent totally unrelated program achieve balanced loading facility possible task belonged single program object achieve speci ed time response situation message transaction processed mentioned operating dedicate thread tively zeroing memory example zero page thread microsoft window russinovich solomon book detail extracted linux thread switching code version kernel detail o set di er version kernel source code written combination assembly language c contained included obtain pure assembly code fed source thegcccompiler retinstruction simpli cation actual kernel point jump block code end struction brief description posix java apis intended concrete illustration broader concept replacement umentation apis nd documentation web http http chapter threadschapter scheduling introduction chapter saw operating system support concurrent tion multiple thread repeatedly switching processor attention thread switching implies mechanism known scheduler needed choose thread run time resource need scheduling example thread read disk drive disk scheduler place order simplicity consider processor scheduling normally people speak scheduling mean processor scheduling similarly thescheduler understood mean processor scheduler scheduler make decision way keep computer user happy example picking thread time completely ignoring generally good scheduling policy unfortunately policy make user happy time reason simple di erent user having icting desire example user want task completed quickly user b want task b completed quickly time relative merit di erent scheduling policy depend ask context ask simple example student enrolled course unlikely decide assignment work considering assignment scheduling policy need respond context operating tems provide scheduling mechanism leave user charge subtle policy choice example operating provide mechanism running whichever thread highest numerical priority chapter scheduling leaving user job assigning priority thread mechanism general family policy suit goal fore spend chapter describing di erent goal user scheduler mechanism used achieve goal approximately particularly user wish achieve icting goal generally satis ed heavily scheduling issue present goal agree thread make productive use processor preferred waiting completion time delay arrival input section scheduler arrange keeping track thread state scheduling run usefully following section thread state devote section entirely question user goal independent realized spend section apiece broad family scheduler examining work serve user goal family scheduler based xed thread priority section based dynamically adjusted thread priority section based priority controlling thread proportional share processing time section division possible taxonomy scheduler serve help introduce operating system scheduler explain principle keeping mind context user goal presenting family scheduler brie y remark section role scheduling play security chapter concludes exercise programming exploration project note thread state typical thread time waiting event unable execute useful instruction event occurs consider web server read client request network read requested web page disk sends page network client initially server thread waiting network interface data available server thread scheduled processor waiting best execute loop checked data productive use thread state processor time data available network server thread execute useful instruction read byte check request complete server need waiting data arrive request complete server know page load disk issue appropriate request disk drive point thread need wait time disk completed requisite physical movement locate page di erent example video display program display frame video wait fraction second displaying movie doe play fast thread frame checking computer clock time productive use processor plausible wait executing loop continually check event question approach known busy waiting modern operating multiple thread competing processor case busy waiting bad idea time scheduler allocates thread lost thread achieving added value thread waiting operating system provide alternative way thread wait operating keep track thread usefully run waiting doe storing runnable thread data structure called run queue waiting thread wait queue reason waiting structure conventionally called queue used style true queue example list thread waiting time elapse kept order desired time example wait queue set thread waiting availability data particular network communication channel executing loop thread want wait event noti e operating intention operating remove thread run queue insert thread appropriate wait queue shown figure scheduler considers thread run queue execution select waiting thread run scheduler choosing thread make progress given processor run chapter mentioned arrival hardware interrupt cause processor temporarily stop executing instruction rent thread start executing instruction operating chapter scheduling run queue wait queue originally running thread need wait run queue wait queue newly selected runnewly waiting figure thread need wait operating move run queue wait queue scheduler selects thread remaining run queue dispatch start scheduling goal interrupt handler service interrupt handler perform determining waiting thread doe need wait longer example computer clock gured interrupt processor hundredth second interrupt handler check rst thread wait queue thread waiting ci c time elapse time thread waiting arrived thread need checked thread kept time order hand thread slept long quested operating list sleeping thread run queue thread available scheduling case operating check thread similarly illustrated figure putting preceding information tinct state thread running awaiting dispatch scheduler processor event operating system add state order make ner distinction waiting kind event versus waiting kind handle special circumstance example thread nished running need kept thread noti ed simplicity stick basic state foregoing list critical moment thread lifetime operating change thread state thread state change indicated figure real operating add additional transition example possible forcibly terminate thread waiting state having terminate accord running scheduling goal user expect scheduler maximize computer performance allow exert control goal ned precise goal explain following subsection high performance mean high throughput section fast response time section user control expressed term urgency importance resource allocation section chapter scheduling run queue wait queue past movepresent movefuture leavedon t figure operating handle timer interrupt thread waiting time past moved run queue wait queue kept time order scheduler need check thread nd waiting time future gure time shown human scale ease understanding runnable waitingterminationyield preemption dispatch wait eventrunninginitiation figure thread change state shown thread tially created runnable actually running processor dispatched scheduler running thread voluntarily yield processor preempted scheduler order run thread case running thread return runnable state alternatively running thread wait external event runnable running thread scheduling goal throughput personal computer far processing capability available work largely sit idle patiently waiting keystroke user look scene large internet service google di erent situation large room lled rack rack computer necessary order pace incoming request computer cope small fraction economic reason service provider want cluster server small possible throughput server high possible throughput rate useful work search transaction accomplished example measure throughput number search transaction completed second maximizing throughput certainly implies scheduler processor runnable thread work possible slightly obvious implication member computer component just processor device disk drive network interface memory hierarchy including cache memory using resource scheduler maximize throughput mentioned device chapter example computationally intensive graphic rendering program running concurrently virus scanner return example later current chapter way thread interleaved nutshell goal processor disk drive busy time assistant project appreciation entail assistant danger falling idle set work aside long explain assignment similarly processor switch thread necessary disk work cache memory impact scheduling way arises multiprocessor system switching di erent thread necessary reduce throughput processor time wasted overhead context switching available useful work main source switching overhead direct cost switch entail saving register loading thread value instead big cost reduced cache memory performance reason explain moment multiprocessor system second issue chapter scheduling thread likely run faster scheduled processor ran result cache memory e ect maximize throughput scheduler try maintain speci c processor thread consistently schedule thread processor unless countervailing consideration probably learned computer organization course cache ories provide fast storage address recently cessed near recently accessed location program frequently access location exhibit temporal locality access nearby location exhibit spatial locality processor able data cache slower main memory suppose processor switch thread new thread favorite memory location likely quite di erent cache memory initially su er miss slowing processor speed main memory shown figure time new thread data displace data old thread performance improve suppose just point cache adapted second thread scheduler decide switch clearly recipe computing multiprocessor processor improves throughput similar manner reducing number cycle processor stall waiting data slower part memory hierarchy processor local cache memory thread resume running processor previously ran hope nd data cache worst thread incur cache miss need fetch data main memory phrase worst odd context needing way main memory multiprocessor fetching main memory highest cost situation memory access expensive refer data held processor cache situation easily arise thread dispatched di erent processor previously ran shown figure circumstance multiprocessor cache ence protocol come play typically mean rst transferring data old cache main memory transferring main memory new cache excess coherence needed block shared multiple thread reduces throughput scheduler arranged processor scheduling goal processor thread acachemain memory b aa b thread b figure processor executing thread cache hold thread value cache hit rate high processor switch thread b memory access miss cache slower main memory aprocessor processor thread athread bcache b b b b bcache memory athread bthread ab b b b b figure processor executes thread processor executes thread b cache hold corresponding thread value scheduler later schedule thread opposite processor memory access miss local cache need use cache coherence protocol retrieve data chapter scheduling response time throughput principle measure computer formance response time elapsed time triggering event keystroke network packet arrival completed response updated display transmission reply packet notice sense example frequent context switch bad throughput necessary optimize response time system intended direct action single user tend optimized response time expense throughput centralized server usually designed high throughput long response time kept tolerable operating trying schedule runnable thread processor thread necessary order respond event response time inevitably involves tradeo ing quickly event running corresponding thread mean responding slowly event leaving thread runnable state awaiting later dispatch way resolve using ed information relative urgency importance thread section information operating able better just shrug virtual shoulder consider real world situation email friend reporting transpired life asking corresponding update doing year barely started writing inevitably long reply second email message arrives close friend asking want tonight choice nish writing long letter reply second email choice temporarily long letter aside send o reply regarding tonight telling story life choice extends response time email order response time email short possible symmetry doe mean logical basis choice prioritizing reply provides bene t response time icts harm task operating know processor time thread need order respond use logic email example guide choice policy shortest job sjf scheduling minimizes average response time demonstrate exercise scheduling goal policy date batch processing system processed single large jobof work time company payroll account payable operator minimize average turnaround time job submitted completed processing shortest rst operator usually pretty good idea long job job run regular basis reason interested sjf scheduling batch job unlikely encounter background understanding modern operating improve responsiveness thread normally operating wo know processor time thread need order respond solution guess based past behavior prioritize thread consumed large burst processor time past burst processing wait external event solution operating hedge bet doe know thread need run brie y wo sink time wrong thread switching frequently runnable thread need little processing time time relatively soon thread involve long computation succesfulness hedge depends duration thetime slice given thread number runnable thread competing processor lightly loaded frequent switch ensure responsiveness contrast consider heavily loaded computation occasionally interactive thread need just little processor time operating ensure responsiveness identifying prioritizing interactive thread doe wait line thread time slice brief time slice add substantial delay urgency importance resource allocation goal high throughput quick response time inherently involve user control scheduler smart scheduler make right decision hand user goal revolve precisely desire able say following thread high priority work explain di erent notion confusingly lumped heading priority disentangle confusion use di erent name urgency importance resource allocation reserve word chapter scheduling later description speci c scheduling mechanism used help achieve goal throughput responsiveness control urgency importance resource allocation task urgent need soon example small homework assignment tomorrow massive term paper write day homework urgent doe necessarily mean smart prioritize homework make decision zero homework order free time term paper basing decision task urgency importance term paper important word importance indicates stake accomplishing task timely fashion importance make good scheduling decision suppose term paper week case decide work homework today knowing time write paper starting tomorrow example suppose term paper start researching hour absolutely late paper accepted case realize hopeless start term paper decide time homework instead urgency importance quite di erent matter cision user speci e urgency determine user control scheduling ect importance task hard deadline importance dealt homework cess ruthless triage importance measure cost dropping task entirely hand deadline importance measuring bad task late extreme user provide information urgency instead demanding result soon possible case high importance task work possible low importance task ll idle moment important urgency importance way user wish express relationship di erent thread controlling fraction available processing resource allocated time matter fairness example user sharing computer fair devote half processing time user thread half processing time user thread situation speci c degree inequity desired example web hosting company sell share large server scheduling goal small company website company want provide good service growing customer base choose buy share web server expecting twice server processing time return larger monthly fee common thousand user university student share single computer considerable attention devoted scheduling user consumption shared processor time balanced relatively long time period week user did lot computing early week nd thread allocated small portion processor time later week user chance catch fair share did mean equal share administrator grant di ering allocation di erent user example student taking advanced course receive computing time introductory student advent personal computer scheduling fallen favor approach scheduling alive example linux scheduler largely based scheduling idea main reason mention scheduling distinguish scheduling concept name confusingly close scheduling balance processing time given thread shorter time scale second idea focus thread runnable allocate processor time proportion share user speci ed example suppose big server company purchased time company pay month company b c given share company share company b suppose simplicity company run just thread thread b c correspondingly thread wait hour input arrive network thread b c runnable half processing time b c share thread input nally arrives thread runnable wo given block processing time thread instead half processor time thread b c quarter ecting ratio share simplest sort scheduling allows share speci ed individual thread thread b c chapter scheduling ceding example sophisticated version allows share speci ed collectively thread run particular user ing logical group example user equal share processor time independent runnable thread user user run multiple thread simply subdivide share processing time similarly example big server contracted multiple company probably want allow company run multiple thread controlling overall resource allocation company just individual thread linux scheduler provides exible group scheduling facility thread treated individually placed group user way administrator chooses version default thread receive processor share vidually default changed version new default automatically establish group terminal window way matter thread run ticular terminal window wo greatly degrade overall performance completely precise automatically created group correspond terminal window grouping process known session normally terminal window corresponds session way session come existence session explained book having learned urgency importance resource allocation important lesson clari cation understand user mean sentence higher priority thread b user want devote twice processing time b higher priority sense meriting larger proportion resource user want devote processing time running b spare moment go waiting state higher priority sense greater importance greater urgency unfortunately operating system traditionally given user rich vocabulary directly express goal example unix family operating system including mac o x linux provides way user specify niceness thread word nice understood sense nice thread prone saying right ahead wait word high niceness akin low priority di erent member operating family interpret single parameter niceness di scheduling goal original tradition mac o x adheres niceness expression importance nice thread normally run spare processor time newer scheduler linux instead interpret niceness number expression resource allocation proportion nicer thread getting proportionately processor time pointless arguing interpretation niceness right problem user di erent thing want tell scheduler able control knob luckily operating system provided somewhat sive vocabulary user control example mac o x allows user express urgency thread deadline related formation importance niceness di erent class thread placed hierarchicial relationship assumption thread explicit urgency information important similarly scheduler including linux use niceness proportion control allow thread explicitly agged thread receive processing unless processor idle summary section figure show taxonomy scheduling goal described figure preview scheduling anisms section figure show goal designed satisfy scheduling goal control performance throughput response timeurgency importance resource allocation figure user want scheduler improve performance allow user control di erent performance goal high throughput fast response time di erent way user exert control specifying thread urgency importance resource chapter scheduling scheduling mechanism proportional share section priority fixed priority section dynamic priority earliest deadline section decay usage section figure scheduling mechanism based running highest priority thread pacing thread receive tional share processor time priority xed adjusted ect deadline thread nish thread processor usage mechanism goal xed priority urgency importance earliest deadline urgency decay usage importance throughput response time proportional share resource allocation figure scheduling mechanism present explain satisfy scheduling scheduling scheduling scheduler use numerical priority thread control thread selected execution thread higher priority selected preference lower priority thread left runnable state running thread lower priority running simplest way priority assigned user manually specify priority thread generally default value explicitly speci ed way user manually change thread priority speaks scheduling long operating automatically adjusts thread priority scheduling achieve user goal limited circumstance simple real system o er option example linux microsoft window allow priority scheduling selected speci c thread thread precedence scheduled using mean discus section fact scheduling included international standard known posix operating system attempt follow aside priority xed important note real system use smaller priority number indicate preferred thread larger priority number indicate preferred priority thread actually indicated lower priority number book consistenty use priority priority mean preferred independent encoded number particular scheduler run queue kept data ture ordered priority studied algorithm data structure know theory using clever sentation priority queue binary heap practice operating system use simpler structure use small range integer priority array entry possible priority rst entry contains list thread highest priority second entry contains list thread highest priority forth processor idle thread terminated entered waiting state scheduler dispatch runnable thread highest available priority scheduler compare priority thread runnable newly initiated chapter scheduling waiting newly runnable thread higher priority running thread scheduler preempt running thread lower priority thread cease run return run queue place scheduler dispatch newly runnable thread higher priority possible strategy exist dealing tie runnable thread equally high priority assume processor run thread higher priority possibility run thread runnable rst wait event chooses voluntarily yield processor second equally thread dispatched possibility share processor attention thread tied highest priority alternating fashion thread run small interval time typically ten hundred millisecond preempted clock interrupt handler thread equal priority dispatched cycling eventually rst thread posix standard provides option user select rst rst fifo policy round robin rr policy scheduling viable open ronment user accidentally create thread run long time environment thread carefully design priority scheduling reasonable choice particular frequently used system control aps airplane wing thread system normally perform periodic task example thread wake second make particular adjustment aps sleep remainder second task deadline complete deadline missed program failed meet speci cation meant real time simplest case deadline period example second adjustment second designer like know thread running carefully analyze ensemble make sure deadline missed order designer need estimate long thread run period illustrate analysis schedule time simple example assume thread periodic deadline equal period interaction competition single processor scheduling general idea extended case assumption hold read book devoted speci cally system key theorem proved liu layland article make easy analyze periodic scheduling thread meet deadline xed priority signment assignment prioritizes thread shorter period longer period icy known scheduling check deadline met consider case situation thread period start moment test schedule feasible assign orities fashion assume thread newly runnable time plot happens seeing deadline missed test feasibility schedule conventional use agantt chart used priority schedule work given set thread scheduling approach xed priority work necessary redesign using demanding thread hardware processing power gantt chart bar representing passage time divided region labeled thread running corresponding time interval example gantt chart show thread running time time time time thread run time time consider example periodically executing thread period deadline second execution time period second period deadline second execution time period second surface look like just barely feasible single processor average demand half processor second average demand half processor second chapter scheduling totalling fully utilized oversubscribed processor assume overhead time context switching thread accounted including thread case execution time really work missed line need draw gantt chart determine thread processor need shorter period assign higher priority liu layland theorem assume ready start period time rst second resulting gantt chart look like note run initially thread runnable higher priority making deadline go waiting state time able start running nately second running time runnable start second period time moment preempted thread occupies processor time miss deadline time run second accept liu layland theorem know switching assignment higher priority wo solve problem taking theorem face value draw gantt chart alternative priority assignment exercise thread miss deadline section present scheduling mechanism handle preceding scenario successfully time scheduling suppose execution time second second period detail case gantt chart rst second look follows notice managed execute second period managed execute second period scheduling missed deadline able convince need look timeline pattern rst second repeat subsequent second scheduling scheduling exible allowing ing automatically adjust thread priority ect changing cumstances relevant circumstance appropriate adjustment make depend user goal trying achieve section present couple di erent variation theme cally adjusted priority continuity section section show priority dynamically adjusted periodic time thread using technique known earliest deadline scheduling section explains decay usage scheduling dynamic adjustment policy commonly used computing environment earliest deadline scheduling saw section scheduling optimal priority scheduling method schedule thread needed second needed second goal achievable optimal method dynamically assigning priority thread method known est deadline edf edf scheduling time thread runnable priority according following rule sooner thread deadline higher priority optimality edf liu layland theorem consider example needing second needing second using edf scheduling gantt chart rst second execution follows need continue gantt chart start repeating notice thread miss deadline receives second processor time period receives second processing period work better scheduling thread chapter scheduling prioritized di erently di erent time time prioritized deadline sooner time versus runnable second time time get lower priority later deadline time versus processor nishes work rst period work starting second period work example tie priority time runnable time deadline break priority tie favor thread obtain preceding gantt chart practice correct way break tie result fewer context switch theoretical sense strategy work equally exercise redraw gantt chart assumption preempted order run decay usage scheduling bene t control system ing airplane ride crashing prominent computer life instead notice workstation computer use daily chore like typing book computer execute thread task keeping le sic decoding playing natural rate typically computer user goal expressed term deadline term desire quick response interaction high throughput processing major computation dynamic ority adjustment help goal operating system mac o x microsoft window occasionally user workstation computer want express opinion priority certain thread order achieve goal related urgency importance resource allocation work especially importance example search sign terrestrial intelligence rated low priority based small chance success ed priority serve base priority operating use starting point automatic ments time user accept default base priority thread reason thread di er priority automatic adjustment simplicity subsequent discussion assume thread base priority kind thread tie priority scheduling rating automatic adjustment processed fashion discussed earlier get run time slice scheduler switch thread length time thread allowed run switching called quantum time slice thread need run time slice example make request waiting state long time slice case scheduler immediately switch thread reason operating adjust priority maximize throughput situation thread example chapter introduced scenario user running graphic rendering program window running virus scanning program window indicated operating processor disk busy resulting improved throughput relative using computer time disk working read request virus scanner processor doing graphic rendering soon disk transaction complete scheduler switch processor attention virus scanner way virus scanner quickly look data read issue read request disk drive work delay graphic program time run virus scanning thread waiting disk order achieve interleaving thread operating need assign thread higher priority reason operating adjust priority mize response time situation interactive thread competing computationally intensive thread example pose running program window trying set new world record computing digit window typing term paper long pause rummage note try think write mind cessor giving attention computing moment inspiration start typing want word processing program precedence respond quickly keystroke operating given word processing thread higher priority notice situation computationally intensive thread competing thread unable use processor chapter scheduling waiting disk transaction complete waiting user press key operating adjust upward priority thread waiting state adjust downward priority thread running state nutshell decay usage scheduler mac o x scheduler microsoft window t general pattern strictly decay usage scheduler discus scheduler remainder section decay usage scheduler mac o x adjusts thread priority downward base priority ect recent processor usage thread cap justment matter thread run priority sink minimum value thread recently running lot priority substantially lower base priority thread run long time waiting user example priority equal base priority way thread wake long waiting period priority thread able run thread recent processor usage increase thread run decay thread wait shown figure thread running usage increase adding time ran thread waiting usage decrease multiplied constant example mac o x multiplies usage time second continuously updating usage thread calculate update particular thread usage just state change paragraph currently running thread usage updated ily yield processor time slice end face potential preemption thread come waiting state point time thread running added usage priority correspondingly lowered mac o x time spent running state scaled current overall load added thread usage way thread run time high load priority drop quickly numerous contending thread chance run thread spending time waiting state usage adjusted downward ect number decay period elapsed example mac o x usage multiplied n scheduling usage timepriority timebase priority figure decay usage scheduler mac o x us thread usage increase run decay exponentially wait cause priority decrease running increase waiting number eighth second elapsed exponential decay fraction second waiting bring priority way base second waiting thread previously ran great deal base priority fact mac o x approximates na thread waiting second exactly base priority microsoft window us variation theme recall decay usage scheduler adjusts priority downward base ect recent running restores priority base thread wait window doe reverse thread come wait state given elevated priority sink base priority thread run net e ect thread waiting get higher priority running di erence speci c numerical size change calculated thread run window decrease priority base linear fashion decay usage scheduling window doe use exponential decay boost waiting thread instead thread waiting given priority boost depends waiting small boost waiting disk drive larger boost waiting input keyboard forth larger boost chapter scheduling associated kind waiting usually longer net e ect broadly similar exponential decay usage estimate achieves described section scheduler store run queue array thread list priority level case implement priority adjustment moving thread level fore mac o x microsoft window scheduler considered example broader class multilevel feedback queue scheduler original multilevel scheduler placed thread level primarily based main memory used used longer time slice lower priority level today important multilevel feedback queue scheduler approximating scheduling advantage decreasing priority running process base mac o x base microsoft window doing normally prevent runnable thread permanently ignored thread higher base priority course window partisan reply base priority indicate importance important thread arguably ignored practice totally shutting thread bad idea son phenomenon priority inversion explain ter window small escape hatch second temporarily boost priority thread unable dispatched thing notice foregoing example tendancy magic number crop scheduler usage decayed factor time second factor time second time quantum execution millisecond millisecond doe microsoft window boost thread priority waiting keyboard input ve seven answer question designer tuned numerical parameter scheduler trial error experiment using workload similar expect encounter real use keeping workload xed imenter varies scheduler parameter measure performance indicator response time throughput set parameter optimize measure performance workload careful systematic experimentation parameter likely user happy time administrator adjust parameter suit particular need installation scheduling leaving decay usage scheduler worth pointing kind user goal scheduler good achieving suppose thread decided like devote processor attention thread start running processor time want rst thread twice processing thread principle able achieve resource allocation goal decay usage scheduler appropriately ddling base priority thread practice come appropriate base priority achieve desired processor proportion kind goal important user di erent form scheduler used discus section scheduling resource allocation primary user goal scheduler need somewhat perspective approach discussed far focusing just thread important run moment scheduler need pacing thread doling processor time controlled rate researcher proposed basic mechanism controlling rate thread granted processor time thread granted use processor equally just simple larger location granted longer time slice time smaller allocation mechanism known weighted robin scheduling wrr uniform time slice used thread larger allocation run thread smaller allocation rotation list runnable thread name used mechanism ing context minor variation weighted fair queuing wfq stride scheduling virtual time scheduling vtrr uniform time slice used thread larger allocation chosen run average cause thread selected lottery weighted odds chapter scheduling sort rotation mechanism called lottery ing lottery scheduling terribly practical thread appropriate share processing time long run signi deviation short run consider example thread half processing time duration twentieth second thread run time second thread shut second risking major loss responsiveness just having string bad luck coin ipped time second day long come head time row point programming project calculate probability discover course day chance thread going second running actually quite high despite shortcoming lottery scheduling received considerable attention research literature turning approach illustrate di erence example suppose thread allocated resource proportion half processor time weighted scheduling following gantt chart time millisecond taking approach use xed time slice millisecond sitting round sitting round gantt chart rst scheduling round look follows pattern repeat weighted scheduling advantage fewer thread switch weighted fair queueing hand thread lated runtimes consistently close desired proportion cise allows explore di erence linux ed niceness thread control proportion processor time thread receive core scheduling algorithm weighted rst gantt chart separate scheduling policy used scheduling thread discussion concern scheduler used ordinary thread scheduler called completely fair scheduler cf multiprocessor cf schedule thread running cessor largely independent mechanism balance overall computational load processor note revisit question scheduling t multiprocessor context directly assign niceness level time slice cf assigns niceness level weight calculates time slice based weight runnable thread thread given time slice tional weight divided total weight runnable thread cf start target time long make complete runnable thread suppose example target millisecond runnable thread equal niceness equal weight thread run millisecond independent niceness niceness thread run millisecond notice rate dependent overall load unlike xed time slice mean using cf loaded tend sacri ce throughput order retain desired level responsiveness level responsiveness controlled target time thread wait successive opportunity run settable administrator value millisecond used example default uniprocessor system load extremely high cf doe tinue sacri cing throughput response time lower bound little time thread receive point reached adding additional thread increase total time cycle thread continuing reduce time minimum time thread parameter administrator gure default value cause time thread stop shrinking number runnable thread reach consider case thread share cpu niceness niceness cf assigns niceness level weight respectively time thread proportional roughly time large estimate thread niceness receive approximately millisecond millisecond chapter scheduling thread niceness receive approximately millisecond millisecond result achieved thread niceness weight approximately ratio generally cpu proportion determined relative di erence niceness absolute niceness level weight arranged geometric progression analogous musical scale particular interval major fth harmonic quality matter scale positioned ratio frequency having seen overview niceness control allocation processor time cf discussion actual mechanism used meter processor time cf scheduling mechanism based big idea lot smaller detail largely ignore big idea keeping track thread total running measured unit scaled accordance thread weight niceness thread credited nanosecond running nanosecond time elapses thread running niceness thread credited approximately nanosecond running nanosecond actually run precisely credited nanosecond running actual nanosecond given funny accounting running thread doing called virtual runtime goal keeping thread running proper proportion simply amount running whichever furthest cf devoted cpu thread furthest constantly switching forth thread instead scheduler stick current thread time slice run preempted waking thread scheduler doe choose new thread pick thread minimum virtual runtime long haul virtual runtimes kept approximately ance mean actual runtimes kept proportion speci ed thread weight ect thread niceness concept keeping virtual runtimes balance important consider couple concrete example consider case thread equal niceness scheduler try make sure thread run equal amount time xnanoseconds elapsed thread run nanosecond make exactly true scheduler need switching forth thread instead scheduling uler willing stick thread length time time slice result millisecond instead thread having run millisecond maybe thread run millisecond thread b run millisecond shown ure scheduler decides thread run pick run millisecond thread b chance catch thread way check later wo thread continuing advantaged thread instead thread taking turn run di erence large millisecond example suggests consider happens thread di erent niceness example suppose thread niceness thread b niceness make arithmetic easier let pretend exactly thread run exactly time thread scheduler did worry problem switching thread ideal situation millisecond longer thread run millisecond instead ideal thread run millisecond thread b millisecond scheduler switching thread discrete time slice expire ideal situation actually happen instead thread run millisecond thread b run millisecond shown figure run longer say thread b allowed catch fact thread b run longer ought remember really ought run millisecond way scheduler gures multiplies thread time scaling factor thread scaling factor thread b actual runtimes millisecond millisecond virtual runtimes millisecond millisecond looking virtual runtimes clear thread virtual millisecond thread b ahead virtual millisecond scheduler know choose thread run notice thread thread b example ideal situation having received real millisecond real millisecond virtual runtimes exactly tied thread run virtual millisecond scaling factor taken account description accumulating virtual runtime chapter scheduling b runtime b figure thread thread b niceness accumulates millisecond virtual runtime elapsed millisecond run gure show gantt chart cating thread running point gure plot virtual runtime versus time thread solid thread b dashed millisecond point scheduler choose thread b run lower virtual scheduling b runtime ab figure thread accumulates millisecond virtual runtime elapsed millisecond run thread b lates virtual runtime approximately time fast rate niceness gure show gantt chart indicating thread running point gure plot virtual runtime versus time thread solid thread b dashed millisecond point scheduler choose thread run lower virtual runtime corresponding fact run twice thread b time assuming thread remained runnable time actual linux cf scheduler given equal time slice shown accounting virtual runtime work case chapter scheduling thread started rst booted stayed continuously runnable need bit enhancement deal thread created waking timed sleep wait uler did special run caught thread ridiculous runtime newly created thread asleep long time giving runtime thread deprive thread normal opportunity run thread brie y run queue cf actually doe allow catch runtime thread threshold time wake virtual runtime set forward slightly minimum virtual runtime previously runnable thread way run soon longer usual similar e ect achieved dynamic priority adjustment decay usage scheduler microsoft window adjustment goal proportional sharing responsiveness throughput newly created thread given virtual runtime slightly greater minimum virtual runtime previously runnable thread essentially just run waiting turn run run queue kept sorted order runnable thread virtual runtimes data structure used purpose tree variant binary search tree property leaf twice deep leaf cf scheduler decides switch thread switch leftmost thread tree earliest virtual runtime scheduler performs thread switch circumstance expiration time slice new thread enters run queue provided currently running thread just recently started running gurable lower limit quickly thread preempted advantage positioning runnable thread timeline virtual runtimes represented tree naturally prevents waking thread starving thread remained runnable possible earlier linux scheduler time march thread wake inserted timeline later later virtual runtimes runnable thread patiently waiting cpu hand retains xed virtual runtime eventually lowest virtual runtime chosen run thread switch occurs security scheduling security scheduling kind attack relevant scheduling denial service do attack attack goal preventing legitimate user able use denial service attack frequently nuisance motivated little immaturity perpetrator sophisticated scheme example consider consequence used coordinating military force vulnerable denial service attack straightforward way attacker misuse scheduler order mount denial service attack usurp mechanism provided administrative control recall scheduler typically provide control parameter thread deadline priority base priority resource share authorized administrator need able say thread really low priority analogous statement parameter attacker exercise control denial service attack simple giving low priority critical thread real operating system guard interface typically user authenticated ular thread bona administrator control thread scheduling parameter generally owner thread user ran program created thread naturally relies aspect security consider later chapter protected tampering able authenticate identity user programmed fashion check evaded real system guard unauthorized user thread attacker use slightly sophisticated strategy targeted thread compete tacker create thread attempt siphon o scarce resource processor time little left targeted thread response designer arrange denial service attack cumbersome easily tinguished normal behavior interdicted example recall single thread high xed priority completely starve normal thread system prohibit normal user running thread reserving privilege authorized istrators fact typical system place o xed priority chapter scheduling priority subject adjustment result attacker run concurrent thread order drain o signi fraction processor time legitimate user generally wo reason denial service attack distinguished ordinary behavior limit number thread user constrain denial service attack causing user hardship inevitably degree denial service attack mitigated degree normal user retain exibility create thread alternatively scheduling policy used intrinsically resistant denial service attack particular ulers considerable promise regard version linux cludes assign resource share user larger group share subject hierarchical subdivision originally proposed waldspurger lottery scheduling observed disfavored susceptibility unfairness distribution processing time waldspurger later showed hierarchical proach used stride scheduling deterministic share scheduler subsequently used variety scheduler server thread lifetime process quest originating di erent user present additional cation resource allocated user user funding server thread resource consumption simplest approach special user just purpose large resource allocation provide work server thread doe behalf user unfortunately prevent denial service attack user submits request server thread use entire processor time allocation deny service user request server thread admittedly thread using service isolated problem small solace server thread question critical address issue recent research suggested thread able switch user resource allocation thread handle di erent request idea allocate resource rectly thread independent resource container instead time thread draw resource resource container switch drawing di erent resource container solves problem fairly accounting server thread usage multiple thread draw single resource container security scheduling proposal prevent user receiving processor time running thread finally mind approach processor scheduling taken prevent denial service attack attacker simply whelm resource processor time example attacker frequently targeted system limited ability establish new work connection nonetheless comprehensive approach security need include processor scheduling networking component exercise gantt chart introduced context scheduling used illustrate scheduling concept concerning response time suppose thread gered event time need run second respond suppose thread triggered event occurring second later trigger need run second respond draw gantt chart following case indicate response time response time average response time allowed run completion run b preempted triggered pleted doe resume c preempted triggered thread executed fashion starting completes time slice quantum second suppose linux running thread run nite loop body just chew processor time given thread run user thread run second user logged network second terminal window doe scheduler user fair share processor time doe thread fair share answer depends group scheduling feature left default guration disabled provide answer case answer question text chapter exploration project behavior prefer explain chapter scheduling draw gantt chart thread scheduled dance xed priority higher priority thread run periodically period deadline second execution time period second period deadline second execution time riod second assume thread start period time draw gantt chart far thread missing deadline draw gantt chart thread scheduled dance earliest deadline policy thread tied earliest deadline preempt thread favor newly runnable thread thread run periodically period deadline second execution time period second period deadline second execution time period second assume thread start period time draw gantt chart point start repeat deadline met suppose thread available run time need second processing respectively suppose thread run completion starting draw di erent gantt chart possible order thread run chart compute turnaround time thread time elapsed ready time complete compute average turnaround time order order shortest average turnaround time scheduling policy produce order following analysis relevant lottery scheduling used programming project consider coin weighted come head probability pand tail probability value pbetween let f n k p probability sequence ntosses coin run k consecutive head prove f n k p ned following recurrence ifn k f n k p f n k p ifn k f n k p k p k p security scheduling b consider probability ntosses fair coin leastkconsecutive head kconsecutive tail equal f c alternative formula b rectly suggested probability ntosses having ther kconsecutive head kconsecutive tail calculated f n k n k equivalently n k explain reasoning lead incorrect formula point fallacy reasoning additionally di erence answer incorrect formula correct formula b small case use enumeration possibility verify answer correct section show gantt chart example thread share processor proportion rst gantt chart show thread scheduled using wrr second using wfq gantt chart draw corresponding graph line thread showing thread accumulated virtual runtime vertical axis versus real time horizontal axis thread accumulate millisecond virtual runtime millisecond actually run similarly thread accumulate millisecond virtual runtime millisecond run thread accumulate millisecond millisecond run graph line start end look far line deviate diagonal connecting point scheduling approach keep line closer diagonal ect close approach coming continuously metering computation thread respective rate draw variant figure page based assumption scheduler devotes millisecond thread onds thread b millisecond thread scheduler called choose thread millisecond point choose chapter scheduling programming project install modi ed linux kernel test e ect eliminating dynamic priority adjustment nd relevant code le able demonstrate change process share processor accordance niceness able demonstrate responsiveness interactive process degraded lot process running testing response time process read input user easily quantitative result process repeatedly sleep measure longer sleeping period actually requested write report explain did hardware software text did carefully replicate result consider coin weighted come head abilitypand tail probability value pbetween let f n k p probability sequence ntosses coin run kconsecutive head write program calculate f n k p using recurrence given exercise make program reasonably need use algorithm design technique known namic programming create element array ifrom ton ll element iof array withf k p calculation value offrequires value f retrieve required value array using recursive end return elementnof array b thread b selected probability time slice second probability day thread second running f calculate value using program c performance better thread b go long time running thread doe use result exercise b calculate probability thread b go second processor time course security scheduling exploration project experimentally verify answer exercise help user topcommand fraction processor thread get disable automatic group scheduling boot kernel noautogroup option experimentally measure impact niceness cessor time given thread uniprocessor system access ing compare scheduler linux us decay usage scheduler mac o x older version unix sure experiment idle write simple test program just loop run copy normally niceness using nice command elevated niceness use topcommand observe fraction processor thread get repeat test using di erent degree elevated niceness repeat test situation thread niceness example normal niceness thread elevated niceness thread write report explain did hardware software context did carefully replicate result try draw conclusion suitability niceness resource allocation tool system studied note order observe impact niceness linux need run thread single scheduling group simplest way run thread single terminal window alternatively boot kernel noautogroup option instruction project assume using linux analogous exploration possible system speci c command di er portion project assume permission run thread narily requires administration privilege portion project omitted requisite permission portion project assume processor single processor chip fact single core chapter scheduling ability run thread quite old computer fail meet assumption old computer omit portion project program shown figure run number thread speci ed command line main thread creates child thread thread get time day start running continues running time day second later save source code program compile using following command thread suppose run program single processor using mal cf scheduler increase number thread expect happen total elapsed time program need run stay nearly constant approximately second grow linearly upward second test prediction run following command look elapsed time report schedtool program used command order limit thread single processor processor number schedtool time schedtool time schedtool time schedtool time b suppose run program single processor using scheduler thread priority level scheduled using fifo rule increase number thread expect happen total elapsed time program need run stay nearly constant approximately second grow linearly upward second test prediction run following command look elapsed time report schedtool program used command limit thread single processor specify fifo scheduling priority level sudo program used security scheduling include include include include include include iostream include sstream include void killtime int sec struct timeval start gettimeofday start perror gettimeofday exit gettimeofday perror gettimeofday exit sec sec return void run void arg killtime return figure rst portion program run number thread speci ed command line thread run second time elapsed thread started program continued chapter scheduling int main int argc char argv int nthreads std argv nthreads thread int code int code thread run code std failed strerror code std exit run int code thread code std failed strerror code std exit return figure second portion program run number thread speci ed command line thread run second time elapsed thread started program continued previous security scheduling run administration privilege assuming permission allows fifo scheduling selected sudo schedtool time sudo schedtool time sudo schedtool time sudo schedtool time c time output line generated prior ments included elapsed time user processor time add user sor time total processor time nd total case quite similar elapsed time thread program kept processor busy essentially time suppose switch using processor mal cf scheduling expect happen total processor time number thread go test prediction run following command schedtool time schedtool time schedtool time schedtool time d suppose use processor fifo ing expect happen total processor time number thread go elapsed time expect happen number thread go test prediction run following command sudo schedtool time sudo schedtool time sudo schedtool time sudo schedtool time note motivated notion thread state explaining busy waiting indicated alternative thread want wait notify operating issue recognized early chapter scheduling operating system example paper codd et al quoted chapter remark sake use machine demand programmer compiler point reached problem program activity central processing unit proceed operation completed control passed supervisory program problem program serviced program today called operating remarked main cost thread switching lost cache formance observation quanti ed various measurement study regehr use term quantum time slice interchangeably keeping contemporary usage early operating system used word ferently quantum ner subdivision coarser time slice subset runnable thread brief quantum thread received quantum use time slice moved thread place mentioned multilevel feedback queue lottery stride scheduling passing early reference number respectively liu layland wrote seminal article ing survey scheduling ized realistic circumstance article sha rajkumar sathaye drew example real system scheduler mac o x crosoft window linux mac o x linux reliable way nd information reading kernel source code did version darwin linux microsoft window source code publicly available conversely doe need dig nd detailed description careful russinovich solomon book segue decay usage scheduling scheduling remark principle achieve proportional share suitably setting base priority decay usage scheduler practice map proportion base priority matical modeling study hellerstein provides evidence aspect claim hellerstein explicitly show principle achieve term rate objective explicitly show practical reading graph carefully security scheduling choice service rate insensitive base priority render proportion reach region extreme sensitivity jump potential proportion stepping base priority di erence remarked linux cf act uler processor relatively independent mechanism used apportion thread processor considering concept directly applied multiprocessor context rst question mean pose thread runnable weight single processor clear rst cessing capacity processor thread receive half total processing capacity thread receive half leaving processor idle half time practical approach thread use processor generalizing suitable nition weight behave multiprocessor requires care chandra coworkers explained work fair scheduling nitional question resolved question scheduler run multiple processor bottleneck synchronized access single run queue active research topic distributed weighted round robin scheduler li baumberger hahn look promising alternative scheduling augment uler resource manager adjusts thread priority heavily utilized achieve desired resource allocation example approach window resource manager microsoft includes window server resource manager support policy divide cpu time equally process user remote desktop session web application pool allowing user group given larger share detail appear publicly documented information available microsoft online technet library resource container described banga druschel mogul chapter schedulingchapter synchronization deadlock introduction chapter seen operating support concurrent thread execution time come consider support controlled interaction thread thread running time computer inherently interact reading writing common set memory location hard providing control particular chapter examine control relative timing execution step place di ering thread recall scheduler granted considerable authority ily preempt execution thread dispatch thread scheduler response unpredictable external event long request take complete computational step taken thread interleaved quite predictable manner unless programmer taken explicit measure control order event control measure known nization usual way synchronization control event ordering causing thread wait section provide detailed case tion needed describing problem occur interacting thread properly synchronized uncontrolled interaction called race examining typical race illustrate need particular form synchronization mutual exclusion mutual exclusion ensures thread time operate shared data chapter synchronization deadlock ture resource section present closely related way mutual exclusion obtained known mutexes monitor covering mutual exclusion turn general chronization challenge mechanism address lenges example want ensure memory location read lled useful value devote section enumerating common synchronization pattern mutual exclusion afterward devote section popular mechanism used handle uations condition variable important extension monitor combination monitor condition variable allows situation cleanly handled semaphore old favorite provides single simple mechanism principle nization problem semaphore hard understand use correctly synchronization solves problem race create new problem deadlock recall synchronization typically involves making thread wait example mutual exclusion thread need wait turn order enforce rule time deadlock result cycle waiting thread form example thread wait thread b happens waiting thread shown figure pathology result waiting address practical cure section completing study mean synchronization waiting interacts scheduling topic chapter interesting way particular unless special precaution taken chronization mechanism subvert priority scheduling allowing priority thread run thread wait section brie y consider interaction synchronization scheduling tame thread wait wait forthread b figure deadlock result thread wait complete cycle simple example thread waiting thread b waiting thread race need mutual exclusion section address problem deadlock unwanted scheduling interaction root cause problem worth considering underlying problem thread block progress thread undesirable absence dramatic symptom deadlock blocked thread ca advantage available processing power produce useful result ternative nonblocking synchronization technique increasingly important number processor core typical computer grown section brie y address topic showing data structure safely support concurrent thread blocking progress finally conclude chapter section looking security issue related synchronization particular subtle nization bug nearly cause malfunction unless provoked exploited attacker order circumvent normal security policy concluding section provide exercise ming exploration project note despite wide range topic cover chapter leave later chapter atomic transaction particularly sophisticated important synchronization pattern monly encountered middleware devote chapter entirely explicitly passing message thread example network provides synchronization communication message received transmitted despite synchronization role chose address various form message passing chapter chapter related communication race need mutual exclusion thread operate shared data structure strange malfunction occur timing thread turn cisely interfere example consider following code appear sellticket procedure event assigned seat seatsremaining dispenseticket seatsremaining seatsremaining displaysorrysoldout chapter synchronization deadlock surface code look like sell ticket seat available happens multiple thread controlling di erent point sale executing code time people try buy ticket human perceive moment time scale computer probably happen rst second shown figure case blue moon timing exactly wrong following scenario result shown figure thread check seatsremaining seatsremaining test succeeds thread rst branch thread b check seatsremaining seatsremaining test succeeds thread b rst branch thread dispenses ticket decrease seatsremaining thread b dispenses ticket decrease seatsremaining customer wind sitting lap course plenty equally unlikely scenario result misbehavior exercise come scenario starting seatsremaining thread dispense ticket butseatsremaining left scenario example race race thread use data structure mechanism ensure thread us data structure time thread precedes interleaved program malfunction generally malfunction expressed invariant property thread thread b seatsremaining dispenseticket seatsremaining displaysorrysoldout figure human think trying buy ticket time chance good thread thread example run thread b correctly discover seat race need mutual exclusion thread thread b seatsremaining seatsremaining dispenseticket dispenseticket figure thread b interleaved act ticket left sell really exists violated example invariant value ofseatsremaining nonnegative added number ticket dispensed equal total number seat invariant assumes seatsremaining initialized total number seat invariant involves variable race result thread read variable modifying example suppose variable recording ticket sold recording cash money drawer invariant relation number ticket sold time price ticket plus starting cash equal cash hand suppose thread midst selling ticket updated variable exactly moment thread chooses run audit function inspects value variable nd inconsistent state inconsistency sound terrible similar sistency occurred medical setting variable recorded drug administer recorded dose dangerous inconsistency like happened radiation therapy machine occasionally lethal quences worse patient su ered terrible immediately lethal injury lingered time excruciating intractable pain example having thread rying operation data structure harmless long operation way time word interleaving thread execution need granularity plete operation selling ticket auditing cash drawer interleaving operation ok thread performs chapter synchronization deadlock operation row thread need alternate forth sale audit completed interruption reason interleaving complete operation safe designed rely invariant preserve provided initially construct data structure state invariant hold sequence whatsoever operation leave invariant intact needed synchronization mechanism allows thread obtain private access data structure begin work excluding thread operating structure conventional metaphor say thread lock data structure thread locked structure unlocks allowing thread turn thread midst operation temporarily excludes arrangement called mutual exclusion mutual exclusion establishes granularity thread interleaved scheduler mutexes monitor saw section thread share data structure need mechanism obtaining exclusive access structure mer arrange exclusive access creating special lock object associated shared data structure lock locked thread time thread locked lock said hold lock vocabulary obvious connection metaphor lock thread operate examine data structure holding corresponding lock discipline prevent race support form race prevention operating system ware generally provide mutual exclusion lock mutual exclusion lock ungainly shorter generally used programmer simply talk lock lead confusion synchronization mechanism called lock example troduce lock section mutex popular shortened form mutual exclusion lock ticular posix standard refers mutexes use book section present posix application programming interface api mutexes section present alternative mutexes monitor interface mutexes known monitor finally section show lie interface explaining mechanism typically used implement mutexes mutex application programming interface mutex state locked held thread unlocked held thread implementation texes way create mutex initialize state ventionally mutexes initialized unlocked state minimum operation lock mutex unlock lock unlock operation symmetrical sound unlock operation applied mutex locked operation doe job return making calling thread wait lock operation hand invoked lock locked reason calling thread need wait shown figure thread invokes lock operation mutex mutex locked state thread wait thread unlocked mutex point thread wanted lock mutex resume execution nd mutex unlocked lock proceed thread trying lock mutex switch mutex unlocked locked thread allowed proceed wait mutex unlocked behavior lock operation provides mutual exclusion thread proceed past point invokes lock operation single thread succeeds switching mutex unlocked locked thread unlocks mutex say hold mutex unlockedwait thread unlocklockedtry lock finish lockin glock unlock figure locking unlocked mutex unlocking locked change mutex state thread try lock mutex case thread wait acquires mutex lock thread unlocks chapter synchronization deadlock exclusive right safely operate associated data structure fashion freedom race exists regardless waiting thread chosen lock mutex question thread go rst matter reason return section basic operation initialize mutex lock unlock essential operation example test mutex immediately lockable waiting lock system rely manual reclamation memory operation destroy mutex longer used individual operating system middleware system provide mutex apis t general pattern described varying detail order concrete example api present mutex operation included posix standard standard di erent operating system provide api c apis posix api declare mutex initialize default attribute follows thread want lock mutex operate associated data structure unlock mutex following added operate protected data structure example figure show key procedure ticket sale example written c using posix api thread using mutex leaving unlocked state programmer pected destroy underlying memory reclaimed executing following procedure posix provides couple variant useful particular circumstance fers wait acquire mutex instead return mutexes monitor void sellticket seatsremaining dispenseticket seatsremaining seatsremaining cashonhand cashonhand price displaysorrysoldout void audit int revenue seatsremaining price cashonhand revenue printf cash fails exit figure procedure begin locking mymutex end unlocking race called concurrent thread additional code shown main procedure rst initialize mymutex chapter synchronization deadlock code unable immediately acquire lock allows programmer specify maximum time wait mutex acquired time return error code wide availability reason posix mutexes worth studying programmer allowed choose variant provide di erent answer question exceptional circumstance mutex apis include speci c answer question exposing range possibility question issue follows happens thread try unlock mutex unlocked locked di erent thread happens thread try lock mutex hold note thread wait unlock mutex situation constitute simplest possible case deadlock cycle waiting thread consist single thread waiting posix standard allows programmer select di erent type mutexes answer question di erent way pthread mutex default thread try lock mutex hold unlock doe hold bet o happen programmer responsibility make attempt di erent system behave di erently pthread mutex error check thread try lock mutex hold unlock mutex doe hold operation return error code pthread mutex normal thread try lock mutex hold go deadlock situation waiting unlock mutex just wait thread thread try unlock mutex doe hold bet o free respond like pthread mutex recursive thread try unlock mutex doe hold operation return error code thread try lock mutex hold simply increment mutexes monitor time thread locked mutex allows thread proceed thread invokes unlock operation counter decremented reach mutex really unlocked want provoke debate expert concurrent ming ask opinion recursive locking mutex behavior speci ed posix option pthread mutex recursive hand recursive locking get rid especially silly class deadlock thread wait mutex hold hand programmer recursive locking available follow disciplined development approach particular programmer track exactly lock held point program execution monitor structured interface mutexes programming involves packaging data structure procedure operate context mutexes used rigidly structured way state variable object kept private accessible code associated object object shared thread contain mutex additional eld eld containing object state method object private one used internally start locking object mutex end unlocking mutex immediately returning rule followed impossible thread race state object access object state protected object mutex programmer follow rule manually programming guage provide automatic support rule automation ensures rule consistently followed mean source program cluttered mutex e readable object automatically follows mutex rule called tor monitor programming language concurrent pascal used research setting cially popular language using monitor simple chapter synchronization deadlock keyword monitor beginning declaration class object public method automatically lock unlock automatically supplied mutex monitor language support synchronization feature condition variable discus section true monitor popular java programming language provides close approximation achieve nization java programmer need exercise raw mutexes importantly resulting java program essentially uncluttered true monitor program added keyword synchronized declaration nonprivate method java object automatically mutex associated recursively lockable kind programmer choose lock object mutex duration block code using synchronized ment synchronized someobject code holding someobject mutex note case code need operating state someobject doe code need method associated object word synchronized statement essentially exible using raw mutexes key advantage locking unlocking automatically paired advantage important eliminates big class programming error programmer forget unlock mutexes exceptional circumstance example procedure lock mutex beginning unlock end come ifstatement terminate procedure mutex locked synchronized statement exible typical java program use instead programmer add keyword synchronized declaration public method example ticketvendor class follow outline figure marking method synchronized equivalent wrapping entire body method synchronized statement synchronized body mutexes monitor public class ticketvendor private int seatsremaining cashonhand private static final int price public synchronized void sellticket seatsremaining dispenseticket seatsremaining seatsremaining cashonhand cashonhand price displaysorrysoldout public synchronized void audit check seatsremaining cashonhand private void dispenseticket private void displaysorrysoldout public ticketvendor figure outline class chapter synchronization deadlock word synchronized method object executed holding object mutex example sellticket method chronized di erent thread invoke served wait turn sellticket method implicitly locking mutex entry unlocking return just explicitly posix version figure similarly thread executing audit method need wait ticket sale progress method marked synchronized acquires mutex order program monitor style java need disciplined use private andpublic keywords including making state private need mark public method synchronized underlying mechanism mutexes subsection mutexes typically operate scene start version function correctly build version version mind throw away rst version play critical role nal version plicity version pthread mutex normal kind lock result thread try lock mutex hold exercise gure change needed pthread mutex recursive version mutex called basic spinlock spinlock queuing mutex increasing order sophistication meaning name apparent explain functioning kind mutex start basic spinlock modern processor architecture instruction used change content memory location obtain information previous content location crucially structions executed atomically indivisible unit broken arrival interrupt interleaved tion instruction processor detail instruction vary concreteness use exchange operation atomically swap content register content memory location suppose represent basic spinlock memory location contains mutex unlocked mutex locked unlock operation trivial unlock mutex just store lock operation bit trickier us atomic exchange operation express pseudocode shown figure key idea looping thread succeeds changing mutex long mutexes monitor lock mutex let temp repeat atomically exchange temp mutex temp figure basic spinlock version mutex memory location storing unlocked locked locking mutex consists repeatedly exchanging register containing memory location location changed thread hold lock thread keep swapping doe harm process illustrated figure understand motivation spinlock need know little cache coherence protocol multiprocessor system copy given block memory reside di erent processor cache long processor read memory location soon processor want write cache block communication cache necessary processor read value typically cache writing occurs invalidates cache copy exclusive ownership processor want write block need ushed rst cache loaded exclusively second processor alternately writing block continual memory interconnect cache block transferred forth cache exactly happen basic spinlock version mutex locking thread processor waiting lock atomic exchange instruction processor writing cache block containing spinlock contention mutex happen doe performance terrible motivate improvement spinlocks use simple approach basic spinlocks contention rid cache coherence waiting contended mutex order allow multiple processor wait lock generating outside individual cache waiting using read mutex mutex unlocked need try grabbing atomic exchange approach lead chapter synchronization deadlock temp mutex result temp mutex locking try successful locking mutex tempmutex mutexmutex figure unlocking basic spinlock consists storing locking consists storing using atomic exchange instruction exchange instruction allows locking thread verify value memory really changed thread repeat attempt pseudocode shown figure notice common case mutex acquired immediately version act just like original attempt acquire mutex fails di erently mutex eventually acquired way version mutexes presented far share key property explains called spinlocks engage busy waiting mutex immediately available recall discussion scheduling busy waiting mean waiting continually executing instruction check awaited event mutex us busy waiting called spinlock fancier version spinlocks exist described note alternative busy waiting notify operating thread need wait operating change thread state waiting wait queue eligible time processor instead scheduler use processor run thread mutex unlocked waiting thread runnable form mutex make use wait queue called queuing mutex spinlocks reason busy waiting thread doe make headway matter mutexes monitor lock mutex let temp repeat atomically exchange temp mutex temp mutex temp figure spinlocks represented way basic spinlocks using single memory location lock operation us ordinary read instruction place atomic exchange waiting mutex unlocked time spin loop using processor di erent thread bene t thread harming waiting aw argument overhead cost notifying operating desire wait changing thread state doing context switch attendant loss cache locality situation spinlock need spin brie y nding mutex unlocked thread actually waste time busy waiting waste getting thread way relative spinlocks queuing mutexes depends long thread need wait mutex available reason spinlocks appropriate use mutexes held brie y quickly acquirable ample linux kernel us spinlocks protect internal data structure brief operation example mentioned scheduler keep runnable thread run queue scheduler want insert thread data structure operate lock spinlock doe brief operation unlocks spinlock queuing mutexes needed case thread hold mutex long contender busy wait mutexes complex stored single memory location spinlocks mutex chapter synchronization deadlock memory location used record mutex state unlocked locked list thread waiting acquire mutex list allows scheduler place thread waiting state instead busy waiting using terminology chapter list wait queue spinlock used protect race operation mutex pseudocode refer component respectively assumption locking unlocking operation performed shown pseudocode figure figure illustrate functioning operation important feature note mutex design concern happens thread performs unlock operation mutex thread waiter list figure mutex state variable changed locked state unlocked state instead mutex left locked waiting thread woken word locked mutex passed directly thread really unlocked section explain design partially responsible convoy phenomenon section present alternative design mutexes put mutex unlocked state synchronization pattern recall synchronization refers form control relative timing thread synchronization includes just mutual exclusion programmer want impose restriction relative timing rule thread time section present pattern synchronization crop application bounded bu er lock barrier section just desired synchronization section technique used achieve synchronization pattern lock mutex lock fashion let unlock add current thread remove current thread runnable thread unlock yield runnable thread figure attempt lock queuing mutex locked state cause thread join wait queue unlock mutex lock fashion let thread runnable unlock figure waiting thread unlock operation queuing mutex cause thread runnable note case mutex left locked state e ectively locked mutex passed directly thread chapter synchronization deadlock thread locksmutex state waiter threadmutex state waiter thread locksmutex state waiter mutex threadstate waiter operation result figure locking queuing mutex unlocked simply change mutex state locking queuing mutex hand put thread waiter list thread unlocks thread unlocksmutex thread thread thread bmutex mutex state waiter thread bstate waiter operation result state waiter state state figure unlocking queuing mutex waiting thread simply change mutex state unlocking queuing mutex waiting thread hand leaf state set locked cause waiting thread start running having acquired synchronization pattern bounded bu er thread linked processing pipeline rst thread produce sequence value consumed second thread example rst thread extracting textual word document skipping formatting code passing word second thread speaks word aloud simple way organize processing strict alternation producing consuming thread preceding example rst thread extract word wait second thread converted sound second thread wait rst thread extracted word approach doe yield concurrency thread runnable time lack rency result suboptimal performance computer processor thread spends lot time waiting device instead consider running producer consumer concurrently time producer new value ready producer store value intermediate storage area called bu er time consumer ready value retrieve value bu er normal circumstance operate pace consumer go bu er retrieve value nd bu er consumer need wait producer catch want limit size bu er use bounded bu er need make producer wait get far ahead consumer lls bu er putting synchronization restriction place ensures long haul rate thread match short term run faster familiar bounded bu er pattern business real world example cook restaurant fry er concurrently cashier selling bounded bu er burger exact number burger bu er grow shrink somewhat group worker porarily little faster extreme circumstance doe group worker wait figure illustrates situation need wait easy place bounded bu er work computer system pipe feature built operating system including linux mac o x microsoft window analogous feature pipe allow output produced process serve input chapter synchronization deadlock cookbounded buffer burger cashiergrill figure cook fry burger place bounded bu er queued later sale cashier take burger bu er sell available cashier wait similarly bu er area cook take break frying burger example mac o x open terminal window shell following command l say run program concurrently rst l list le current directory second say convert textual input speech play computer speaker shell command vertical bar character indicates pipe rst program second net result spoken listing le mundane version example work mac o x system linux l tr run program concurrently time second tr copy character input output change ations way case replacing lowercase letter corresponding uppercase letter net result uppercase listing le le listing ahead transliteration long doe ow bu er operating provides pipe backlog listed le bu er transliteration run fast want exhaust synchronization pattern lock example synchronization pattern actually quite similar mutual exclusion recall example audit function needed acquire mutex auditing operation order make sure audit read consistent combination state variable design achieved correctness cost needlessly limiting concurrency prevented audit underway time operation possibly interfere goal rectify problem lock like mutex thread lock lock speci e planning writing protected data structure reading just mutex lock operation immediately complete instead wait time lock acquired di erence number reader hold lock time shown figure wait reader wait writer hold lock writer wait lock held thread writer reader lock particularly valuable situation operation time consuming reading le stored disk especially true reader expected choice mutex lock performance mutex simpler lower overhead lock pay overhead allowing concurrency interesting design question arises lock held reader writer waiting suppose new reader try acquire lock allowed forced wait writer surface reason reader wait coexist existing reader achieving greater concurrency problem overlapping succession reader writer waiting arbitrarily long writer wind waiting remaining reader arrived long writer did form starvation thread unfairly prevented running thread prevent particular kind starvation version lock make new reader wait waiting writer section learn build lock primitive synchronization mechanism lock generally useful provided chapter synchronization deadlock protected data structure reader writer wait wait wait wait waitwait wait wait figure lock held number reader writer lock held reader reader thread read protected data structure concurrently system actually build posix standard example includes lock procedure posix standard leaf dividual prioritize new reader versus waiting writer posix standard includes specialized form lock speci cally associated le ect earlier comment locking especially valuable reading time consuming le stored disk posix dard le lock available complex fcntl procedure operating system provide simpler face flock barrier barrier synchronization common synchronization pattern discus barrier commonly used program numerical calculation scienti c engineering application ulating ocean current crop tions long requirement thread group nish phase computation move condition variable scienti c computation thread dividing processing large matrix example thread process row matrix requirement thread nish phase processing starting come fact overall computation sequence matrix operation parallel processing occurs matrix operation barrier created initialized programmer speci e thread sharing thread completes rst phase computation invokes barrier wait operation thread wait operation doe immediately return thread calling immediately proceed exception whichever thread wait operation barrier tell thread programmer speci ed thread thread invokes wait operation wait operation immediately return waiting thread nally wait operation return illustrated figure proceed second phase computation typically barrier reused second phase forth word barrier reinitializes state release waiting thread just lock barrier ned term general synchronization mechanism little reason practice barrier provided posix widely available apis condition variable order solve synchronization problem described section need mechanism allows thread wait circumstance appropriate proceed producer need wait bu er space consumer need wait data reader need wait writer unlocked writer need wait reader unlock thread reached barrier need wait thread situation condition thread wait c condition video playback paused wait user press pause button example handled using condition variable chronization mechanism work partnership monitor chapter synchronization deadlock thread waitthread b thread c wait waitthread d wait start figure barrier created speci c number thread case thread invokes wait tion waiting thread group start running mutexes used style monitor basic operation condition variable wait notify system use signal instead notify thread nd circumstance liking cutis wait operation go sleep time thread invokes notify operation example bounded bu er producer wait condition variable nd bu er consumer freeing space bu er invoke notify operation condition variable delving important detail variant concrete ample helpful figure show java code boundedbuffer class explain example work return general discussion condition variable moment sider test class help reduce size bu er qualitatively di erent situation tested quickly second need test program multiple thread doing insertion retrieval way di erence operation started completes case retrieval need retrieved value correct designing test program surprisingly interesting experience programming project java object single condition variable automatically ated just mutex wait method wait object condition variable notifyall method wake thread condition variable public class boundedbuffer private object buffer new object arbitrary size private int numoccupied private int firstoccupied invariant numoccupied firstoccupied buffer firstoccupied contains th oldest entry numoccupied public synchronized void insert object o throw interruptedexception numoccupied wait space wait buffer firstoccupied numoccupied o case retrieves waiting data wake notifyall public synchronized object retrieve throw interruptedexception numoccupied wait data wait object retrieved buffer firstoccupied buffer firstoccupied null help garbage collector firstoccupied firstoccupied numoccupied case insert waiting space wake notifyall return retrieved figure boundedbuffer class using monitor condition chapter synchronization deadlock object condition variable method need called thread hold object mutex boundedbuffer example ensured straightforward way using wait andnotifyall inside method marked synchronized having seen wait andnotifyall need called mutex held spot problem waiting thread hold mutex way thread acquire mutex able notifyall learn rest story thread invokes wait doomed eternal waiting solution dilemma follows thread invokes wait operation hold associated mutex wait eration release mutex putting thread waiting state way mutex available potential waker waiting thread awoken reacquires mutex wait operation return case recursive mutexes used java awakening thread reacquires mutex lock count just unlock operation fact waiting thread temporarily release mutex help explain feature boundedbuffer example waiting beginning method ensures invariant intact mutex released generally waiting happen later long state variable updated long state second waiting loop condition veri ed hold doe method real work loop essential awoken thread need reacquire mutex contending thread trying acquire mutex guarantee awoken thread mutex rst guarantee state nd need wait waiting thread release mutex order wait dition variable action indivisibly way thread acquire mutex rst thread started waiting condition variable ensures thread notify operation thread want wait actually waiting addition waiting appropriate condition method invoked notifyall end method sition crucial notifyall method doe release mutex calling thread continues hold mutex reach end synchronized method awoken thread need quire mutex able make headway condition variable method nishes regardless method noti cation early version monitor condition variable described hoare used di erent approach notify operation immediately transferred mutex awoken thread contention waiting thread thread performing notify operation waited received mutex awoken thread today version described previously dominant particular used java posix api boundedbuffer code figure take aggressive proach notifying waiting thread end operation waiting thread woken using notifyall safe approach boundedbuffer state changed way thread thread sure notice thread care simply waiting program improved reducing noti cation remember correctness come rst optimization later fore optimizing check simple correct version actually performs inadequately approach reducing noti cation notifyall inside ifstatement cumstances unconditionally particular producer waiting bu er consumer waiting bu er time noti cation needed inserting bu er retrieving bu er programming project modify code ect test work approach reducing noti cation use notify method place notifyall way single waiting thread awoken waiting thread remember optimization considered straightforward version performs inadequately cautious attitude appropriate programmer nd tricky reason notify optimization quite order verify change notifyall notify correct need check thing danger waking thread way know waiting know able proceed looping waiting danger waking wrong thread way know waiting know chapter synchronization deadlock able proceed thread proceed got mutex rst thread property example waiting thread executing identical loop condition satis ed exercise condition hold theboundedbuffer example replacing notifyall bynotify safe case true noti cation operation unconditionally inside ifstatement limitation java object single condition variable boundedbuffer example thread wait dition variable waiting space insert method data retrieve method allows multiple condition variable associated monitor mutex use di erent condition variable allow speci cally notify thread waiting space waiting data posix api allows multiple condition variable mutex gramming project use feature rewrite boundedbuffer example separate condition variable used wait space used wait data posix condition variable initialized dependent particular mutex mutex instead passed gument condition variable waited somewhat arrangement current waiter need pas mutex operation sponding notify notifyall called api allows thread invoke holding corresponding mutex using exibility introducing race bug technique illustrated boundedbuffer applied equally lock barrier leave ming project importantly technique work c synchronization need example video player state variable indicates player rently paused playback thread check variable displaying frame paused wait condition variable thread set variable response user pressing pause button user interface put variable unpaused state doe notify operation condition variable develop application analogous programming project semaphore semaphore seen monitor condition variable quite general used synthesize synchronization anisms lock synchronization mechanism generality semaphore purpose semaphore natural resulting code application natural example bounded bu er result succinct clear code probably main reason tinued use instead hanging largely historical inertia having gotten head start tor semaphore date opposed early monitor asemaphore essentially unsigned integer variable variable nonnegative integer value semaphore freely operated arbitrary arithmetic instead operation allowed time semaphore created initialized nonnegative integer programmer choice semaphore increased operation generally called release letter vi short dutch word sense dijkstra originator semaphore use release semaphore decreased operation frequently called acquire orp pi dutch breviation use acquire semaphore value stay nonnegative thread performing acquire operation wait value thread performed release operation make value positive doe waiting thread continue acquire operation common use semaphore mutexes semaphore tialized serve mutex acquire locking operation release unlocking operation assuming locking locking properly paired semaphore value locked value attempt lock using acquire forced wait unlocked value locking proceed note semaphore used limited way advantage mutexes chapter synchronization deadlock program bug result attempt unlock unlocked mutex mutex signal error semaphore simply increase likely causing nasty behavior later thread allowed execute acquire better use semaphore keeping track available quantity resource free space data value bounded bu er thread creates unit resource increase semaphore thread wish consume unit resource rst doe acquire operation semaphore force thread wait unit resource available stake thread claim unit following pattern boundedbuffer class rewritten use semaphore shown figure us semaphore class package java api programming project instead write semaphore class using java mutexes condition variable order semaphore best possible light moved away using array store bu er instead used list provided java api programming project try rewriting example use array figure discover blemish need numoccupied integer variable figure duplicate information contained occupiedsem simply ferent form second need introduce explicit mutex nization synchronized statement code update nonsemaphore state variable complication semaphore lose charm using list hid extra complexity deadlock chapter introduced concurrency way solve problem sponsiveness throughput unfortunately concurrency created introduced synchronization solve lem race obvious question new problem arise chronization easy answer synchronization reintroduced original responsiveness throughput problem lesser degree cause synchronization reduces concurrency section synchronization creates entirely new problem potentially section explains problem known deadlock thread wind permanently waiting section deadlock import public class boundedbuffer private object buffer new object private static final int size arbitrary private semaphore occupiedsem new semaphore private semaphore freesem new semaphore size invariant occupiedsem freesem size occupiedsem buffer contains entry oldest youngest public void insert object o throw interruptedexception o public object retrieve throw interruptedexception object retrieved return retrieved figure alternative boundedbuffer class using chapter synchronization deadlock explain di erent solution problem deadlock problem illustrate deadlock arise consider highly simpli ed keeping bank account suppose account object component mutex current balance procedure transferring money account look follows pseudocode transfer sourceaccount destinationaccount lock lock unlock unlock suppose feeling generous transfer myaccount youraccount suppose feeling generous transfer youraccount tomyaccount luck end richer poorer transfer request completed start exactly happens execute concurrently mutexes prevent race condition sure account left inconsistent state note locked account entire duration transfer locking long update balance way auditor ca alarming situation money disappeared account appeared account race auditor consider following sequence event lock source account transfer lock lock source account transfer lock try lock destination account transfer try lock hold mutex forced deadlock try lock destination account transfer try lock hold mutex forced wait point waiting deadlocked generally deadlock exists cycle thread waiting resource held example thread resource involved mutexes deadlock involve resource consider lock example focus mutexes simplicity example deadlock involving thread consider generalizing preceding scenario transferring money bank count suppose example ve bank account numbered ve thread thread trying transfer money account shown figure transfer involves locking source destination account thread deadlock lock source account rst try lock destination account situation famous dressed dining philosopher problem dijkstra wrote group ve philosopher place round dining table ate particularly kind spaghetti required fork ve fork table pair adjacent plate shown figure apparently dijkstra concerned communicable disease mononucleosis thought ok philosopher seated left right particular fork share instead concerned possibility deadlock ve philosopher start picking respective fork wait fork available wind deadlocked exploration project thread source account destination account figure ve thread try transfer money source account destination account thread lock source account able proceed locking destination chapter synchronization deadlock figure philosopher numbered place circular dining table fork pair adjacent place philosopher try pick fork time deadlock result try computer simulation dining philosopher exploration project apply deadlock prevention approach described section dining philosopher problem deadlock usually quite rare special attempt prevent lock held long window opportunity deadlocking quite narrow like race timing exactly wrong noncritical choose ignore possibility deadlock need sional reboot deadlocking malfunction probably common nonetheless learn option dealing lock system critical ignoring known problem unprofessional section explain practical way address threat deadlock deadlock prevention resource ordering ideal way cope deadlock prevent ing practical technique deadlock prevention illustrated example transferring money bank account account stored computer memory speci ed numerical address use tation min mean whichever account object occurs lower address earlier memory similarly use max mean whichever occurs higher deadlock use ordering account ordering account number make transfer procedure transfer sourceaccount destinationaccount lock min sourceaccount destinationaccount lock max sourceaccount destinationaccount unlock unlock try transferring money try transferring money lock account mutexes order deadlock possible transfer run completion technique used mutexes source acquired known advance thread acquire resource need order increasing ory address matter thread resource involved deadlock occur example technique look code linux kernel recall chapter scheduler keep run queue hold runnable thread data structure kernel source code structure known rq processor multiprocessor rq scheduler move thread processor rqto need lock rqs figure show code note procedure us deadlock prevention technique nement test special case runqueues fact deadlock prevention possible particular ordering technique showed used mutexes need locking apparent computation proceeds following linked list data structure need consider coping deadlock preventing ex post facto deadlock detection order diagnose deadlock need information waiting suppose mutex record just locked unlocked thread held mation useful unrelated purpose implementing recursive mutexes additionally thread chapter synchronization deadlock static void struct rq struct rq lock lock lock lock fake lock lock lock lock figure linux scheduler us deadlock prevention locking run deadlock immediately acquire mutex waiting state record mutex waiting information struct resource allocation graph figure show example graph section sample deadlock bank account transfer square thread circle mutexes arrow mutex thread waiting acquire thread mutex currently held graph cycle show deadlocked test deadlock periodically thread waited unreasonably long time lock order test deadlock us standard graph algorithm check resource location graph contains cycle sort mutexes described book mutex held thread thread waiting mutex vertex graph greater allows somewhat simpler graph search directed graph deadlock detected painful action needed order recover deadlocked thread forcibly terminated rolled earlier state free mutexes hold general computing environment thread clean way rolled bit akin freeing bear trap cutting o leg reason ex post facto deadlock detection common purpose operating system environment ex post facto deadlock detection recovery work cleanly database system support atomic tions explain atomic transaction chapter need understand transaction cleanly rolled transfer transfer figure cycle resource allocation graph indicates deadlock square represents thread circle mutex arrow square circle show thread waiting mutex arrow circle square show mutex held chapter synchronization deadlock update database undone infrastructure available database system commonly include deadlock detection deadlock detected transaction fails rolled doing e ect releasing lock break deadlock allows remaining transaction complete transaction restarted figure show example scenario deadlock detection taken oracle database transcript show time interleaving di erent session connected database session shown left margin session shown indented space command line start prompt sql contain command typed user command line broken line t width book page explanatory comment start line output chapter recovery particular deadlock explanation transaction immediate deadlock detection approach deadlock presented far aimed time moment deadlock occurs arranges prerequisite circumstance leading deadlock occur notice deadlock occurred mess cleaned turn alternative intervening moment deadlock intervention quire technique similar discussed section technique conventionally known form deadlock detection deadlock prevention literal perspective deadlock prevented happening long deadlock allowed occur resource allocation graph remain acyclic free cycle time thread try lock mutex act follows mutex unlocked lock add edge mutex thread indicate thread hold lock mutex locked follow chain edge chain dead end graph acyclic end chain thread trying lock mutex add edge showing thread waiting mutex thread waiting deadlock sql update account set balance balance row updated sql update account set balance balance row updated sql update account set balance balance note response sql session hanging sql update account set balance balance session hang sql session following error message update account set balance balance error line deadlock detected waiting resource figure oracle database detects deadlock session connected database session shown left margin transferring account account session shown indented transferring account account update statement lock account updated session hang try locking account session previously chapter synchronization deadlock end chain thread adding extra edge complete cycle shown figure add edge thread waiting state stead return error code lock request throw exception indicating mutex locked deadlock resulted notice graph search somewhat simpler ex post facto deadlock detection graph kept acyclic nonetheless basic idea deadlock detection just proactively fact deadlock detection form needed application program tried lock mutex respond news request granted application program simply try acquire mutex repeatedly error code instead program release lock currently hold restart beginning chance needing repeat response reduced sleeping brie y releasing lock restarting designing application program correctly handle immediate lock detection challenging program release existing lock restore object lock protecting consistent state case immediate deadlock tection used reasonably easily program acquires lock modi e object example immediate deadlock detection linux mac o x lock placed le using fcntl lock request complete cycle fcntl procedure return error code edeadlk deadlock detection mandatory posix speci cation fcntl interaction synchronization ing recall scheduler control runnable thread run cessor synchronization action performed running thread control thread runnable synchronization scheduling teract form interaction known priority sion convoy phenomenon particularly interesting said way cause lot grief subvert prioritization interaction transfer transfer figure resource graph solid arrow indicate transfer hold transfer hold transfer waiting dashed arrow indicates request currently transfer lock dashed arrow added cycle completed indicating deadlock request fail enter state waiting thread convoy phenomenon greatly increase context switching rate decrease throughput simplicity presented assumption priority inversion scheduler used thread wait thread run thread di erent ity level share mutexes blocking synchronization primitive minor violation priority ordering inevitable example consider following sequence event involving thread share single mutex thread go waiting state waiting request complete thread run acquires mutex request completes making thread runnable preempt thread start running thread try acquire mutex tex locked thread forced wait thread resume running point thread waiting thread run temporary violation priority ordering chapter synchronization deadlock deal programmer generally ensure thread hold mutex long thread soon release mutex allow thread run insidious problem lead lation priority order priority inversion suppose thread low medium high priority consider sequence event thread waiting state waiting request complete thread run acquires mutex request complete making thread runnable thread preempt thread start running thread try acquire mutex tex locked thread forced wait point thread highest priority runnable run situation thread running indirectly keeping thread running thread blocking thread virtue relative priority thread blocking thread holding tex thread run long time fact succession thread overlapping lifetime come thread wait time despite higher priority priority inversion continue arbitrarily long time priority inversion problem avoid scheduling time decay usage scheduler naturally lower ity thread running eventually drop low thread run free mutex allowing thread run succession thread run long hold thread arbitrarily long microsoft window responds priority inversion periodically boosting priority waiting cesses rst shortcoming sluggish responding priority inversion second scheduling able application system interaction solution priority inversion problem make problem away just limiting duration e ect genuine solution priority inheritance priority inheritance simple idea thread waiting mutex temporarily priority thread hold mutex thread hold mutexes run highest priority priority priority lent thread waiting mutexes example thread priority inheritance allow thread hold mutex run priority unlocks mutex truly thread run soon possible thread wait notice thread sel sh motive ting thread use priority want thread way principle applied form scheduling priority scheduling analogy priority inheritance deadline inheritance earliest deadline scheduling lending processor allocation share ing convoy phenomenon remarked repeatedly program normally hold mutex long attempt lock mutex mally encounter contention important locking mutex contention expensive particular big cost request lock mutex context switching attendant loss cache performance unfortunately particularly nasty interaction scheduling synchronization known convoy phenomenon cause heavily used mutex perpetually contended causing large performance loss convoy phenomenon subvert scheduling policy assignment priority section explain convoy phenomenon examine solution suppose central data structure protected mutex thread operates fairly frequently time thread operates structure thread lock mutex unlocks operation kept short possible frequent mutex spends appreciable fraction time locked percent scheduler point preempt thread example chapter synchronization deadlock thread consumed allocated time slice example tion mutex locked percent time surprising thread preempted held mutex happens programmer wrote thread loses control long hold mutex locked thread going unlock mutex instruction opportunity execute instruction time come processor dividing time nrunnable thread priority level thread holding mutex presumably run ntimes time thread immediately block situation popular mutex held long time thread running mutex popular chance good thread try acquire mutex locked thread try acquire mutex queued wait queue queue thread convoy named analogy unintentional convoy vehicle develops slow vehicle road passing lane convoy spell trouble eventually scheduler new time slice thread hold mutex thread design quickly unlock mutex happens ownership mutex passed rst thread wait queue thread runnable thread unlocked mutex continues run just recently given new time slice expect run long time probably wo terribly long try reacquire popular mutex nd locked say given mutex away rst waiter needing thread take place convoy queued mutex point new holder mutex get run give away mutex unlikely run time slice queue continues thread turn moving mutex queue brief period execution rear queue slight change makeup thread stop waiting popular mutex new thread seen aggregate convoy persist long time situation cause problem context switching rate go way instead context switch time slice context switch attempt acquire popular mutex overhead context switch drive throughput interaction scheduler policy choosing thread run subverted ample priority scheduler priority govern thread run reason simple scheduler choose runnable thread convoy phenomenon runnable thread queued mutex described mutexes said mutex contains wait list waiting thread implied list maintained fifo basis true queue convoy thread essentially scheduled fifo pendent scheduler policy example priority thread dispatched mutex queue scheduler run queue loss prioritization avoided handling mutex wait queue priority order way run queue fifo mutex unlocked thread waiting ownership mutex passed thread waited longest highest priority changing thread moved mutex waiter list runnable doe solve throughput problem running thread going experience anthropomorphized given mutex away context switching rate switch lock acquisition convoy reorder dissipate stronger medicine needed popular mutexes instead mutexes showed figure page use version shown figure popular mutex unlocked allwaiting thread runnable moved waiter list runnable thread list ership mutex transferred instead mutex left unlocked state equal way running thread say simply relock mutex course time slice lock unlock mutex repeatedly context switching mutex held percent time mutex probably held thread eventually block reason time slice expiration point scheduler select woken thread run note naturally follow normal scheduling policy priority order woken thread selected run did mutex ship directly transferred need loop beginning mutex acquisition code thread turn chapter synchronization deadlock lock mutex repeat lock fashion let unlock let successful true add current thread remove current thread runnable thread unlock yield runnable thread let successful false successful unlock mutex lock fashion let thread runnable unlock figure protect convoy unlock operation set tex state unlocked make waiting thread runnable awoken thread loop trying lock mutex contrast prior version mutexes thread awoken mutex left locked nonblocking synchronization scheduled time thread nd mutex unlocked wo expensive thread able run normal period overhead lock request convoy dissipate posix standard api mutexes requires approach taken minimum ownership mutex directly transferred waiting thread waiting thread selected based normal scheduling policy fifo alternatively mutex implementation simply dump waiting thread scheduler let sort figure nonblocking synchronization order introduce nonblocking synchronization concrete example let return ticketvendor class shown figure page example thread selling ticket temporarily block thread accessing ticketvendor ensures seatsremaining cashonhand kept consistent preventing thread selling available ticket downside scheduler preempt thread hold ticketvendor lock thread want use ticketvendor remain blocked rst thread run arbitrarily far future progress vending ticket conducting audit kind blocking underlies priority inversion convoy phenomenon extended cyclic chain object lead deadlock absent problem hurt performance needed ticketvendor manages avoid race bug kind unbounded blocking recall spinlocks introduced section use atomic exchange instruction thread succeeds changing lock unlocked state locked state guaranteed thread did successful thread granted permission make progress example vending ticket actually making progress releasing lock separate action atomic exchange delayed nonblocking version ticketvendor requires powerful atomic instruction package actual updating ticketvendor obtaining permission instruction meet need doing chapter synchronization deadlock thing atomically instruction determines variable contains speci ed value report answer instruction set variable new value answer preceding question variant instruction provided contemporary processor hardware level java api class included package figure nonblocking version ticketvendor class us class atomicreference example sellticket method attempt make progress using following method invocation snapshot state match earlier snapshot concurrent thread snuck sold ticket case state atomically updated method return true point ticket safely dispensed hand method return false enclosing loop retry process starting getting new snapshot state explore behavior programming project synchronization illustrated example ensures thread blocked waiting lock held thread particular matter long scheduler chooses delay tion thread thread continue making progress way thread end running arbitrarily long making progress thread slip update state case like continues make continue particular thread keep retrying stronger form nonblocking synchronization known synchronization guarantee individual thread make progress synchronization considerably complex style synchronization shown rarely used practice improving practicality synchronization remained active research area progress ularly period suggest synchronization day nonblocking synchronization import public class lockfreeticketvendor private static class state private final int seatsremaining cashonhand public state int seatsremaining int cashonhand seatsremaining cashonhand public int getseatsremaining return seatsremaining public int getcashonhand return cashonhand private final atomicreference state state private final int startingseats startingcash public lockfreeticketvendor int startingseats int startingcash startingseats startingcash new atomicreference state new state startingseats startingcash figure sellticket audit method detail remain filled figure ticket vendor us nonblocking tion notice directly storing seatsremaining cashonhand store atomicreference state object package variable allowing kept consistent locking gure show atomicreference chapter synchronization deadlock public void sellticket true state snapshot int seatsremaining int cashonhand seatsremaining state new state seatsremaining cashonhand price snapshot dispenseticket return displaysorrysoldout return public void audit state snapshot int seatsremaining int cashonhand check seatsremaining cashonhand figure method previous gure ticket vendor atomicreference support nonblocking synchronization consistent snapshot taken current state state set updated version ticket dispensed snapshot remains security synchronization technique used create data structure allow multiple thread carry operation concurrently maximum extent possible example queue going liver data ned order dequeue operation need processed sequentially reason additional data ca enqueued queue time earlier data dequeued data structure easy design program achieving high formance concurrency introducing bug quite challenging concurrent data structure programmed expert used building block concurrent queue particular used framework queue task processed pool thread example apple grand central dispatch framework security synchronization insecure reason security cies designed bug code enforcing policy allows enforcement bypassed example saw chapter denial service attack mounted setting user thread low priority remarked result erating system allow thread priority changed owner issue overlooked insecure inadequate policy insecure clever grammers nd way bypass restriction using bug operating code bug involve synchronization accurately lack bug generally race condition resulting inadequate synchronization factor make race condition worth investigation exploiting weakness cracker programmer complicated concurrent likely troduce race bug concurrency synchronization hard reason testing unlikely eliminated bug work correctly vast majority time race occur normal operation cracker able trigger race understanding fully staging necessary sequence event odds chapter synchronization deadlock improved thousand example cracker easily program computer loop attempt ten thousand time lucky timing happens allow seemingly impossible situation defeating signer careful security reasoning hypothetical example assume operating ture changing thread priority given pointer block ory containing value identi er thread changed new priority let suppose code looked like owned current user set priority return error code invalid request race cracker start worthless thread owns modify victim thread ownership check priority set timing doe work great harm cracker try particular example entirely realistic number regard doe illustrate particular class race contributing curity vulnerability tocttou race acronym time check time use operating designer normally guard particular tocttou bug copying request structure protected memory doing checking tocttou bug arise regularity operating kernel privileged program example suppose email delivery program granted privilege writing le independent le ownership normal protection deliver user mail user mail le delivering mail mail le check mail le normal le really expected location indirect reference symbolic link le located explain symbolic link chapter cover le system detail important way trick mail delivery program writing sensitive le changing genuine mail le symbolic link just right moment exploit tocttou security synchronization sun microsystems particular problem mail software early exercise example race condition showed thread dispense remaining ticket checking seatsremaining decrement di erent sequence event code starting seatsremaining thread dispense ticket seatsremaining left pseudocode figure page consecutive step remove current thread runnable thread unlock spinlock spinlocks held brie y possible ought consider step reversed shown figure explain reversing bad idea giving example sequence event reversed version malfunction change queuing mutexes correspond posix pthread mutex recursive add additional ponents mutex state waiter spinlock explain replacing notifyall bynotify safe bounded buffer class figure page concrete sequence event modi ed version misbehave semaphore used mutex doe correspond kind posix call pthread mutex error check pthread mutex normal pthread mutex recursive justify answer state licensing rule require center infant present adult enforce rule using semaphore track remaining capacity number additional infant accepted time infant enter acquire operation rst release infant leaf time adult enters release operation acquire operation adult chapter synchronization deadlock lock mutex lock fashion let unlock add current thread unlock remove current thread runnable thread yield runnable thread figure buggy version figure exercise asks explain wrong enforce state rule create problem adult try leave explain wrong concrete scenario illustrating problem b identi ed preceding subproblem remedied using mutex semaphore c alternatively abandon semaphore entirely use monitor condition variable illustrated deadlock detection using transcript taken oracle database figure page transcript tell lock granularity row table evidence assertion b suppose locking table instead explain deadlock ensued c locking table deadlock happen circumstance example suppose kind object thread mutexes locked mutex contains reference thread hold named mutex unlocked isnull ilarly thread blocked waiting mutex contains reference mutex waiting security synchronization thread waiting mutex isnull pose thread contain eld available use initialized suppose array thread thread thread forth thread write pseudocode rithm test contains deadlock main topic chapter synchronization closely related topic chapter thread scheduling author hardly describing following pair topic brief explanation understanding rst topic pair useful gaining understanding second thread scheduling b thread synchronization c scheduling synchronization d scheduling thread e synchronization scheduling f synchronization thread suppose computer processor run program immediately creates thread assigned high medium low xed priority assume thread competing processor thread share access single mutex pseudocode thread shown figure suppose mutex doe provide priority inheritance soon expect program terminate b suppose mutex provides priority inheritance soon expect program terminate programming project give opportunity experimentally rm answer suppose rst line audit method figure page replaced following line int seatsremaining int cashonhand explain chapter synchronization deadlock thread sleep second lock mutex terminate execution program thread sleep second run second thread lock mutex sleep second unlock mutex figure thread referenced exercise programming project flesh ticketvendor class figure page ing figure page guidance add simple test program us ticketvendor multiple thread temporarily remove thesynchronized keywords demonstrate race condition serting call method appropriate point incredibly lucky timing necessary set demonstration race previously considered thread selling seat thread selling seat count going audit midtransaction reinsert synchronized keyword race bug resolved thesleep s place demonstrate race mutual exclusion previous project using c program posix thread mutexes alternatively use programming language choice support concurrency mutual exclusion choose simpli ed version process evolves time bouncing ball investment compound terest population predator prey write program thread thread simulate process chose time pass possibly suitable scaling second security synchronization tor time year simulated time thread provide user interface user modify parameter ongoing simulation pause resume lation sure properly synchronize thread java appropriate language project use language support concurrency synchronization user interface project identical previous instead building simulator process build game kind action continues user make write test program java boundedbuffer class ure page modify boundedbuffer class figure page notifyall inserting bu er retrieving bu er test work rewrite boundedbuffer class figure page c using posix api use condition variable ability space availability data ne java class lock analogous bounded buffer class figure page allow additional reader acquire lock writer waiting alternative java use programming language support mutexes condition variable modify lock prior project tional reader acquire lock writer waiting modify lock prior project support additional operation reader use upgrade status writer similar dropping read lock acquiring write lock atomic writer sneak acquire lock upgrading reader doe happens thread hold lock reader try upgrading writer think good response situation chapter synchronization deadlock ne java class barrier analogous boundedbuffer class figure page alternatively use programming language support mutexes condition variable ne java class semaphore remove import line figure page boundedbuffer class work rewrite bounded bu er figure page instead using list us array couple integer variable just like earlier version figure page sure provide mutual exclusion portion method operates array integer variable translate bounded bu er figure page c using posix api semaphore translate dining philosopher program exploration project language example use c posix thread mutexes system linux pthreads mutex created priority inheritance turned o using sort write program c test scenario considered exercise need ability run thread ordinarily requires administrator privilege exploration project show use sudo exercise privilege project show usetime time program execution schedtool restrict program single processor start main thread xed priority using time andschedtool build corresponding action program write increase complexity program need consult documentation number api feature discussed textbook create mutex priority inheritance turned o need pas pointer mutex attribute object mutex attribute object initialized using gured using ate thread speci c xed priority need pas pointer attribute object initializing tribute object using guring using security synchronization procedure nd appropriate priority level use return value serve low priority add form medium high priority order make main thread wait thread creates use order thread know run second use gettimeofday shown figure page thread sleep hand use sleep procedure shown figure page thread ready terminate program using exit elect use schedtool program likely need use api procedure instead flesh lockfreeticketvendor class figure page test line programming project putting code count number time loop retries failed compareandset operation able code operates correctly generally doe needing lot retries experimentally insert explicit operation delay thread getandcompareandset ber retries go result correct delaying thread able thread continue operating usual pace exploration project illustrated pipe form bounded bu er piping output lscommand trcommand disadvantage example way run concurrently tell lsmay run completion output going temporary le trrun afterward input coming temporary le come alternative demonstration pipeline apparent command run concurrently rst command doe immediately run termination java program figure simulates dining chapter synchronization deadlock problem thread philosopher thread us nested synchronized statement lock object representing fork philosopher left right philosopher dines time rapid succession order thread running thread print message time philosopher dines try program assuming running computer multiple processor core likely wo output thread deadlock philosopher dined time dramatically reduce number say likely program initially print message aware program running sage stop entirely sign thread deadlocked experience doe program lock doe consistently run program repeatedly document observed including variability circumstance observed available run java want compare b optionally try limiting program run core likely longer deadlock thread interleaved coarse granularity scheduler thread switching ne granularity hardware instruction execution using linux exploration project page explains limit program single core using window achieve similar result using start command ag detail available web o x option unless installed developer tool reboot entire just cpu enabled giving following command rebooting sudo nvram return normal operation command sudo nvram reboot security synchronization public class philosopher extends thread private object leftfork rightfork private int mynumber public philosopher object left object right int number leftfork left rightfork right mynumber number public void run int timesdined true synchronized leftfork synchronized rightfork timesdined thread mynumber running public static void main string args final int philosopher object fork new object philosopher int philosopher fork new object int philosopher int philosopher philosopher p new philosopher fork fork figure java program simulate dining chapter synchronization deadlock c guarantee program wo deadlock multiple core making thread number acquire right fork left fork explain prevents deadlock try doe program continue printing message long let run search internet reported security vulnerability involving race condition nd recent recent report nd case particularly similar earlier one note safety problem summarized leveson turner problem went race bug issue include sloppy software development methodology total reliance software exclusion hardware interlock inadequate mechanism dealing problem report eld describing race spoke thread execution interleaved fact unsynchronized program execute bizarre way just interleavings example thread result thread order java programming language considerable e ort gone specifying exactly reordering thread ecution step legal line programmer synchronization used avoid race rst place trying understand race behavior losing battle spinlocks introduced rudolph segall form spinlock handle contention considerably better basic variety doe perform processor running thread contending shared spinlock problem time processor release lock processor try acquiring modern system use increasing number processor software designer turned sophisticated spinlocks instead thread monitoring single ory location waiting change thread location monitor waiting thread organized queue continue run loop unlike wait queue thread release lock set memory location monitored thread queue form queueing spinlock orqueue lock pioneered scott security synchronization summary nements chapter textbook herlihy shavit recall brief description posix java apis placement documentation web http http respectively particular claimed java mutex associated single condition variable unlike posix api actually version java api gained ond form mutexes condition variable contained package new mechanism grated java programming language one described feature allowing multiple condition variable mutex spinlocks depend atomic exchange instruction mentioned use atomic instruction atomic increment fact dijkstra showed mutual exclusion possible using ordinary load store instruction approach complex practical dijkstra calling historical mentioned text waiting condition variable using loop thread nishes waiting rst acquire mutex example thread noti ed data placed bounded bu er nd thread emptied bu er reason loop necessary rare occasion wait procedure return notify ornotifyall having invoked circumstance known spurious wakeup semaphore proposed dijkstra privately circulated manuscript formally published work note dijkstra credit scholten having shown usefulness semaphore presumably includes semaphore solution bounded bu er problem dijkstra present idea using consistent ordering prevent deadlock lished havender note title refers deadlock potentially confusing today deadlock avoidance mean di erent deadlock prevention havender describes today called deadlock prevention deadlock avoidance practical proach dating dijkstra work eshed mann remarkably habermann title speaks terminology completely opped seminal paper present deadlock avoidance textbook havender described approach preventing deadlock ordering chapter synchronization deadlock best approach call obtaining necessary resource time man elphick shoshani published survey deadlock issue contemporary distinction deadlock prevention deadlock avoidance courtois heymans parnas described variant lock programming project reader precedence waiting writer waiting writer precedence point version prevents starvation question class thread starve resource allocation graph introduced holt early accessible publication number holt considered sophisticated case presented resource multiple unit available resource produced consumed merely acquired released monitor condition variable apparently air early clearest exposition hoare similar idea proposed brinch hansen dijkstra brinch hansen designed programming guage concurrent pascal later wrote history example deadlock prevention linux kernel extracted le version use priority inheritance limit priority inversion explained sha rajkumar lehoczky presented alternative solution priority inversion problem known priority ceiling protocol priority ceiling protocol force thread wait acquiring mutex mutex available return extra waiting guarantee thread loan priority thread free needed mutex allows designer calculate tighter bound task execution time priority ceiling protocol provides form deadlock avoidance convoy phenomenon solution described blasgen et al dijkstra introduced dining philosopher problem reference presented sophisticated solution prevented deadlock ensured hungry philosopher got turn eat neighboring philosopher taking multiple turn rst textbook herlihy shavit good starting point security synchronization learning nonblocking synchronization ticket vendor example relies crucially java garbage collector automatic memory management time update performed new state object created problem caused reusing old object garbage collection safe memory reclamation object considerably interesting shown michael example synchronization practical series paper kogan petrank timnat petrank tocttou race vulnerability sun mail delivery software reported group known site http org read able nd copy advisory web searching chapter synchronization deadlockschapter atomic transaction introduction chapter described mutual exclusion mechanism ensuring object undergoes sequence transformation left state invariant hold state called consistent state particular idea monitor monitor object constructed consistent state public operation monitor object work correctly invoked consistent state reestablish invariant returning interleaving action di erent monitor operation allowed monitor state advance consistent state chapter continue theme state transformation time address issue ignored chapter invariant span multiple object transforming single object consistent state consistent state need transform object consistent state example suppose use object form rooted tree object knowing parent child shown figure invariant x y child y x parent operation node new position tree need change object node old parent new parent order preserve invariant exceptional circumstance operation fail forced doing chapter atomic transaction b c parent point child child point parent d eca b d eca b d eca b figure rooted tree pointer child parent example satisfying invariant b invariant violated e parent c e child d c c invariant restored child pointer leading e agrees e parent pointer complete transformation c requires modi cation node c d formation example necessary resource unavailable user press cancel button input fail validity check hardware failure occur nonetheless left consistent state anatomic transaction operation take servable initial state observable nal state intermediate state observable perturbable atomic transaction start consistent initial state modi e state using atomic transaction state remain tent atomicity preserved face concurrency failure transaction interact concurrently running transaction transaction intermediate state left failed transaction requirement known isolation requirement lack generally failure atomicity atomic transaction simply called transaction fact cording author atomicity nition transaction unfortunately author transaction need atomic lack agreement nomenclature troduced chapter phrase transaction introduction focus clear henceforth skip modi er use understanding atomic unless wise speci ed transaction system require atomicity durability transaction durable state successfully completed transaction remains intact crash afterward rebooted successful transaction end explicit commit action ni e consistent nal state established visible transaction durable transaction crash commit action nal transformed state intact ter restart crash occurs commit action initial unchanged state restart note failure atomicity slightly simpler nondurable tions atomicity crash restarts easy arrange clearing memory restart guarantee partially updated state visible update partial remain clearing memory happen automatically puter main semiconductor dram memory used memory isvolatile doe survive reboots strictly speaking volatility mean memory doe survive loss power reboots power left generally clear volatile memory nondurable transaction ensure failure atomicity matic failure rebooted example action update discover invalid input respond bailing example recovering detected deadlock entail aborting deadlocked transaction situation handled using explicit abort action indicates tion terminated visible change state change concealed undoing arder reuter coined catchy phrase saying support transaction acid test quality acid acronym indicates transaction atomic sistent isolated durable acronym quite popular somewhat redundant seen transaction really provides property atomicity durability consistency property tem state consistent invariant hold transaction written correctly preserve invariant leave state consistent execute atomically isolation simply atomicity face concurrency concurrent transaction interact property atomicity durability refer transaction chapter atomic transaction pendent object transaction operate returning earlier rooted tree example moving node new position transaction modify node old parent new parent atomic unit stand contrast monitor control single object obtain requisite atomicity monitor tree single monitor object instead having monitor node tree monitor operation node general approach reconcile modularity lumping lot data monitor creates performance problem making large chunk monitor prevent concurrency ought possible concurrently node di erent part tree atomic transaction allow concurrency sort protecting entire transformation state point worth emphasizing state remains consistent transaction executed time tions fact execute concurrently performance reason transaction responsible maintaining atomicity face concurrency ensure transaction interact running concurrently achieve isolation ensuring transaction read data object modi ed transaction enforcing restriction entail introducing chronization limit doe completely eliminate concurrency section sketch example way tions used middleware operating system support application program present technique used make transaction work divided section section explains basic technique ensuring atomicity transaction addressing durability ond section explains mechanism used ensure failure ity extended support durability section explains additional mechanism provide increased concurrency dinate multiple participant cooperating single transaction finally section devoted security issue chapter concludes cis exploration programming project note example application transaction transaction concept pervasive middleware erating system example presented example application transaction subsection rst middleware system section explain middleware application database system system moving ing system arena section explains role transaction play journaled le system current dominant form le database system transaction concept strongly rooted database system decade database provided transaction service application programmer database system extremely important form middleware used enterprise information like middleware database system built operating service raw hardware providing service application software service synchronization service just operating provides mutexes database provides transaction hand transaction service central ning mission database instead database system primarily cerned providing persistent data storage convenient mean cessing stored data nonetheless goal chapter transaction t relational database system cover just sql language used system enable try ample real particular example using oracle database relational database system manipulate table data chapter discussion deadlock detection showed simple example oracle database involving account account number scenario shown figure page involved transferring money account updating balance account example involved table called account column balance table created sql command shown create table account int primary key balance int similarly initialize account account using following chapter atomic transaction insert account value insert account value point look table select command select account following reply balance using relational database oracle format table slightly di erent course aspect example di er particularly deadlock detection response point replicate deadlock detection example ure need open di erent session connected database window rst session debit account second session debit account page speci c sql command session try credit account blocked session locked account similarly session blocked trying credit account creating deadlock illustrated figure saw oracle detects deadlock chooses cause session update request fail having prerequisite setup position role transaction play situation session processing transaction recall session debited account nd unable credit account transaction make forward progress hand want just stop dead track ping block progress session transaction session just bail cleanup debited account debiting source account crediting destination account violate atomicity make customer angry session need abort transaction using rollback command aborting transaction earlier debiting account release lock account result session attempt credit account nally stop hanging complete continuing earlier tradition showing session example application transaction try debiting account completes leaving account locked try crediting account block waiting account deadlock try debiting account completes leaving account locked try crediting account block waiting account figure transfer transaction deadlock wait exclusive access account obtained exclusive access diagram vertical dimension represents passage chapter atomic transaction left margin session indented space interaction look like sql rollback rollback complete row updated course trying transfer account count want aborting transaction retry sql update account set balance balance command hang session transaction account locked transaction need commit allowing session continue retry sql commit commit complete row updated sql update account set balance balance row updated sql commit commit complete sql select account balance example application transaction notice end account updated correctly example account doe look debited debiting aborted transaction wiped away figure illustrates transaction recover deadlock large account concurrent transfer transaction di erent pair account rarely lock situation preceding example arise nice know database system clean way dealing transaction aborted deadlock detection reason retried later concurrent transaction create correct result race database locked account causing temporary hanging case deadlock observed system system form important class middleware like database system support transaction concept developer enterprise information system normally use form middleware system avoidable database system database system primary mission sage queuing support transaction instead system specialize provision communication service discus chapter discussion broader family middleware belong messaging system oriented middleware mom straightforward application messaging consists server accessed request queue response queue shown figure server dequeues request message request queue carry required processing enqueues response message response queue think worker desk basket labeled take paper process put step dequeue process enqueue grouped atomic transaction step fail request message left input queue ready retried request lost visible sign repeated processing duplicated response message course cause failure ect retries reason realistic system generally count retries divert request message example chapter atomic transaction deadlock fails roll try debiting account block waiting account completes leaving account locked try crediting account completes leaving account locked commitsession deadlock block waiting account crediting completes leaving account locked commitblocks waiting account try crediting account figure figure transaction recover deadlock roll releasing lock hold prior gure vertical dimension represents passage example application transaction request queue response queueserver b figure analogy server dequeues message request queue process request enqueues message response queue b worker take paper basket process paperwork put basket troubleshooter request queue system provide durability tem crash restarts request generate exactly response system application opt durability order reduce persistent storage obtain higher performance provide greater concurrency server queuing request queue shown figure uration interesting interaction atomicity dequeue action interpreted strictly taking message head queue wait rst transaction commit abort know message second transaction dequeue rst transaction abort message tried dequeue head queue taken second transaction vent concurrency system generally relax queue ordering little allowing second message dequeued fate rst message known e ect rst message provisionally removed queue way second message transaction handling rst message abort rst sage returned head queue second message dequeued advanced work ow system include processing step processing step connected intermediate message queue system processing stage treated chapter atomic transaction request queue response queueserver serverserver figure server parallel dequeue common request queue enqueue common response queue allow concurrent operation message need provided strict order transaction transaction commits stage input gone inbound queue output outbound queue seen work ow exhibit atomicity example failure later processing stage roll earlier stage consider sale merchandise example work ow shown ure transaction incoming order check validity generate output message outbound queue order rmation customer billing record account receivable shipping request shipping transaction operating shipping dequeue shipping request ful ll failure detected shipping transaction longer abort overall work ow order rmation billing sent instead shipping transaction ternative drive overall work ow forward somewhat di erent direction hoped example shipping transaction queue message apologizing customer crediting chase price customer account figure show work ow extra step transaction customer later compensating transaction refund billed using atomic transaction simpli e application programming imagine plex reason large work ow individual ing stage fail midway interact concurrently executing stage treating work ow stage atomic transaction messaging considerably reduces application designer example application transaction order processingaccounts receivableshipping systemcustomerincomingordersbilling recordsorderconfirmationsshippingrequests figure simpli ed work ow selling merchandise processing single order produce di erent response response queue step request queue subsequent step order processingaccounts receivableshipping systemcustomerincomingordersbilling recordsorderconfirmationsshippingrequestscreditsapologies figure work ow failure shipping produce ing response abort overall work ow compensating response credit customer account previously debited send apology customer indicating previously rmed order lled chapter atomic transaction burden diagram figure provide accurate abstraction observable behavior showing processing stage linked message queue finally consider sale work ow keep track available chandise customer account balance information able individual processing stage work ow frequently use database transaction involve sage queue database atomicity need cover transaction abort want database left unchanged andthe request message left queued section explain comprehensive atomicity achieved coordinating system participating transaction journaled file system transaction concept employed middleware longer extensively operating system application operating system quite important contemporary ating system provide le system employ atomic transaction maintain structural consistency le consistency data stored le le system known naled le system orjournaling le system reference use underlying mechanism known journal discus journal section alternative log example journaled le system include ntfs used microsoft window hf plus used mac o x reiserfs jfs xfs used linux originated proprietary unix system jfs developed ibm aix xfs developed sgi irix file system journaled need use technique section maintain consistency data structure file system provide primitive form data storage access database system chapter contemporary ing system generally treat le arbitrarily large potentially extensible sequence byte accessed way textual name nized hierarchically nested directory folder typical operation le include create read write rename delete underlying simple abstraction largely invisible data tures known metadata help locate organize data example le grow size le free store di erent part le di erent location le store metadata le indicating portion le example application transaction located le store information concerning part storage use allocate unused space le growing existence metadata mean simple le operation involve update information persistent storage extending le example update information free space information space allocated le structure need kept consistent disastrous portion storage used storing le available allocation second le update atomic transaction atomic transaction visible user consider renaming le new directory entry need created old entry removed user want change atomically possibility le having name journaled le system treat operation requested cation program atomic durable transaction program asks rename le rename operation return indication success application program sure renaming taken place crash immediately afterward rebooted le new said way rename operation includes commitment transaction application program tell transaction committed guaranteed durable journaled le system achieve higher performance delaying transaction commit time rename operation return tion committed minute le commit transaction completed interval come crash le consistent state maybe completely minute worth operation appeared complete successfully vanished exchange risk gained ability fewer writes persistent storage improves performance notice version transaction providing value state boot result sequence operation possibly truncated sequence hodgepodge partial result incomplete unordered operation journaled le system protect metadata application data stored le left inconsistent state crash particular writes le taken e ect writes lost way necessarily one performed recently chapter atomic transaction journaled le better o er guarantee write operation completed crash ected state crash limited guarantee program want multiple writes atomic fashion writes place le provide assistance le designed fully support transaction including allowing programmer group multiple update transaction example fully transactional le transactional ntfs txf added microsoft window vista version mechanism ensure atomicity having seen valuable atomic transaction middleware erating system ready consider value actually provided particular atomicity transaction ensured atomicity aspect isolation concurrent transaction assurance failed transaction visible e ect section isolation formalized serializability particular locking discipline locking used ensure rializability section failure atomicity assured use undo log serializability locking transaction execute concurrently long interact way make concurrency apparent execution equivalent serial execution action run time committing aborting transaction start execution equivalent serial execution called serializable execution section carefully ne mean execution equivalent mean execution serializable addition simple rule using lock guarantee serializability rule used transaction system known locking equivalence serializability ned somewhat di erent way nitions simplest nd justify locking mechanism normally used achieve serializability practical system aware general nitions needed order accommodate mechanism ensure atomicity advanced concurrency control mechanism note end chapter provide pointer sophisticated alternative transaction executes sequence action focus action read write stored entity row database table example action lock unlock lock assume stored entity lock associated use following notation x mean read entity xby transaction tj want value read use rj x v withvas value x mean write entity xby transaction tj want value written use wj x v withvas value x mean acquisition shared reader lock entity xby transaction tj x mean acquisition exclusive writer lock entityxby transaction tj x mean unlocking shared lock entity xby transaction tj x mean unlocking exclusive lock entity xby tiontj x mean upgrade transaction tjof hold entity x lock shared status exclusive status read return recently written value later section revisit assumption considering possibility writes store successive value entity new location read choose old value sequence action executed transaction called history transaction execute concurrently write action order happen transaction history terleaved interleaving transaction history called history locking action shown time lock granted possibly earlier time lock requested assume history include relevant action particular transaction abort doe extra writes time undo e ect earlier writes section undo writes explicitly listed history note chapter atomic transaction implicitly assuming transaction e ect storage particular let look example suppose xandyare variable initially equal suppose transaction variable transaction variable transaction preserve invariant serial history follows x x x x y y y y x x x x y y y y make sure understand notation rected exercise write serial history transaction transaction sequence step action remain serial history showed xandyboth end value wrote serial history transaction obtained di erent nal value variable invariant hold common numerical value xand yi transaction rst make important point transaction designer insist deterministic execution scheduling ect result serializability weaker condition continuing scenario variable double variable follows x x x x x x x x y y y y y y y y convince history serializable persuade equivalent serial history shown previously transaction nished variable updated way serial history example transaction unlock xbefore locking y interleaved nonserializable fashion x x x x x x x x y y y y y y y y invariant broken end xi equal yi equal history equivalent serial mechanism ensure atomicity primary goal section lock used disciplined fashion rule nonserializable history particular learn previous example xshould unlocked afteryis locked need formalize mean history equivalent nition serializability rigorous make assumption lock transaction correctly pair lock unlock operation transaction lock lock hold upgrading shared exclusive status unlocks lock doe hold leaf lock locked end lock function correctly transaction granted lock shared mode held transaction exclusive mode transaction granted lock exclusive mode held transaction mode assumption controversial history equivalent rst history turned second performing succession swap step swap revers order adjacent action subject following constraint action di erent transaction tion action kept given order action following seven icting pair x sk x x ek x x ek x x uk x x rk x x wk x x wk x forbidding swap rst pair ensures lock continue properly functioning tkmay lock x lock tjhas unlocked icts ensure read action return correct value swapping read write change value read chapter atomic transaction return nal ict ensures xi left storing correct value figure illustrates constraint swap note icts action operate stored entity shown x operation di erent entity ferent transaction reversed harm exercise prove earlier example serializable history equivalent example serial history action di erent transaction involve entity reversed harm read exercise includes serializable history read entity need reversed order arrive equivalent serial history ready state locking rule ensure serializability concentrate understanding rule say afterward transaction obeys locking entity operates transaction lock sponding lock exactly read writes entity rst time unlocks exactly read writes entity time entity transaction writes transaction tially obtains corresponding lock exclusive mode upgrade lock exclusive mode writing transaction performs lock upgrade action forming unlock action notice locking rule leave modest ibility regarding use lock consider example transaction read write xand read write following transaction history obey locking x x x y x y y y x y x x y y y x x x x x y y y y x y exercise come additional bilities mechanism ensure atomicity b c d x y x x x y x x figure illegal legal swap illegal swap step action b illegal swap icting operation entity c legal swap operation di erent entity di erent transaction d legal swap noncon icting operation di erent transaction programmer writes transaction explicitly includes lock unlock action possibility valid monly programmer includes read writes explicit lock unlock action underlying transaction processing automatically insert lock unlock action make gramming simpler case likely use simple rule immediately read action acquire corresponding lock shared mode transaction doe hold immediately write action acquire corresponding lock exclusive mode transaction doe hold transaction hold lock shared mode upgrade end transaction unlock lock transaction locked able convince rule special case locking holding lock end transaction need predict transaction future read write action need prove locking ensure ity recall history serializable equivalent serial chapter atomic transaction need long locking followed nd sequence swap transform history serial understand tion history serial just proof technique using help understand actually occurs operation transaction system business forcing transaction execute serially concurrency good performance running transaction doing reverse tion programmer thought term serial transaction execution interleaf showing interleaving showing simplify proof use following vocabulary portion history starting tj rst action continuing including tj rst unlock action phase oneoftj portion history starting tj rst unlock action continuing tj action phase oftj action performed tkduringtj phase aphase impurity oftj similarly action performed tk duringtj phase phase impurity oftj transaction impurity kind pure transaction pure history serial game plan proof use swap purify transaction say tj ond tkis pure purifying tjdoes introduce impurity tk purify transaction time having worry wrecking transaction puri ed earlier iftjis impure purify rst removing phase tie phase impurity remove phase impurity remove leftmost repeat new leftmost gone leftmost phase impurity tjmust preceded action tj action reversed swap move leftmost impurity left swapping repeatedly impurity percolate way left pass rst operation tj point cease impurity tj phase mechanism ensure atomicity removed similarly starting rightmost percolating right pas operation tj need leftmost phase impurity tjcan swapped neighbor rightmost phase impurity swapped neighbor recall legally swap action di erent transaction seven forbidden icting pair order leftmost impurity oftj action performed transaction tk action tjas neighbor similar argument applies rightmost impurity neighbor action nitely di erent transaction remaining concern seven icts leftmost phase impurity neighbor icts x sk x x ek x x ek x x uk x transaction tjdoes unlock action phase nition phase icts x rk x x wk x x wk x locking rule ensure read write action performed appropriate lock held way transaction tjandtkcan hold lock x exclusive mode similar argument rule ict rightmost phase impurity neighbor exercise ll detail seen swap step rifytjby percolating phase impurity left phase impurity right goal serialize arbitrary history complies locking rule chapter atomic transaction like pick transaction impure purify repeat going transaction pure history serial plan work need sure purifying transaction doe wreck purity pure transaction purifyingtjdoes touch action lie tj rst action action way purifying tjcould endanger existing purity tkis iftklies partly tj span becausetkis pure lie tj span doe need consider case tklies withintj span fact able convince stronger action pure transaction tklies tj span tklies single tj phase phase phase iftk action occupy consecutive position phase purifying tjwill percolate tk action left leave consecutive position preceding start tj similarly tkis phase action right wind consecutive block right oftj tk purity preserved conclude history obeying locking rule serializable recall serializable history equivalent serial history serial history composed transaction transaction move consistent state long locking used behave moving consistent state consistent state particular situation obtained simply locking entity operating rst time holding lock end transaction serializable history equivalent serial history di er important regard unlike serial history serializable history include concurrency transaction allows achieve higher performance entail risk deadlock present serial execution deadlock occurs deadlocked transaction need aborted abortion way transaction fail turn question atomicity preserved face transaction mechanism ensure atomicity failure atomicity undo logging recall atomic transaction temporarily consistent state long restore consistency committing example middle transfer account money temporarily account long money destination account time transfer seen way protect harm rary inconsistency using locking prevent concurrent transaction ected inconsistent state need deal possible source trouble transaction abort making update state prevent later transaction seeing inconsistent state transaction fail reason example transfer transaction debit money source account crediting destination account discover destination account doe exist alternatively detect deadlock trying lock destination account way transaction aborted having debited source account transaction atomic preserve consistency need undo debit source account way failed transaction left state unchanged legal outcome atomic transaction support transaction processing failure atomicity extremely ensure programmer write lot complex prone code attempt provide failure atomicity troublesome consider way achieve failure atomicity transaction processing approach try test possible cause failure taking action example test destination account exists locked debiting source account lead poor modularity logical place check destination account association crediting account addition advance checking approach doe cope concurrency concurrent thread messed destination account checked approach test possible failure occur provide manual cleanup action example failure occurs crediting destination account revert money source account problem complicated transaction failure handler needed shown figure handler chapter atomic transaction successfailureaction action action action cleanup failure cleanup cleanup failure cleanup cleanup figure failure atomicity ensured testing failure step process providing appropriate failure handler failure handler action need clean prior action remove e ect approach doe scale general undo log used transaction processing mechanism ensure atomicity action need undo rst action handler action need undo action handler fourth action need undo action exercise failure handler share cleanup code prevent quadratic increase code transaction failure handler share cleanup code manual cleanup action signi cantly complicate structure transaction contrast system support transaction database tems make failure atomicity completely transparent application grammer transaction abort automatically clean state transaction observe e ect aborted transaction order provide service transaction mally us undo log conceptually transaction undo log record action needed change transaction state time transaction writes new value stored entity add entry undo log showing entity restored prior state simplest way record old value entity transaction transaction processing write prior section saw scene action just write x rst acquire exclusive lock learn transaction processing scene add entry undo log showing xneeds set undo step entry undo log list xas entity question prior value transaction abort transaction processing read transaction undo log entry recent earliest carry reversion listed log sure understand undo log entry need processed reverse chronological order exercise example matter notice undoing write operation involves writing undo write x write important consequence locking transaction writes entity hold corresponding lock exclusive mode transaction nished aborting committing lock entity transaction read dropped earlier subject usual phase rule lock need retained long possibility aborting exists possibility chapter atomic transaction exists mentioned conceptually transaction undo log normal transaction processing system actually store undo log combined log entry added end order process entry single transaction reverse chronological order entry contains pointer previous entry action transaction keep pointer latest entry shown figure section durability requires additional logging extra log entry mixed combined log transaction undo entry transaction durability logging adding durability transaction raise new directly indirectly direct issue durability transaction commits data need stored persistent available restart persistent storage ash memory disk drive indirect issue failure atomicity need work restarted need clean action progress time crashed writing persistent storage simplest way ensure durability store entity sistent storage writing transaction go directly persistent latest undo entry latest undo entry previous undo entry figure having separate undo log transaction undo log combined case entry action chained shown processed separate transaction durability logging storage terribly consider example di erence speed disk drive ram explain practical alternative later section correct solution need address failure atomicity transaction abort undo log allows roll writes transaction did transaction progress crash transaction aborted restart time partial updating state visible abortion restart usual way using undo log precaution taken undo log stored persistent storage available restarted use called recovery processing transaction writes new value entity persistent storage rst write undo record persistent undo log shown figure previously did emphasize order writes occur really matter crash rst write second user risk possibility entity written undo record undo operation intended restore entity new value old value safe use entity old value word undo operation idempotent idempotency important crash undo record written entity written recovery processing write addition crash middle recovery start beginning harm repeated undo processing form undo record shown record entity old value naturally provides idempotency recovery processing way gure action progress need aborting usual way undo log combined log includes explicit record time transaction commits abort way recovery read backward log noting completed transaction processing undo entry chapter atomic transaction x x log undo log x undo log x figure order allow crash recovery undo log entry persistent write underlying object persistent storage generally slower main memory real transaction processing system use somewhat sophisticated approach reduce writing persistent storage entity accessed rst time copied main memory read writes happen main memory high performance transaction copy latest version entity persistent storage occasionally evict entity main memory doe active merit space allocation address topic chapter particular transaction similarly performance reason log record initially written main memory later copied persistent storage way large chunk log written persistent storage time improves performance device disk drive incorporating performance improvement changing thing wreck atomicity durability crashed situation possible committed transaction written result nonpersistent memory violating durability noncommitted transaction written value persistent storage corresponding undo log entry violating atomicity protect case need additional machinery transaction durability logging simplest approach restoring correct operation enforce new rule entity written persistent storage sponding undo log entry written persistent storage commit entry log written persistent storage commit operation complete entity written persistent storage commit entry written log rst rule ensures undo entry needed recovery able recovery time second rule prevents recovery process aborting transaction user saw committed crash rule ensures committed transaction durable rst rule hard argue taken called logging wal wal rule typical system manage work variant note provide pointer literature rule deserves closer scrutiny durability demand updated value transaction provides entity stored persistent storage action commit rule suggest speci c location entity persistent storage stored usual location read lead question speci c choice location necessary desirable transaction commits update entity stored persistent update stored tie usual location recovery process locate way crash restarts recovery process bring entity usual location date allowing normal operation resume recovery process doe work reading log log like obvious alternative place store committed transaction update answer earlier question necessity necessary write transaction update main data entity persistent storage transaction commits instead update written log redo log entry long redo entry log commitment marker persistent storage commit operation completes ensure durability just chapter atomic transaction undo log entry simple record data entity old value redo log entry simple copy new value need address question desirability advantage writing redo log entry persistent storage directly dating modi ed entity primary location answer need understand system use disk persistent storage slowest accessing disk drive mechanical movement needed reach particular place disk writing large block data single location disk faster writing lot smaller piece data individual location using redo log entry commit operation wait single large write disk new portion log undo redo commit forced single disk operation redo log commit operation held waiting lot individual writes point seen mechanism used real action processing system simpli ed overview form biggest performance issue omitted speed recovery crash using mechanism described far recovery process need read entire log transaction ing started running practical system run long time transaction processing system incorporate mechanism put limit log need processed mechanism generally referred checkpointing simplest historically earliest approach create checkpoint point main persistent storage brought consistent state log entry prior checkpoint need retained sophisticated checkpointing mechanism avoid having bring consistent state normal processing continue additional transaction mechanism section learned primary mechanism used support transaction locking logging section extend knowledge advanced area isolation reduced order increase concurrency section multiple transaction participant coordinated using commit protocol section additional transaction mechanism increased transaction concurrency reduced tion locking ensures serializability price concurrency throughput transaction forced wait lock big problem depends greatly workload mix system exclusively process short transaction involving entity example transfer account system problem locking action lock small portion data long contention system exclusively process transaction involving entity database example mining cal business data strategically useful pattern exhibit ior locking problem number transaction coexist using shared mode lock mix little update big deadly analysis transaction database locked long time choking o ow update particularly troubling given update likely critical imagine airline analyze history thoroughly ca book new reservation problem business use separate database system operational handle short transaction update data periodically night data transferred operational data warehouse warehouse hold historical data generally quite present close analysis analyst run arbitrarily long transaction warehouse directly run ad hoc query interactive session dare operational imagine analyst type query go home typing commit interactive session exceeds time limit abort continue hold lock valuable warehousing strategy avoids obvious manifestation general problem doe provide complete solution perfect solution exists database system provide partial solution transaction programmer choose sacri ce serializability order attain greater concurrency sacri cing serializability increase concurrency doe mean chapter atomic transaction grammers sacri cing correctness performance serializability great simpli cation programmer trying reason carefully program ensure correctness careful reasoning possible nonserializable execution additional mental labor labor free immune error serializable execution ought default alternative considered performance demonstrably inadequate recall locking transaction generally hold lock transaction commits abort suppose instead transaction did exclusive lock writing acquire shared lock read operation release immediately read database system microsoft sql server ibm o er option called read committed fact contrary sql standard read committed default mode transaction programmer need explicitly request serializability acquiring shared lock brie y value prevents reading data written transaction progress transaction hold lock exclusive mode strange phenomenon possible relaxed isolation possible serializability enforced phenomenon read transaction read entity later read entity nd value changed happen read transaction writes entity commits nonrepeatable read spoken problem arising relaxed isolation dangerous tion programmer think application tolerate nonrepeatable read example doe read entity twice serializability super uous true consider example variable xandy value writes transaction reverse copiesyintox doing transaction expect xandyto equal transaction achieve short read lock doing transaction rently result swapping xandy old value shown figure making equal exercise come history exhibiting phenomenon database system oracle postgresql radical approach relaxed isolation known multiversion concurrency control mvcc write action store new value entity additional transaction mechanism x y figure transaction release read lock soon reading corresponding object execution serializable example transaction swap xandy value shown di erent location old value read action need read recent version read older version particular transaction read entity written version recently committed transaction started writes committed completely ignored read lock needed known snapshot isolation transaction using snapshot isolation obtains write lock entity written modi ed tion committed writing transaction started write request aborted error condition writing transaction roll restart clear snapshot isolation provides repeatable read people forgetting nonrepeatable read symptom relaxed isolation think snapshot isolation rializability regrettably oracle postgresql foster belief calling snapshot isolation mode o er true alizability option example system transaction copy xtoywhile copying ytox highest isolation level coordinated transaction participant mit transaction processing built using mechanism described far locking log containing undo redo entry need mechanism want able coordinate multiple subsystem working shared transaction mechanism commit protocol section commit locking chapter atomic transaction unrelated happens contain phase example coordination include queuing relational database us mechanism previously described order provide atomic durable transaction like able single transaction rst dequeues request message queue doe database ations nally writes response message queue atomic durable unit example go wrong database processing rollback undo database change restore request message queue transaction processing system generally include module specializing coordination known transaction manager various resource manager database system manager communicate using commit tocol order ensure participant agree transaction aborted committed particular transaction commits durable resource manager gray pointed essence commit wedding ceremony party asks participant really want ahead commitment say party announces commitment taken place somewhat greater step commitment tocol follows shown figure case successful commitment new transaction begin register transaction ager return transaction manager assigns identifying transaction context transaction us service resource manager present transaction context resource manager subcontract resource manger pass transaction context resource manager see new transaction context rst time register transaction manager involved transaction known joining transaction transaction wish commit contact transaction additional transaction mechanism transaction transactionmanagertransactionmanagertransactionmanagerresource begin assign try use resource join transaction prepared commit phase ok commit complete phase acknowledgment figure commit protocol coordinate transaction ticipants shown enumerated accompanying text diagram show case resource manager indicate ok commit transaction committed transaction manager know involved resource manager earlier join message transaction manager start phase asking resource manager prepared commit resource manager asked prepare commit check reason example database check consistency constraint violated resource manager detects problem reply transaction ager transaction aborted problem resource manager rst make sure transaction update stored persistent storage example redo log record complete resource manager indicates tion manager transaction commit far resource manager concerned transaction manager wait received reply resource manager reply indicate unanimous agreement commit transaction manager log commitment record noti e resource manager start phase chapter atomic transaction resource manager hears transaction phase commitment log commit record drop exclusive lock holding transaction transaction phase possibility abort need perform undo action crash restarts transaction manager commitment log record forward phase resource manager sends acknowledgment tion manager indicating completion phase activity acknowledgment received transaction manager log completion commit way crash restart know bother redoing phase hand phase transaction manager hears request abort resource manager forced recover crash nd commitment record noti e resource manager roll transaction using undo log security transaction transaction processing system used enterprise critical operation great deal thought gone security issue transaction processing system issue arise system actually particular transaction nism se focus security implication stem using atomic transaction security consequence atomic transaction salutary constructed atomic transaction easier reason general saw chapter cracker exploit race condition happen order subvert security design similar trick played forcing operation fail doing action using atomic transaction designer excludes entire category vulnerability furthermore security enhanced using transaction processing infrastructure trying achieve atomicity ad hoc mean prone security vulnerability complex code rarely used saw achieving failure atomicity general mechanism undo log involves considerable plex nonmodular code example exploration project security transaction examine linux kernel source code messy prone code tested normal circumstance come play case failure bug undetected year cracker go looking contrast infrastructure included reputable database presumably tested son correct operation central concern author peripheral second exact infrastructure come play situation example undo log processed deadlock recovery abort failure situation testing anism common situation provides assurance correct operation common situation seen security guideline regarding transaction ple used simple positive interaction transaction security unfortunately yes action powerful abstraction mechanism hide great deal complexity simple interface application grammer think term simple interface totally ignore complex complex underpinnings curity implication great danger abstraction mechanism transaction included blind really going security guideline abstract view transaction consider underlying mechanism discussed chapter instance need think transaction nings occurs reasoning vulnerability denial service attack transaction processing system great deal locking scene generally provide deadlock detection timeouts lock doe mean subverted transaction bring transaction knee really want wait timeout period lock acquisition worse usual way handling locking problem roll involved transaction restart problem caused uky coincidence surely recur second try manipulated cracker position repeatedly rolling retrying transaction making headway consuming great quantity resource processing time log space retries aside locking retries need understand action consumption log space resource able chapter atomic transaction denial service attack attacker trick lling log space disk pitfall lose track exactly degree tion transaction enjoy relative concurrent computation example suppose transaction temporarily store dential information widely readable data entity deletes information committing alternatively transaction store information abort discovering information dential doe protect information disclosure maybe maybe transaction running serializable isolation locking concurrent tions information protected allow adversary run transaction acquire lock example sql committed isolation level protected dential information matter serializable transaction careful clean data committing similarly suppose transaction rely keeping database tent maintaining invariant property order operate correctly ically database inconsistent transaction tricked violating security policy safe transaction declared use isolation level adversary vented introducing additional transaction necessarily mentioned earlier using oracle postgresql database tem isolation level doe actually provide serializability provides snapshot isolation understand actly snapshot isolation entail way reason kind situation cracker manipulate transaction cracker arrange transaction run alizable fashion leaf database inconsistent way creates security vulnerability transaction processing system closed environment cracker easily introduce extra transaction analyze ing transaction make somewhat resistant attack result risk mentioned generally remained theoretical date known exploit advantage programmer confusion tween snapshot isolation true serializability example nonetheless important remember abstraction dangerous unless understand really doing understand vulnerability nal pitfall unwary programmer possible security security transaction cation transaction manager provide atomicity action control example chapter sumed transaction aside using storage device mature transaction processing system allow controlled transaction transaction commits output kept impounded commit output actually produced system far use special hardware tested crash output produced contrast featured system programmer build application particular transactional database support system textbook automatically included transactional protection application programmer need responsibility printing valuable ticket allowing purchase aborted example exercise example deadlock detection recovery database transaction tried update account balance commit suppose add step beginning action immediately rst update display table ingselect displaying table impact scenario play explain happen action executed enforcing serializability using locking note tested using oracle us mvcc locking introduced serial history example transaction added xandyand transaction write serial history rst leave sequence step transaction text change value appropriately prove example serializable history equivalent example serial history showing result swap step way serializable history serial history following history history serializable equivalent serial history listing step serial history just list transaction number chapter atomic transaction appropriate order history serializable say x x x z z z y y y x x x v v v y y y b v v v x x z z z x z x z x v y y x z v v y c x y x z y z x x z z y y x y x z y z d x x x x x x z z z z z z y y y y y y e x x y y y x y y y x x y x y y x serializable history exercise one obey phase locking rule example locking page showed di erent history transaction read writes xand read writes come ve history transaction obey locking rule explain rightmost phase impurity tjcannot ict neighbor explain pure transaction tk action occurring impurity span tjmust lie entirely tj phase entirely tj phase particular collection transaction need locking ensure serializability generally fragile uation disturbed addition obeying locking transaction history obeys phase locking rule nonetheless produce rializable history matter interleaved b come transaction history obeying phase locking interleaved rst nonserializable history security transaction mentioned providing failure atomicity undo log sults complex code example putting explicit succession cleanup action action failure handling code result quadratic increase code size flesh detail argument proving figure page extended include n action contain cleanup step example transaction matter undo log entry processed reverse chronological order suppose use locking rule shared lock held duration read action released immediately afterward exclusive lock held end transaction history transaction complying locking rule copy x value toy copy y value starting wind redo exercise instead locking assume isolation level known committed used implemented short read lock exercise time assuming snapshot isolation tested using oracle cle read committed level doe use short read lock test shot isolation using oracle start transaction following command set transaction isolation level serializable suppose stored value increased undo record written doe include old value instead undo record indicates undo operation value decreased idempotent problem arise crash recovery page example history given transaction obeys locking subsequently page list simple rule ensure locking example history obey simple rule s wording page nitions locking assumes tjcontains unlock action explain safe assumption provided tains action chapter atomic transaction suppose new value value bothxandy possible old value xbut new value y answer question time assuming locking assuming committed isolation level used implemented short read lock assuming snapshot isolation case justify answer programming project build simple java class support transaction atomic concurrency failure durable deadlock detection class provide state transaction operate example encapsulate array integer putandgetoperations transaction use modify access slot array transaction need limit state accessed tions order receive guarantee atomic execution use java thread s transaction class nd currently running using class care automatically acquiring releasing lock programming project accordance locking need track lock action hold undo log transaction information stored using mapor using threadlocal object design option provide method used signal start transaction termination commitment abortion option encapsulate transaction using interface analogous runnable java api runmethod carry transaction method return transaction commits hand method throw exception transaction abort client application class write program multiple thread transferring money bank account encapsulated array integer used store account balance array index serving account number design collection concurrent transfer deadlock free ensure lot concurrent transfer lot case multiple transfer access account security transaction correct nal balance provide good evidence class cessful warding o race include transaction abort making update test use undo log exploration project work example chapter java ee tutorial chapter java ee tutorial linux us le permission change mount option experiment formance impact journaling option particular test intensive workload mounting le option control protection provided le data opposed metadata rst le operation atomic durable second crash occasionally leave data updated corresponding metadata update possible metadata updated pointing old data write report carefully explaining did hardware software context did replicate result carry scenario exercise using relational database use interactive session given command set transaction isolation level read committed sure end command session commit inspect outcome carry scenario previous project using cle postgresql transaction isolation level set serializable optional extension explore adding keywords update end select command make di erence try scenario previous project using microsoft sql server ibm transaction isolation level set serializable nd xandyare swapped happens instead doe depend interleave mands session chapter atomic transaction come plausible scenario using snapshot isolation serializability result security vulnerability need detailed sql code just english description data transaction mality helpful course explain adversary need order exploit vulnerability quadratic growth code size exercise stem sumption action failure handler disjoint cleanup code result lot repetition cleanup action way explicit cleanup code eral undo log avoid quadratic growth share common cleanup code cleanup action appears ures later transaction just execute shared cleanup code failure earlier transaction example pattern procedure linux kernel source le skim code need understand write description ming language mechanism us execute appropriate cleanup code based late failure occurs think alternative programming language mechanism serve purpose exercise written kernel version relevant aspect procedure stable quite version note treatment transaction barely scratch surface terested transaction read book devoted entirely topic best start probably bernstein comer detailed treatment derlying principle weikum vossen practical detail lot code gray reuter earliest electronic transaction processing system poorly mented open literature apparently company regarded technique achieving atomicity durability proprietary gray suggested developer merely prioritized code paper late did technique explain begin showing publication reference make good reading today longer polished work gray quite uential today primarily security transaction terest historian material appears polished form book reuter arder reuter introduced acronym acid ogy presented isolation subsumed atomicity aware author instead treat atomicity meaning atomicity face failure lampson sturgis use unitary mean atomic respect failure term doe caught speci c software version used example oracle database postgresql showed work ow system gured message queue connecting processing stage popular alternative connect processing stage centralized process manager coordinate work ow example receiving message order processing manager send message account receivable shipping customer process manager allows centralized monitoring control process manager sold enterprise application integration eai product tibco businessworks mentioned nitions history equivalence serializability chosen simplicity accommodate sophisticated concurrency control method wish pursue previously cited book weikum vossen provides good foundation classic work topic include bernstein goodman stearns rosenkrantz work cite regard relaxed isolation relevant locking rst published eswaran et al paper brought fore aspect serializability relational database glossed normally locking granularity individual row database table suppose transaction operating account zero balance surface think lock just row account table concurrent transaction doing withdrawal brings account balance zero inserting new account zero balance introduces problem known phantom tion assumption invalidated change row transaction read addition new row eswaran et al proposed solution predicate lock impractical taken literally provided foundation practical technique describing durability failure atomicity face crash di erentiated volatile storage persistent storage real system chapter atomic transaction consider issue greater example failure overwriting block disk result disk having old new version available necessitates precaution writing copy critical block good starting point topic work cited beginning note key paper snapshot isolation relaxation isolation clude berenson et al kempster stirling thanisch adya liskov historically original treatment relaxed isolation gray et al attributed wedding analogy commit gray rst introduced conference paper reused book reuter transaction increasingly used multithreaded ming alternative synchronization proaches illustrated previous chapter context actional object individual memory location leading term transactional memory tm abstraction ther supported hardware hardware transactional memory orhtm software software transactional memory orstm best survey eld book harris larus rajwar practicality stm questioned promising particularly embedded functional programming language haskell virtual memory introduction chapter seen synchronization including action control interaction concurrent thread ample synchronization ensure thread time update memory location holding shared data structure learn form control provide thread private storage regulating thread access shared storage chapter present mechanism virtual memory used provide thread private storage controlling teraction virtual memory turn abstraction useful goal just giving thread vacy using introductory section present basic concept virtual memory devote section surveying plication virtual memory afterward turn detail mechanism policy nd related discussion section chapter concludes standard feature security issue section exercise programming exploration project note essence virtual memory decouple address running program use identify object address memory us identify storage location known virtual address physical address background understanding distinction consider rst highly simpli ed diagram computer virtual memory shown figure sor sends address memory want store value chapter virtual memory processor memoryaddress data figure virtual memory processor sends dress directly memory memory load value memory data loaded stored transferred appropriate direction load operation retrieves recent value stored speci ed address processor memory using common set address communicate role played address somewhat di erent perspective processor perspective memory explain perspective processor program processor executing address way di erentiating stored object processor store value wish retrieve value need specify retrieved us address essentially name just executive tell clerk le widget supplier later ask clerk document led widget supplier processor tell memory store value particular address later load address address used executing program refer object known virtual address course virtual address arbitrary name virtual address number processor make use group related object related name easily compute object group simplest example kind grouping related object array array element stored consecutive virtual address allows virtual address individual element computed base virtual address array element position array memory perspective address identifying name object spatial location storage cell memory us address determine cell steer data address used memory specify storage location known physical address figure show processor memory view address like shown figure physical address come directly virtual address numerically introduction processor figure virtual memory virtual address cessor name object equal physical address memory storage location di erence processor memory perspective come apparent consider processor dividing time multiple computational process process need private object natural use process figure show necessitates ing di erent address processor memory virtual address longer equal physical address make work computer structured shown figure program execution processor work entirely term virtual address load store operation executed processor sends virtual address intermediary memory management unit mmu mmu translates virtual address corresponding physical dress sends memory figure process us virtual address triangle simpli ed model complicated object referenced real process consider realistic example process use virtual address object processor memory process b figure process use virtual address name object virtual address equal physical address process object need stored chapter virtual memory processor memorymmu datavirtual addressphysical address figure memory management unit mmu translates processor virtual address memory physical address suppose copy spreadsheet program running copy naturally want refer spreadsheet di erent spreadsheet object process process us numerical virtual address natural running instance spreadsheet program use address running code memory perspective di erent process object need stored di erent physical address need private name arises quite strongly concurrent process running di erent program principle application program use di erent name virtual address program requires unwieldy coordination shared object address name behave somewhat di erently address location suppose process communicating shared bounded bu er producer consumer perspective process bu er channel process channel process object memory need store object location hold true name used process numerical virtual address virtual address physical address forced equal possible process use virtual address refer di erent physical address use di erent virtual address refer physical address seen mmu map virtual address physical dress discussed nature mapping far point go mapping simple computing physical address twice virtual address yield general mechanism known virtual memory instead virtual memory following additional introduction function map virtual address physical address resented table computational rule doubling way mapping general size manageable table doe independently list physical address virtual address instead virtual address grouped block known page table show page virtual address corresponding page frame physical address explain greater tion section brie y consider alternative segmentation content table controlled operating includes incremental adjustment table purpose section wholesale change table ing thread allows thread private virtual address space case thread belong di erent process explained section table need contain physical address translation page virtual address e ect entry left blank unde ned virtual address illegal processor use processor generates illegal address mmu interrupt processor transferring control operating interrupt known page fault mechanism serf limit usable address allow address translation inserted table needed creating address translation fashion application virtual memory arrange data necessary improving mance nement notion illegal address entry table marked legal use speci c way commonly legal read particular page virtual address write page main purpose serf allow sharing memory process summary virtual memory consists operating ned table mapping virtual address physical address granularity page opportunity intervention erating access table show illegal able exible mechanism operating chapter virtual memory switch multiple view physical memory part physical memory completely invisible view virtual dress map physical address part visible view appearing di erent virtual address mapping virtual physical address need established advance marking page illegal access making able interrupt indicates rst accessed operating provide mapping basis section us general mechanism us virtual memory section contains catalog us virtual memory tion application virtual memory enumerated everyday use operating system comprehensive list longer include application far limited research system esoteric setting private storage introductory section chapter explained computation running computer want private age independent computation happen running computer goal private storage elaborated subgoals computation able use virtual address nd convenient object needing avoid using address computation computation object protected accidental malicious access computation allocation achieved giving computation virtual memory mapping form core process concept aprocess group thread associated protection context introduce process fully chapter particular learn phrase context intentionally broad including protection feature le access permission us virtual memory study chapter focus particularly tant process context mapping virtual address physical address word purpose chapter process group thread share virtual address space chapter computer hardware operating software collaborate achieve protection preventing software outside operating updating mmu address mapping process restricted accessing physical memory location operating allocated page frame process page assuming operating allocates di erent process disjoint portion physical memory process ability interfere physical memory area process need disjoint moment time process turn using physical memory protection model process given separate virtual address space mainstream approach today purpose present chapter granted chapter explore alternative allow process share single address space remain protected controlled sharing norm process use disjoint storage operating map limited portion memory process address space limited sharing way process communicate simply way reduce memory consumption time needed initialize memory regardless motivation shared physical memory occupy di erent range virtual address process exibility exercised shared memory used store structure linked list pointer represented virtual address simplest example sharing occurs ple process running program normally process divide virtual address space region region hold machine language instruction program data program contains character string printed error message region conventionally called textof program region hold rest process data chapter virtual memory tems actually use region stack data process running program share text operating map text process virtual memory address space protection bit mmu set enforce access way shared text doe accidentally communication channel modern program make use large library supporting code example great deal code related graphical user interface shared quite di erent program web browser spreadsheet operating system allow process share library protection just main program microsoft refers shared library library dlls figure illustrates process share form program text text dlls gure process b running program us dlls process c d running program us dlls process shown encompassing appropriate program text dlls writable data area word process encompasses area mapped virtual address space operating perspective simplest way support interprocess communication map physical memory cesses virtual address space permission process communicate freely writes shared memory read writes figure illustrates sharing writable area memory communication simple operating simple application programmer need include mutexes writer lock similar synchronization structure shared ory need scrupulous care use lock communicating process exhibit race debug operating system mac o x use virtual ory support structured form communication known message passing process writes message block memory asks operating send message process receiving process copy sent message small message operating literally copy message cess memory large message actually copied instead operating update receiver us virtual memory process running program process b running program process b running program process d running program program program text dll dll text program text dll text process writeable storage process b writeable storage dll text dll text program text process d writeable storage process c writeable storage program program text dll text dll text figure address space process includes text program process running text dlls used program writable storage area chapter virtual memory communication area shared writeable storage process s private storageprocess b s private storage process process b figure process communicate sharing writable storage area memory map point physical memory sender message sender receiver access message copied maintain ease debugging come message ing operating mark page sender receiver engage nasty race sender composes message invoking operating protection place message composition doe stand way nal nement message passing sharing system mac o x o er copy write cow process try write shared page mmu use interrupt transfer control operating operating make copy page sender receiver individual copy writable operating resume process trying write allowing succeed provides complete illusion page copied time message sent shown figure advantage process write message page copying avoided flexible memory allocation operating need divide computer memory various process retain use rst glance memory allocation problem doe us virtual memory modifiable copy message sent process s storagemodifiable copy message received process b s storage process process bstep step written process s storageprocess b s storage process process bmessage sent shared process s storageprocess b s storage process process b figure use copy write cow message passing process writes message private memory step asks operating map memory containing message process b address space step process permission write shared area violates restriction operating copy ected page give process write permission copy allows write operation proceed step net e ect message copied sent copying avoided process writes shared chapter virtual memory need megabyte mb need operating allocate rst mb memory lowest physical address rst process mb second kind contiguous allocation run rst problem contiguous allocation ory process requires grow shrink program run rst process immediately followed memory second process happens rst process need space second problem contiguous allocation process exit new process di erent size started suppose mb memory available process running size mb mb mb suppose rst process terminate freeing chunk memory suppose process start running memory available contiguous chunk illustrated figure situation known external mentation discus external fragmentation carefully chapter contiguous allocation important disk space ne contrasting term internal fragmentation chapter modern system virtual memory contiguous allocation main memory erating allocate available physical page frame process independent located memory example nundrum figure solved shown figure realistic setting surprising pattern physical memory allocation display degree contiguity virtual address contiguous physical address scattered memory sparse address space just virtual memory provides operating exibility allocating physical memory space provides application program process exibility allocating virtual address space process use address make sense data structure large gap provides exibility compiler runtime environment assign address data structure suppose example process data structure need store need allocated contiguous range address need able grow upper end us virtual memory process process b process mb mb mb process mb mb mb doe process d mb figure contiguous allocation lead external fragmentation example contiguous space available process d termination process c freed total mb process d halfprocess bprocess d second mb mb mb figure virtual memory physical memory allocated process need contiguous process d accommodated memory chapter virtual memory picture look like address megabyte free free free example address range actually pied wanted allow structure grow position apart wind lower percentage occupancy real process span address range gigabyte using near storage typically allow region grow address space grow order allow process use kind sparse address space wastefully occupying corresponding physical memory operating simply doe provide physical address mapping tual address gap persistence operating provide way user retain important data shut restarted commonly data kept le kind persistent object used persistent object normally stored disk example write book storing le disk way retype book time computer rebooted consider persistence chapter question relates virtual memory process need access le persistent object ask operating map le address space operating doe actually read le memory instead reading basis process access particular page le rst time mmu signal page fault operating respond reading page le memory updating mapping information resuming process reason operating choose fetch additional page time assumption likely needed soon discus possibility section process writes page mapped le operating remember write page disk order achieve persistence operating us virtual memory page modi ed written read implies operating need know page modi ed date disk called dirty page way track dirty page using technique discussed initially marking page way mmu generate interrupt rst attempt write clean page operating make page writable add list dirty page allow operation continue operating make page clean writing disk mark page keeping track dirty page common requirement using approach just described mmus erally provide direct approach approach mmu keep dirty bit page write page cause hardware set dirty bit needing operating intervention operating later read dirty bit reset intel itanium architecture contains compromise operating set dirty bit hardware support provides exibility software approach incurring large performance cost program loading particularly important case le get mapped memory running program executable program ordinarily stored le disk conceptually running program consists reading program memory disk jumping rst instruction program huge contain part way used example error handling routine used corresponding error occur addition program support feature optional mode user need reading program quite rare case program get used interactive user prefer short pause disk access long particular reading program initially mean program slow start frustrating reading program mentally operating start quickly expense brief pause operation pause ten liseconds duration occurs time user interaction threshold human chapter virtual memory summary operating designer reason use virtual memory technique read program basis order avoid reading unused portion order quickly start program execution general persistent storage page fault cause operating read program result program loading application grammers make program start quickly grouping necessary code page course laying gram text really job human application programmer compiler linker nonetheless programmer able provide guidance tool zero filling security reason ease debugging operating let process read memory location contains value left process previously used memory memory occupied persistent object cleared operating new process access seemingly mundane lling region memory bene t virtual memory operating ll arbitrarily large virtual address space zero using single page frame physical memory need map virtual page physical page frame mark technique sharing page frame zero doe address situation process writes zeroed page situation handled using variant cow technique tioned section mmu interrupt processor write page zero operating update mapping page refer separate page frame zero resume process followed cow principle literally operating copy page frame zero produce separate writable page frame zero operating run faster directly writing zero new page frame needing copy page frame fact need zero lling demand instead operating spare page frame zero replenishing stock idle time way page fault occurs writing page zero operating simply adjust address map refer us virtual memory spare prezeroed page frame make writable operating proactively lls spare page frame zero idle time bypass processor normal cache memory write directly main memory zero lling seriously hurt performance displacing valuable data cache substituting disk storage ram explaining application virtual memory persistence showed operating read accessed page memory disk write dirty page disk reason doing disk storage di erent property main semiconductor memory ram case persistence relevant di erence disk storage nonvolatile retains content power disk di er ram regard particular couple order magnitude cheaper gigabyte motivates use virtual memory goal simulate having lot ram using disk space course disk ve order magnitude slower ram approach pitfall process long period actively running example desktop user application di erent word processor web browser mail reader focus attention minute hour time leaving idle similarly process part remain inactive spreadsheet user look online help day spreadsheet use phenomenon inactivity provides opportunity capitalize inexpensive disk storage retaining performance fast semiconductor memory computer need ram hold working set active portion active process performance intolerably slow disk access routine basis computer need ram entire storage need process inactive portion o disk paged active incur delay disk access mix activity change user set word processor aside us spreadsheet rst time day new working set active page ram computer responsive history virtual memory focus application dating invention virtual memory early chapter virtual memory time memory magnetic core magnetic drum semiconductor ram magnetic disk kind paging disk role played virtual memory pay considerable attention particular interesting policy question arise application virtual memory operating need free space overcrowded ram need guess page unlikely accessed soon come topic replacement policy rst considering question mechanism policy apply spectrum virtual memory application mechanism virtual memory address mapping need exible mentioned tion mean mapping function stored explicit table granularity page individual byte word system today use page exception operating hardware access research suggests general mixing page size bene cial explained note linux moved direction typical page size grown decade reason explore exercise today common kilobyte kb page virtual memory page frame physical memory size start address multiple page size example page rst page page frame address address forth page virtual memory address space map underlying page frame physical memory example figure show possible mapping unrealistically page page frame number box page number page frame number starting address number multiplied page size gure page stored page frame page size kb mean virtual address lates physical address virtual address translates physical address forth virtual address word page translates physical address word page frame point physical address adding virtual address virtual address translates physical address start new page mechanism virtual memory x frame figure example mapping page page frame page allocated page frame page allocated page frame page allocated page frame x indicate page frame assigned hold page page page frame unused mapped di erently note page frame currently holding page page page translation available exercise gain experience working translation virtual address physical address translating address page course realistic computer page frame physical memory page virtual address space ten hundred thousand page frame hundred thousand page result operating designer need think carefully data structure used store table map virtual page number physical page frame number section devoted presenting alternative structure current use page table linear multilevel hashed alternative fallen favor deployed brie y mentioned note data structure operating us page table need communicate mapping information hardware mmu actually performs mapping nature interface constrains page table design provides important context comparing performance alternative page table structure section explain form chapter virtual memory interface finally section provides brief look segmentation historically important alternative paging adjunct interface seen operating store form page table data structure memory showing physical memory page frame hold virtual memory page present possible page table structure shortly important design issue applies equally page table used performance consideration explain important data ture nearly useless literal sense single memory access performed processor generates virtual address need translation physical address naively mean gle memory access processor requires lookup operation page table performing lookup operation require memory access page table represented number memory access double real access page table access memory performance bottleneck modern computer system mean virtual memory make program run half page table lookup avoided luckily virtual address accessed realistic software random stead exhibit temporal locality spatial locality dress accessed likely accessed long nearby address likely accessed soon nearby address likely page kind locality wind creating temporal locality considered level page page accessed chance good page accessed soon address mmu take advantage locality keeping quickly accessible copy modest number recently used translation store limited number pair page number corresponding page frame number collection pair called translation lookaside bu er tlb memory access refer page number present tlb mmu able produce corresponding page frame number needing access page table happy circumstance known tlb hit fortunate mechanism virtual memory tlb doe contain needed translation tlb miss tlb component ern microprocessor order fast clock cycle time perform small benchmark tlb quickly sible order performance fall o sharply larger workload tlb reasonably large hundred entry prevent page table access unfortunately goal ict chip designer know make lookup table large fast coping possible dilemma requires cooperation designer hardware operating application software hardware designer ameliorate problem including twotlbs instruction fetch data load store way category memory access need compete tlb hardware designer ameliorate problem cluding hierarchy tlbs analogous cache hierarchy small fast tlb make access fast larger slower tlb ensures page table wo need accessed time tlb miss example amd opteron microprocessor contains instruction data tlbs contains instruction data tlbs hardware designer operating designer tool reducing demand tlb entry example ferent tlb entry provide mapping page varying size operating able map large contiguously allocated structure fewer tlb entry retaining exible tion rest virtual memory operating designer need use tool variable page size reduce tlb entry consumption minimum application process use small page kb operating use larger page similarly video frame bu er consecutive megabyte need carved chunk secondary bene t using larger page reduce size page table case smaller page table quicker chapter virtual memory fundamentally operating design decision need eye ect tlb pressure critical performance factor obvious example normal page size obvious example size scheduler time slice switching process frequently increase tlb pressure hurt performance tlb doe need ushed process switch issue shortly application programmer role play program exhibit strong locality reference perform better cache hierarchy tlb formance program exceeds tlb capacity generally quite precipitous data structure inherently example large sparsely occupied ble perform worse smaller densely occupied table regard theoretical analysis algorithm leading assume memory operation constant time point seen computer us di erent representation virtual memory mapping page table tlb page table comprehensive slow representation tlb selective fast representation need learn entry page table loaded tlb lead topic interface general mmu load page table entry tlb driven basis memory access result tlb miss mmu load relevant translation tlb page table future access page tlb hit key di erence computer architecture mmu doe tlb loading autonomously doe lot help operating software running processor architecture mmu contains hardware known page table walker page table lookup operation software intervention case operating maintain page table xed format hardware understands example processor pentium operating realistic option use multilevel page table hardware page table walker expects format interface consists largely single register contains starting address mechanism virtual memory page table operating just load register let hardware deal loading individual tlb entry course additional complication example operating store updated mapping information page table need ush obsolete entry tlb processor hardware specialized access page table tlb miss hardware transfer control operating using interrupt operating software look missing address translation page table load translation tlb using special instruction resume normal execution operating doe page table lookup use data structure designer wish lookup operation special hardware walker normal instruction load memory omission page table walker render processor exible simpler tlb miss expensive entail context switch operating attendant loss cache locality mips processor used sony playstation example processor handle tlb miss software architecture di er handle process switch recall process private virtual memory address space operating switch process translation virtual address physical address need change architecture necessitates ushing entry tlb exception global entry ushed shared process architecture tag tlb entry process identifying number known address space identi er asid special register keep track current process asid operating switch process simply store new asid register tlb need ushed tlb hit asid page number match e ectively ignoring entry belonging process architecture hardware page table walker process switch require changing register pointing page table typically linear page table multilevel page table process operating us hashed page table hand share table process using asid tag just like tlb having seen mmu hold page translation tlb tlb entry loaded page table hardware walker operating software time turn structure page table chapter virtual memory linear page table linear page table conceptually simplest form page table turn quite simple practice concept linear page table array entry page virtual address space rst entry table describes page describes page forth nd information page n us approach array access multiply nby size page table entry add base address page table recall page corresponding page frame page table entry contains minimum valid bit page frame number valid bit page corresponding frame page frame number unused valid bit page mapped speci ed page frame real page table contain bit indicating permission example writing allowed dirtiness forth figure page showed example virtual memory guration page held page frame page page frame page page frame figure show information expressed linear page table notice page number stored linear page table implicit position entry rst entry implicitly page page forth page page table entry stored byte tiny page table occupy consecutive byte memory information page valid mapping byte base address table fundamental problem linear page table real one larger example address space page bit used specify location page kb assume byte page table entry page table storing process use undesirably large fraction computer memory computer currently running process hypothetical total mb page table percent total ram worse modern processor moving address space assume larger page hard linear page table spanning address space stored exercise calculate just huge page table problem large page table insurmountable linear page table used system example vax mechanism virtual memory valid page frame x x x x x figure linear page table information page ni stored position number n counting example rst row position show page stored page frame row position show page stored page frame row valid bit indicate page frame hold corresponding page number page table entry page frame number irrelevant number x shown indicate ture quite commercially important linear page table support option current itanium architecture storing huge page table inconceivable secret nd way avoid storing table recall virtual memory address space generally quite sparse small fraction possible page number actually translation page frame particularly true system address space billion time larger system number page actually used quite comparable provides key storing linear page table need store part actually contain valid entry surface suggestion create big problem solves yes memory store valid entry nd entry particular page number recall point linear page table directly nd entry pagenat address nentries beginning table leave invalid entry work squish address remaining valid entry better need avoid wasting memory invalid entry able use simple address calculation nd valid chapter virtual memory word valid entry need stay address invalid entry said way want thrifty storage page table thrifty address combination just barely possible storage addressing need divorcing storage page table allocation address entry requires insight pattern address space usage sparse completely random software use quite page row leave large gap use consecutive page clumping valid invalid page mean decide portion linear page table worth storing relatively coarse granularity granularity individual page table entry store chunk page table contain valid entry invalid entry mixed store chunk contain entirely invalid entry fact choose chunk page table size page example page page table entry chunk page table contain page table entry chunk wo actually need storage frequently unused page row view page table bunch consecutive page need storing trick use virtual memory store page table way decouple address page table entry virtual address page table entry form nice orderly array entry page nbeingnentries beginning physical address story recall page table divided chunk want store want store allocate page frame memory convenient want store allocate page frame use virtual memory store virtual memory page table dizzying suppose start virtual address generated running application program need translate physical address want look virtual page number page table multiply mechanism virtual memory page number page table entry size add base address virtual address virtual address page table entry translate page table entry virtual address physical address way headed path nite recursion system use linear page table way recursion figure box labeled copy diagram simple concept reality solution recursion problem form using ferent representation store mapping information linear page table used virtual dress used translation page table entry virtual address example multilevel page table accessed using cal address used provide mapping information page holding main linear page table multilevel page table section leave wondering point linear page table representation going needed use directly main page table mapping page indirectly mapping page table page answer need recall mmu tlb keep track recently used translation repeated access virtual page number doe require access page table new page number accessed page table kind accessed true translating application virtual address translating virtual address page table entry depending virtual address generated application software possibility address page recent access page table lookup needed mmu know translation address new page chunk page previous access linear page table lookup needed mmu know translation appropriate page linear page table address new page far accessed kind page table lookup needed mmu relevant translation cached chapter virtual memory application s virtual address application s physical addressapplication s page numberapplication s offset page load memory page table physical address page table entryvirtual address page table entrypage table base virtual page table entry size application s page frame numberapplication s offset figure diagram show virtual address generated application process translated physical address using linear page table point translation procedure indicated diagram virtual address page table entry need translated physical address using method di erent used application virtual address order avoid nite recursion imagine inserting copy diagram place box second result require substitution forth mechanism virtual memory virtual memory access generally exhibit temporal spatial cality access fall rst category access page table organization irrelevant compare linear page table alternative organization focus remaining cesses access spatial locality make fall second category multilevel page table scene used rarely important multilevel page table quite bit slower linear using combination improves performance expense complexity multilevel page table recall practicality linear page table relies observation valid page table entry tend clustered page table divided chunk chunk need storage remaining chunk located big array using virtual memory address translation access page table observation quite di erent rst empirical fact software second design decision accept rst observation making di erent choice stored chunk located exactly happens multilevel page table known hierarchical page table mapped page table divide page table chunk hope chunk wo need storage locate stored chunk recursive use virtual memory using tree data structure single array simplicity start considering case architecture actually used extremely popular architecture architecture intel pentium amd athlon family microprocessor architecture us page page table entry occupy byte entry t chunk page table single chunk span mb virtual address space given architecture us virtual address virtual address space gigabyte gb spanned chunk page table need locate storage chunk chapter virtual memory case determine chunk did merit storage using structure like chunk page table kb size contains entry byte entry page directory point chunk page table individual page frame figure illustration page table hierarchy branching factor level example page invalid page explore example exercise consider modi ed version page table format exercise operating machine store physical base dress page directory special register hardware page table walker nd suppose later point processor generates virtual address present mmu lation figure show core translation process omitting tlb validity check mmu follows following translation process initially divide virtual address bit page number bit o set page look page number tlb tlb hit occurs concatenate resulting page frame number o set form physical address process hand tlb miss occurred subdivide page number bit page directory index bit page table index load page directory entry memory address time page directory index plus page directory base address taken special register check page directory entry valid bit page frame holding page neighbor matter interrupt processor page fault conversely valid bit page directory entry contains physical base address chunk page table load page table entry memory address time page table index plus page table base address come previous mechanism virtual memory page directory page x page xpage table page page page page figure page table page directory point chunk page table point page frame leftmost pointer leading leftmost chunk page table point page frame holding page entry marked invalid indicated x diagram example second entry rst chunk page table invalid showing page frame hold page principle applies page directory level example page frame hold page second page directory entry marked chapter virtual memory page directory indexpage table indexoffset page bit bit bit load memoryload page directory base address page directory entry address page table entrypage table base page frame numberoffset page bitsvirtual address page number physical address figure diagram show core paged address ping omitting tlb validity check virtual address divided page number o set page bit left unchanged translation process page number vided page directory index page table index index multiplied number byte entry added base physical address corresponding data structure producing physical memory address entry loaded base address page directory come register base address page table come page directory mechanism virtual memory check page table entry valid bit page frame holding page question interrupt processor page fault hand valid bit page table entry contains physical page frame number load tlb complete memory access description somewhat simpli ed show key feature design compact page directory entry covering span mb region entirely invalid stored region containing valid page page directory entry point compact structure containing individual page table entry actual design derives additional advantage having page directory entry span page directory entry optionally point directly single large page frame pointing chunk page table entry leading indirectly page frame described option controlled bit page directory entry using feature operating provide mapping information large contiguously allocated structure page directory entry contains permission bit just like page table entry using feature operating mark entire region virtual address space quickly doe need set bit kb page region translation process outlined earlier extended check permission bit level signal page fault interrupt permission violation level principle used page table expanded greater number level taken course data structure seen structure called trie digital tree radix tree virtual page number divided group consecutive bit group bit form index use level tree starting leftmost group level indexing level allows chunk level located example architecture used opteron athlon processor later imitated intel employ level page table kind nominally chapter virtual memory architecture virtual address actually limited bit current version architecture basic page size kb rightmost bit o set page bit remain virtual page number page table entry similar entry higher level increased size byte physical address larger chunk page table reference page spanning mb similarly branching factor higher level tree bit needed select entry follows virtual page number divided group bit level tree achieving adequate performance page table ing amd designer nd challenge intensi ed extend architecture virtual address require level added page table designer processor di erent choice intel itanium us linear page table hashed page table powerpc us hashed page table hashed page table seen linear page table multilevel page table strong family resemblance design rely assumption valid invalid page occur large clump result allows nesse dilemma wanting store page table entry successive page consecutively memory wanting waste storage invalid entry store page table entry consecutively chunk table omit storage entire chunk table suppose radical approach reject starting assumption assume address space sparsely occupied page table entry invalid stored buy ram processor longer make assumption clustering valid invalid scattered randomly address space allows greater exibility designer runtime ments consequence store individual valid page table entry independent neighbor storing individual valid page table entry storing invalid entry take away primary tool used previous approach locating entry longer nd page n entry indexing n element chunk address space need use entirely di erent approach locating mechanism virtual memory table entry store hash table known hashed page table hashed page table array hash bucket structure hold small number page table entry itanium architecture bucket hold entry powerpc bucket hold entry unlike linear page table array bucket doe private location virtual page number smaller particularly architecture reduced array size page number directly used index array instead page number rst fed function hash function page get assigned speci c hash bucket hash function di erent page assigned bucket simplest plausible hash function page number modulo number bucket array example hash bucket page table entry page forth assigned bucket page forth assigned bucket performance table relies assumption page assigned bucket valid page table entry stored assumption rarely multiple valid entry assigned bucket situation known hash collision collision rare page table size need scale number valid page table entry luckily system lot valid page table entry normally lot physical memory room bigger page table collision rare mechanism handling immediate consequence page table entry need include indication virtual page number describes linear multilevel page table page number implicit location page table entry di erent page table entry assigned location entry need include identifying tag like tlb unrealistically small example using hashed page table return figure page suppose hashed page table bucket capable holding entry entry contain virtual page number corresponding physical page frame number hash function consists taking page number modulo table contain approximately information shown figure chapter virtual memory valid page page frame x x figure entry hashed page table location determined feeding page number hash function example hash function consists taking page number modulo number entry table consider entry recording page held page frame entry position table counting remainder divided possibility collision consequence tating page number tag collision occur valid page table entry need stored colliding entry stored location alternative location need available possibility alternative location hash bucket powerpc room page table entry bucket provided collision involves number entry stored bucket powerpc search entry bucket looking matching tag collision involving entry occurs powerpc collision occurs itanium processor collision resolved hash bucket handle collision operating allocate extra memory chain bucket linked list expensive rare occurrence result hardware page table walker normally handle case walker doe nd matching tag bucket us interrupt transfer control operating charge searching linked list seen reason page table entry hashed page table need larger linear multilevel page table hashed page table entry need contain virtual page number tag bucket need pointer ow chain result factor addition extra feature itanium architecture us entry hashed page table versus entry linear page table incidentally fact itanium architecture support di mechanism virtual memory page table format suggests just hard select research continues relative merit di erent format varying workload result research future system use page table format described likely variant theme architecture mips hardware page table walker excellent vehicle research allow operating use page table format whatsoever operating system treat hashed page table software tlb table similar hardware tlb hold selected page table entry case provision need overfull hash bucket entry t simply omitted slower multilevel page table provides comprehensive fallback miss software tlb alternative particularly attractive porting operating linux originally developed machine multilevel page table segmentation far acted virtual memory synonymous paging today true virtual memory rst veloped competing approach paging segmentation system notably multics included hybrid seen historically segmentation competitor collaborator paging subsection describes segmentation historical perspective word used today related concept segmentation sense described gone extinct subsection omitted great loss recall basic premise virtual memory process us address name object memory us address routing information storage location ning property segmentation processor virtual address object using tie virtual address name aggregate object table le particular location object table entry byte le somewhat analogous hailperin identi e family belong hailperin particular person family max aggregate object table le name akin family name called segment process refers segment segment number virtual address divided part number bit segment number remaining bit chapter virtual memory segment surface segmented virtual address di erent paged one saw paged virtual address divided part page number o set page example address divided page number o set page key di erence page purely implementation correspond logical object le stack table segment correspond logical object serve natural unit protection sharing named storage persistent object le xed size kb segment natural size example le process access mapped virtual address space segment segment size need match le size quite arbitrary employing pure segmentation map segment tiguous range physical memory instead page table us segment table speci e segment number starting physical address size permission unlike paging pure segmentation doe provide exible allocation physical memory external fragmentation occur hard nd contiguous free memory accommodate segment tion pure segmentation doe provide good support moving inactive information disk entire segment transferred disk similar problem segmentation combined paging process us address containing segment bers o set mmu translates address stage using segment table page table end result o set physical memory page frame segment occupy available page frame contiguous individual page segment moved disk system combined segmentation paging slightly di ent way exempli ed architecture multics key di erence segment share gle page table given individual page table multics figure show segmentation paging used architecture mmu mmu translates virtual address start looking segment number segment mechanism virtual memory segment number offset segment segment table page numberoffset page page frame numberoffset page frameunified page tablesegment address linear address physical address figure architecture combine segmentation paging ing single page table segment segment table used translate segment number base address o set segment added yielding linear address linear address translated physical address using uni ed page table shown greater figure chapter virtual memory yielding starting address segment length permission just like system use pure segmentation assuming permission ok o set legal regard length mmu add segment starting address o set treating sum physical address mmu treat paged virtual address sort described previous subsection terminology address known linear address mmu look linear address single page table shared segment order locate appropriate page frame figure show alternative method combining segmentation paging used multics multics approach start looking segment number segment table provides information segment length permission allow mmu check access legality segment table doe contain starting address segment instead contains pointer segment private page table mmu us c page table translate o set segment using technique sort saw previous subsection end result o set page frame approach simpler operating manage surface approach look simpler us single page table instead segment signi vantage relative multics approach remember approach allow space physical memory exibly allocated individual contiguous page frame approach force segment allocated single contiguous region address space level linear address approach force operating deal complexity contiguous allocation potential external fragmentation unlike pure segmentation undeniably inferior paging combination segmentation paging attractive combine segmentation meaningful unit protection sharing paging smaller unit space allocation data transfer protection sharing feature simulated using paging probably result hardware designer decided cost segmentation money performance justi ed gain provided support paging created disincentive use segmentation operating system popular operating system unix microsoft window linux signed portable multiple hardware architecture mechanism virtual memory segment numberpage numberoffset page segment table page table page table page frame numberoffset page framevirtual address physical address figure multics combine segmentation paging using separate page table segment segment table used nd appropriate page table used translate address segment support segmentation result operating system make use segmentation system supported completes cycle disincentive designer modern architecture reason support segmentation modern operating system use modern architecture longer support segmentation feature reminiscent combination segmentation paging recall tlbs hashed page table use asids tag page translation translation di erent process coexist said special register hold asid current process ity modern architecture allow process use di erent asids bit virtual address select group asid register address translation occurs step bit address translated asid asid remaining bit translated page frame o set operating set process use asid shared library wind sharing page frame page table tlb entry akin process sharing segment unlike segmentation invisible application level number chapter virtual memory segment asids process quite limited itanium version powerpc policy virtual memory far ned virtual memory explained usefulness shown mechanism typically used map page page frame anisms operating need set policy describing mechanism used policy provide answer following question point page assigned page frame page rst accessed earlier point decision particularly performance critical page need fetched disk time assigned page frame reason policy control timing page frame assignment normally called fetch policy page frame assigned page said page assigned available frame assignment result improved performance processor cache memory policy selects page frame page known placement policy operating need inactive page disk order free page frame page doe choose known replacement policy page moved disk presumably replaced new motivation freeing page frame policy ect performance way quite workload dependent example replacement policy performs workload perform terribly instance consistently choose evict page accessed moment later policy need chosen ned extensive experimentation real workload following subsection focus sample policy reasonably simple performed adequately policy virtual memory fetch policy operating wide latitude regarding page assigned page frame extreme soon operating know page existence assign page frame example process rst start running operating immediately assign page frame page holding program statically allocated data similarly process asks operating map le virtual memory address space operating assign page frame entire le extreme operating wait page fault caused access page assigning page page frame extreme lie range realistic fetch policy try stay just little ahead process need creating page mapping right away ict original goal virtual memory fast start program contain large rarely used portion extreme policy discarded reasonable choice stance said use demand paging creates mapping page response page fault accessing page conversely us prepaging attempt anticipate future page use demand paging advantage waste time creating page mapping go unused disadvantage incurs cost page fault page balance demand paging particularly appropriate following circumstance process exhibit limited spatial locality operating unlikely able predict page going used soon make paging advance demand likely pay o cost page fault particularly low moderately accurate prediction future page us pay o little gained time correct prediction allows page fault avoided linux operating us demand paging exactly stance suggested analysis fetch policy make distinction lled page read le page fault cost di erent linux us demand paging lled page comparatively low cost contrast linux ordinarily us variant prepaging explain remainder section le mapped virtual memory make sense reading disk slow application programmer noti chapter virtual memory operating particular le going cessed fashion linux us demand paging le page programmer provide information using madvise procedure common form prepaging clustered paging page fault cause cluster neighboring page fetched including incurring fault clustered paging called read page faulting page read contrast read ahead read faulting page later page earlier one detail clustered paging vary operating system linux read cluster sixteen page aligned start multiple example page fault rst sixteen page le cause sixteen page read extra fteen page faulting page mix microsoft window us smaller cluster size depends kind page incurring fault instruction data instruction access generally exhibit spatial locality data access window us larger cluster size instruction page data page linux read actually slight variant prepaging theme page fault occurs fault handler fetch cluster page ram update faulting page table entry page ram mapped virtual address space status known page cache subsequent page fault quickly nd page page cache read doe decrease total number page fault convert major page fault reading disk minor page fault simply updating page table reading disk take millisecond ing sixteen page take slightly longer reading success rate prepaging doe need especially high pay o example additional time needed read process prepaged page half millisecond reading cluster sixteen page single page add millisecond repaid single fteen additional page get used prepaging avoid disk access time placement policy just operating need determine make page ident demand advance need decide page reside selecting unused page frame choice uences policy virtual memory physical memory address referenced uence miss rate cache memory hardware cache performance main issue desktop system reason placement policy matter multiprocessor system main memory distributed processing node given processor page frame rapidly access microsoft window server take e ect account allocating page frame issue likely important future potential energy saving access ned portion memory allowing rest standby mode explain placement policy uences cache miss rate need review cache memory organization idealized cache hold nmost recently accessed block memory ni cache size require cache access examine nblocks looking contains location accessed approach known associativity feasible realistically large cache real cache restrict given memory location small set position cache way position need searched sort cache known ple cache alternative location given memory block stored cache particularly rst level use physical address virtual address select set consider happen process repeatedly access block memory misfortune competing set cache cache holding far block active miss rate high standard description situation say cache su ering ict miss capacity miss miss necessitates access slower main memory high rate ict miss signi cantly reduce performance lower cache associativity likely ict miss problem careful page placement important day cache external main microprocessor chip external cache low associativity improved semiconductor nology allowed large cache integrated microprocessor making higher associativity economical rendering placement policy important suppose operating doe wish allocate chapter virtual memory frame reduce cache icts know page portant icting common approach assume page ict virtual memory address translation ict address translation known page oring common approach assume page mapped page frame soon likely accessed temporal proximity given noncon icting frame known bin hopping main argument favor page coloring leaf intact careful allocation level virtual address compiler thor application programmer aware importance avoiding cache icts particularly scienti c application weather forecasting example compiler programmer pad row array little wasted space iterating column array wo repeatedly access set cache kind data allocation preserved page coloring main argument favor bin hopping experimental evidence suggests performs better page coloring doe absent data allocation page coloring exible bin hopping providing way deciding preferred location cache given page opposed ranking possible location preferred replacement policy conceptually replacement policy chooses page evict time page fetched page frame use operating system typically try eviction advance actual demand keeping inventory free page frame inventory drop mark replacement policy start freeing page frame continuing inventory surpasses mark freeing page frame advance demand advantage freeing response page fault delay process incurred page fault contrast operating schedule proactive work maintain inventory free page hardware idle improving response time throughput dirty page requires writing disk rst operating doe proactively able write policy virtual memory page single disk operation making use disk hardware time freed reused page frame retain copy page recently held allows ating inexpensively recover poor replacement decision retrieving page minor page fault instead major page retrieved mapping reading disk particularly important mmu doe inform replacement policy page recently referenced real operating page frame rary state chosen replacement reused example microsoft window replaced page frame following inventory page frame illustrated figure replacement policy rst chooses dirty page frame operating move frame process page table modi ed page list modi ed page list retains information previous page mapping minor page fault retrieve page microsoft call soft page fault page frame remains modi ed page list long thread known modi ed page writer write content disk frame standby page list page frame directly process page table standby page list replacement policy chooses evict clean page standby page list retains previous mapping information soft page fault inexpensively recover prematurely evicted page page frame remains standby long faulted use operating move free page list list provides page frame zero page thread proactively ll zero lled page available quickly respond page fault discussed earlier operating prefers use page frame free list reading page disk zero page thread lled free page frame zero move page frame zero page list remain mapped process page table response page chapter virtual memory page tablemodified page list standby page list free page list zero page listpage faultpage fault disk readclean evictionsoft page fault zero filledafter timewritten diskdirty evictionsoft page fault figure page frame microsoft window referenced page table included page list page frame circulate shown example use soft page fault recover page frame modi ed standby page list page contained page frame prof needed having evicted replacement policy virtual memory using mechanism example window operating keep inventory page frame need evict page time fetch page order size inventory relatively stable long term operating balance rate page replacement rate page fetch di erent way lead major category replacement policy local replacement global replacement local replacement keep rate page eviction page fetch anced individually process process incurs page fault relinquish page frame pushing process page frame replacement policy chooses page frame free held particular process separate allocation policy decides page frame process allowed global replacement keep rate page eviction page fetch balanced basis process incurs page fault process page evicted frame replacement policy chooses page frame free page frame regardless process used separate page frame allocation policy needed replacement policy fetch policy naturally wind reallocating page frame process operating system popular today microsoft window us local replacement member unix family including linux mac o x use global replacement microsoft choice local placement policy window broader pattern following lead digital equipment corporation vms operating hp openvms key reason vms designer chose local replacement prevent poor locality reference cess greatly hurting performance process arguably performance isolation relevant typical window desktop server workload vms timesharing workload global replacement simpler exibly adapts process memory need known advance reason tends local global replacement policy confronted uation total size process working set exceeds number page frame available case local replacement manifest self allocation policy allocate reasonable number page frame process case global replacement excessive mand memory manifested thrashing chapter virtual memory essentially time paging process switching producing extremely low throughput traditional solution excess memory demand swapping operating pick process evict entirely memory writing data disk remove process thread scheduler set runnable thread compete memory space running remaining process operating swap earlier victim swapping add complexity make scheduling choppier global replacement system linux omit rely user steer clear thrashing local replacement system microsoft window hand little choice include swapping simplicity discus swapping text know understand people incorrectly paging swapping example hear linux swapping really paging linux moving individual page process address space disk moving entire address space having seen broader context replacement policy t time consider speci c policy start unrealistic provides standard realistic policy measured operating knew advance sequence virtual memory access select replacement page use furthest future turn just intuitively appealing mathematically prove optimizes number demand fetch replacement policy known asoptimal replacement opt real operating system know future page access advance data allows probability di ent page access estimated replacement policy choose evict page estimated longest time used special case consider program distributes memory access page randomly unequal probability page frequently accessed suppose probability shift slowly case page accessed frequently recent past likely accessed soon versely accessed long unlikely accessed soon make sense replace page gone longest accessed replacement policy known recently used lru policy virtual memory lru replacement realistic opt us mation past future lru entirely realistic requires keeping list page frame order recent access time updating list memory access lru used opt standard compare policy lru gold standard way opt opt optimal policy lru optimal policy relying past activity real process access page randomly slowly shifting probability distribution example process repeatedly loop set page case lru perform terribly replacing page reused soonest nonetheless lru tends perform reasonably tic setting replacement policy try approximate replace recently used page replace page used recently considering realistic policy approximate lru troduce extremely simple policy serve foundation policy simple policy known rst rst replacement fifo tell story operating chooses replacement whichever page frame holding current page longest note di ence fifo lru fifo chooses page fetched longest ago continues frequent use lru chooses page gone longest access figure show example lru outperforms fifo outperformed opt performance ordering universal exercise fifo outperforms lru opt doe perform strictly better fifo smart policy fact early simulation showed performs comparably random replacement mediocre mance sign fifo smart su er belady anomaly increasing number page frame available increase number page fault decreasing expect exercise generate example counterintuitive mance phenomenon opt lru immune belady anomaly member class stack algorithm stack algorithm replacement policy property run sequence page reference system using replacement policy npage frame point reference sequence chapter virtual memory m m lru m fifo figure comparison opt lru fifo replacement policy pair box represents page frame available unrealistically small number box indicate page stored page frame number reference sequence letter h m indicate hit miss example lru performs better fifo hit opt performs better hit page occupy page frame rst resident page frame second example lru policy nmost recently accessed page resident recently accessed page resident clearly recently accessed page include nmost recently accessed page exercise come similar justi cation claim opt stack algorithm recall beginning subsection indicated page frame chosen replacement immediately reused enter inventory free page frame operating recover page inventory reading disk page accessed containing page frame reused nement turn dramatically improve performance fifo fifo evicts page frequently used chance good faulted page frame reused point operating end fifo list replaced essentially fifo policy place page probation accessed probation actually replaced page wind actually replaced accessed recently approximating lru approximation lru based fifo known security virtual memory fifo sfifo enable smarter replacement policy mmus provide reference bitin page table entry time mmu translates address set corresponding page reference bit address translation write memory mmu set dirty bit mentioned earlier replacement policy inspect reference bit set way replacement policy obtains information page recently used reference bit easy implement ciently especially multiprocessor system system omit exist allow operating nd page use cheaply putting probation seeing get faulted replacement policy us reference bit approximate lru clock replacement clock replacement operating considers page frame cyclically like hand clock cycling numbered position replacement policy clock hand pointing ticular page operating inspects page reference bit bit page referenced recently chosen placement bit operating reset move pointer candidate way page chance prove utility having reference bit set pointer come nement operating dirty bit account follows set reference candidate dirty choose page replacement dirty start writing page disk candidate writing complete set dirty replacement policy fifo clock replacement used locally select replacement candidate process globally example version microsoft window use clock placement local replacement policy system reference bit available fifo security virtual memory virtual memory play central role security provides anism equipping process protected memory chapter virtual memory topic chapter discus defer security issue chapter close lationships process concept protection classic virtual memory security issue best discus particularly relevant application programmer recall traditional use virtual memory simulate having lot ram moving inactive page disk create security problem program process dential data permanently stored application want rely operating guard data disk instead want ensure sensitive information written disk way adversary later obtains physical possession disk drive directly read content sensitive information available cryptographic system designed threat model disk presumed subject theft familiar example system store login password disk instead store result feeding password function ing entered password making password vulnerable exposure program login program program store password temporarily main memory application programmer think program sensitive data temporarily volatile main memory store disk programmer care overwrite memory afterward safe zero lasting record dential data disk virtual memory wrote page question vulnerable period virtual memory tionally operating invisibly scene application programmer know protect program vulnerability need forbid operating writing sensitive region memory disk e ect want create exception normal replacement icy certain page chosen replacement posix standard api contains procedure use purpose mlock mlockall unfortunately overuse procedure tie physical memory privileged process allowed use course program handling sensitive information login program need run special privilege security virtual memory exercise section introduced analogy executive le clerk extend analogy clerk serving multiple executive plausible scenario clerk need understand executive referring di erent document using document plausible scenario executive use di erent name refer document explain clerk cope scenario connection virtual memory le containing executable program generally contains text program initial content writable data structure explain cow used writable region mentioned typical page size grown decade brainstorm consideration make smaller page better larger page consideration make larger page better smaller think changed decade identify argument favoring small page weakened time identify argument favoring large page strengthened time presumably tor account historical trend page size hand able identify factor suggested reverse trend presumably outweighed previous exercise concern factor uencing historical trend page size hand uences causing page size remain unchanged year think uences assume page size kb page mapping shown figure page virtual address rst word page physical address translate suppose rightmost kbit address used represent o set page remaining bit used page number consider location o set jwithin page mathematical formula address chapter virtual memory suppose rightmost kbit virtual physical address used represent o set page page frame maining bit used page number page frame number suppose integer n page number ni mapped page table page frame number f n mathematical formula physical address corresponds virtual address suppose architecture us virtual address page suppose linear page table stored process containing page table entry page number suppose size page table entry byte large page table lower right figure page page number explain page number calculated discussion multilevel page table based original version architecture limited physical address bit newer processor o er optional physical address extension pae mode order address sixteen time ram consequence page table entry page directory entry increased byte instead page chunk page table kb entry chunk page table page directory hold b big virtual address range doe chunk page table span page directory entry directly point large page frame size just pae directly point page frame c big virtual address range page directory span d page directory longer span virtual address range pae requires adding level tree newly added root node doe large branching factor calculated preexisting level page directory doe root point e draw diagram analogous figure page pae security virtual memory figure page show small example lru lower miss rate fifo replacement develop example similar size fifo lower miss rate lru figure page lru fifo replacement higher miss rate opt develop example similar size lru fifo low miss rate opt doe small example belady anomaly small integer n short sequence page number reference fifo replacement policy given ninitially page frame fewer miss result reference sequence initially page frame used justify claim opt stack algorithm assume tie broken replacing lowest numbered page involved tie conducting measurement study good conduct multiple trial experiment reporting data single run particular case study paging caused particular activity important reboot experimental run multiple page table entry point page frame extreme case entire virtual address space readable zero having page table entry marked pointed single page frame assumption section hashed page table section violate problem cause consider window operating choice page frame use reading page disk doe make sense prefer page frame free page list zero page list b doe make sense prefer page frame free page list standby page list c page frame modi ed page list worse choice standby page list chapter virtual memory programming project write program loop time time using inner loop access element large array byte time long program take array access varying array size array size average time suddenly change write report explain did hardware software context did carefully replicate result linux version unix including mac o x support mmap andmadvise tem call read online manual page write simple c test program map large le virtual memory gram use madvise indicate random access genuinely access le randomly access sequentially program usemadvise indicate sequential access behave sequentially randomly time program rebooting computer run write report explain did hardware software context did carefully replicate result report draw conclusion experiment doe rect use madvise important performance test exploration project linux nd le mapped process address space typing command following form cat wherenis process id number read documentation proc section online manual order understand output format look various process map nd case le mapped process address space di erent virtual address linux system variety networking software forth case security virtual memory linux unix including mac o x nd formation process using pscommand include process provide option option allow specify information obtained process particular command p provides column output resident set size physical memory virtual size process presumably virtual size large resident set size ratio resident set size virtual size using general ability pipe output command use pipeline p awk printf sort obtain numerically sorted list ratio process nonzero virtual size want processing list le like p awk printf sort ratio try system range ratio span median ratio compile run c program figure linux unix including mac o x run p l command preceding project output able virtual memory resident set size program contains large lled array go unused virtual resident set size process compare change size recompile run size change doe unit measure use command exploration project determine sparse process address space fraction range lowest mapped address highest mapped address belongs mapping contiguous address range occupied unoccupied hole hole large linear multilevel page table plausibly advantage chapter virtual memory include int int main int argc char argv p l note letter l return figure c program show size including size large array zero running pscommand section estimated relative price gigabyte speed disk versus ram look price speci cation web make estimate ratio explain assumption make data use explained text linux normally us form clustered paging known read using madvise procedure override normal behavior particular region tual memory marking randomly accessed turn o prepaging sequentially accessed switch variant form prepaging instead experimenting mode selectively programming project experiment changing virtual memory use provided build install linux kernel near kernel source le nd nitions v v v change nitions ned ned virtual ory area treated accordance mode ned independent us madvise build kernel change conduct experiment compare mance program running variant kernel performance running normal kernel want build variant kernel order try mode write report clearly presenting result carefully explaining did hardware software context did replicate security virtual memory project written kernel version relevant aspect source code stable quite version note trace paging seminal article lished early designer atlas computer report computer rst use small fast memory large slow memory simulate large fast memory note cite recent article jessen brought light unpublished doctoral dissertation untsch dissertation proposed similar approach simulating large fast memory read article write comparison untsch work atlas team date ous di erence unpublished proposal unbuilt machine apparent uence resulted actual machine publication frequently enced later writer surface issue compare substance proposal like today virtual memory note introduced virtual memory concept stressing distinction address name information location storage ham point earliest paper virtual memory cerning pioneering atlas computer dennis point greater length year later paper seminal regard paging segmentation respectively fore dennis paper segmentation used commercially burroughs end decade denning wrote tial survey virtual memory eld including paging segmentation us list virtual memory traced earliest paper famously simulation large fast memory small fast memory large slow external storage device rst used atlas computer exploration project regard related mechanism proposed earlier untsch jessen recently described context denning developed working set concept virtual memory application modern vintage message passing cow recent example mac o x chapter virtual memory discussing application virtual memory touched ple implementation issue compromise approach dirty bit reference bit employed itanium reference able example performance impact cache bypassing prezeroing page paper linux powerpc introducing representation address mapping mentioned mixing page size bene cial important body research topic talluri dissertation navarro showed transparent support mixed page size practical linux moved direction prior version used page specialized purpose version huge page feature allows ordinary application process page automatically coalesced possible divided necessary speci c information example system mentioned able itanium including ity multics microsoft window hashed page table interesting historical design sion starting atlas continuing past hashed page table clustered page table deployed commercially atlas used fully associative inverted page table array storage location page frame element ncontained page number resident page frame locate given page number address translation special hardware checked entry inverted page table parallel hardware doe scale large number page frame ibm replaced parallel search hash table retaining inverted page table entry hash table pointed entry inverted page table hp originally adopted approach precision architecture recognized hash table inverted page table merged forming today hashed page table described huck hay huck hay introduced notion software tlb recall linear multilevel page table store page table entry secutively chunk sequential page number example page chunk contain unused entry wasting space hashed page table hand store page table entry individually space wasted unused entry entry need ni cantly larger optimal balance point space extreme page table reference exhibit spatial locality keeping small cluster consecutive page entry jacent speed access based observation talluri hill security virtual memory khalidi proposed clustered page table variant hashed page table entry hash table contains page table entry consecutive page kessler hill evaluated page coloring bin hopping approach page placement belady published early comparison replacement policy cluding fifo lru complex version opt called min separate publication coworkers showed fifo subject anomaly come bear ence mattson et al ned opt modern form proved optimality introduced concept stack algorithm proved immune belady anomaly aho denning ullman alyzed optimality probabilistic model particular showed lru approximates optimal replacement given slowly varying reference probability turner levy showed segmented fifo page placement approximate lru work context vms local replacement similar replacement policy using cheap mation recently freed page substitute reference bit time global patterned clock replacement used babaoglu joy shortly chapter virtual memorychapter process protection introduction point having seen thread perform computation virtual memory space computation place nally prepared synthesize notion process process play central role view operating experienced ministrators application programmer moderately sophisticated computer user particular technical concept process come closest informal idea running program concept process entirely standardized di erent erating system system use di erent word detail nition vary nonetheless stream system based nitions include following thread process embodies running program process closely associated single thread program designed divide work multiple thread program run example web browser use thread download web page thread continues respond user interface virtual memory accessible thread word ply sort protection scheme ensures thread process access memory process legitimate access right mainstream protection approach process virtual memory address space shared thread process chapter process protection present alternative process share single address space varying access right individual object address space case access right assigned cess individual thread access right process hold right resource memory example right update lar le disk service request arriving particular network communication channel address issue chapter sketch general approach process hold access right process hold speci c capability capability write particular le hold general credential identi cation user process running case credential indirectly implies access right way separate mechanism access control list resource allocation context limited resource space ory disk generally associated process reason process termination serve implicitly release resource holding reallocated operating system generally handle memory way second process associated limited resource quota billing account resource consumption charge simplicity comment issue miscellaneous context operating system associate aspect running program state process example system linux unix conforming posix standard track process current working directory thread process access le explicitly cating directory containing le operating look le starting process current working directory torical reason operating track single current working directory process thread state better associated individual thread hard operation thread upset le operation underway concurrently running thread cause big master narrative item miscellaneous context wo consider chapter list key aspect process concern protection aspect focus posix process management api diving consideration various approach protection devote section basic posix process management api used thread running process creates process process exit section serve make use process concrete studying api allow understand shell command interpreter executes user command studying basic posix process management spend remaining section chapter learning various aspect protection mind protection large diverse area troduce di erent protection mechanism chapter leave topic later chapter postpone protection question ci c le system chapter protection intimately related security cover chapter particular emphasis basic mechanism defer chapter question mechanism deployed enforce chosen security policy divide current chapter treatment protection section section address fundamental question limiting process access memory showing processor provide tinct execution mode serve foundation protection present approach memory protection separate address space process single address space ing memory protection section rst present fundamental access right examines approach mentioned senting access right capability combination credential access control list assumption section protection operates granularity process section examines alternative ner coarser granularity protection approach protects part process approach hand protects entire simulated machine simulated machine running operating section chapter concludes examination security issue directly raised material earlier section posix process management api operating system provide mechanism creating new process minating existing process performing related action detail vary provide concrete example present relevant feature posix api used linux chapter process protection including mac o posix approach process identi ed process id ber positive integer process exception come existence forking parent process exception rst process created operating start running process fork o new process thread running parent process call fork procedure parent process fork return process id number new child process error occurs procedure instead return negative number process id number important parent later want exert control child nd child terminates child process start running child process regard copy parent process protection purpose credential parent capability purpose access le opened reading writing addition child contains copy parent address space available executable program code parent variable initially value parent address space copied instead shared variable start having di erent value process soon performs instruction store memory special facility exist sharing memory speaking normal case course operating doe need actually copy page address space use copy write cow avoid postpone copying child process nearly identical parent start o performing action parent fork procedure return code called application programmer generally want child continue executing step parent point having process behaved identically fork procedure give child process indication child behave di erently fork return value child contrast return value parent process child process id number mentioned earlier normal programming pattern fork operation mediately followed ifstatement check return value fork way program code wind following di ent course action parent child handle possibility failure signaled negative return value program figure show example parent posix process management api child process similar loop ve time printing ve message interval di erent print di erent sage shown sample output figure mind output possibility id number di erent interleaving output parent child vary run run example program illustrates process copy loopcount variable start initial value established fork process ments counter copy ected programming project write variant program early version unix thread ran process program involved concurrency needed create multiple cesses using fork situation normal program like figure includes code ent child today concurrency program normally using multithreaded process leaf big use fork creating child process run entirely di erent program case child code forking program long load new program start running happens example time type program shell prompt shell fork o child process run program program execution distinct process forking used combination fore turn thread running process load new program start program running posix standard includes di erent procedure used load new program start running variant theme name starting exec commonly called exec family member exec family given information nd new program stored le provide program argument environment variable need family member di er exactly calling program vides information family member closely related system ne execve procedure kernel operating library procedure written term execve execl simpler member family use example program figure print line identifying including process id number get using getpid procedure us execl run program named p print information running process execl come line print error message saying execution failed chapter process protection include include include iostream using namespace std int main int loopcount process loopcount cout process endl returnedvalue fork returnedvalue process perror error forking report error return returnedvalue child process loopcount cout child process endl loopcount decrement child counter sleep wait second repeating parent process loopcount cout parent process child id returnedvalue endl loopcount decrement parent counter sleep return figure program demonstrates process creation using fork program print line output including ve parent child process fork posix process management api process child process parent process child id parent process child id child process parent process child id child process parent process child id child process parent process child id child process figure sample output forker program figure show just possible sequence event nd surprising error message issued unconditionally ifstatement testing error fact occurred reason surprising situation member exec family return error occurs new program started running replacing old program process possibility returning old program looking example program use execl take argument string followed special null pointer reason null mark end list string example string us execl fewer rst string speci e le contains program run psprogram directory generally contains fundamental program remaining string argument available program control behavior rst conventionally repeat command p remaining argument axl contains letter axindicating process listed letter lindicating complete information listed process sample output figure exact process id mentioned initial message show id process running p axl command process id remains execl changed program process running changing process inconvenience execl use need know chapter process protection include include include iostream using namespace std int main cout process id getpid exec endl execl p axl null perror error execing p return figure program illustrates procedure execl member exec family used change program current process running process id program report later shown psprogram process start running psprogram note unconditional error message execl execl fails doe calling program continue run process id exec uid pid command p axl figure sample output execer program figure narrower shorter omitting column output produced p axl command line output remaining output process process id pid executed p axl process process running p axl posix process management api directory program le located example previous program work pshappens installed avoid problem use execlp variant lename doe include directory search list directory looking le just like shell doe type command illustrated example program combine fork execlp shown figure example program assumes running x window linux unix system run xclock program display clock separate window run launcher program shell clock window appear shell prompt command execute clock keep running di erent happens type xclock directly shell case shell wait xclock program exit prompting command instead example program similar typing xclock shell character tell shell wait program exit program said run background way shell doe exactly sample program fork o child process executes program child process allows parent process way shell parent loop prompt command shell given character fork o child process run requested command child process parent doe continue execute concurrently instead parent wait child process terminate parent continues pattern fork execute wait apply case forking child process enable concurrency provide separate process context run program order wait child process parent process invoke waitpid procedure procedure take argument rst process id child parent wait zero want parent wait termination example process wait child process figure show shell shell used run user choice command date l p illustrated figure real shell allow command line argument o er background execution option provide feature nonetheless derstand basic shell run program programming project add missing feature notice child process terminate prior parent chapter process protection include include int main returnedvalue fork returnedvalue perror error forking return returnedvalue execlp xclock xclock null perror error execing xclock return return figure c program run xclock waiting program doe forking o child process executing xclock child process result xclock continues run window parent process exit allowing shell program run prompt posix process management api include include include include string include iostream using namespace std int main loop return cout command word flush string command cin command command exit return returnedvalue fork returnedvalue perror error forking return returnedvalue execlp null perror return waitpid returnedvalue perror error waiting child return figure program shell wait child chapter process protection command word date thu feb cst command word l microshell command word p pid tty time cmd bash microshell p command word exit figure sample interaction show date l pscommands run microshell figure invoking waitpid waitpid procedure actually need wait contrary suggests able ately report child process termination case invoking procedure commonly referred child process child process terminates parent waiting operating retains information terminated process parent wait terminated process waited known zombie waiting zombie make process id number available assignment new process memory used store information process reused known ingthe zombie programming project contains additional information reaping zombie exec family procedure interacts interesting fashion protection mechanism process executes program le ordinarily impact process protection context bilities reading writing le example remain intact process continues operate user identi cation credential mean run program generally acting behalf access right correspond user identi cation important exception program le cialset user id setuid bit set case process executes program acquires credential le owner owner le ordinarily user created le unless ownership explicitly changed setuid program check user ran protecting memory sort data time day example setuid mechanism provides extremely general mechanism granting access right grant subset right user choose condition program writing setuid program test condition performs controlled access mundane example create game program ability write le high score matter running user forbidden directly writing le similar program likely encountered use change password program update password database permission directly modify discus section setuid mechanism exibility make useful enforcing security policy point section mechanism source security pitfall ordinary program execution credential left unchanged security problem discus point seen key element process life cycle important omission shown process terminate returning main dure process terminate using exit procedure java terminate process using kill dure documentation detail exploring process programming mechanism operating system use protect memory occupied process want pursue application programming note section end chapter suggests additional reading protecting memory memory protection fundamental barrier process process operating process freely write operating data structure operating unable enforce kind protection fact process write memory hold operating instruction process e ectively switch entirely di erent operating choosing process freely write memory process ability write le example manipulate doing understand kind protection need rst understand memory protected section explains foundation protection chapter process protection processor ability switch restricted unrestricted mode operation section explain memory protection built foundation way giving process virtual memory address space giving process di ering access right single address space foundation protection processor mode operating give process address space instead give process access right portion shared dress space operating need privileged relative cesses operating able carry action changing address space access right process perform process truly contained access memory way operating doe reason modern processor run di erent mode operating application process name mode vary privileged mode called kernel mode mode orsupervisor mode kernel mode common use use privileged mode called user mode processor kernel mode execute instruction encounter including one change memory accessibility one directly interact device one switch user mode jump instruction address accessible user mode kind instruction used operating ready user process time run processor user mode execute normal instruction add load store attempt perform change memory accessibility interrupt process execution jump handler operating occurrence known trap sort transfer operating occurs page fault interrupt timer going o device requesting tion additionally process directly execute instruction operating procedure known example process use call ask operating perform thefork andexecve operation described section call request process doe unmediated access device transfer operating routine protecting memory operating mode jump starting address routine designated entry point jumped way process ca just jump middle operating arbitrary address operating need access portion memory memory used process process access operating private memory switching operating mode entail change memory protection varies architecture architecture require operating use address space access process example special register point base page table register need changed time operating mode change page table operating provide access page unavailable process architecture allow page table entry contain ferent protection setting operating mode example page marked readable writable executable kernel mode totally inaccessible user mode case page table need changed switching operating mode kernel us page table process range address occupied kernel o limit process architecture t pattern example linux operating allows process access gb address space reserving gb access kernel sort architecture address space doe change switching user process simple operating routine user process operating need switch address space returning user mode scheduler decides time come run thread belonging di erent process change address space necessary depends overall design address space process single shared address space section address alternative having described distinction kernel mode user mode position explain way thread implemented using mode figure show option schematic form explain following paragraph described chapter operating kernel use thread internal purpose zeroing unused page frame ushing dirty page disk circumstance thread execute entirely kernel mode called kernel thread chapter process protection user mode kernel mode b c figure relationship possible thread scheduling dispatching code switch thread operating mode thread kernel kernel scheduler dispatcher b thread run user mode scheduled dispatched kernel c thread run user mode scheduler dispatcher shown figure processor run rst kernel thread kernel scheduling thread dispatching code second kernel thread leaving kernel mode operating kernel scheduler choose run thread process shown figure b switching user thread requires mode switch thread process switch user mode kernel mode needed moving user thread scheduler second switch kernel mode user mode needed kernel dispatch user thread nomenclature user thread standardized common term native thread simply thread context clear avoid cost switching thread process middleware system provide scheduling dispatching mechanism analogous kernel residing code code running user mode shown figure c allows outgoing thread scheduler incoming thread execute user mode mode thread process thread commonly called thread prefer microsoft bers make clear talking figure b thread contain code provides nice metaphor suggesting multiple bers exist native thread shown figure kernel scheduler divide processor thread thread scheduler switching protecting memory user mode kernel mode figure multiple thread enclosed supported native thread kernel scheduler switch closing native thread dispatching occurs creates microsoft call bers thread needed understand processor mode order appreciate preceding kind thread mind introduced processor mode di erent reason processor mode provide foundation protection process example processor mode allow process ned address space multiple address space mainstream multiple address space system operating system including linux microsoft window mac o x provide memory protection giving process virtual memory address space unless application programmer make special arrangement address space completely disjoint programmer explicitly ask operating map le block shared memory space process address space multiple address space design particularly appropriate tectures comparatively narrow address example address reference address space going run process couple gigabyte data access way obtain space using multiple address space motivation multiple address space go away present practical purpose system regardless address size multiple address space design confers advantage mentioned section provided tionale virtual memory process allocate virtual address pendently mean compiler build chapter process protection program concurrent process running program able use address copy data procedure dynamically allocate memory example creating object work independently di ent process shared memory independently appear convenient virtual address process example process running program consistently use virtual address input channel consistently use second virtual address output channel process output channel input channel independent address space confer disadvantage brie y mentioned section inconsistent virtual address shared memory mean structure ca shared level abstraction provided programming language object linked pointer reference java lower level abstraction executed computer language construct generally represented virtual address object contains tual address separate address space virtual address meaningful process shared memory region contain simple data structure contiguous array ters contain complex need pointer linked list tree strictly speaking pointer used long represented virtual address compiler wo process care map shared memory location square independent allocation memory data structure span multiple shared memory region problematic important variant pointer problem ognize memory hold code data instruction include virtual address virtual address instruction jump virtual address data location load store virtual address included instruction su er fate er need kept local process process need coordinate assignment virtual address process need coordinate address allocation traded away advantage separate address space example consider dll mapped process address space natural instruction dll include address location dll possible unless dll occupies range virtual address protecting memory disadvantage separate address space address used ultimate object example pose process communicating want suggest map new object address space sending process ca specify object question address address object receiving process doe address object instead communication need term nomenclature lenames ilarly virtual address ca play role persistent storage object validity ned single executing process disadvantage severe displace multiple address space system mainstream advantage cause designer explore alternative process share single address space single address space system commercially case considerable success consideration system alternative single address space system need consider advantage disadvantage single address space exact opposite multiple address space process share store address freely need coordinate allocation instead rehearsing case single address space consider protect memory question security memory protection critical gram contain bug debugging challenging result bug process manifest symptom cess memory protection bug process cause symptom process bug form ing memory used process situation process data spontaneously change result bug unrelated process debugging nightmare single address space process varying access right memory goal moving single address space simply decouple question accessibility addressability concern memory location named concern location read written multiple address space process protected chapter process protection addressability process typically ability memory location used address space share particular region memory accessibility region seldom modulated independently individual process example rare region marked process contrast process single address space separated addressability memory location instead process di er regard memory region permission read write intel itanium architecture contains representative mechanism porting protection shared address space page table entry hashed page table contains protection key number idea page protected way key particular data structure span page page key giving process right read page key process right read structure collection sixteen special register hold protection key possessed currently executing process memory access checked doe cess key match accessed page hardware trap operating handler like page fault process need access independently protected memory region number protection key register operating normally use register cache recently accessed structure key like tlb protection key miss fault occurs operating immediately assume access illegal instead rst search comprehensive list process key missing key operating load key register resume execution process truly doe key doe operating cope illegal access terminating process protection key register contains key number set access control bit read write execute permission recall page table entry access control bit process access page appropriate permission key register page table entry allows access page table entry specify maximum access process protection key register provide modulated access individual process example process able read group page process write single address space system remain outside mainstream proved commercially viable ibm chose representing access right single address space design innovative product line aimed small business issued revised version basic design renamed iseries called design proved successful june ibm report iseries server installed worldwide representing access right section present principal approach representing access right use section clarify vocabulary used discussing protection system fundamental access right protection control access object bysubjects object kind entity need protection region memory le service translates name address subject active entity attempting make use object generally assume process thread process access right kind object repertory operation subject perform protection permit example memory region read write operation naming service lookup insert modify operation subject object operation performed subject operation terminating process protection mechanism normally operate term access right given subject process computer access right ultimately ect external authority human user capture notion say subject acting behalf principal purpose equate word use technical word occasionally principal organization individual server cess treat client process principal purpose client process really intermediary operated user distinguishing feature principal right pletely question policy technical mechanism organizational policy directs web server grant right particular client web browser example address chapter process protection browser principal hand organizational icy directs web server attempt identify human sitting web browser grant access right basis human principal web browser just intermediary subject example web server indicates subject operate behalf principal time di erent principal di erent time scenario web server operating behalf browser time behalf o browser time scenario web server operating behalf di erent human di erent time lead interesting question access right web server common design operating protection mechanism subject union access right need principal subject responsibility enforce ci c protection standard practice web server consider example web server running software let user read email web browser operating typically let mail software running server access user stored mail time regardless currently reading mail mail program make sure let read mail web context substantial redesign typically necessary operating protect principal leaving job application software mail program operating usually completely unaware principal google us linux operating server completely implausible create separate linux user identity user gmail way gmail store mail le marked operating level owned readable suppose away web context situation operating support multiple user run server software operates di erent time behalf di erent user organization le storage server print server t pattern context server software subject running behalf user principal accessing le object constrained c access control server software run time access right able serve user need carefully written checked make sure accurately enforces desired protection example print server need representing access right checked make sure user ca print user le just follow automatic consequence operating usual enforcement access restriction better design operating protection nism allow server switch set access right case subject said protection domain protection domain simply set access right possessed subject subject need switch domain order obtain extra access right normally available principal mentioned form system linux unix process executes program setuid bit set process switch protection domain taking identity program le owner corresponding access right time look subject s object ito say si allowed perform particular set operation generalize picture instantaneous state protection access matrix row subject column object entry row s column oof matrix set operation scan perform ono shown figure attempt subject perform operation checked legality reference matrix access matrix system dynamic gain loses column row operation listed individual cell matrix change time example forking o new process add row column matrix new process subject object process executes setuid program entry process row matrix change new user identity conveys di erent access right object change access matrix ect explicit protection tions making private le readable passing access right held process process protection operation regulated access right listed access matrix illustrated figure changing le accessibility operation le contained entry le column matrix normally operation appear entry column process able change le accessibility process right change le f accessibility corresponding access right matrix spot exactly row chapter process protection objectsz soperationss perform ono figure access matrix row subject column object entry showing operation subject perform object f accessibility transfer right accessibility figure access matrix contain right control change matrix example process right change accessibility le f change entry f column access matrix process right transfer right copy access right matrix corresponding entry notice representation right transfer right relies fact subject representing access right column similarly process pas access right entry row column permission recall subject object column row order t common protection mechanism access matrix model slight contortion necessary example anisms include access right granted principal user independent running computation time necessary add principal subject addition process access right row principal row process running behalf principal principal start running new process protection initialize newly added row right taken principal row tively process just right special operation principal object allowing indirectly use principal right figure trates alternative access matrix model general protection established set operation contained access matrix include operation change matrix generality suggests struct elegant mathematical theory protection system work independently speci c concrete system unfortunately model generality limit result mathematical theory provide harrison ruzzo ullman showed sic assumption general access matrix model simulate turing machine matrix playing role turing machine tape fundamental question particular access right leak turn equivalent halting problem able restricting problem render decidable make practically solvable example fall class problem explained note classi cation computational complexity theory contains hard problem solution algorithm unlikely exist concrete protection system need analyzed individually reference general result access matrix model access matrix represent di erent security policy depending content focus operation allow modi cation matrix distinguish broad category policy tionary access control dac mandatory access control mac mainstream system linux microsoft window mac o x usually gured use dac probably familiar chapter process protection jdoe read write read write b jdoe jdoe read write use right figure access right initially granted principal jdoe option right conveyed process operating behalf principal option process created jdoe right copied row matrix example right read le write le option b given just special right indirectly use right ofjdoe class policy familiar dac object considered owned principal process creates object le owner owner broad right control object accessibility owner le choose let user read write le dac system giving away arbitrary access right le away transferable right allowing user propagate access le contrast object creator mac doe obtain control access right object instead access right determined explicit security policy changed parameter policy designated security ordinary user example consider mac enforces military policy regard classi ed document using created classi ed document fact creator doe special control choose access user cleared document classi cation level way document readable user declassifying operation security perform postpone comparison dac mac system representing access right section include basic leaving detailed treatment chapter explain technique used track access right independent sort policy right enforcing rst technique use capability explain section second technique use access control list credential explain section capability acapability indirect reference object like pointer key distinction capability includes information needed locate object set access right example cesses possess capability le capability le pability permitted reading writing process possesses capability tangible representation entry row access matrix nomenclature standardized word bility date popular academic literature name used today mainstream operating system microsoft window refers capability handle posix system linux unix refer descriptor continuing example le window process le handle permitted reading linux process le descriptor permitted reading shortly handle descriptor actually direct capability everyday purpose programmer think way capability confuse matter designer linux unix system recently started using word somewhat di erent sense capability new sense word confers right doe refer speci c object example process hold capability allows access le allows kill process distinguish sens new capability called capability draft standard posix fact abandoned use word sense process store capability way depending design operating system process special storage area just capability independent normal virtual memory address space process microsoft window posix chapter process protection approach alternative approach taken iseries process capability stored normal memory just like data separate storage area capability called short capability list frequently called speci c name handle table microsoft window descriptor table posix system system provide special call entry operate normal load store operation applicable entry referred integer position list example operation read le take integer argument position le capability includes read permission operation open le reading add entry return integer index entry integer index serve handle microsoft window descriptor posix integer stored process memory signi cance outside process vantage point process integer just useless numerical value mean accessing capability mean integer directly used pas capability interprocess communication retain persistent storage order pas capability process need use special sending process speci e capability send integer index receiving process noti ed newly acquired capability integer index receiving process general given di erent integer sending process sent process posix system descriptor sent using sendmsg received using recvmsg example allow process opened le pas open le descriptor second process read le capability model incomplete explanation posix le scriptors explain chapter fully understand le descriptor need consider property operating keep track information associated open le especially current position le reading ing present chapter prefer continue topic capability explaining option stored instead segregating capability process forcing process use position surrogate capability operating process direct possession representing access right capability particular ibm chose approach carried forward iseries gated capability addressable capability stored address space capability addressable value considerably exible variety storing addressable capability object software use link independently protected object gether larger structure just pointer used make traditional structure linked object exibility particularly valuable iseries mentioned section single address space major addressable capability prevent application program forging recall approach operating store capability memory inaccessible cess forgery nonissue normally capability come trusted call capability stored ordinary memory location stop program writing appropriate set bit look like capability using forged capability perform protected operation basic approach exist prevent capability forgery approach used iseries relies special hardware feature memory word supplemented tag bit indicating word contains capability normal instruction set bit capability operation set word tag bit set used capability alternative approach us cryptographic technique achieve high probability forgery detected needing special hardware capability represented large string essentially random bit operating check given string bit valid way forge capability incredibly lucky guess approach preventing capability forgery force user gram processed trusted translator enforces strong type type prevents capability forgery way type error interestingly iseries doe user program trusted translator apparently type simply weak tion special tagging hardware example stronger type providing protection section discus use java virtual machine provide protection ner granularity operating process iseries combination single address space chapter process protection capability determining set capability available given process easy job place unlike just scan process address space looking capability process doe individual address space instead access portion shared address space reachable capability capability process available lead object turn contain capability leading object capability lead discovered object nd capability require general directed graph traversal algorithm similar needed garbage collector regardless nd process capability recognize set capability link abstract model protection system access matrix process set capability corresponds row access matrix record subject right object hypothetical provided protection purely capability correspondence access matrix row capability set exact correspondence direct real system blend protection access control list topic consider section hybridization protection representation process set capability hold portion content access matrix row common operating system capability selectively granted selectively revoked example selective granting capability operating allow just process open le private information obtain corresponding capability section achieves process successfully opening le passed capability privileged continue operate le le owner revoke capability short destroying le posix system owner ca destroy open le just content name system multics various research system supported selective revocation capability object revoked remain valid approach track location copy capability invalidated overwriting approach check capability valid time used request operation example capability large random string bit object contain list valid capability irrevocable capability reconcile security reason architect change relative representing access right original design taken eliminated use capability operating posix system pragmatic approach problem irrevocable capability system use capability storage access right process running excess access right caused irrevocable capability away rebooted worst case storage access right provided access control list topic chapter access control list credential seen capability list collect access right held process slice access matrix natural considering instantaneous right process executes natural setting auditing policy regarding access right purpose system use mechanism based user credential access control list anaccess control list acl essentially slice access matrix listing object subject access object manner listing subject ne granularity individual process acl speci e right user principal named group user example acl microsoft window pulling property dialog box folder selecting security tab dialog box visual form dialog box dependent particular version window principle apply modern version shown figure folder named acl entry group user administrator individual user dialog box process running credential tor group allowed control folder permission control listed actually abbreviation set permission individual permission need click advanced button give dialog box figure button producing result shown figure control actually set thirteen di erent permission sion slash name di erent interpretation applied folder applied le subtlety figure concern presence deny column check box column right allow column chapter process protection figure initial dialog box summarizing microsoft window acl security tab property dialog box suspect redundant deny box checked allow box unchecked reasonable suspicion wrong figure user group allowed denied ability create le program file folder understand acls need understand di erence denying permission allowing seen acl entry allow permission deny graphical user interface look entry allow deny permission fact ble checking box unchecks mind right user derive acl entry speci cally user identity acl entry group belong combining various acl entry having option make sense reason parliamentary procedure vote yes stain acl entry abstains allows denies permission permitting acl entry decide question figure simply member user group determinative way regard creating le member user group able create le folder depending acl representing access right figure clicking advanced button dialog box shown ure produce dialog box turn give opportunity click button obtain detailed view shown figure chapter process protection figure detailed view microsoft window acl entry allows control really summary thirteen di erent representing access right figure microsoft window acl entry shown detailed view permission allowed denied circumstance acl entry allowed control chapter process protection say depending group user belongs meaning having allow box deny box checked applicable acl entry abstain access denied acl entry applies user speci e permission allowed acl entry applies user speci e permission denied case key di erence arises acls parliamentary procedure majority vote doe win acls instead single vote deny access overrule number vote allow access like veto power possessed permanent member united nation security council allows acl include exception example member group given access listing individually speci c user denied access figure summarizes rule combining acl entry window kernel acl entry actually combined ing di erent rule acl entry applies user speci e permission allowed acl entry applies user speci e permission denied kernel obeys whichever acl entry listed rst api procedure generally used maintain acls care deny entry precede allow entry e ectively result rule shown ure deny entry override allow entry particular graphical user interface shown preceding gures make use api give precedence deny entry exercise analyze relative merit rule combining acl entry detail vary operating operating microsoft window version acls typical system edged acls dating multics looking allow deny allow allow deny allow deny deny deny deny allow deny figure table show rule combining microsoft window acl entry rule used repeatedly combine number acl entry nal result combining applicable entry treated deny text explains di erent rule used lower level gure explains usual representing access right example acls consider popular alternative use highly restricted form acl particular explain le permission portion posix speci cation implemented linux mac o x version unix posix system o er option acls focus traditional required permission common microsoft window posix concept user group le owned particular user usually creator owning group acl le exactly entry entry speci e permission user owns le second entry speci e permission user bers owning group owning user entry speci e permission user owner member owning group note unlike window acl entry contribute single user permission apply user permission treated binary fashion granted granted need distinction way acl entry ned perform odd stunt like giving permission access le entry posix acl specify mission read write mean directory permission abbreviated single letter r w le total permission bit r w x owner r w xfor rest owning group r w xfor bit output l directory listing program given letter lindicates want listing lot information example listing home directory line start max followed size date time directory entry letter dat beginning indicates entry subdirectory character permission rwxpermission chapter process protection member group randx w user permission ordinary le rwxpermissions relatively people confused mean directory directory rpermission allows possessor nd name listed directory permission necessary access named le rpermission directory user just able observe taste lenames wpermission allows possessor create delete rename le directory note particular user doe permission write le permission delete le create new xpermission allows possessor use lename directory getting access le subject le permission xpermission allows user traverse directory look given directory determine rpermission user access le directory user know guess appropriate permission le xpermission simple rule use randxpermissions directory unless really know doing giving sion rcan frustrating break modern program graphical user interface interface present user list le pick making user type lename value xwithout ri security security design relies user knowing obscure choice lenames probably wise hand xwithout ri useful r need think quite creatively nd value letting people lenames make use exercise opportunity creative normal purpose directory permission rwx group really trust lot want use directory want described preceding bulleted list having wpermission directory quite powerful allows delete replace alternative granularity protection existing le directory overwrite le power kept check directory bit alongside rwxpermission bit constituting acl used limit power wpermission sticky bit set le deleted directory owner le owner directory administrator limitation applies renaming le access control list variety simpli ed kind generally used conjunction capability posix process want read write le example start using open procedure translate lename le descriptor refers capability open procedure take argument lename string integer encoding set ag set ag contains information process intends read le write le example open attempt obtain capability le named beta directory named alpha current directory open procedure us process user group credential check process necessary permission xpermission current directory subdirectory named alpha rpermission le named beta alpha process executed tuid program permission check using e ective user id adopted program ownership information similarly sion check e ective group id program owning group analogous set group id setgid feature used assuming sion granted open procedure creates capability le return integer le descriptor providing access capability point acls cease relevant xbit removed alpha rbit beta open le descriptor continue function open le descriptor irrevocable capability described section alternative granularity protection section showed operating protect process unwanted interaction section considers possibility providing analogous control interaction single process section considers protecting entire operating chapter process protection environment single computer protection process described process indicated unit ularity protection provided operating operating system protect process generally protect component process doe mean tection process important ca achieved instead protection normally job middleware operating consider example java object thread used application server considerable infrastructure safely shared running instance application instance frequently created later terminated want pay overhead cost operating process application instance instead application server allow numerous instance exist single operating process hand application server contain application di erent source protected sort debugging security nightmare process unprotected order protect application coexist single process process run java virtual machine jvm provides protection basic support java object thread jvm provides good example middleware provide protection component process protect java thread jvm make sure java code executing obeys certain restriction typical restriction method read uninitialized local variable previously written prevents method picking value left memory previously executed method di erent application instance principle jvm enforce restriction carefully ing step java program executing example jvm maintain set initialized local variable program run assignment local variable add set use local variable preceded check variable set problem approach make java code run like molasses winter instruction program preceded hundred instruction checking various restriction alternative granularity protection satis ed program running hundred time slowly real jvms smarter approach class loaded jvm component called veri er mathematically prof path code uninitialized variable read veri er check restriction similarly having proved path safe checked sens jvm run code speed ahead veri er check potential path code great number path nitely consider example method loop middle path beginning method end go loop zero time go loop time forth veri er construct safety proof using sort data ow analysis compiler traditionally used optimization analysis involves nding greatest solution simultaneous equation important general theorem regarding data ow analysis show greatest solution give set security guarantee counted hold point independent path taken point veri er check path safety exercise prove theorem protection entire simulated machine seen jvm allows zoom create collection protected domain single operating process similarly zoom treat operating complete process just protected domain larger virtual machine monitor vmm vmm us computer run simulate execution similar computer run operating process commercially signi vmms vmware esx server ibm esx server us hardware simulate multiple server example single multiprocessor server late uniprocessor server operating microsoft window linux simulated processor turn ecuting real processor control vmm similarly us ibm mainframe zseries simulate multiple zseries machine running ibm legacy mainframe operating system running chapter process protection vmm used look example ure box indicates hardware software component xeon hardware member pentium family ply interface upward layer layer vmm speci cally esx server simulates virtual machine providing interface leftmost virtual machine running linux middle running window rightmost running older version linux presence microsoft window linux hardware come server solidation di erent group enterprise settled di erent software environment hosted common hardware reduce total cost ownership version linux ect similar story case new version tested older version continues production use particular case shown gure linux virtual machine running single process apache web server virtual machine running process apiece case database server web server notice process bene t level protection vided operating vmm example window responsible isolating sql server process ii process nd way subvert window protection anism isolation fail process running virtual machine remain isolated long esx server ware continues job consider explanation version linux running machine group lot stake choose run latest version available security patch group stake choose stick older secure version avoid disruption upgrade group need fear consequence attacker ing group di erent hardware machine vmm provides assurance operation vmm similar operating like operating us scheduling divide processing time us page mapping divide memory key di erence doe support apis le operation posix instead vmm support interface similar real machine complete device virtual machine use instruction set architecture real hardware vmm doe need simulate execution alternative granularity protection hardware including xeon processorvmware esx serverlinux window linux sql server ii oracle apache posix posixhttp odbc http odbc http figure example show vmm vmware esx server porting multiple operating system label box identi e component label horizontal dividing line identi e interface unlike operating system vmm provides upward interface relies basis instruction directly executed real hardware issue privileged instruction kind used operating system task managing hardware changing page table recall processor generally operating mode kernel mode instruction legal user mode dangerous instruction transfer control trap handler trap handler software run kernel mode need explain mode used support level execution vmm operating application process vmm run kernel mode underlying processor executes instruction virtual machine hand doe user mode way vmm complete control protect virtual machine virtual machine need support simulated kernel mode run operating system vmm keep track virtual machine simulated mode virtual machine simulated kernel mode simulated user mode virtual machine executes privileged instruction example manage hardware trap vmm occurs shown figure vmm check virtual machine simulated nel mode privileged instruction attempted virtual machine operating vmm carry intent struction example doing requested hand virtual machine simulated user mode vmm chapter process protection o user mode simulating kernel mode simulate privileged instruction vmm kernel mode vmm kernel mode application user mode simulating user mode b o user mode simulating kernel mode trap return simulate traptrap figure attempt execute privileged instruction virtual machine trap vmm occurs virtual machine executing operating code application code hardware user mode case vmm know virtual machine simulated kernel mode simulated user mode responds accordingly virtual machine simulated kernel mode vmm simulates privileged instruction return trap b virtual machine simulated user mode vmm simulates trap occurred real machine switch simulated kernel mode jump operating trap handler virtual security protection trap virtual machine switching simulated kernel mode jumping trap handler virtual machine operating tem exercise consider trap handler virtual machine operating later return control tion program particularly interesting design question virtual memory handled operating running virtual machine set page table mapping virtual page number think physical page frame number vmm doe level mapping translating virtual machine page frame truly ical page frame hardware way vmm allocate hardware memory virtual machine trick like ing copy write cow transparently share memory virtual machine order support double translation address vmm computes functional composition address translation provides composition hardware mmu virtual machine simulated page table map aintob vmm want mapbintoc vmm put translation directly atoc real page table used hardware mmu security protection protection play essential role security title section literally long section instead simply highlight key security issue directly raised material chapter important message tion essential security security easily confused example security includes maintaining dentiality protection includes use access control list limit read access mission surely right wrong data question disk drive unlocked room access control list world wo dential adversary simply need steal drive read machine programmed ignore acls chapter address broader security picture nasty security pitfall arise distinction principal subject simpli ed term user process process operating credential user carry action chapter process protection user approve way happen user authentication weak log consider topic instead concentrating problem remain know human keyboard discussing posix process mentioned user credential retained process fork executes program program run acting credential true system microsoft window immediately raise possibility trojan horse program apparent benign purpose hidden nefarious intent suppose give program tell show really funny animation bart simpson impersonating gate run enjoy animation chuckle merrily unfortunately laughing programmer know program doe showing animation remember program doe doing process acting user credential ability send private data network probably doe trojan horse variant general trojan horse theme email worm pose receive email attached program run program want credential suppose doe send new email address book attachment protection think right read address book send email return address way malicious program spread computer world course worm perform action suppose knowingly run gift program doe make safe trojan horse necessarily variety way unknowingly run program follows example recall discussion execlp mentioned look sequence directory nd program le just shell doe search mean type simple command p list process necessarily know program run program named psi directory come search path particular common unix user search path started current directory named directory ceased popular open invitation trojan horse planted adversary write access security protection directory putting current directory search path user completely safe clever adversary plant trojan horse named common misspelling program installed system attack really safe alternative leave current directory search path want run program current directory need specify explicit pathname example run microshell program figure compile current directory run attacker want plant trojan horse run need advantage search path program run le access permission set people overwrite le modi ed version similarly directory containing program writable program deleted replaced setting program containing directory writable like obvious invitation trojan horse nd imagine situation arise repeatedly encountered installer program commercial application software set installed program directory writable user face installers administrator need vigilant manually change permission trojan horse problem far dangerous cretionary access control dac mandatory access control mac far actually trojan horse dac example mac enforces military classi cation level trojan horse possibly read secret le write copy unclassi ed le operating forbids process reading writing way notice using mac dac partially intended guard computer user making unwise decision far mac guarding tion needing trust program author trust people running program come nontechnical source like keeping eye employee money external program author security pitfall come ability setuid program propagate owner credential suppose adversary brie y ability act credential using mean setuid trojan horse alternatively adversary simply use keyboard getting ee assume adversary ability damage initial access method removed return getting ee smart chapter process protection use brief access create setuid shell owned executable adversary convenient later time adversary run program whatsoever credential analogy leaving door unlocked easy burglar retro t secret entrance house administrator ght unwanted setuid program measure turning setuid feature o le system normal user write regularly scanning le system looking setuid le measure valuable treating symptom bigger problem setuid mechanism elegant generality fundamental mismatch organizational security policy organization authorization ow ployees empowered pas authority setuid program raise additional set issue sense opposite trojan horse problem security problem arise person providing authority di erent person deciding authority used trojan horse trick user running program providing credential action speci ed program author conversely setuid program provides author credential unintentionally allow user running control action carry way mismatch source authority source control programming oversight explain case setuid program cedes control user running example suppose designer setuid program want print le want user running program specify printer le program execute shell command like lpr printername lename printername come user input lename controlled setuid program seemingly innocent command compromised way following adversary control directory search path mand executing program adversary choice normal printing command adversary input printer contains space print command gain extra argument taken lename print speci ed adversary adversary input printer contains semicolon print command turn separate command security protection lprand run totally di erent program adversary choice unix programmer developed body lore write setuid setgid program falling trap preceding example lore address particular pitfall interpolating arbitrary user input shell command fundamental step reduce risk program exploited mind risk function chance exploitation damage reduce opportunity exploitation making setuid setgid program small simple possible making executable user possible reduce damage exploitation having setuid setgid program owned special user group exists just purpose relevant sion program owned normal user group unrelated permission worst choice setuid program owned special administration account root permission absolutely positive setuid program valuable enforcing security policy basic permission acls represent example suppose want low group employee write le following limitation employee add entry end le modify existing entry entry include time stamp employee making addition employee make addition normal business hour subject physical observation provide greater protection impersonation sophisticated protection special accommodation need example saw microsoft window separate permission data versus data unlikely directly support package chapter process protection c policy instead funnel group access setuid program enforces policy database programmer commonly use similar technique granting user permission directly access table grant user permission run stored procedure access specialized view table showed microsoft window acls graphical user interface good opportunity point importance user interface design security protection doe enhance security virtue able correctly enforce security policy instead enhances security actually used correctly enforce policy general sophisticated mechanism lower chance user actually gure use correctly make mistake result overly restrictive protection notice complain make mistake result restrictive permission likely complain user interface design help user manage complexity reduce chance error microsoft way providing simpli ed interface common grouping permission individual underlying permission visible request uniform rule deny permission precedence allow permission likely result accidental underprotection rule processing allow deny permission speci ed order description meaning rwxpermission bit directory nored important issue discus le naming chapter single le multiple lenames listed multiple ries saying xpermission bit directory control access le directory oversimpli cation directory permission control name directory used access le case accessible name directory unless know le way restrict access permission bit ancestor directory xbit discussing virtual machine monitor remarked vmm process running separate virtual machine isolated face security breach virtual machine operating system sound surface like example defense depth general security principle providing multiple independent guard breached prevent security failure view entirely correct vmm plete power virtual machine vmm security breached security protection security operating system irrelevant isolating process vmm operating system necessarily result better protection operating attacker need subvert vmm course vmm secure operating simpler enhanced security come substitution better protection mechanism cumulative contribution additional protection mechanism exercise consider fork typically used today uniprocessor make sense schedule child process run ately fork continue run parent process explain sure cow account described access matrix containing access permission vidual process user way posix process access permission di erent user di erence dac mac example circumstance prefer dac explain example circumstance prefer mac explain explain relationship access matrix acls explain relationship handle handle table capability like microsoft window compare capability addressable capability powerful application programmer simpler operating designer justify answer suppose process computer occupy total gb virtual memory half occupied addressable capability suppose capability represented random string bit subject constraint capability equal probability randomly generated string bit equal capability chapter process protection microsoft window suppose user group bigandsmall property user belong small belong big suppose user jdoe belongs small big know user belong group explain le acl set allow read access user member bigbut small b explain le acl modi ed using nary user interface additionally allow jdoe read access changing user access right c explain alternative rule used window kernel combining allow deny permission make goal stated previous possible d make argument alternative superior used microsoft window interface e make argument permission combining rule microsoft window interface superior alternative kernel f argument nd persuasive combining permission multiple applicable acl entry desirable use combining operation associative tative combining operation speci ed table ure page associative commutative b operation changed combined yield deny operation longer associative c alternative combining rule used window kernel associative commutative explain think creatively come scenario able owner posix directory grant rpermission directory xpermission posix le directory owned user group permission x owner group xfor member group user security protection user s read le b user s write le c user s execute le d le executed user possibility e ective user id e determines possible user id used f following true user list content directory ii user use directory pathname access le subject le permission iii user list content directory iv user use directory pathname access le subject le permission user list content directory vi user use directory pathname access le subject le permission function sticky bit directory posix exercise prove theorem relied jvm veri er let sbe set security property let v e directed graph vertex vand graph represents program vertex point program edge possible control ows let distinguished element ofv start vertex edge u v ine say uis predecessor v setpred v consists predecessor edge u v letfuvbe monotone function fuvis function fuv b possibly cyclic path directed graph start vertex ne security property hold path h ne security property guaranteed vertex vto beg v wheregis function satis e following equation g g v v fpv g p chapter process protection use induction length path prove thatg vn path leading tovn security property guaranteed vnhold b figure page show trap vmm used simulate trap operating running virtual machine accompanying text describes situation trap handler operating nishes executes instruction control transferred application program mode change real simulated occur copy figure page use ve di erent color shade box operating system vmm hardware trace vertical line segment color corresponding component creates boundary programming project write test variant forker program figure page code possible shared parent child process variant produce output original forker program write variant forker program figure page parent child process dissimilar given program learn know able read line text break word modify microshell figure page accept command use execvp pas word command line ments modify microshell previous project word command word passed command line argument instead program skip waitpid try using modi ed microshell run command ground subsequently terminates run pscommand microshell zombie terminated process microshell did wait security protection problem running background process nate accumulate zombie exit microshell zombie reaped special process called theinit process reaps orphaned zombie way avoid accumulation zombie microshell execute following code reading command line waitpid wnohang time loop code child process wo actually wait reap process wnohang option mean rst argument speci c process id number indicate child process loop keep repeating long nd zombie reap behavior forker program figure page tell parent child process get copy theloopcount variable copy equal virtual address di erent virtual address testing help determine using single address space multiple address space modify program process print loopcount address loopcount conclude result observe exploration project figure contains simple c program loop time time calling fork afterward sleep s second compile run program sleep use pscommand second terminal window listing process process shown running program explain drawing tree process box process line connecting rst parent linux unix read documentation command use search setuid setgid program case possible determine program need setuid chapter process protection include int main int argc char argv int loop time fork time calling fork sleep sleep second figure c program loop time time fork end sleep second time run thepscommand copy process running setgid case try determine le owned user group owns le related one browse web case buggy setuid program tuted security vulnerability write summary case nd look particular recurrent theme occasionally adversary gain control ftp web server widely used software distributed explain particular source concern term security issue discussed chapter read cert advisory nd web example countermeasure suggested advisory doe help mitigate sort problem linux unix use program ration project le executable writable user identify directory writable user nd opportunity installation trojan horse suppose carefully check source code program run make sure run version compiled source code check safe trojan horse think read security protection turing award lecture cited note end chapter write brief summary explaining thompson uenced thinking topic research feature included mac o x used chromium browser run various operating system write paper compare perspective sandboxing including particular t chromium run mac o note idea process group thread sharing protection context date seminal paper dennis van horn terminology shifted decade early author used word today called thread today called process supplement brief introduction posix api process management way reading documentation posix standard web http tation speci c implementation linux easily available approach likely useful rst read book topic good choice stevens rago robbins robbins multics uential multiple address space process share individual memory segment named le name directory tree process used segment number addressing shared segment name segment protected using combination acls capability example daley dennis article later retrospective saltzer interesting feature multics way architecture use intermediate processor protection mode kernel user mode availability multiple protection mode join segmentation underutilized feature architecture case single address space system chase et al itanium mechanism described intel documentation good source information soltis book relevant source paper chapter process protection harrison ruzzo ullman use access matrix model theoretical result independent speci c protection system simistic mentioned text showed important problem undecidable decision problem satis e criterion problem pspace mean solvable using memory unlimited time second problem property algorithm exists solve algorithm exists problem pspace nition problem pspace lutions problem solution general consensus plausible possibility capability introduced dennis van horn limited context remain today mainstream system greater power addressable capability explored fabry linden variant idea incorporated various research system hydra cap known direct uence idea design ibm commercial system citation given previously described text posix descriptor essentially variant capability overall posix protection model loosely connected capability model interestingly edged capability model retro tted posix shown watson anderson laurie kennaway jvm veri er speci ed lindholm yellin vmware esx server vmm described article waldspurger doe wonderful job showing operating concept applied practical design problem good overview current direction vmm technology appeared special issue computer magazine said vmm simulates zseries machine strictly speaking vmm just component called cp short control program simulated architecture technically called zseries consists particular hardware implementation architecture analogous pentium family implementation ibm evolved root particular early version described meyer seawright use paging operation did allow paging security protection machine year later parmelee et al version did provide paging virtual machine evolution described seawright mackinnon creasy evolved today way devious form trojan horse explained son lecture gave receiving turing award chapter process protectionchapter file persistent storage introduction chapter study di erent kind service provided operating middleware di erent form persistence service provide retention data period time long include crash power failure similar disruption access service provide application program mean operate object identi ed attribute portion content principle kind service independent persistent object identi ed numeric address naming applied object persistence access service provided concert named le stored disk addressing single chapter kind object store data persistent object simple sequence byte complex c object representation retirement portfolio bene t management contemporary mainstream system common form persistent storage follows le array byte modi ed length read written numerically speci ed position torically word meaning nition dominant file storage normally provided operating system serve primary example chapter chapter file persistent storage relational database multiset row known tuples orrecords row provides ately typed value table column example table chapter title column hold character string number column hold integer ual row table contain title file persistent storage number database storage mally provided middleware operating object c object sort associated programming language example java object persistent persistent object normally supported middleware using previous type sistent storage unfortunately competing approach supporting persistent object java api doe single standardized approach discus persistent object access service variety form single directory unique name sort sophisticated search familiar web concentrate access option popular operating system middleware directory map name object subdirectory forming tree directory nested le folder variant object accessible multiple name directly multiple name refer object indirectly refers refers object ating system generally use hierarchical directory provide access le provide access object contain speci ed data example index table order used nd row order placed particular customer relational database middleware commonly us index provide access row file indexed fast searching design persistent storage mechanism uenced service provided underlying hardware technology year dominant technology magnetic disk drive ash memory playing rapidly increasing role disk drive likely remain important year come introduction section summarizes key performance characteristic disk drive summary serf background design decision explained remainder chapter section present external view persistence service looking le operation available posix operating system material practical value likely use le design serf motivate examination le design subsequent section understand requirement persistence service need meet make sense consider internal mechanism us moving underlying mechanism persistence section examine technique used allocate disk space metadata used package allocated space usable object simplicity section make reference le system technique used provide space database table fundamentally di erent le turn section primary mechanism locating data directory index initially explain mechanism used traditional context le directory database index point variation common theme providing access search key brief example mechanism merged provide le access leaving level view access service explain topic particular administrator application programmer way multiple name refer le moving internals present data structure commonly used store directory index access persistent storage need retain integrity face crash example storage space assigned le marked free use crashed just space allocated similar property needed directory index crash occurs le renamed le old new chapter covered use log provide durable atomic transaction seen primary mechanism used ensure integrity contemporary persistent storage system nonetheless devote section topic metadata integrity sketch alternative proaches problem operating system allow le system varying design mixed linux use disk partition store chapter file persistent storage speci c le partition hold le designed microsoft window mac o mixing le system provides valuable case study polymorphism use multiple tations common interface devote section topic finally attention security issue section ing usual selection exercise project bibliographic note disk storage technology disk drive store block data known sector typical sector size byte interface contemporary disk drive computer conceptually quite simple essentially just large array sector just like array sector consecutively numbered maximum depends capacity drive processor ask disk controller perform basic operation processor request controller write data ed address main memory ram speci ed sector number disk reason remainder section write request specify number consecutive sector transferred processor request controller read data ed sector number speci ed address main memory read request specify multiple consecutive sector ferred view disk drive large array sector writing correct software writing software performs disk access involve far mechanical movement access time vary substantially particular contemporary disk drive sustain data transfer rate measured ten megabyte second accessed optimally ten kilobyte second accessed randomly understand software need avoid performance penalty order magnitude help look inside black box internal structure disk drive figure disk drive contains stack platter mounted common spindle spinning xed rotational speed revolution minute data recorded surface platter read o using head recording playback head surface head supported arm pivot position head nearer disk storage technology platter spindle head head arm pivot head arm figure photo opened disk drive stack platter visible head arm extending platter area topmost layer head arm holding head surface platter similar layer stacked example layer head platter second platter photo copyright reprinted courtesy seagate technology chapter file persistent storage central spindle figure show relationship platter spindle head arm arm left xed position rotation disk cause circular region disk surface pas corresponding head circular region single disk surface known track track divided hundred sector collection track disk surface accessible particular position head arm called cylinder head active time depending head active position head arm single track worth sector read written order access data t single track option head switch change active head provides access track cylinder seek move arm position closer spindle order provide access cylinder happens head switch time modern drive quite similar time needed seek adjacent fraction distinction important henceforth talk seeking seek time larger track apart tionately reason duration automobile trip proportional distance just automobile need celerate beginning trip decelerate end trip painstakingly pull parking spot disk arm need celerate decelerate home exact position destination track net result seeking track ten thousand cylinder away millisecond time long seeking adjoining track seeking adjoining track take long ten kilobyte data transferred drive busy seeking speed ratio short long seek larger ratio total access time accessing sector involves just seeking sector track appropriate track spinning active head disk controller need wait appropriate sector come head position delay known rotational latency time disk take complete revolution comparable time taken seek ten thousand cylinder rotational latency bring total access time random sector adjoining track small factor access time sector distant track access underway additional sector read written high speed pas head assembly request disk storage technology multiple sector happens cross track boundary pay penalty seek time larger penalty rotational latency rst sector track positioned pass head just seek completes software access large number consecutive sector advantage doing single large request smaller request advantage reduced overhead interface tween computer disk di erence signi issuing separate request cost additional disk revolution ticularly writes missing timing sector mean waiting revolution come read problem cause disk drive contain ram known cache bu er hold data passed active head accessed waiting come disk use cache bu er writes software designed tolerate loss recently written data crash secret attaining disk drive potential locality locality locality sector similar identifying number cently accessed generally faster accessing sector greatly di erent number consecutive sector generally faster accessing sector small di erences sector number consecutive sector large request faster accessing smaller request performance issue related locality mind considering topic disk space allocated performance issue directly related locality brie y mention seeing uences software design interesting level book software wait disk drive complete request issuing request di erent thread disk drive capable queuing multiple request handling whichever order best utilizes mechanical component example access track queued disk drive perform order sector happen pas head chapter focus system employ single disk drive sake simplicity using multiple drive divide chapter file persistent storage replicate data raise interesting s reliability performance note section end chapter suggests reading want explore area posix file api system including linux mac o x support complicated set procedure operating le evolved decade eventually posix standard everyday purpose programmer ignore api instead using cleaner apis built included java standard nonetheless introduce posix api important system form interface operating kernel software running level application process encapsulated library file descriptor file referred di erent way pathnames integer le descriptor pathname le optionally ing sequence directory used reach le descriptor hand provides information le location just featureless integer operation require le descriptor particular read data le write data le requires le descriptor process happens inherited le descriptor forked parent happens received le descriptor message process read write le knowing process use open procedure obtain le descriptor named le process le descriptor close process terminates operating automatically close remaining open le descriptor file descriptor refer open le source destination input output keyboard display screen procedure work regular le work equally hardware device network communication port forth ag place distinction matter primary focus regular le persistent posix file api convention process inherit le descriptor parent le descriptor known standard input dard output standard error output numbered tively remembering number use symbolic name ned run program shell make special ments standard input generally keyboard standard output error output directed shell window display screen redirect standard input output le using shell notation example shell command p l run psprogram loption generate list process saw chapter displaying list screen command put list le called psprogram doe need know change writes output standard output case shell need di erent closing preexisting standard output opening le place executing psprogram p program error message report output standard error output remains connected display screen way error message hidden le figure contains program illustrating shell operate preceding example child process closing inherited dard output opening executing p complicated procedure open rst argument le open character string doe contain slash character le process current directory process current working directory changed using chdir procedure contained slash operating traverse directory nd le open particular start current directory look subdirectory alpha look alpha forbeta nally look beta le gamma start slash search le begin looking root directory etcand directory passwd section discus le naming including related aspect posix api le given additional chapter file persistent storage include include include iostream include include include using namespace std int main returnedvalue fork returnedvalue perror error forking return returnedvalue close perror error closing standard output return error open return smallest file descriptor use process having closed open reuse number open perror error opening return execlp p p l null p option letter l perror error executing p return waitpid returnedvalue perror error waiting child return cout note parent old standard output endl figure program illustrates shell run command p l forking child process close inherited standard output place open executing posix file api second argument open speci e particular way le opened indicates le opened writing opposed indicates le created doe exist ing error indicates le truncated zero length writing old data thrown option speci ed argument open needed speci e access permission given le created case access permission read write owning user rw setting aside open close operation le involve reading writing content le operate metadata attribute describing access permission time modi cation owner variety procedure chmod utime chown allow attribute set wo illustrate procedure allows attribute le retrieved program figure us fstat procedure retrieve information standard input report just attribute larger package information printing owner modi cation time stamp program check standard input regular le shell told redirect standard input using case doe program print le size concept size doe make sense stream input coming keyboard example program compiled le called fstater shell command information le verify using command l moving actually reading writing content le level posix api provides di erent choice outlined explicit position sequential memory mapped mmap external pread read le portion thereof mapped process address space using mmap procedure allowing normal memory load store reading writing alternatively le left outside address space individual portion explicitly read written using chapter file persistent storage include include include include include iostream using namespace std int main struct stat info fstat info perror error getting info standard input return cout standard input owned user number endl cout modified ctime cout file endl cout regular file endl return figure program describes standard input using information retrieved using fstat information includes owner modi cation time standard input regular le case size le posix file api copy le memory memory le sion procedure pread andpwrite need told position le read write version read andwrite operates sequentially operation implicitly using portion le immediately preceding operation discus bilities brie y virtue mmap simplest procedure start mapping file virtual memory use mmap illustrated program figure copy content le program expects given name input output le argv andargv respectively us open procedure translate integer le descriptor using fstat figure nd size input le size play role program make output le size using ftruncate despite ftruncate doe necessarily make le shorter set le size truncating padding extra byte value zero use input le size call mmap map input output le virtual memory protection respectively returned value virtual address le start process address space use input le size tell library procedure memcpy byte copy memcpy procedure loop executes load store instruction copy place virtual memory loop written explicitly clear likely library routine carefully tuned speed course explained argument mmap detail intent provide comprehensive documentation api procedure provide complete tutorial instead example feel le using mmap le opened mapped virtual address space accessed memory example using memcpy underlying idea virtual le access using mmap le array byte just like region virtual address space le access treated virtual memory access style le consider accepts half argument le array byte chapter file persistent storage include include include include include include include iostream using namespace std int main int argc char argv argc cerr usage argv infile outfile endl return int open argv perror argv return struct stat info fstat info perror error stating input file return void mmap perror error mapping input file return figure rst portion program using virtual memory mapping copy le program continued posix file api int open argv perror argv return ftruncate perror error setting output file size return void mmap perror error mapping output file return memcpy return figure second portion program using virtual memory mapping copy le program continued previous chapter file persistent storage reject half treated memory section style largely reject rst premise reading writing file speci ed position convenient accessing le virtual memory advantage particular writing le using mmap raise problem process easy way control time update persistent speci cally simple way process ensure data structure written persistent storage consistent state middle series related update process write le read permission write permission page fault implicitly read le page fault occur course writing data le portion virtual memory le range address presumes know big le suited situation know advance data written reason programmer prefer leave le separate virtual memory address space use procedure posix api explicitly copy data le memory memory le pread andpwrite procedure argument le descriptor virtual address memory number byte copy position le procedure copy byte starting speci ed position le speci ed address pread le memory pwrite memory le procedure somewhat tricky use correctly copy fewer byte requested signal error condition away retrying operation need carefully designed loop reason devote space example sequential reading writing mmap pread pair rely ability access arbitrary position le treat le array byte interface work source input posix file api output keyboard network connection instead need use sequential style read write operation take place speci ed position left o sequential quite convenient purpose used le example suppose following command shell l p information open le named information writing standard output run program succession lsto list le rent directory psto list process net result information contains listing pscommand doe need special step direct output position le mediately lsstopped instead using sequential feature posix api process naturally wind writing byte output position previously written byte previous byte written process process perform sequential using read andwrite dures identical pread pwrite argument specifying position le instead plicitly directed read write current le o set update le o set le o set position reading writing maintained operating special le keyboard input sequential input intrinsic needing explicit le o set regular le persistent storage le o set numeric position le kind pread andpwrite argument operating keep track scene le opened operating creates open le description structure includes le o set normally initialized le descriptor descended open share open le description example previous example lsandpswriting information le process le descriptor referring open le description share le o set process independently call open le separate le o set process implicitly increase le o set doe read write length zero explicitly change le o set using lseek procedure lseek procedure set le o set le regular le process chapter file persistent storage combination lseek andread orwrite simulate pread orpwrite simulation prone race multiple thread process share open le description unless use synchronization mechanism mutex normally lseek used infrequently sequential access dominating example process read le sequentially using read use lseek set beginning read second time conceptual model based tape drive ordinary read writes progress sequentially tape rewinding skipping forward possible read andwrite procedure share pread pwrite necessity looping byte transferred easier use facility ned standard library higher level programming language java scene library using read andwrite doing looping detail disk space allocation le analogous virtual memory us level indirection map object storage location virtual memory mapping virtual address address space physical address memory le mapping position le location persistent storage mapping coarse granularity kilobyte time virtual memory page mapped page frame le block le mapped storage block block typically kilobyte size spanning multiple sector discussing virtual memory remarked operating free assign unused page frame physical memory hold page virtual memory allocation policy correct cause cache memory perform better persistent storage face similar allocation problem mance issue considerably pronounced persistent storage hardware disk drive assume section le freedom store data unused disk block choice make determine access le translate access disk seen pattern disk access make huge performance di erence order magnitude disk space allocation allocation policy closely examined placement policy chapter allocation policy embodiment allocation mechanism look key objective allocation imizing wasted space time section goal expressed minimizing fragmentation maximizing locality fragmentation word fragmentation used di erent sens consider nition notbe using author fragmentation refers degree le stored multiple noncontiguous region disk le stored single contiguous sequence disk block called extent fragmented nition le stored separate extent slightly fragmented le block individually scattered disk le maximally fragmented nition defragmentation program move le block disk leave le single extent allow future allocation defragmentation program arranges le free space disk clustered contiguity sequentiality issue mentioned preceding graph important speed access discus section broader heading locality refer fragmentation use nition established operating system eld alternative nition fragmentation concern space highly fragmented disk large proportion storage capacity unavailable allocation le explain remainder subsection phenomenon cause space unusable source waste space allocated integer multiple le block size example le allocate space unit kb le big t single unit allocated kb single byte larger kb unused space le block called internal fragmentation internal fragmentation depends desired le size le block size analogy consider parallel parking area individual parking space marked painted line driver actually respect line wasted space depends car parked depends chapter file persistent storage apart line painted larger parking space generally result wasted space le block size multiple underlying disk drive sector size le subdivides space single disk sector generally le block span consecutive disk sector example disk sector byte grouped le block larger le block cause internal fragmentation advantageous perspective particular larger block size tends reduce external fragmentation additionally larger block size implies fewer block track reduces bookkeeping overhead space allocation request rounded multiple block size operating locate appropriate number unused block order read write le quickly possible block single consecutive extent moment consider absolute requirement later consider relaxing continuing earlier example suppose need space le just byte larger kb rounded block new requirement contiguity mean looking disk consecutive block free luck maybe disk half half consists le block one available use situation lot space available grouped place isexternal fragmentation long insist contiguous allocation external fragmentation cause wasted space block free use scattered usable surface appears external fragmentation result strange circumstance example second le block occupied certainly t description start implies allocated lot small le suddenly want allocate larger le second implies really dumb choosing small le went skipping block phenomenally bad luck user choice le delete external fragmentation occur plausible circumstance particular wind small gap space available allocation larger amount space previous allocation leaving silly gap disk space allocation small scenario illustrates phenomenon consider disk room le block suppose start allocating le point space allocation look follows suppose deleted resulting gap block free end disk point le created block gap leaving block unused unused block way satisfy allocation request unused block broken block le block end disk notice wound gap le created later deleted stupid allocation le replaced le resulting gap di erence le size mean disk used exclusively storing large le wind small gap hold large le fundamental problem external fragmentation returning parallel parking analogy consider area parking space marked pavement leaving driver allocate space courteous leave pointless gap small gap arise car varying size come large car vacate space taken smaller car result gap equal di erence car size small smallest car use situation happens repeatedly di erent spot block total wasted space accommodate car chapter file persistent storage earlier mentioned increasing le block size crease internal fragmentation decrease external fragmentation son larger block size variability space allocated file di erent size rounded kilobyte say kb kb size rounded multiple kb case kb kb reduced variability reduces external fragmentation extreme case external fragmentation occurs le allocated space suppose relax requirement le allocated single extent disk using le metadata possible store di erent block le di erent location virtual memory address space scattered physical memory doe mean external fragmentation nonissue performance reason want allocate le contiguously possible external fragmentation simply change issue free space used issue free space used le access slower get topic locality locality recall disk provide fastest performance asked access large number consecutive sector single request location nearby previous access request le designer interpreted condition fast access implying following locality guideline space allocation space allocated le broken extent possible le need allocated extent extent nearby previous file commonly used close succession concurrently placed near connection fast access guideline based implicit assumption computer workload largely sists accessing le time reading writing le entirety beginning end case reasonable imation truth preceding locality guideline result disk space allocation good performance important remember guideline incorporate assumption workload disk mance characteristic workload di erent allocation strategy appropriate particular computing workload consolidated smaller number computer using technique virtualization discussed section le access jumbled example di erent allocation strategy make sense rosenblum ousterhout suggested block allocated space disk order written regard le belong position occupy le issuing large number consecutive writes disk single operation allows performance writing application software concurrently writing multiple le doing random position le write operation issued disk optimal unlike conventional le layout course read access performed order writes fortunately workload perform read order writes workload need read access particular read access critical workload read disk block repeatedly block read problem read repeatedly need su er cost disk access time kept ram returning mainstream strategy listed beginning subsection primary open question identify le likely accessed contemporaneously place nearby disk approach used unix le system assume le commonly accessed conjunction parent directory sibling le directory approach base le placement assumption observed behavior assumption remains future behavior like past behavior example microsoft introduced feature window xp version observes order le access boot time application startup time reorganizes disk space allocation based observed access order mac o x doe similar version measure le heavily used group chapter file persistent storage allocation policy mechanism having seen consideration uencing disk space allocation tation locality better position appreciate speci c allocation mechanism used particular le policy choice embodied mechanism range alternative di erent le system broad consider sketch representative option le way keeping track disk block use free allocated common representation information bitmap array bit disk block bitiindicating block ii use bitmap easy look space particular region disk slow search entire large disk desired size extent free space unix linux le system use slight variant bitmap approach linux le serve example overall disk space divided chunk known block group disk block block group encompass mb block group bitmap indicating block group free exercise example given block group bitmap t single block summary information le indicates free space block group speci c location free space block group allocation step rst nd suitable block group using summary information nd suitable collection block block group using bitmap remarked earlier unix linux le system generally try allocate le near parent directory particular regular le placed block group parent directory provided space group rule followed subdirectory result attempt cram entire le block group le system use alternative rule choose block group subdirectory creating subdirectory early version similar le system selected block group containing lot free space spread directory corresponding le relatively evenly disk new directory went block group lot free space good chance le contained rectory t block group traversing directory tree long time allocation policy disk space allocation directory near parent directory recent version similar le system used di erent allocation policy directory developed orlov subdirectory allocated parent directory block group provided doe crowded failing allocation policy look subsequent block group crowded preserve locality entire directory tree block group directory corresponding le wo result signi performance improvement workload traverse directory tree le decides locate le particular block group need allocate extent disk block hold le data hopefully extent lie chosen block group need way large le escape ne single block group biggest challenge allocating extent knowing big extent allocate older le system required application programmer specify le size time le created allocate extent corresponding size modern system work way instead le grows automatically accommodate data written meet challenge modern operating system use technique known asdelayed allocation background need understand ing system normally write data disk moment application program issue write request instead data stored ram written disk later delay writing yield option disk space allocated data go ram later get written disk delayed allocation operating need choose disk block hold data time go ram tag data ram disk block data belongs later writes data speci ed location disk approach simple requires operating allocate space rst block data soon generated clue block follow delayed allocation put o choice disk block time actually writing disk data stored ram tagged le written position le operating doe need guess data program going write time generates rst block instead wait chapter file persistent storage data get written allocate extent size operating know desired extent size need search data structure record available space bitmap individual block group option tracking free space xfs le particularly designed large le system take alternative approach us balanced search tree known track free extent disk space store free extent indexed location index size way xfs quickly locate free space near speci ed location disk quickly locate desired space technically tree used xfs slight variant known data structure section free extent indexed size xfs allocator naturally use t policy nd smallest free extent bigger desired size t exact extra space broken o left smaller free extent bitmap hand natural allocation policy t policy nding rst free extent large policy merit compare exercise metadata seen le analogous virtual memory allocation policy select concrete storage location chunk data continuing analogy explain metadata serf analog page table recall separate address space process page table storing information regarding page frame hold process page page forth similarly le metadata storing information regarding disk block hold le block block forth page table choice data structure holding mapping information discus alternative structure section metadata data data information regarding disk data stored important kind metadata brie y enumerate kind section revisit access control topic considered perspective chapter section question access control information enforced access attempt stored le second metadata look section minor miscellaneous kind metadata data location access control access date time author include le name kind metadata make sense le system le exactly modern le system t description le name multiple name better o thinking property le route lead le similarly persistence service data accessed multiple route database index include naming section metadata instead including section directory indexing data location metadata simplest representation data location metadata array disk block number element iof array specifying disk block hold block iof le analogous linear page table traditional unix le system including linux use approach small le le array disk block number stored le metadata structure known inode short index node larger le le system inodes compact using indirect block roughly analogous multilevel page table discus traditional form inodes indirect block discus native used modern le system extent map avoid storing information individual block provide access large extent map inodes indirect block unix rst developed early vative feature le design design served model commonly used unix linux le system present day including linux metadata system stored data structure better called expedient elegant structure small le allows le grow large manipulated simple code le represented compact chunk data called inode inode contains le metadata le small initial portion metadata le large allowing large le metadata indirect block inodes kept small chapter file persistent storage size le contains array inodes stored disk block set aside purpose multiple inodes block inode identi ed position array inode number inumbers fundamental identi er le le essentially le identi ed le le forth indicate le inodes position forth later section le name mapped inode number inode provides metadata le metadata includes disk block number holding le data access mission metadata category metadata shown figure simpli ed diagram inode directly contains ping information specifying disk block contains block le like linear page table recall inodes small xed size le grow block long resolve ict inode directly contains mapping information rst dozen block exact number varies le system consistent le realistic inode picture shown figure disk block indirectly accessed emphasize aspect inode design block le mapped exact way directly inode regardless block small le rst block large le mean large le peculiar asymmetry block accessible advantage le grows transition small le large early block mapping information remains unchanged le small inodes kept small fraction le block disk block number le block disk block number le block disk block number access permission metadata figure initial approximation inode show principle egories metadata diagram unrealistic list disk block number unlimited actual inodes limited metadata le block disk block number le block disk block number indirect access le block end le access permission metadata figure inode block number end le indirectly referenced block size inodes block overhead le percent le large ow inode stingy allocating space metadata need metadata space doe allocate second inode allocates additional disk block indirect block provides room block number shown figure exact number additional block number depends big block block number block block number indirect block hold k block number block number shown gure kind indirect block speci cally called single indirect block add single layer indirection inode point point data block example block single indirect block allows accommodate le slightly mb size handle le use multilevel tree scheme analogous multilevel page table inode indirect block le block disk block number le block disk block number le block disk block number le block disk block number indirect block block number access permission metadata figure inode used single indirect block block number stored shown note indirect block actually considerably larger inode contrary appearance chapter file persistent storage inode contain block number double indirect block contains block number single indirect block contains data block number figure show enhancement inode design retains dozen direct block original single indirect block adding double indirect block double indirect block point indirect block point data block le grow quite large exercise gure just large unix le system step allowing inode point triple indirect block shown figure comparing multilevel page table illuminating unbalanced tree used allows small shallow tree grow large deeper tree straightforward way later grow somewhat straightforwardly imbalanced having presented method mapping le block disk block shortly turn alternative avoids storing information block basis worth drawing analogy page table just page table need provide page frame number page page memory inode indirect block need provide disk block number block le entry left blank typically using reserved value mistaken legal disk block number valuable sparse le known le hole sparse le large portion containing zero usually portion written allocating disk block le block le avoid wasting space time extent map seen traditional inodes indirect block based notion block map array specifying disk block number le block block map completely general le block mapped disk block file block ncan mapped totally di erent disk le block recall le designer prefer make use generality performance reason consecutive le block normally allocated consecutive disk block forming long extent provides key data structure storing mapping information suppose le block long occupies disk block block map contain metadata inode single indirect block le block disk block number le block disk block number le block disk block number le block disk block number single indirect block number double indirect block number access permission metadata double indirect block indirect block indirect block block number le block disk block number indirect block block number le block disk block number indirect block similar indirect block figure inode used single double indirect block block number stored shown inode data block single indirect double indirect triple indirect data block indirect block ton data blocksmany double indirect block ton indirect block astronomically data block figure structure le start inode ues tree single double triple indirect block eventually reaching data chapter file persistent storage disk block number extent map hand contain entry le extent just opening sentence paragraph contains range block number entry extent map need contain information extent alternative entry contain extent length starting disk block number example extent map entry say le contains block starting disk block block starting disk block entry contain extent length starting le block ber starting disk block number example extent map entry rst entry describes extent block starting position le occupying disk block starting number second entry describes extent block starting position le occupying disk block starting number rst approach compact second approach advantage extent map entry understood isolation needing read preceding extent map entry particularly useful extent map stored discus subsequently simplicity assume second approach remainder discussion system use rst obvious extent map big improvement typical block map use block number refer block percent space overhead surely ordable today cheap disk storage reason le designer try reduce small overhead ignore possibility extent map take space block map happen le scattered lot tiny extent key fact disk space turn time precious commodity indirect block result extra disk operation consider example reading le stored single extent block map approach le need disk read operation read single indirect block read data block assumes inode cached memory having read inodes disk block le smart read data block metadata operation extent map entire mapping information t inode assume inode cached single read operation read le like twice fast admittedly somewhat arti cial example realistic workload signi speedup possible modern le system use extent map including microsoft dows ntfs mac o x hf plus xfs ported linux sgi irix version unix le handful tent far common case store sequence extent map entry inode window mac o x ing structure analog inodes ntfs large kb directly store entire extent map le extent le system use smaller inodes structure provide interesting comparison technique handling situation extra space needed large extent map hf plus take approach quite reminiscent traditional unix ode rst extent map entry stored directly structure one just rst larger number additional entry stored single serf le subsequently xfs hand store extent map entry le c space inode root node tree tree contains extent tree small root tree leaf extent directly inode just hf plus extent map grows larger entry descendant node tree left inode unlike hf plus special treatment rst data structure balanced search tree structure generally gured large node forming shallow bushy tree property make suited disk storage transferring large block data large node performing succession operation slow shallow tree encountered tree case summary review exception description speci c application structure used associate search key corresponding value like dictionary associate word nitions phone book chapter file persistent storage name phone number key textual string organized alphabetic order example number organized increasing value required way determine relative order key allows entry located key inserted deleted far said hash table structure used hashed page table balanced search tree distinguish provide cient operation based ordering key just equality key example asks look phone book reply smit entry skip right smirno smith hash table ability search neighbor key need present tree crucial used extent map want information extent containing le block extent map entry explicitly mentioning instead entry specifying extent starting le block entry largest key equal play di erent role persistence system tion use directory le name index database content data access service rent section play role mapping position le location disk earlier section saw related use management free space allocation data structure fundamental case choose introduce cause extent map like simplest application free space mapping complicated dual indexing size location directory complicated use textual string key probably familiar binary search tree tree node contains root key pointer subtrees key smaller root key key larger root key convention adopted subtree contains key equal root key node similar using single root key make distinction use nroot key make way distinction root node contains nkeys ascending order pointer subtrees shown figure rst subtree contains key smaller rst root key subtree contains key rst second root key forth subtree contains key larger root key disk block used hold node metadata keyn figure node contains nkeys pointer subtrees subtree contains key particular range ofncan quite large resulting broad shallow tree fact disk block half root key subtree pointer provide substantial branching factor observation provides inspiration mechanism used maintain entry inserted node allowed half totally exibility mean easily insert node long hard case handled splitting node special exception root node required half exception allows build tree number entry add level height tree consider example inserting entry node insertion key room node replaced node containing smallest key largest key node accounted nof key median key left insert median key parent node serve divider node shown figure insert median key parent node parent node split parent splitting process continue tree tree shallow wo long node split parent root tree gain new parent holding just median key way tree grows height level bayer mccreight paper introducing suggested node contain pair pointer subtrees practical application today instead use variant called chapter file persistent storage nodeparent parent nodesbefore inserting inserting figure inserting illustrated cause node split median key moving parent tree nonleaf node contain just key pointer subtrees key having associated value key node used solely navigation subtree leaf contain pair actual content data structure example small extent map entry organized shown figure sort store extent map single le xfs mac o x hf plus slightly di erent approach needed le extent map combined single recall rst extent le included tree entry le describes extent map entry position le entry contains le number analogous inode number starting block number le length block starting disk block number concatenation le number starting le block number serf key way entry particular le appear consecutively tree order position le insertion algorithm slight variant pure work di erences exercise access control metadata complexity data structure storing access control information directly related sophistication protection recall posix speci cation followed unix linux provides access control list acls permission le owner owning group information stored compactly le inode microsoft window hand allows general acls designer ntfs faced metadata file block length starting disk figure small extent map contains information used nd extent range le block number range disk block number tree extent described leaf nonleaf node containing just navigational information challenge fact revisited design decision access control inode contain bers identifying le owning user identifying le owning group containing bit representing rwxpermissions owning user owning group user number containing permission bit called le mode waste bit mode used encode additional information le regular le directory device forth figure show permission termined extracting inode mode using stat di er slightly fstat saw earlier le speci ed numerical le descriptor compile program resulting executable stater command like somefile produce information l somefile early version ntfs stored acl le independently acl small t structure stored stored extent disk block just like le data structure contained extent map acl window microsoft redesigned ntfs advantage fact le identical acls content acls stored centralized database le identical acls share underlying representation chapter file persistent storage include include include include include iostream using namespace std static void int test char toprint test cout toprint cout int main int argc char argv argc cerr usage argv filename endl return struct stat info stat argv info perror argv return r w x r w x r w x cout endl return figure program us stat retrieve cess control metadata whichever le speci ed argument argv directory indexing metadata le length just multiple block size inode equivalent contains le size byte program figure page showed retrieve information metadata example posix speci e le time stamp recording le accessed written modi ed way modi cation includes writing data making change permission metadata attribute ntfs record le hidden ordinary directory listing hf plus metadata attribute supporting graphical user interface example le record icon position metadata attribute posix system connects le linking use multiple name le topic tion le inode contains count name refer le count reach zero le use process operating deletes le operation user normally think deleting le actually just remove underlying le deleted consequence directory indexing having seen le system provide storage le ready consider system allow le located similar question regarding database system consider system provide indexed lookup section set stage discussion presenting common framework le directory database index showing way di er section separation le directory database index currently weakening introduction indexing mechanism locating le having shown basic principle directory index use section dig particular aspect le directory way multiple name refer single le finally section scene look typical data structure used directory index file directory versus database index traditionally le system include directory provide access le database hand include index chapter file persistent storage access entry database based portion content clean distinction le system database currently blurring alternative technique based index available particular apple introduced feature mac o x version spotlight spotlight section microsoft quently included related feature window vista trend make important directory index common distinguishes directory index provide mapping key object key directory name external object named change content le changing change changing content contrast key index attribute indexed object intrinsic object example index database table chapter allow direct access row title file persistent storage number row updated change chapter title number index need updated cordingly similarly update index context corresponding change indexed row make sense say want look row chapter number nd real chapter number directory identi e single le le di erent directory directory database index hand unique attribute unique example useful index table user account unique login unique index used nd single record information user log jdoe index used nd record information user doe index use combination multiple attribute key example versity course catalog unique index keyed combination department course number nal distinction le directory database index fundamental kind object provide access traditionally directory provide access entire le analog table relational database index hand provide access entire table individual row table distinction misleading reason system typically serf directory indexing table row describes table index row really index table access row used provide access database table mentioned earlier operating developer incorporating index order provide access le topic section using index locate file described le traditionally accessed using ries considerable recently using index help user locate le content attribute suppose remember le containing book disaster leaving aside possibility world better o book search le numerous way example le computer hundred page mac o x using index le page count attribute simply ask le greater page shown ve le meeting restriction easy recognize seeking search feature mac o x called spotlight integral component le way directory lenames instead indexing search provided process external operating considered form dleware le support indexing generic ability notify process event creation deletion le change le content event sent process subscribes used purpose keeping display le icon date spotlight feature us determine le need reindexing save new version book le noti e spotlight le changed allowing spotlight update index based page count unlike le directory stored special data structure internal le index access based content attribute like page count stored normal le directory apple refers indexed attribute actual le tent metadata book example number page chapter file persistent storage ment piece metadata usage word di erent traditional use le system le xed collection le metadata attribute owner sion time modi cation contrast spotlight metadata attribute far numerous list attribute speci c individual type le example le ing book attribute specifying page count le containing vacation photo attribute specifying exposure time second attribute make sense corresponding le make sense seen metadata attribute need indexing speci c individual type le common attribute need determined di erent way di erent type le example reading pdf le determine number page quite di erent reading microsoft word le determine number le stored totally di erent format indexing portion spotlight receives noti cation le indicating le changed indexed delegate actual indexing work specialist indexing program depends type le install new application program installation package include matching indexing program way able search le using relevant attribute apple having foresee di erent le type file linking indexed attribute page count generally unique tem document contrast seen directory name single le just pathname speci e single le doe mean converse true subsection explain di erent way le reachable multiple name straightforward way multiple name reach single le directory entry name speci e le figure show directory name referring le interpreting gure understand box labeled le doe denote just data contained le le metadata permission posix api situation arisen di erent way le created alpha procedure directory indexing file alpha betathe file figure directory contain name le link alpha beta added beta le created beta procedure link beta alpha added alpha matter original added play tical role afterward shown figure distinguished people talk added linkto le need understand le name link le distinguish added link procedure posix allows le name multiple directory long directory le previous illustration figure alpha andbeta current directory named le stead directory entry multiple directory pointing le example figure situation le directory structure getting tangled posix tems ordinarily allow directory exception directory contains special entry called extra link directory called extra link parent directory just link add le unlink remove example unlink eliminate route le figure removing beta entry directory alpha mentioned earlier removing implicitly removing le operating remove le longer name longer use process open le continue exist name demonstrate exploration project posix support alternative multiple name lead le refer rectly refer le second situation rst called symbolic link figure show example chapter file persistent storage file delta filename file file alpha beta gammaroot figure le di erent name directory example pathnames lead le speci ed symbolic link beta refers le beta doe symbolic link called soft link ordinary link called hard link important emphasize di erence gure directory map option pointer le represented inode number code look lenames dures open treat option di erently look alpha nd beta recursively look beta nd actual le symbolic link shown figure created executing symlink beta alpha symbolic link somewhat tricky form long chain dangling reference loop preceding example form longer chain adding gamma symbolic link alpha symbolic link beta code looking le need traverse chain end le end chain execute unlink beta dangling erence gamma symbolic link alpha file alpha betabeta file figure symbolic link allows le refer le indirectly way le directory indexing symbolic link beta exist worse having deleted beta reuse symbolic link alpha creating loop posix procedure look le return special error code eloop encounter situation addition returning eloop true loop procedure allowed return error code chain symbolic link longer ned maximum symbolic link exible hard link create bolic link refers directory create symbolic link refers le stored separate le example symbolic link main le stored local disk drive refers le stored auxiliary le network le server option possible hard link create symbolic link ordinary hard link shell using lncommand command run program invoke link procedure symlink procedure explore command result produce exploration project le system outside unix tradition store metadata le directly le directory entry separate structure inode tightly bind used reach le identity le e ect attribute le just mean accessing le system kind symbolic link used easy analog hard link lead interesting situation system need retro tted posix compliance example apple hf plus developed mac o based unix happened mac o underlying design sumes le exactly fuse directory metadata structure mac o x unix need support le multiple name created link name use unlinked accommodate apple put le situation special invisible directory random number name le provided special kind symbolic link completely invisible posix api procedure normally inspect symbolic link simply following chapter file persistent storage directory index data structure simplest data structure directory index unordered linear list pair used database index traditional approach directory le system remains use system day structure way nd directory entry linear search database unordered linear search available index searching underlying row database table small directory linear search perform quite reasonably fore administrator design directory tree tory remains small example home directory mandacome rst letter username way directory entry turn entry small fraction thousand user home directory shortly kind directory tree longer necessary modern le ern le similarly thousand user major course listed content second alternative structure hash table hash table ically indexed array pair software directly access entry number iwithout looking preceding entry trick know time entry contain particular key knowledge come using hash function key entry number long key collide assigned location looking particular entry maxinside directory operation independent table size necessary hash key numerical hash code use code directly access appropriate entry contains desired key max lookup complete contains key lookup complete report failure collision entry contains key looked start searching tive location searching kept rare ensuring table hash table occasionally used database index particular option postgresql mentioned section disadvantage relative supporting based access example way use hash table index nd row accounting table payment particular metadata integrity date hash index perform index postgresql documentation cite reason discourage use hash table occasionally used indexing le directory particular ffs le used bsd version unix support directory hashing extension feature build hash table memory large directory time accessed data structure remains unsorted linear list dominant structure database index temporary le system directory discussed structure section showed provide highly cess example used directory microsoft ntfs sgi xfs di erent form apple hf plus system index directory represented tree hf plus instead put directory entry big key tree formed concatenating identifying number parent directory particular child le subdirectory entry single directory appear consecutively tree metadata integrity crash data held volatile main memory ram lost particular data le intending write persistent storage temporarily bu ering ram performance reason lost di erent implication depending lost data user writing le le metadata user data noncritical recognized human damaged restored backup source user data critical explicitly ushed persistent storage control application program example relational database committing transaction need ensure log entry persistent storage use posix api fsync procedure force operating write log le persistent storage metadata operation crash cleanly lost entirety tolerated user erate situation crash middle metadata chapter file persistent storage result damage integrity metadata structure self structure organize storage block meaningful le storage content just big pile bit individual le check damage le system contain mechanism protect integrity metadata structure face sudden unplanned shutdown extreme hardware failure question machine room burn better o backup metadata integrity threatened single logical transformation metadata state implemented writing individual block persistent storage example extending le data block require metadata block written storage containing inode indirect block pointing new data block containing bitmap free block showing allocated block longer free crash update happened metadata inconsistent depending update written persistent storage lost block longer free le dangerously block use le claim having block use dangerous irreparable le got state consistency repair program x free block bitmap marking block free contrast situation progress point block allocated second le clean repair le appear equal right block based preceding example distinguish kind data integrity violation irreparable corruption noncritical reparable ruption critical reparable corruption irreparable corruption le using block avoided cost noncritical reparable corruption lost block repaired nient critical reparable corruption block use repaired return normal operation le designer chooses strategy maintaining metadata integrity basic strategy use main variant logical change metadata state accomplished writing single block persistent storage single block commit record log discussed section metadata block metadata integrity rolled reboot commit record written writing commit block creates real state change approach known journaling alternatively creates new metadata tures modifying existing one single block write state change pointing current data structure approach known shadow paging logical change metadata state accomplished writing multiple block persistent storage order update carefully controlled crash sistencies metadata reparable kind consistency repair program run crash restore data integrity detecting correcting violation metadata structure invariant property update order controlled performing metadata update synchronous write le actually writes updated metadata block persistent storage ately bu ering write ram later update order controlled bu ering updated metadata block ram later writing speci c notation regarding dependency ing block persistent storage write block depends block updated repeatedly written storage cyclic cies develop necessitating additional complication mechanism approach known using soft update strategy update ordering synchronous writes quite popular linux us approach example performance consideration removed approach favor unlikely return problem synchronous writes slow normal operation far fatally typical le system size grown consistency repair process necessary crash come unacceptably long synchronous writes expensive system kind use sparingly possible result inconsistency crash reparable critical kind need immediate repair consistency repair process completed returning crashed chapter file persistent storage contemporary le system switched journaling strategy example include linux microsoft window ntfs mac o x hf plus rebooting crash little work undo redo update accordance log faster take time proportional activity logged checkpoint time proportional le size shadow paging widely adopted journaling example wafl le used network appliance storage server zfs le developed sun microsystems btrfs le linux network appliance choice design tivated primarily additional functionality shadow paging provides storage block overwritten superseded new version wafl naturally support snapshot track prior version le content shadow paging widespread journaling hope shadow ing form ordered update synchronous writes soft update increase demand snapshot capacity storage device utilization storage causing shadow paging increasingly challenge journaling dominance soft update strategy generally ned bsd version unix main selling point provides painless upgrade path synchronous writes structure le remain identical share biggest problem synchronous write strategy need consistency repair take time proportional le size admittedly soft update somewhat ameliorate problem tency repair soft update enforce update ordering restriction cheaply synchronous writes le system using soft update ord tightly control inconsistency possible crash synchronous write system ensure inconsistency reparable soft update system ensure inconsistency noncritical variety safely reparable running consistency repair need completely hold eration soft update valiant attempt make best intrinsically awed strategy strategy widespread use contemporary design journaling discussed section important understanding di erent strategy compare polymorphism file implementation study strategy undoubtedly computer scientist note section end chapter suggests reading shadow paging soft update hybrid shadow paging journaling known le polymorphism file implementation studied modern programming language especially one encountered concept polymorphism ability multiple form object treated uniform manner typical example polymorphism graphical user interface object displayed screen support operation self mouse clicked di erent kind object di erent method responding common erations program iterate list graphical object uniformly invoking operation knowing kind respond contemporary operating system kernel interface le tems polymorphic common uniformly invokable interface operation hide diversity concrete implementation polymorphic interface called virtual le vfs vfs ne collection abstract datatypes represent concept tory entry le metadata open le datatype support collection operation example directory entry nd associated le metadata object using object access modify attribute ownership protection use le metadata object obtain open le object use perform read write operation interface operation work seamlessly di erent concrete le system le object happens belong le le write operation write data way le ntfs le writing happen ntfs way operating system typically written c programming language doe provide support programming vfs polymorphism need programmed itly example linux vfs open le represented pointer structure containing data le turn contains pointer structure le operation structure contains pointer procedure operation read chapter file persistent storage forth figure show invoking polymorphic operation le involves retrieving le particular collection le operation called retrieving pointer particular write eration contained collection invoking actually quite similar programming language work hood c mechanism visible procedure writes given count byte bu er particular position le underlies posix pwrite andwrite procedure described earlier security persistent storage considering security persistent storage critical clear model threat want defend concerned attacker access physical disk drive kept locked door drive taken service adversary vation resource use expensive equipment concerned authorized user misusing authorization concerned outsider concerned attacker motivation modify delete data motivation breach dentiality explained section unencrypted data written disk drive attacker physical access drive protection good lead option security scious encrypted data disk drive key struct file file const char buf count po ret ret write file buf count po return ret figure linux vfswrite procedure shown stripped detail us pointer look invoke speci c code handling write security persistent storage lead design cryptographic le system automatically encrypt decrypt data attacker getting drive use physical security locked door alarm system guard attacker away need coupled careful screening personnel authorized physical access especially involved system maintenance keeping security intact disk removed service raise issue selling used disk risky proposition le deleted overwritten file system generally delete le merely updating directory entry metadata make disk block previously constituted le free use data remains disk block block reused deletion provides little security knowledgeable adversary trace remains previous directory entry metadata adversary simply search disk block numerical order looking interesting data overwriting data far sure thing depending overwriting newly written data wind disk original really obscure ware unable completely control e ect disk drive transparently substitute block carefully peated overwriting software enlists cooperation disk drive controller e ective adversary possess sophisticated technical resource motivation acquire use sophisticated adversary able use magnetic force scanning tunneling microscopy repeatedly overwritten data recoverable best option discarding drive containing sensitive data straightforward physical destruction disk shredder operation awesome sight behold seen owe watch video available web having talked hard remove remnant data drive need switch gear talk reverse problem data easily altered erased magnetic storage hard squeaky clean compare traditional paper record nd authorized user make alteration detectable ordinary mean company alters accounting book fact book real book paper visible trace chapter file persistent storage hand authorized person company alters computerized record know specter authorized user tampering record open area auditability internal control addressed sively accounting literature recent corporate scandal focused considerable attention area including passage united state act mandate tighter control result implementing new requirement company demanding le system record entire version history le latest version lead interesting cal consideration note provide reference topic possibility legal change cause le designer reconsider relative merit shadow paging journaling authorized user cooking book adversary wish alter delete data visible form attack siders vandalism le deleted wholesale defaced new message appear example public website dalism raise important general point security security consists reducing risk successful attack mitigating damage successful attack organization ni dependence computing contingency plan clean attack vandal luckily contingency planning ective form security measure considerable sharing resource planning contingency example backup copy data kept physically protected writing serve expedite recovery vandalism security breach operational programming error natural disaster backup kept separate location exercise introduction chapter gave example database table including column typical row contain corresponding description example table choosing suppose posix api did use integer le descriptor required le passed security persistent storage dure mmap read orwrite discus advantage tages change given posix api us integer le descriptor clearly need theopen procedure close discus advantage disadvantage eliminating close api mentioned defragmentation program rearranges le free space disk contiguous consider analogy external fragmentation result smaller car taking spot opened larger one total free space block car place date car physical analog tion program action defragmenting parking exercise make harder people nd car problem arises le disk computer program exible people ing disk le able unambiguously locate le defragmentation program arrange word di erence directory index spotlight search feature mac o x nd le rapidly using index feature undesirable sequence performance based description chapter expect performance problem le us disk block block group bitmap block group t single block t allocation sound superior t actuality work better placing new allocation smallest able space t leaf larger space later best t exact t extremely close leftover space small useful demonstrate phenomenon creating example sequence extent allocation deallocations using unrealistically small disk t succeeds t point get stuck t ceeds t get chapter file persistent storage assume inode contains direct block number single double triple indirect block number assume block kb block number byte largest le needing use triple indirect block draw alternative picture figure page showing happen inserted instead showing happen inserted instead using figure page translate following le block bers disk block number insertion node capacity nalways behaves way node leaf node split key new node median key inserted parent node situation somewhat di erent insertion leaf node use variant rule work example starting figure page assume leaf node room record information describing extent nonleaf node room key associated pointer subtrees initially insert information extent starting le block respective starting disk block insertion make leaf node require splitting b insert extent starting le block starting disk block require splitting leaf node record information extent need remaining leaf node record rst node resulting split second unlike pure information removed leaf level relocated parent insert parent copy key starting le block number explained di erent way figure page arise starting alpha starting beta option previous book administrator accidentally deleted le admitted having security persistent storage backup month administrator longer work college immediately took drive service smart thing think did recover le containing book programming project modify program figure page simulate shell command tr read documentation fstat procedure modify program figure page print comprehensive information want incorporate code program figure page write program open le mode map entire le address space using mmap program search byte mapped region testing equal character soon xi program print success message exit entire le searched nding x program report failure time program le varying size anxat beginning xonly end seen l p information put listing le listing process information suppose executable program l p information result process listing information list le program accomplish write program write program used rename le using rename procedure program use link andunlink chapter file persistent storage exploration project section make quantitative claim typical temporary disk drive use current literature verify update value quantity following list cite source use general answer need order magnitude approximation sector size b sustained transfer rate optimal access pattern c sustained transfer rate random access d rotational speed e proportion head switch seek time f proportion seek time large small seek g data transferable time needed seek h proportion rotation time seek time large seek research write short paper persistent storage technology used magnetic disk did fall use historical example persistent storage technology originally expected displace magnetic disk failed summarize happened case example persistent storage technology magnetic disk currently use speci c niche make particularly suited niche broader tion area magnetic disk used performance characteristic di erent disk invalidate design decision presented chapter example experimental proposed storage technology suggested possible future replacement magnetic disk performance characteristic di erent disk invalidate design decision presented chapter unix linux le system generally place ordinary le near parent directory introduction new orlov allocator place subdirectory near parent directory security persistent storage important form locality modifying linux le scatter le directory disk measuring worse performance get used today provide result simpler understand journaling activity factor linux source le tains procedure near procedure nd code call order select block group new inode normal le use try place le block group parent tory depending option selection directory use new orlov allocator old tended spread directory widely di erence discussed section change code use inode subdirectory irrespective option setting build kernel modi ed code set boot normal kernel modi ed make sure di erence kernel implies built normal kernel repeatedly reboot kernel time timing test unpacking software distribution removing time conduct timing test record elapsed time user cpu time write report explain did hardware software context did carefully replicate result large performance di ence nd kernel di erence consistent trial explainable chance suming signi di erence extent slower version spending longer using cpu versus waiting disk reach conclusion extra time likely come procedure taking longer execute reduced locality disk access generate data showing performance impact mac o x hot le clustering feature report result summarize hot le clustering work sure chapter file persistent storage cite source follow closely linux mac o x read documentation debugfs orhfsdebug respectively use tool examine structure le linux system generally include debugfs mac o x need download hfsdebug web minimum report le disk block used store le extent disk block constitute densely packed extent disk measure density divide number disk block di erence highest lowest block number posix linux mac o x read mentation lnand using create situation figure page using shell command needing write custom program doe output l use rmto remove beta di erent content doe l afterward doe alpha old new content posix linux mac o x demonstrate program continuing make use open le name le removed remove name using rmin shell needing write program us unlink similarly program using le existing program cat ortail programming needed make sure program actually read writes le name removed just continuing use data memory read le previously nd easiest program concurrently making use le writing reading posix linux mac o x read mentation lnand using create situation figure page using shell command needing write custom program doe output l use rmto remove beta di erent content doe l afterward doe alpha old new content security persistent storage seen form link symbolic link hard link unix originally added later research history unix nd kind original unix based earlier multics o ered kind link research multics nd kind o ered unix original kind journaling le system need run consistency repair program crash normally consistency repair program available speculate useful explanation match article xfs cited note note chapter assumed use single disk disk array volume manager introduce layer interesting question popular form disk array raid survey chen et al interesting example using adaptive policy manage raid paper wilkes et al hp autoraid accessible tutorial disk technology performance anderson anderson dyke riedel article quantify performance bene t gained queuing multiple request disk controller allowing internal scheduler process request appropriate order information posix api http original unix api posix evolved did later unix sion matter article ritchie thompson paper sketch internal structure initial unix le tem speci c le system mentioned include ntfs hf plus xfs wafl internal external fragmentation distinguished article brandell conclusion reached paper quickly called question vocabulary introduced standard orlov heuristic allocate directory umented source code post email list forth multiple variant allocator included linux quite orlov proposed closest published version orlov work note posted website chapter file persistent storage http meantime site gone content available internet archive machine allocation idea classic work includes comparison t t allocation knuth mentioned analog inodes microsoft ntfs large contain entire extent map le rare case extent map doe t single record ntfs expands metadata multiple record unlike le system continues use linear extent map introduced bayer mccreight later survey comer explained variant historical le system worth studying tic tenex multics originated hierarchical tory tenex important innovation automatic versioning le versioning incorporated system unix ntfs included feature faded prominence recent upsurge concern auditability helped bring versioning fore interesting related paper include santry et al quinlan dorward soules et al regarding alternative journaling wafl paper cited previously provides good example shadow paging rodeh addressed interesting situation arises shadow paging combined important design ingredient modern le system btrfs linux le exempli e combination soft update presented ganger et al rosenblum ousterhout design le lf essentially amount paging scheme new version data metadata block occupy previously free location disk overwriting prior version lf commonality journaling le system written block constitute log gutmann provides information hard truly delete data networking introduction overarching theme book computation interact support operating system middleware chapter saw computation running di erent time interact using persistent storage chapter computation distributed space time sending message network networking topic merit course textbook goal overview review depending studied topic particularly highlight way ing tie division responsibility operating system middleware application software chapter go depth middleware commonly used support distributed application black box inimical education provide networking absolutely necessary development tributed system objective make network engineer capable monitoring congestion guring router start goal pursue goal overview networking hurt instead trying plain foundation underlie distributed system chapter spend lot time foundation time structure web distributed le system chapter move completely away networking se middleware commonly used build distributed system chapter networking network internet going clear meaning closely related term network internet internet start describing network internet common essential di erence understand general concept internet able ne internet speci c internet network collection link switch internet link communication channel wire optical bers radio channel switch device connect link forward data switch known speci c name example connect radio link wired link known access point connect constituent network internet known router discus subsequently network internet computer interfaced link shown figure interface identi ed address interfaced computer transmit data tagged destination dress normal circumstance data make way appropriate link switch arrive speci ed tion simpli cation ignore multicast single message delivered destination interface chunk data tagged address informally called packet later introduce variety speci c term datagram segment frame synonymous packet implies particular context single network opposed internet preceding tion essentially entire story data injected network tagged destination address information route leading address word misleading dress network convey information physical location computer network address packet data network address like envelope addressed college peter mn usa like addressed hailperin network need gure path link switch lead location switch need considerable responsibility switch network shoulder responsibility ering data keeping track interface known location switch simpler approach forwarding data way sure run destination interface introduction switch linklegend computeraddress address figure network internet contains link switch interfaced computer alternative path connect computer described text information needed determine picture single network interconnected group network internet forwarding comprehensive cause data ow cles approach scale network normally ned limited number interface workgroup company network scale small geographically number interface called local area network lan conversely wide area network wan tie interface far apart generally number just multiple network linked internet using router switch connect network shown figure order distinguish internet network need explain linking network doe just result single larger network distinguishing feature internet destination address data conveys internet address identifying destination network speci c computer interface network returning analogy packet data internet dress like envelope addressed hailperin gustavus adolphus college people world analogous router gure forward envelope gustavus adolphus college envelope college campus people analogous switch local network forward envelope internet work similarly router gures router order reach destination network independent speci c computer network data forwarded router using ordinary mechanism constituent network likewise forwarded router destination computer chapter networking network network network switch linklegend router network figure internet formed connecting network connection network provided router switch interfaced link belonging network destination network mechanism structure internet address come cost computer moved network assigned new internet address return cost internet scale larger size individual network particular internet connects large fraction world computer simply known internet protocol layer network communication governed set rule known protocol specify legal action partner dialog step way example web browser communicate web server using http hypertext transfer protocol speci e message browser server legally send step section message actually look like paraphrase message plain english order illustrate notion protocol web browser asks web server download particular web page changed version browser cached server legitimately respond di erent way including changed new introduction change wo bother sending page clue page talking web server allowed response question asked allowed response legal circumstance created new page upload surprisingly http forbids web server responding like appropriate di erent protocol used deliver email human converse talk subject versation sure use rain conversation did catch say similarly computer use application protocol like one downloading web page sending email message transport protocol control matter retransmitting portion message lost application protocol viewed layered transport protocol designer application protocol granted service provided transport protocol common transport protocol tcp transmission control protocol application protocol designer assume transport protocol care reliably sending stream byte having arrive order cation loss need concern application protocol designer byte encode various message response transport protocol designer doe worry byte need streaming computer just mechanism packaging chunk byte sequence number retransmitting lost chunk assembling chunk receiving end based sequence number layering protocol result separation concern protocol designed concern detail transport layer responsible allowing pair computer engage conversation feature known multiplexing example web browser desktop computer requesting web page college main server time email program delivering outgoing email server layer connection identi ed internet address computer port number end identi e speci c communication endpoint web browser connects port number server email program connects software receiving computer delivers data port chapter networking appropriate software demultiplexes arriving data transport protocol turn simpli ed assuming anetwork protocol make best e ort deliver chunk data internet address transport protocol use service sending fresh chunk application data handed application layer sending retransmissions use internal purpose sending acknowledgment indicating data received versus need retransmission regardless perspective network protocol just packet deliver perspective transport layer delivery just happens detail like routing need concern network layer actually misnomer sponsible routing data internet fact common network protocol called internet protocol ip protocol used attempt deliver data internet address possibly way termediate router underneath layer genuinely concerned individual network link physical layer say layer section say layer implemented networking hardware ethernet network card wired wireless lan respectively counting stack physical link network transport layer frequently referred layer think application layer fact layer omitted session presentation layer layer application layer layer reason need know number frequently discussion networking device rewalls example tell rewall doe ltering based level content say rewall look speci c content web page request email transmission listing seven layer illustrated figure known osi open system interconnection reference model omit layer subsequent discussion architecture internet developed prior osi reference model internet architecture application layer take additional sibilities character set encoding establishment network connection assigned presentation session layer osi reference model largely fold layer di erence doe matter unless engineering network introduction osi reference model example protocol http smtp imap dns cifs nfs tcp udp sctp ethernet session transport network link physical figure diagram seven protocol layer osi reference model provides example layer discus bulk chapter divided section application layer transport layer network layer combination link physical layer section followed usual section security exercise project note principle traditionally internet based principle state considerable control responsibility hand endpoint computer interfaced internet periphery router device interior internet providing simple packet delivery service term protocol layering mean end computer traditionally concerned port application protocol virtue principle user agree new application protocol needing cooperation ability try new application protocol grassroots popular important evolution internet introduction web internet progressively moving away principle alluded example rewalls lter application layer mention rewalls section force leading away chapter networking principle examine section upshot today longer possible just start using new application protocol associated port number new port number blocked traverse internet help explain popular use web service mention chapter form communication middleware gured package application program message web e ect layering protocol web protocol proach help circumvent obstacle new protocol internet chapter stick traditional layer topping application layer networking role operating system ware application software just network protocol layered software nicates using protocol layering networking software doe correspond directly major division focus book application software optional middleware operating common division role system middleware application software responsible protocol operating handle transport layer api operating system present application program usually corresponds service transport layer api normally described providing socket abstraction discus socket apis section keeping division role protocol responsibility application software example web browser email program responsibility respective application tocols interesting exception domain dns map name numerical internet address using layer protocol us protocol play critical supporting role di erent application tems best think dns software form middleware run outside operating kernel support application software le system run application protocol layer application layer visible operating normal support le system mean distributed le software operating kernel contrary norm protocol chapter application expressed term sophisticated communication service socket api example application programmer want send sage queued received queuing dequeuing operation treated atomic transaction example application programmer want invoke operation object just sending stream byte case middleware provides necessary communication abstraction application layer transport service provided operating system application layer typical protocol include http used ing web smtp simple mail transfer protocol used ing email post protocol version used ing email imap internet message access protocol used accessing email examining present http example section turn tion protocol play important role scene domain explain section various distributed le system explain section web typical example use web browser view web page browser contact web server using protocol known http hypertext transfer protocol protocol form browser connects appropriate port server normally port number sends request awaits response server request response overall format initial line stating general nature request response number header line providing detailed chapter networking blank line separate header body number line message body message body actual web page downloaded loaded appears ordinary web browsing request response common case request body ll form submit concrete example let retrieve home page http bene t web browser use program called telnet connect web server port using command telnet type following line blank host rst request line stating want home page using version protocol second header line cating web host want page necessary web server di erent alias serve di erent tent depending host using blank line indicates header line speci ed point server respond large number line output rst one look like ok date sun jan gmt server apache sun jan gmt etag byte connection close doctype html public html http application layer html en head title max hailperin home page body max hailperin rst line response say request ok satis ed using http version number status code indicates request successful server sends quite header line probably gure mean example header indicates home page contained byte time tried example line describes web browser interpret message body case text le written using html hypertext markup language character set international standard known unicode transformation format boundary header message body formed blank line familiar syntax html body written html html format independent http protocol used transferring kind le familiar format web used image http standard includes feature shown simple example illustrate just consider sending request similar rst additional header host time reply web server shorter modified date sun jan gmt server apache connection chapter networking etag corresponds scenario described section browser human using telnet simulate browser asking send web page changed version previously downloaded version identi ed using etag entity tag server provided sent previous version case version server match provided tag server just sends short reply e ect browser use validate continuing use cached copy domain application layer frastructure network layer take responsibility routing packet data ed internet address internet address understands number encoding destination network speci c interface network human generally want use numeric dress instead prefer use name matter using http browse web smtp send email probably using additional protocol scene translate name numerical address col known domain dns hierarchically structured name known domain name domain actually general facility allows chine distributed internet maintain arbitrary mapping domain name value just mapping computer name numerical internet address sake overview concentrate dns used particularly important context use domain name refer internet address quite analogous use pathnames refer le topic addressed section following paragraph aspect analogy kind name hierarchical second kind name absolute relative naming system allow object directly multiple name fourth naming system allow indirectly refer refers domain speci e www subdomain gustavus turn subdomain edu structure similar pathname application layer le le wwwwithin subdirectory gustavus directory edu di erences component domain separated dot instead slash listed speci c speci c way posix pathnames di erence initial slash start ing eduin current working directory start root directory le option called relative absolute pathnames fact dns main name come variety familiar domain relative refer college web server depending context used want absolutely sure talking need use lute domain complete dot end hand cruel administrator set interpreted expected site real reason relative domain name allow shorter name referring computer local domain discussion le linking section explained simplest form linking name directly refer le similarly domain name directly refer internet address dns domain multiple kind information resource record associated type domain directly speci ed internet address resource record type letter short address example domain name type resource record containing address domain name referring directly internet address recall symbolic link soft link pathnames refer directly le indirectly pathname refers similarly dns support domain name alias domain name example domain currently type resource record instead type cname resource record showing alias looking second dns nd alias cname record referring domain actual type record specifying internet address internet address returned lookup operation chapter networking alternative domain name domain end chain alias known canonical explains resource record type called cname order translate address application program web browser us component known resolver resolver communicates using dns protocol server provides requested information system resolver operating kernel instead linked application program shared library ating perspective application program engaged network communication remote fact communication constitutes dns lookup invisible perspective application programmer resolver supporting infrastructure need programming resolver constitutes middleware technical sense word ally marketed product operating separate middleware product protocol used resolver server response protocol resolver indicates information looking internet address type resource record particular domain server responds requested information error report referral server better able answer question detail dns protocol somewhat complicated reason designed general just suitable internet address lookup second designed reliably serve entire internet contains provision coordinating multiple server outline paragraph dns protocol doe use ordinary line text unlike http example showed earlier instead dns message encoded compact binary format experiment dns using telnet exploration project suggest alternate way experiment dns server contains information complete dns given piece information stored single server normal circumstance instead information partitioned replicated following way hierarchical tree divided zone control stored independently example college maintains application layer domain name ending server control additional resource record dns indicate dividing line zone information name zone stored tiple server provide failure tolerance higher performance secondary server zone periodically check master server update resource record dns list thoritative server zone server cache individual piece information receive server course normal operation repeatedly access sending dns query way new york time server instead local server acquires copy information continue using speci ed period time expires distributed file system application viewed operating system using http download copy le remote server pending server gured able upload le server editing given le currently editing containing chapter stored centralized server making use process instead taking advantage convenient subtle kind tocol distributed le order edit chapter le stored central server simply access pathname just way access le local disk drive magic certain part le directory tree accessed network server ordinary le operation reading writing turn network message using appropriate protocol distributed le system commonly used boundary particular organization unlike protocol previously discussed hap reason di erent distributed le protocol remained viable single standard dominating popular cifs common internet file nfs network file cifs primarily championed microsoft commonly organization substantial number chapter networking window system frequently referred previous thesmb server message block protocol individual message sent cifs continue called server message block nfs developed sun microsystems primarily used site unix linux system dominate confuse nomenclature speci c feature cifs called dfs distributed file wo discus feature continue use phrase letter refer distributed le system general shortly design cifs nfs di er important regard quite bit common ticular case client software need partially located operating kernel use pathname extends directory tree supported cifs nfs operating kernel need recognize fact transfer control appropriate network client code code handle local le system kernel using general purpose vfs virtual le mechanism described section vfs mechanism delegate responsibility le operation reading writing kernel code speci c distributed le kernel code carry priate protocol exchange remote server just capture detail attempted le operation pas specialized process outside kernel actually doe network communication nfs pure protocol sense http dns interaction client server consists client sending request rst server sending response cifs hand complicated communication structure ordinary operation reading le accomplished message paired form server spontaneously send message client request notify client event le changed client wish access le noti cation allow cifs client cache le content locally performance needing sacri ce correctness key di erence system design concern information server maintain ongoing client operation di ence clear consider reading le cifs client invokes operation open le reading invokes individual read erations invokes close operation operation like open pread close operation described section contrast nfs open close operation read operation transport layer completely specifying le read position virtue design tion client server naturally tolerate party crashing rebooted hand stateless design readily support le locking keeping le cache date transport layer mentioned earlier transport layer provides port number tiple communication channel share multiplexed internet address protocol common internet provides essentially service multiplexing primitive transport protocol called udp user datagram protocol like derlying internet protocol make e ort deliver chunk data destination internet doe guarantee reliability ordering preserved major work time browse web page send email transmission trol protocol tcp protocol doe far provide port number provides application layer ability open reliable connection byte streamed program using tcp open nection local port number remote port number speci ed internet address connection open transmit byte data end connection know received end order duplication omission party communicating close connection http example section telnet program used open tcp connection web server port character typed request streamed connection received intact web server similarly web server response received telnet displayed service provided protocol nient application programming messaging object service present chapter convenient widely used application programming erally operating system provide section present overview socket application programming interface used advantage service section plain basic tcp work finally section chapter networking evolution tcp modern version proposed future version possible outright replacement socket apis asocket object used endpoint communication ferent apis revolve socket abstraction forming variation common theme important posix socket api window socket api known winsock java socket api discus brie y programming example java easiest use ordinarily socket associated local internet address port number socket know computer address port number socket used tcp communication stream associated remote internet address port number identifying communication partner local association known binding socket bound address port number remote association known connection socket connected partner socket used udp connected partner time packet data known datagram communicated using socket remote internet address port number need provided speci cally datagram convenience remote internet address port number used repeatedly socket apis generally allow mation provided using connect operation real connection formed address port number simply stored default value datagram operation socket di erent state diagram figure di erent life cycle state datagram socket used udp protocol stream socket initiating tcp connection stream socket accepting incoming tcp connection transition marked diagram dashed line require explicit operation java api state follows freshly created socket unbound address port number state socket doe represent genuine communication endpoint just hollow shell potential endpoint bound posix winsock apis socket created unbound transport layer unbound boundbindclosedclosesend receive figure state diagram show life cycle datagram socket used sending receiving udp datagrams java api class used purpose binding happens automatically constructor bound connectedconnectunboundbindclosedclosesend receive figure state diagram show life cycle stream socket used initiate tcp connection java api class used purpose binding connection dinarily happen automatically constructor bound listeninglistenunboundbindclosedclose accept creates connected closedclose receive send figure state diagram show life cycle stream socket used accept tcp connection java api class used purpose bind listen operation ordinarily performed automatically tor time accept operation succeeds new connected socket returned java api instance chapter networking using separate operation java api create bound socket really want later bind normal constructor socket class binding time socket created saving step socket bound connected listening ing connection attempt udp datagrams sent received state stream socket state used stepping stone connected listening state java api sition connected listening state generally accomplished time socket created posix winsock apis connect listen operation explicit bound socket connected remote address port number forming tcp connection byte streamed direction bound socket listening incoming connection attempt time application program accepts incoming connection attempt socket remains listening state new socket spawned o bound local address port number original listening socket connected state listening state new connected socket used communicate client initiated accepted connection server program way wind lot socket ated local port listening socket number connected socket tcp connection kept tinct tcp connection identi ed number internet address port number end connection socket closed longer needed socket data structure vestige communication endpoint operation legally performed illustrate tcp server accepts incoming connection communicates using resulting connected socket consider java gram figure server contains nite loop accepts connection time reading connection writing closing accepting connection acceptable setting web server slow client hold demonstrate transport layer import import class server public static void main string argv throw exception string storedmessage serversocket listeningsocket new serversocket true socket connectedsocket bufferedreader fromclient new bufferedreader new inputstreamreader printwriter toclient new printwriter string newmessage storedmessage storedmessage newmessage figure server listens port connection time get read line text connection use new message store server writes previous message connection rst connection message sent previous message chapter networking project programming project modify server spawn o concurrent thread incoming client sticking unmodi ed code socket associated port program run listening socket class serversocket exists time server running succession connected socket class socket time client connects multithreaded version connected socket existence time port compile run java code figure test server way shown section http use telnet program connect port machine running server just connected port connect telnet type line text response connection close connect di erent machine repeat procedure time line text previously entered come nd ca connect port probably security rewall blocking connection simplest workaround limit testing connection machine running server program connect using special hostname localhost using telnet client interaction use program written speci cally purpose demonstrate way tcp socket used connect client program server port program figure directly form connected socket bound arbitrary port local host connected speci ed host port try program compile run command like java client localhost response previous message stored server repeating command new message trieve preceding java example send single line text direction connected socket just feature example chose e ect ne nonstandard protocol used tcp transport layer accessed java socket api equally carry number line text sequence byte direction just need insert loop point program read writes connected transport layer import import class client public static void main string argv throw exception usage java client hostname msgtosend string hostname argv string messagetosend argv socket connectedsocket new socket hostname bufferedreader fromserver new bufferedreader new inputstreamreader printwriter toserver new printwriter true messagetosend string retrievedmessage retrievedmessage figure client program receives hostname textual message string command line argument connects server running speci ed host port sends line text containing message read reply line print user chapter networking example write http client server java using sort code tcp dominant transport protocol understand tcp used socket api vide reliable transport byte stream direction tion port scene brief overview technique tcp us support reliable ordered byte stream help appreciate issue subsection sketch tcp form tcp mechanism generally implemented operating kernel recent enhancement proposal change topic section application program us kernel socket api send byte kernel store byte away internal bu er time time take group consecutive byte bu er add header identifying information beginning sends network receiver using network layer ip chunk byte header called segment connection maximum segment size typically larger byte exclusive header application program trying send large number byte kernel break segment send application program sending byte kernel wait little byte failing send small segment performance bottleneck copying byte application program kernel bu er generally reaching network interface card system optimized network performance great length reduce number time data copied header segment provides port number end connection speci e position segment byte occupy overall sequence transmitted example rst ment header say byte second segment header say byte receiving code operating kernel need pay tion sequence number use deliver byte correctly application program using socket api read data segment arrive network order example taking di erent route kernel need store arriving data bu er return application program order transport layer number order arrives sending trick spending time copying data place addition arriving order segment arrive network layer occasionally lose packet overcome problem tcp mechanism retransmitting segment sender continue bu er segment receipt acknowledged case need retransmitted segment believed lost retransmitted turn lost delayed receiver need cope duplicate segment performance unacceptable tcp transmitter sent segment time waiting acknowledgment sending good idea allow arbitrarily segment sent waiting acknowledgment fast computer sending slow computer receive bu er space easily whelmed feature tcp provides scene ow control say limit unacknowledged data sender allowed outstanding time traditional tcp acknowledgment contains single number n indicate byte nhave successfully received style acknowledgment known cumulative acknowledgment limited suppose sender transmits seven ments byte rst fth seventh arrive receiver incoming segment send edgments saying byte received sender know byte received pretty good clue byte clue subsequent ve segment received idea preceding example illustrates scenario tcp sender retransmit segment having received acknowledgment rst byte duplicate ment sender justi ed assuming second segment lost retransmitting rule tcp specify waiting duplicate knowledgments easily occur simply segment arriving order duplicate acknowledgment indicates hole opened sequence number order segment arriving order hole quickly lled needing retransmission unfortunately provoke triple duplicate acknowledgment quent segment need transmitted sender chapter networking transmit allowed send ow control tions congestion control restriction shortly duplicate acknowledgment triggered tcp sender need fall mean detecting lost segment use timer acknowledgment received conservatively long time ment assumed lost conservative waiting period cause substantial performance degradation nal challenge tcp controlling congestion occurs switch including router internet link leading switch particular rate receive new data data destined particular outbound link coming switch number inbound link total rate data owing switch exceeds rate sent outbound link switch start build queue data awaiting forwarding imbalance temporary queue build little drain imbalance persists queue grow long creating lengthy delay eventually switch start discarding packet phenomenon known congestion congestion good cause packet data delayed lost tcp interprets unreasonably long delay packet loss delay outright loss cause tcp retransmit segment make problem worse sending data congested switch tcp contains feature act throttle rate sends segment new ted detects packet loss theory packet loss caused switch queue interpreted sign congestion detail congestion control somewhat complicated important fact know occurs independently tcp nection newly opened connection start low mission rate ramping rate cause congestion detected application performance improved using multiple tcp nections parallel sending lot data connection repeatedly opening new connection little data apiece modern web browser obey rule using parallel persistent tions parallel connection mixed blessing constitute attempt unfairly compete internet user creating potential arm transport layer evolution tcp traditional tcp detects data loss combination timeouts triple duplicate cumulative acknowledgment detected data loss serf sign congestion tcp responds detected data loss retransmissions order ensure data reliably delivered ery design decision challenged networking researcher system detect loss way detect congestion loss ensure reliability retransmission result partially ployed remain research proposal innovation discard tcp basic service model bidirectional byte stream subsection brie y overview trend order make point network protocol timeless truth design subject change network hardware improved rate bit mitted greatly increased time needed bit travel world acknowledgment bit travel shrunk consequence computer mit quite bit getting acknowledgment result common large number unacknowledged tcp segment situation weakness mentioned cumulative acknowledgment start signi lost segment nice know exactly one lost reason aselective acknowledgment feature added tcp receiver provide sender complete information byte received provides new way detect data loss manner data loss detected likely stem tion doe mean tcp sender need wait lost segment order sense congestion sense gestion sooner avoid loss entirely way deployed part internet router provide explicit congestion noti cation ecn send overt signal tcp transmitter throttle needing implicitly code signal discarding packet approach perimented tcp sender notice acknowledgment starting longer infer queue building called tcp vega lost segment just signal congestion prevent data delivered necessitating retransmissions chapter networking approach ensuring data delivered packet lost data encoded redundant format large subset packet contains information allow data reconstructed concept best explained highly simpli ed example shown figure general approach known forward error correction using erasure code sophisticated version used build system streaming large le video using udp nal area change service provided tcp alternative transport protocol known sctp stream control transmission protocol proposed internet standard o er similar reliable delivery congestion control tcp single bidirectional byte stream sctp sender transmit stream message entire chunk data akin udp datagrams delivered reliably correct order boundary preserved run undi erentiated byte stream sctp connection carry stream direction message individual stream delivered order lost message stream doe hold delivery message stream unlike trend mentioned previously ect detail sctp popular necessary rethink apis constitute interface application program operating system network layer network layer delivers packet data appropriate destination computer internet section highlight aspect layer explain di erence version ip explain address structured currently dominant version second overview router forward packet appropriate path reach destination finally explain network address translation nat technology considerable utility odds original architectural principle internet ip version packet data sent internet header formatted dance internet protocol ip packet contains tcp network layer data segmentseach column number soif segment lost reconstructedto fit y segment figure sending redundant data allows loss tolerated suppose segment data sent simplicity segment byte long suppose loss rate low unlikely segment lost waiting segment lost retransmitting sender transmit data segment parity segment sequence number header ve lost data segment deliverable lost segment reconstructed udp datagram tcp udp header follows ip header packet starting ip header known ip datagram ip datagram contain udp datagram confusing stick word discussing ip reserve udp important piece information ip header follows version ip used governs format ing header eld currently version dominant version limited use version doe exist internet address packet sent internet address packet delivered code number protocol indicating ip header followed tcp header udp header header eld discus support optional extension basic protocol protocol di er currently dominant principal way source destination internet dress larger bit instead greatly ease signing internet address ubiquitous device cell phone second designed support security feature protecting packet terception alteration forgery feature time available optional extension known ipsec chapter networking partially reason transition happening exceedingly slowly far dominant version explained section internet address contains nents identi er particular network identi er speci c interface network analogy section hailperin gustavus adolphus college given address bit long ask bit devoted pose example doe address contain network number interface number unfortunately answer question simple address pre x number bit long identi e network remainder bit identifying interface network length network pre x varies network network internet address partitioned component uniform way motivation awkward design internet need support large number network example large network containing example conceptually simple solution problem use larger address containing network number interface number designer decided stick total bit address size place early version internet addressing network identi er bit long interface identi er bit designer considered important stick prior address size bit prior design concept bit partitioned uniform way design choice cram address bit allowing exible division allows small number large network short network pre x large number small network long network pre x address conventionally written dotted decimal format address divided component component translated decimal number decimal number written dot example computer internet address translating decimal binary produce internet address binary bit rst identify network college partment mathematics computer science remaining identify speci c computer network computer network layer kernel aware internet address division bit fact stored mask case translate dotted decimal binary rst bit bit kernel us information sends internet packet compare destination address address paying attention pre x speci ed mask case kernel check rst bit destination address destination network computer kernel send data directly using network addressing mechanism hand destination outside network kernel send packet gateway router leading local network outside world link layer kernel send packet gateway router network address ultimate destination internet address ip header routing label switching ordinary functioning internet entity actually selects route packet data follow sense planning entire route advance instead time packet arrives router router decides neighboring router forward packet overall route emerges composite result local decision router need forward packet decides neighboring router consulting forwarding table entry forwarding table speci e internet address pre x router pre given large table router forwarding decision rapidly just requires table lookup problem entry table keyed pre x making lookup operation complicated case key limitation traditional internet routing need look pre x destination network get forwarded router large service provider core internet prefer exible engineering ability send alternative route core provider one expensive lookup operation pre x burdensome router need switch high chapter networking order address issue internet service provider particularly core internet moving away traditional ip router label switching router using multiprotocol label switching mpls label switching router look router using pre x destination address instead using length label attached packet mpls speci e dard format labeling ip packet rst reach label switching router router attache label based destination address engineering consideration packet labeled forwarded label switching router label switching router number time based label packet nally passed traditional router label get stripped o approach task router warding individual packet based table lookup operation router engaged activity router constantly rebuilding forwarding table ect recent information internet exchange formation using routing protocol study routing protocol approach generating forwarding table entry quite interesting leave networking text network address translation end like people network home us internet protocol computer network open tcp connection computer internet example browse website home network constituent network internet situation actually quite typical home network result use network address translation nat router connects home network service provider network nat technology allows entire network entire private internet pose single computer internet matter home computer connects external site external site source internet address address represents network computer home network private ip address example packet home network use address router forward packet home network service provider modi e packet replacing private ip address single public network layer address service provider assigned nat router did change packet source address chaos result recall tcp connection uniquely identi ed combination value source destination address port number suppose start browsing home computer time wife doe home puters opening tcp connection destination address destination port number source address start computer pick source port number using wife source address start computer pick source port coincidence pick home network tcp nections distinguishable di erent ip address outside home network issue nat box rewrite packet source address leaf port number combined separate tcp connection problem nat router rewrite packet source port number tcp header source address ip header internally network distinct address coincidentally identical port number externally share common address nat router make sure use di erent port number example assign port number wife port number router make entry table later reference entry map internal packet destined web server address port number external packet address port number entry web server internal address port number map external address port number figure illustrates scenario luckily port number scarce resource tcp header eld source destination port number bit size puters ordinarily use near apiece nat router problem assigning distinct external port number port use computer home network nat router essential function rewrite reverse manner packet coming internet large private network example packet arrives source address source port destination address destination port nat table belongs chapter networking computer nat router table shown internal address port address address port port figure nat router rewrite port number address computer share single public address connection nat modify packet destination port time packet reach computer look web server directly communicating using private address happens external computer want initiate tcp tion home computer particular case home luck nat router gured forward inbound ets come connection initiated private network answer somewhat di erent network ing nat router consider example business chooses use nat router business allow outgoing connection computer just home outgoing connection ate temporary entry router table rewriting rule just like router business allow incoming connection port standard http port main web server port standard smtp port main email server guring nat router permanent rewriting rule ets coming business public address port rewritten web server private address retaining port packet coming public address port rewritten email server private address retaining port example illustrates problem nat routing ming violation principle suppose link physical layer business want start o ering new kind internet service using new protocol listens new port number work corporate network administrator need make new entry nat router table like web email server signi stumbling block introducing new service reason service today packaged inside http directed usual port nat routing problem fundamental one ipsec designed prevent packet altered transit nat relies doing exactly technique working recently developed doe introduce additional complexity despite problem nat routing heavily used day principal reason internet address expensive worth sharing negative consequence ameliorated fact network administrator prefer internal computer o limit external access security reason link physical layer plug ethernet cable socket plug snap socket right size computer start sending high low voltage cable high low recognized equipment end extreme fry equipment example issue addressed physical layer various standard exist ethernet ber optic ethernet twisted pair copper wire forth granted physical layer bit end link problem solve example computer local network address data presumably chunk data known frame need header speci e source address destination address suppose plug computer network start immediately hearing having come middle frame start paying attention start frame recognize boundary frame nite minimum space silence frame recognizable signal beginning frame shared link like radio channel pose problem various computer turn transmitting issue addressing chapter networking taking turn concern link layer known data link layer computer system hardware device support link physical layer operating kernel provides hardware frame data deliver complete address recipient local network hardware doe rest conversely hardware interrupt operating report arrival incoming frame issue link physical layer direct bearing operating system software biggest exception ing common kind network ethernet use address totally independent internet address operating sends packet data net address address pre x show local network kernel need mechanism looking corresponding hardware address commonly known mac medium access control dress kernel discovers mac address using network protocol called arp address resolution protocol kernel broadcast request machine local network asking know mac address corresponding particular ip address operating kernel receiving machine compare requested address see ip address responds providing mac address requesting kernel store information away table later reuse wo need bother computer repeatedly lot network technology developed account bulk network today network use wire ber optic use version ethernet standard network use radio signal use version standard frequently known identifying number working group standardizes use interface integrated combined network device communicate device mac address ethernet portion network portion internet routing required switching device link ethernet way known access point network security network security just networking large eld survey chapter network security large area purpose addressing twofold want impress important remained silent think unimportant second scratching surface feel constituent topic data security extend security system data persistently stored today world data frequently transit network example student grade stored college computer transmitted internet time grading home comprehensive data security include network security key di erences persistent storage network communication amount data available long period time sistent storage network hand generally carry particular piece data eetingly contrast gaining access merchant database containing customer credit card bers tapping network connection snagging number pas time interception operation storage directly accessible limited number people physical access subject risk physically apprehended internet hand accessible entire world worth malefactor e ective reach law enforcement internet pervasive rst factor dominant network security major concern today second factor considered dominant mind network adversary limited eavesdropping modifying data passing network send message trigger additional data ows occur computer typically home today network intruder intruder obtained complete control remotely mand computer carry action computer including accessing persistently stored data way organization company government agency chapter networking computer similarly devoting large amount attention network security security protocol layer security vulnerability threat exist layer protocol stack similarly defensive measure possible level protect dentiality transmitted data ensure authenticity integrity arriving data notorious network security problem application layer example include forged email sql mer worm propagated owing memory space particular application program used incoming message layer vulnerability stem fundamental protocol design decision email claim come come plementation aws program checking putting data bu er room vulnerability combated directly using better design careful programming unrealistic expect fection area human endeavor indirect method used minimize risk section tions role gured rewall intrusion detection system play example essentially zero need organization allow come internet large particular port number used sql slammer worm ity ought shielded rewall application layer provides plenty opportunity actively hance security example email protocol retro tted cryptographic technique ensure message really come stated sender modi ed transit read intended recipient pgp pretty good privacy internet mail extension exactly example reason web browser web server need directly send http message vulnerable tcp connection instead interpose layer encryption known secure socket layer ssl time visit secure website padlock icon click shut mean ssl use conceptually main http application layer tcp transport layer strictly speaking protocol transport layer tcp subject set network security attack network server place level server attack ooded initial request followed proposal xing problem fundamental way run changing protocol widely deployed example technology transport layer optional tcp feature message authentication feature ticularly used router order secure communication boring router possible intruder inject bogus routing information internet rendered unusable router routing update message using optional tcp feature check signature update receive neighboring router biggest security vulnerability network layer packet incorrect source address typical response problem ltering router example packet allowed college campus internet large source address legitimate range assigned college prevent pretending mentioned ipsec security technology network layer common application ipsec organization computer physical location including frequently er home want allow communicate securely location carried lic internet ipsec support kind virtual private network vpn making sure packet data sent encrypted completely opaque eavesdropper stymie active intruder attempt modify inject packet finally lowest layer protocol stack link physical layer immune security issue mention just arp protocol used translate internet address mac address designed consideration security issue result easy computer local network internet address ought belong computer network attack readily detected responded prevented second example signal organization picked street outside encryption built early version faulty newer version frequently turned use nitely read widely available tutorial security system gured securely usually chapter networking firewall intrusion detection system rewall imposes restriction internet crossing border example company outside world particular computer rest internet conscious organization deploy multiple rewalls protecting outer perimeter border internal group individual system computer installation hooked internet small single home computer rewall rewall computer hardware unit devoted purpose router gured lter software installed directly computer protected rewall operates correctly approach valid rewall software buggy consequence likely severe operating computer protected best practice use reputable external rewall organizational workgroup perimeter software rewalls individual computer home user ideally use approach external rewall case nat router big problem rewalls guring let good reason exist blocking cal study shown large percentage rewalls miscon gured organization rewall guration le ined auditor penetration testing performed auditor make attempt gain access protected network organizational setting pressure network administrator gure rewalls restrictively necessary nization functioning blocked complain complaint cost administrator job home setting hand likely complaining presumably stand heat set rewall setting restrictively sible wait harm doe loosen setting prove way approach compensates inability hire security auditor important step organization preserve overall security use rewalls isolate machine exposed tack particular machine attacker damage limited example consider web server doe port interactive transaction shopping just network security information organization guration shown figure suppose web server software bug sending clever message server normal port outside attacker overwrite critical memory come server executing arbitrary code depending access control place server attacker able deface website replacing nization web page attacker mount attack server machine internal network external rewall prohibits outbound connection server employee organization want recon gure server new information using connection initiate internal network addition rewalls organizational network include intrusion detection id monitor network looking activity doe t usual legitimate pattern id play role alerting network administrator existence problem capturing forensic evidence useful crafting ate response response technical removing infected machine network cooperating properly gured id protect intrusion breach organizational perimeter attack mounted insider cryptography cryptography consists mathematical technique transforming data order assure dentiality integrity authenticity cryptography underlies network security ranging secure email web browsing encryption protocol cryptography provides mean legitimate communication continue adversary thwarted aware practical security problem outside scope cryptography rarely report encryption broken miscon gured rewalls system vulnerable bu er ows everyday occurrence cryptographic technique categorized independent way technique rely sender receiver knowing shared secret secret key know intruder technique use key pair chapter networking internal networkexternal networkweb serverorganization boundary firewall router guration rewall router initiator target allowed port external network web server internal network web server needed operation internal network external network external network internal network web server figure rewall guration allows organization web server provide static content outside world allows action organization need equally conscious module added network security known sender receiver option known cryptography tography application half key pair publicly known kept secret cryptography known cryptography technique encrypt message transform message readable appropriate key technique leave message append message thentication code allows possessor appropriate key verify message really come legitimate sender modi ed note abbreviation mac used context independently use describing feature protocol mac address bit long cryptographic key work legitimate sender receiver need work intruder need goal designing cryptographic make legitimate party work scale modestly key size intruder work scale rapidly way key size chosen infeasible intruder break practical use unfortunately computational hardness result used practical cryptosystems proved possibility remains clever intruder nd way break doe scale rapidly key size system reasonable security computationally legitimate party system giving potential pair communicating party shared secret advance impractical practical system pgp ssl combine type cryptography using tography establish secret key switching cryptography bulk communication present standard technique encryption aes advanced encryption standard known rijndael tions use prior standard data encryption standard de de considered secure simply key size small secure variant us basic de operation time best practice new application use aes technique encryption rsa named initial developer rivest shamir adleman data transformed half rsa key pair chapter networking transformed original using half key pair specify inverse function user want receive encrypted message make half key pair public sender use keeping half private read message standard technique computing mac using shared secret known hashed message authentication code hmac shared cret message combined fed cryptographic hash function known message digest function function designed adversary realistically hope nd input produce output recipient copy sage shared secret result hmac code recipient dent message legitimate came knew ingredient additional safeguard tain possible aws cryptographic hash function standard hmac technique used ipsec example applies hash function twice shown figure hmac code commonly based cryptographic hash function message digest secure hash algorithm unfortunately widely deployed function turn secure previously thought unlike de simply used long key fallen prey fundamental mathematical progress computational problem faced adversary doe scale rapidly hash size conjectured pecially way exploit function vulnerability context hmac fact derlying cryptographic hash function weaker previously thought worrisome new system nitely minimum use vulnerability pronounced developer monitor news cryptography search community consider using successor existing system using particularly text reconsidered converted successor function deliberate speed practical exploit vulnerability context currently true common technique creating mac bine cryptographic hash function rsa mac known digital signature share important feature real signature discus paragraph let explain computed recall rsa network security combine hash hash hmaccombine waymessage key figure hmac computed shown sender receiver use computation copy shared secret key sender us message sending transmits resulting hmac message receiver doe tion using hopefully unchanged message received receiver computes hmac received chapter networking pair speci e pair inverse function sender half key pair secret use signing message make public use checking message inverse function sandc signing checking cryptographic hash function sender us h m signature message recipient want check signature run function c producing c s h m h m becausecis inverse function cipient run received message h veri e value ofh m result provides evidence message pered signed person knew summarized figure key di erence digital signature hmac recipient better position forge digital signature digital signature o er feature known repudiation embarrassing email signed party convincingly claim forged hmac hand o er evidence party regarding wrote message exercise principle protocol layer processed device internet excluding endpoint computer list ve type header line used http protocol function reason domain longer resolve rst time used subsequent us figure page illustrates parity used primitive form erasure coding forward error correction segment reconstructed missing suppose parity segment missing data segment tcp udp header contain port number used layer software demultiplex incoming data appropriate layer consumer analogous number ip header allowing network layer demultiplex appropriate consumer network security m message hh m s h m smessage validity receiver sender c s h m chh m figure digital signature computed veri ed shown signing checking function sandcare inverse kept private publicly known role cryptographic hash function h simply reduce data sandcneed process express ip address dotted decimal express ip address binary network mask bit long network pre x network mask bit long network pre x network mask network pre x network mask network pre x computer ip address mask following destination ip address doe computer send packet directly doe send way gateway router b c d identify number layer osi reference model corresponds following speci c protocol technology chapter networking udp b retrieving email c ethernet mac address d ip e congestion control f ber optic g tcp h router delivering byte proper sequence j dns k l http m retransmitting data acknowledgment received n cifs o verifying cached web page date p port number q nfs section explains tcp recovers lost data segment doe consider lost acknowledgment nonetheless tion section gure lost acknowledgment tolerated explain lost acknowledgment tolerated additional communication delay b explain circumstance tcp incurs extra delay communication recovering lost acknowledgment programming project modify message storage server figure page accepted connection handled separate thread main thread immediately looping accept connection using telnet client slow providing line text doe prevent client served program use synchronized method atomically store newly arrived message retrieves previously stored network security write program retrieve single le web server using http given hostname server le server example given retrieve home page directly use socket api mechanism implement http handling error exceptional circumstance primitive initially java class provides method called getlocaladdress andgetinetaddress used nd local remote internet address associated connected socket write server program accepts connection request time receives connection writes connection line text containing string form remote address connection received write client program connects server display string server sends display client local address use pair program test client connected server nat router exploration project unix linux system program named digthat used send dns query response form use tool explore dns example nd ternet address favorite computer check cname chain leading structure reported use zone transfer function display content local zone aspect dns nd mentioned description use freely available network packet capture analysis tool named wireshark study dns capture packet accessing website previously accessed look just dns ets expand dns portion display regard rmation description dns aspect dns nd mentioned scription use freely available network packet capture analysis tool named wireshark study cifs nfs capture packet chapter networking accessing le provided server look just cifs nfs packet expand cifs nfs portion display regard rmation description aspect nd mentioned description mentioned nfs doe operation opening closing le regard closing inarguably true regard opening claim nfs protocol includes lookup operation similar le open information nfs lookup operation explain looking le similar di erent opening le compile run message storage server figure page using telnet client slow providing line text prevents client served ip address network mask microsoft window ipconfig command unix linux system using ifconfig command typical example use ifconfig network mask bit long network pre x using information ip address actual network pre x explore resource sample policy write summary interesting nd pang et al published description internet background radiation wustrow et al updated background radiation revisited durumeric et al provided update view scanning read available web write summary longer page comparing cifs nfs remark stateless design nfs readily support le locking keeping le cache date hiding word doe nfs provide support service network security section dns section mention type resource record used internet address section ip version section indicates address di erent address version assumed section dns address version held type resource record type used late major security vulnerability known volved use digital signature verisign rapidssl brand research topic write paper explains ability resolution making appropriate connection material chapter sure seek source information authoritative include technical detail note topic chapter covered standard networking textbook tanenbaum kurose ross ultimate source information various protocol corresponding standard document site good compromise providing technical standard tutorial clarity textbook stevens book want delve nel implementation detail look book freebsd linux implementation regarding frequency rewall guration study wool area research mentioned use erasure coding forward error correction example paper byers luby mizenmacher exploration project based paper pang et al wustrow et al durumeric et al chapter networkingchapter messaging rpc web service introduction application programmer create distributed system communicating process fundamentally rely support networking provided operating system support described chapter reliance direct example application program use ets open connection tcp port send byte stream encode application message increasingly reliance direct middleware layer come application program socket api application programmer work term abstraction message queue remotely accessible object middleware provides abstraction making use fundamental operating supported facility chapter present distinct style communication dleware messaging system discussed section support transmission message application programmer choose use message pair middleware remains oblivious pairing treat message individually sending request receiving response happen separate transaction potentially quite di erent time tightly coupled interaction remote procedure rpc system provide alternative style communication sented section time process invokes rpc operation sends request immediately wait response transaction rpc make pair appear chapter messaging rpc web service application program normal procedure return presenting style communication turn tion connection web service web service use ized communication mechanism make programmed functionality able internet web service t rpc model use messaging theory general message change pattern finally chapter concludes usual look security issue section exercise project note messaging system application based transmission message use form dleware known messaging system middleware mom popular example messaging ibm websphere mq merly known mqseries popular api messaging java message service jms java ee messaging system support di erent form messaging message queuing messaging introduced message queuing section build introduction message queuing provide introduction messaging figure illustrates di erence form ing message queuing strongly decouples timing client server queue retain message retrieved optionally client specify expiration time unretrieved sage server need running time message sent hand client weakly decoupled server tity client doe send message speci c server doe send speci c queue creates tural structure queue normally function particular server structure mean message multiple server client need send multiple queue architecture contrast strongly decouples er knowledge subscriber identity message sent general topic distributed number subscriber indicated topic messaging usually doe strongly decouple timing message usually sent current subscriber retained future subscriber portion messaging managing topic object messaging system client server queue message queuing messaging publisher subscribersubscriber subscribertopic figure message queuing involves step client sends message queue queue retains message long necessary server retrieves message messaging involves di erent sequence step subscriber subscribes messaging object publisher sends message topic message distributed current subscriber messaging known broker broker responsible maintaining list current subscriber topic ing incoming publication current subscriber publication topic section explained relationship message queuing transaction transaction retrieve message queue cessing updating database send message queue transaction commits input message gone queue database updated output message queue transaction abort input message remain queue database remains unchanged output message entered queue transactional nature message queuing important quence system request message paired response sage help explain di erence messaging rpc system consider client server coupled request response queue shown figure client generate request sage transaction second transaction wait response message single transaction wait forever having deadlocked transaction commits request message doe enter request queue result server respond wo generate response message client continue waiting response message transaction chapter messaging rpc web service client serverrequest queue response queue figure client server engage protocol using message queue typically client tag request message unique identifying string known correlation id server copy id resulting response message client know request response corresponds commit completing deadlock goal client make use server indivisible step transaction need use rpc messaging messaging participate transaction result interesting publishing just like sending queue message actually sent transaction commits receipt message subscriber handled di erently subscriber receives message transaction abort transaction count message redelivered transaction retried messaging model consumer want receive selected message example want receive stock ticker message updated price ibm stock price program receive stock ticker message reading queue sent subscribing topic published ignore uninteresting sake messaging system generally provide mechanism ltering prior message delivery model selection just ibm stock accomplished simply having speci c topic ing system generally allow topic hierarchically structured like le directory tree internet domain dns topic ibm stock price scriber interested stock subscribe speci remote procedure topic subscriber interested stock price subscribe wildcard subtopic wildcard fancier needed case useful circumstance subscription receive message individual stock ibm general message directed specialized message directed descendant subtopics number level sibling hierarchy topic limited t model message queuing model address qualitative selection criterion naturally lead distinct topic example gave earlier unlikely architect create subtopics reason subscriber interested price range messaging system allow message consumer specify general selection criterion jms api example si messaging session dis messaging destination queue topic executing d symbol price price produce consumer object speci ed selector receive operation performed consumer messagelistener registered consumer message satisfying selection criterion remote procedure goal remote procedure rpc middleware make response communication straightforward application programmer program ordinary procedure call client application code call procedure ordinary way passing argument taining return value use procedure call just happens reside separate server scene middleware encodes procedure argument request message extract return value response message similarly server application code form ordinary procedure time invoked procedure argument extracted request message freeing responsibility section explains principle chapter messaging rpc web service rpc operates section provides concrete example using rpc particular form java rmi remote method invocation principle operation rpc understand rpc middleware function helpful think fact di erent procedure present interface ample consider procedure squaring number di erent procedure numeric argument compute square return work multiplying number use fancy calculation involving logarithm open network connection bored teenager ask teenager square number return value receives correctly extracted textual response procedure known proxy teenager proxy method squaring number involves multiplication rithms delegation responsibility proxy presenting interface procedure figure show rpc middleware us proxy client position making normal procedure client application code actually doe make normal procedure illusion give illusion calling server procedure doe real computation instead called procedure proxy standing server procedure proxy known stub stub proxy discharge responsibility doing actual computation using request response message communicate server stub proxy hide communication issue client application codestub proxyserver procedure request message response message procedure returnclient figure remote procedure application code make normal procedure stub proxy doe carry requested putation sends request message server turn response message procedure return remote procedure cation programmer writing client code case needed server written networking expert rectly write code handle request response message typically server code written application programmer appreciates middleware support shown figure server plication code normal procedure called way running machine client illusion partial server application code really called ordinary procedure illusion concern code doing calling application standpoint caller client caller really dedicated portion rpc runtime known skeleton tie purpose procedure response request message figure application programmer view result middleware communication disappears view client application code directly calling server application procedure single early version rpc communication model based nary procedure call recent version based oriented concept method invocation basic principle rpc commonly understood include method invocation procedure calling key example rpc standard open network computing onc rpc developed sun microsystems internet standard onc rpc serf foundation nfs network file discussed section nfs operation reading le carried calling rpc stub dure take responsibility packaging procedure argument client application codestub proxy procedure procedure returnclient tieserver application code procedure procedure returnserver request message response message figure order server application code free nication detail normal procedure invoked portion rpc runtime called skeleton chapter messaging rpc web service client application codeserver application code procedure procedure returndistributed figure application programmer view rpc client code apparently making direct server procedure rpc proxy mechanism invisible request message extracting return value response message version rpc stub proxy object ing interface server object repertoire method invoked stub us uniform strategy dling method translates method invocation appropriate request message signi rpc standard corba rmi corba common object request broker architecture complicated standard allows code written language code written language located distributed tem rmi remote method invocation considerably simpler mechanism included java standard api simplicity come needing support single programming language rmi optionally use corba communication protocol internet protocol iiop system interoperate important feature rpc system rmi value communicated method argument return value include reference object remotely invoked method operate basic value integer string ned type object remotely accessible object passed reference refers remotely accessible object fact way object nd object communicate getting past initial startup phase initially communication started client object typically look server object using registry specialized server maintains correspondence textual name reference remotely sible object correspondence known binding remote procedure located listens connection prearranged port application server object created client want locate server object bound registry client present textual registry lookup operation receives reference initial server object contact initial contact object use argument return value remote method invocation start passing reference additional object listed registry pretty soon number client server object reference invoking method section occupied rmi programming example designed reinforce aforementioned point remote object located using registry passed reference ple illustrates way application programmer us rmi complement preceding general discussion rpc stub skeleton work provide detailed information inner working rmi example using java rmi using rmi possible develop implementation messaging model publisher send message topic object forward message subscriber code section show implementation simplest possible form particular code following limitation address limitation corresponding programming project message delivery fully synchronous publisher asks topic object deliver message control doe return publisher message delivered subscriber programming project address example program support single topic programming project address example code way subscriber explicitly unsubscribe topic code doe support subscriber terminate lose communication fail programming project provides explicit unsubscription example code includes simple interface sending textual string message displaying received message chapter messaging rpc web service terminal demonstrate communication appeal application game programming project provides opportunity address shortcoming using rmi object remotely accessible implement java interface extends method face declared potentially throwing potential exception necessary underlying operation possibly fail remote invocation operation fail myriad way network disconnection crash machine remote object located figure show source code simple remote interface implemented subscriber topic object reason category participant model implement interface common receive message subscriber directly implement messagerecipient interface later topic object need implement extension interface receive message add subscriber figure show topic interface extends messagerecipient addition addsubscriber method tice argument passed addsubscriber messagerecipient allows reference remotely accessible object subscriber passed topic later use having seen interface remotely accessible object ready example code make use object figure contains simple program sending textual message given rst argument remote object implementing import import public interface messagerecipient extends remote void receive string message throw remoteexception figure messagerecipient interface describes common feature shared subscriber central topic object redistribute lished message subscriber object receive remote procedure import public interface topic extends messagerecipient void addsubscriber messagerecipient subscriber throw remoteexception figure topic interface provides operation subscriber use register receiving message extending messagerecipient interface topic interface prepared receive message publisher topic interface speci c remote object looked aid registry service rmi record binding registry located server computer hostname speci ed second argument local computer hostname given let turn example remotely accessible object created listed registry topic server class shown figure implement topic interface topicserver keep track current subscriber addition happen addsubscriber method deletion happen message successfully livered rmi infrastructure allowed invoke operation thread remote operation marked synchronized provide mutual exclusion prevents race manipulation list subscriber topicserver program run command line main method creates instance class export remote access place local registry using publisher class look nal component example subscriber class shown figure class provides simple test program display message receives like publisher class us registry speci ed host local host speci ed like publisher class look registry obtaining reference remote object menting topic interface reference actually proxy implement interface proxy communicating instance topicserver class unlike publisher subscriber remotely accessible object created exported just like chapter messaging rpc web service import import public class publisher public static void main string args usage java publisher message host string message args string hostname args null try registry registry hostname topic topic topic message catch exception e caught exception e figure program us registry locate remote object named implement topic interface program asks object receive remote procedure import import import import import import public class topicserver implement topic private list messagerecipient subscriber public topicserver subscriber new arraylist messagerecipient public synchronized void receive string message throw remoteexception list messagerecipient success new arraylist messagerecipient messagerecipient subscriber subscriber try message subscriber catch exception e silently drop subscriber fails subscriber success figure topicserver class continues figure receive method shown remotely invoked publisher remotely invokes receive method chapter messaging rpc web service public synchronized void addsubscriber messagerecipient subscriber throw remoteexception subscriber public static void main string args try topicserver obj new topicserver topic stub topic obj registry registry stub server ready catch exception e server exception figure continuation topicserver class begun ure show remote object created exported remotely accessible bound web service topicserver bound registry topicserver doe locate subscriber successfully run topicserver test using publisher subscriber program probably need run rmiregistry program come java detail run program c mechanism ensuring component overall rmi access class likely need consult documentation speci c java order successfully test sample code complete programming project technical dle able communicate multiple machine long running java long network rewalls impede communication web service provide alternate rpc anism allow communication wider assortment machine web service aweb service communicating component complies tion internet standard designed share possible standard used ordinary web browsing allows web service advantage web popularity hopefully making communication programmed component ubiquitous communication human facilitated web rst edition textbook provided information web vice standard including example use tion badly outdated removed version book section remains time contributes treatment topic security communication middleware messaging system rpc server use acls control access like le system example broker hierarchy topic associate acl topic hierarchy acl speci e user group publish subscribe acls subtopics precedence general topic protection speci ed precisely necessary chapter messaging rpc web service import import import import public class subscriber implement messagerecipient public synchronized void receive string message throw remoteexception message public static void main string args usage java subscriber hostname string hostname args null try registry registry hostname topic topic topic subscriber obj new subscriber messagerecipient stub messagerecipient obj stub catch exception e caught exception e figure instance subscriber class created exported way topicserver s remotely accessed bound registry instead stub referring thesubscriber passed addsubscriber method topicserver store reference away security communication middleware subtopics matter allowing subtopics convenience inheriting ancestor topic acl acl list user group granted access leaf open aspect security distributed server know user access right apply incoming connection robust solution problem relies cryptographic mechanism described section exercise doe messaging di er sending byte tcp connection doe messaging di er sending email message doe messaging di er rpc doe using response message turn equivalent rpc web service alternative messaging rpc system kind communication middleware following communication method example application scenario think appropriate message queuing messaging rpc case justify choice communication method recall topic hierarchy wildcard resents component topic represents sequence zero component separated slash suppose topic b following subscription specify topic included suppose si jms messaging session dis jms messaging nation create consumer receive message sent dcontaining symbol ofibmand receive containing price independent symbol rmi programming example suppose subscriber jects subscribed single topicserver publisher object send message topicserver chapter messaging rpc web service subscriber s necessarily print message order plain topicserver implementation shown figure page receive method invokes subscriber receive method mean topicserver method return caller subscriber received message consider alternative version topicserver receive method simply place message temporary holding area quickly return caller separate thread running topicserver repeatedly loop ing message holding area sending turn subscriber java class chapter appropriate use holding area pattern synchronization provided class term speci c particular application programming project create rmi analog server figure page companion client figure page modify topicserver class shown figure page described exercise sure correctly synchronize access list subscriber exercise describes way modify topicserver class receive method doe need wait subscriber receive method normal circumstance tive design achieve goal topicserver receive method create new thread incoming message thread deliver message subscriber modify thetopicserver class shown figure page alternate way sure correctly synchronize access list subscriber rmi example code given section single topic used bound registry publisher topicserver subscriber program ized topic additional command line argument topic separately bound registry demonstrate security communication middleware concurrent execution di erent topic object host subscriber programming project accommodated multiple subscribe topic having separate topicserver istering registry alternative design single topicserver object receive andaddsubscriber method taking extra argument topic develop demonstrate code approach want include extra method purpose adding topic obtaining list current topic provided rmi example tion doe include method removing subscriber topic arguably method redundant topicserver class prepared subscriber fail subscriber wish unsubscribe simply arrange intentionally fail option doe handle case subscriber subscribed topic wish unsubscribe design cleaner exible topic terface topicserver class supported removesubscriber method add demonstrate use section show rmi used convey textual message publisher subscriber way intermediate topic object requisite skill building user interface java use rmi mechanism foundation plication game write program depending design want incorporate feature earlier programming project example multiple topic support multiple chat room welcome change sage type c class game move appropriate textual string publisher class figure page make use topic interface messagerecipient interface change class use general interface strate appropriate change publisher wind communicating directly subscriber intermediary topicserver chapter messaging rpc web service topic interface figure page extends base terface messagerecipient us interface argument type addsubscriber method demonstrate allows topicserver function subscriber topicserver assuming programming project need topicserver functioning subscriber add using addsubscriber stead leave code topicserver unchanged add new program look topicserver object registry add subscriber exploration project read bean java ee tutorial write concise explanation convenient directly using jms work java messaging jms example java ee tutorial chapter tutorial note topic chapter subject particularly rapid technical opments best source information likely website java website http information rmi java ee includes jms information published book emphasize technical detail big picture use technology book doe vide lot advice use messaging hohpe woolf security introduction addressed security issue preceding chapter security pervasive design issue way performance just ca discus virtual memory mechanism persistent storage mance did exist devote later chapter solely performance wrong treat security hand sustained attention security talented researcher rich coherent body security concept resulted worthy chapter section recapitulates ampli e chapter nition curity statement security objective list number level security principle illustrated particular case book section discus area curity technology authentication user identity provision access control ow control limit authority user topic build chapter introduction protection area security technology cryptography addressed chapter section describes virus worm prevalent security threat fall largely outside scope conventional thentication authorization control worm propagate exploiting bu ow vulnerability widespread form vulnerability section security measure subject imperfection just like human chapter security endeavor section response reality assurance technique used assess quality security measure monitoring technique used collect information attack particularly thwarted finally section close book practical note providing summary key security best practice mentioned earlier chapter mentioned course section bringing place hope provide checklist guidance summary chapter end exercise programming exploration project note security objective principle security best understood aspect overall quality like quality general refers meet objective owner primary stakeholder think factor stop meeting objective clear quality stem combination proper design implementation operation similarly security span area examining make security di erent aspect quality like pin nition quality bit carefully tempting rst nition quality designed implemented operated meet objective owner nition somewhat unrealistic fails acknowledge decision particularly regarding design need complete knowledge ect suitability ne nition say quality designed implemented operated reduce appropriate level risk fail meet objective owner risk reduced appropriate level able accept remaining risk incur cost reducing risk nition make risk management sound like ward economic calculation like deciding continue paying high premium old warehouse instead build new warehouse unfortunately decision regarding velopment operation precisely calculable insurance company good estimate likely warehouse burn probability computer fail meet security objective principle tives far fuzzier addition insurance company good estimate large loss result denominated dollar contrast consequence computer cult predict case adequately translatable nancial term consider example computer essential national security nonetheless imperfect approach tem quality provides correct conceptual framework management goal expend resource way provides commensurate reduction risk requires keeping view tor cost likelihood failure consequence failure factor manipulable example building new warehouse preferable reduce material stored warehouse reducing possible loss similarly making computer likely fail preferable reduce reliance failure signi reliance reduced use redundant computer system use noncomputerized system having provided background quality general ne tem security similarly secure designed implemented operated reduce appropriate level risk fail meet objective owner face adversary adversary objective contrary owner strive make fail mildly interesting consequence nition security irrelevant system fail meet owner objective intervention adversary interesting consequence approach quality need extended include action adversary secure need impervious attack adversary fact need especially adversary interfere instead needed likelihood adversary choose mount attack likelihood attack succeed damage likely owner objective successful attack combine produce appropriate level risk relative cost available countermeasure generally acceptable level risk achievable o er resistance attack point reduction vulnerability appropriate approach reducing threat face chapter security successful attack action nontechnical ple organization avoid creating disgruntled employee system face severe threat independent vulnerable example company choose accept cost repeated data entry store customer number online ing reduce threat adversary motivation break reduce consequence successful attack company lose customer goodwill wrong equate technical e orts reduction vulnerability assume e orts reduce threat consequence failure nontechnical nature fact active technical area today monitoring system operation discus section monitoring doe reduce tem inherent vulnerability deters adversary especially adversary internal organization reducing threat low team quickly system operational attack reducing loss owner objective adversary seek thwart end speci c objective owner broad class objective commonly arise discussion security owner wish maintain dentiality information stored computer information disclosed person authorized receive owner wish maintain integrity information stored computer information modi ed deleted person authorized owner wish preserve availability service vided computer person authorized use able interference adversary adversary able cause denial service owner wish ensure accountability possible determine user chosen exercise authority held responsible discretionary choice limit set security security objective principle objective common prerequisite user cation verify user correctly identi ed reliable user identity way enforce restriction user retrieve modify information way record availability relies tication way determine user bona administrator way control use command shut increase chance objective achieved signer useful guiding set principle speci c overall perspective sketched earlier speci c individual technical measure ples came prominence paper saltzer schroeder date following list largely echo saltzer schroeder economy mechanism simple design consistently use small number general mechanism likely secure ample chapter point processing infrastructure likely secure individual ad hoc mechanism atomicity default security designed withhold access default go wrong granting authority result little authority make problem likely xed legitimate user complain example chapter microsoft anism resolving icts acl entry mechanism governs case entry say allow permission say deny kernel give precedence whichever entry listed rst api used gui give precedence denying permission complete mediation ideally access checked ity process allowed continue accessing resource just authority checked earlier point ple chapter change ibm deriving design original design used acls decide grant capability allowed capability retained used reference acls chapter security revised design cause acls record authorization checked consistently open design secret part security mechanism cryptographic key password design inspected party possible increase chance weakness ing light example chapter description openly standardized cryptographic algorithm particular chapter mentioned algorithm weak able warning public scrutiny received separation privilege individual authorized carry particularly sensitive task instead signed authorized user need collaborate bene t defends corruption person position authority privilege process operate authority need adversary make wrong process execution kind damage ca chapter described case adversary exploited time check time use tocttou vulnerability trick mail delivery program writing sensitive le highlighted failure use proper synchronization resulting vulnerable race condition equally point mail program failure honor principle privilege mail program needed authority write user mail le authority write le whatsoever unix provided easy way grant just requisite authority given way vulnerability rendered far dangerous psychological acceptability security mechanism ciently user interface used correctly example graphical user interface microsoft window vides acls shown chapter pointed user interface design includes feature hiding unnecessary plexity work factor just reason cost bene t security countermeasure reason adversary t make sure breaking security objective principle take time trouble worth example discussion cryptographic key length chapter key completely secure gured trial error usual key length adversary resource necessary nd key way compromise recording security breached information breach recorded fashion allows appropriate technical legal response mounted important example principle described chapter use network intrusion detection system defense depth adversary need penetrate multiple pendent defense able compromise functioning example chapter suggested use multiple rewalls hardware rewalls organizational workgroup perimeter software rewall desktop machine alignment authority control person control process supply authorization credential process action chapter described risk trojan horse program combine executor authority author control setuid program combine ecutors control author authority network server program problem similar setuid program low anonymous individual internet degree control action using local user authority physical security owner control physical access computer equipment unencrypted data example ter disk drive protected physical theft erwise dentiality ensured example visited organization business printing mailing lot check individual shock computer room wide open threat integrity dentiality adversary exploit physical access change list recipient attractive proposition leaving section generality diving technical speci c want return topic adversary adversary outside organization inside way exploit nical vulnerability misuse authority granted engage chapter security social engineering tricking greater authority cooperating reason generally use word adversary alternative term intruder cracker word intruder implies external adversary cracker implies us technical mean largest danger use term blind signi threat example protecting tion network perimeter ne defense adversary occasionally adversary intruder cracker priate hacker contrary common usage decade cracker word meant deep creative relationship system nologies taken granted today developed people described hacker today longer dare person hacker outside knowledgeable circle fear derstood just longer use word traditional sense doe mean use cracker user authentication probably familiar user authentication basic form logging computer using password start session usage authentication mechanism su er potentially weakness authentication take place beginning session computer best know seated keyboard attempt notice walked away taken place identify using intangible edge password discourage sharing need knowledge let steal password depriving drawing attention example written password adversary copy leave user authentication password used time log observes using reuse true ically observe typing known shoulder sur ng use technical mean capture password covert software computer typing keylogger network packet capture program sni er use network encryption prevents technique password easy remember case probably easy adversary guess wrote exposing addition pitfall unavoidable common actual password system type password computer having rst authenticated fall prey ingattack adversary set fake capture password present real check password comparing copy stored exposure storage reveal password probably choose password di erent system like people use password di erent system mean weakness security use stored password spread long list weakness sure security cialists devised mean authentication discus section nonetheless rst like explain make best password authentication widely used start avoidable weakness listed cently spoo ng storing password choosing password system password capture using spoo ng phishing form spoo ng attack write program put correct image screen look like prompting password come computer chapter security see look like login screen enter information recorded program program avoid detection displaying realistic error message logging returning genuine login window defend version spoo ng attack need genuine login window authenticate user program microsoft dows gured approach requiring user press key combination start login reason crosoft chose combination window allows programmer draw screen respond key combination particular key combination long window running sure responded window spoo ng program hitch spoofer installed software run window defend need use physical security important reason style spoo ng problematic lately website set look like site really business capturing password user directed fake site using sophisticated network manipulation commonly simply tricked accessing using misleading email message technique known phishing important countermeasure case user education user need credulous email receive technical dimension problem web ing described chapter ssl protocol used encrypted web communication allows browser verify identity web server using certi cate spoo ng likely type password web page authenticated way unfortunately website designer conditioning user ignore principle website use connection display form user type password form submits information using ssl designer probably think cause actual password transmission unless user look html source web form way sure password sent protect spoo ng login form sent using ssl way user seen server authentication typing user authentication checking password storing avoid storing password use cryptographic hash tion function described chapter recall function designed easily invertible practice essentially input produce output feed newly chosen password hash function store hash value user try log feed pro ered password hash function compare resulting value stored hash code shown figure hash code equal practical purpose sure correct password entered stored hash value disclosed recover password trial error cost user convenience support function password new password setting reasonable price pay password multiple independent system principle easily avoid problem stemming using password multiple system just need train pick password shopping sleazy sam super saver site use guard employer dential record practice picking new password lead unmemorizable array di erent password password general category active area development today ispassword wallet system store range password tection master password stored password constitute security vulnerability vulnerability hopefully severe alternative technique help user cope multiple system make use master password doe use protect storage individual password instead individual password generated rithmically master password site name advantage compared password wallet need stored client machine disadvantage easy way change master password authentication designed operated avoid pitfall ing password storage password reuse relies chapter security passwordstorage hash code indication login succeedsuser setting password h passworduser trying log h figure store cryptographic hash password set compare hash attempted password hash function equal hash mean password surely correct hash function invert disclosure stored hash code reveal user authentication login sole authentication method possess mental vulnerability listed earlier overcome user education mitigated way example designed issue password pas phrase random guess constructed real syllable word easily example psychological acceptability avoid problem user walking away demand reentry password particularly sensitive operation ciently long period inactivity countermeasure password threat valuable leave desired turn authentication method relying authorized user know word authentication mechanism rely user cally possesses card small device physical device generically called token big problem token lost stolen normally combined password provide authentication authentication combine di erent source information way achieve authentication combining password token ric authentication recognition physical attribute user ngerprint retinal pattern familiar authentication used bank automated teller machine atm insert swipe card type personal identi cation number pin sentially short password card use magnetic stripe opposed integrated circuit weak token carry xed formation engaging cryptographic authentication protocol easily copied atm application provide security continue used stem aspect design limit money customer withdraw day important di erence biometric authentication technique inextricably tied actual human identity account issued person known pseudonym possible ascertain true identity user contrast biometric authentication user initially enrolled presenting proof true identity passport user identity later deduced matching ngerprint biometric record vantage disadvantage highest standard chapter security necessary advantageous cut personal privacy purpose pseudonymity desirable people dissociate portion life unrelated earlier portion user log using biometric authentication physical device scan user ngerprint attribute transmits digitally coded version scan computer checking attacker capture digital version later replay security breached just case password captured played crucial di erence user issued new password new ngerprint design ric authentication need particularly resistant replay attack biometrics used identi cation authentication user physical attribute play role username ing speci c user password providing evidence selected user actually present biometric identi cation harder problem biometric authentication requires searching entire database biometric information information speci c user broader search space increase chance ror reliable system require user enter identi er textual username access control chapter brie y distinction discretionary access control dac creator object termine access right mandatory access control mac organizational policy directly governs access right chapter went depth capability access control list acls mechanism commonly used implement dac fore focus mac order round picture mac policy mechanism geared protecting dentiality information national security system formal policy regarding ow information predated duction computer system discussion section based policy united state government published literature general principle apply equally ilar system information classi cation user clearance access control discussing government classi cation system brie y remark currently popular application commercial web server goal limit damage attacker achieves control web server united state military sponsored research particularly early goal allowing single computer shared principal operating data varying sensitivity running program written author fully trusted sort known security ml context technical security mechanism enforce ow control access control protect sensitive information indirect disclosure direct access unauthorized principal appreciate need ow control ml consider simplest possible handling information ferent level sensitivity suppose object containing information labeled hand containing sensitive information labeledl principal hclearance read modify object lclearance readlobjects far access control granting class principal access speci c object consider requirement untrusted program run hprincipal allowed copy data hobject lobject lprincipal retrieve ideally program leak information way challenging requirement summarize requirement saying information initially contained anhobject ow lprincipal mean theluser accessing object real ml system handle category information information categorized way overall classi tion level indicating degree disclosure damage national security united state classi cation level used ed dential secret secret technically unclassi ed classi cation level handled like level lowest true classi cation level dential second compartment indicate topic nuclear weapon international terrorism principal cleared access data way secret si cation limited speci c compartment nuclear weapon object labeled exactly classi cation level labeled set compartment example document concern acquisition nuclear weapon international chapter security figure show kind label form partially ordered set figure show combining result partially ordered set known mathematically cartesian product partial order element ordered relative withx y ory x unordered example figand fhgare unordered subset security application principal clearance pi allowed view information labelionly condition known pdominating iin partial order rule disclosing information principal low clearance level cleared necessary compartment untrusted subject process running untrusted program read object label modi e object unauthorized information ow result unless information allowed ow object consumer directly accessed source information strictly speaking information ow result modi cation accessing modi cation based onthe earlier access extremely test earlier access uence later modi cation particular earlier access subtle uence later modi cation occurs overt uence nature possible later modi cation practical ml system generally simpler conservative approach forbidding subject modifying object doe dominate previously accessed object security label partial order ow control policy known lapadula model mitre corporation researcher oped early key idea model associate subject current level chosen principal running subject process current level dominated pal security clearance lower partial order principal chooses exibility run lower current level allows principal run subject modify object subject read object subject restriction enforced rule based formal property spelled la padula original publication cited way note bibliography section use spelling lapadula consistency published description lapadula current spelling access control t s c u n h n h n h n h figure classi cation level secret t secret s dential c unclassi ed u form total order shown left set compartment hand form partial order subset order set compartment subset compartment illustrated right hypothetical compartment nuclear weapon n international terrorism human intelligence h cleared fi hg example read document labeled fi hg fig fhg orfg t n h s n h c n h u n h t n s n c n u n u u n u figure forming cartesian product partial order figure result partial order element pair classi cation level t s c u set compartment ranging fn hgdown tofg element shown order clutter diagram note diagram nition ordering cartesian product pair level dominates level level chapter security bell lapadula mathematical model follows subject running current level cmay read object levelrsuch thatcdominatesr corresponds bell lapadula simple security property subject running current level cmay modify object levelmonly ifmdominatesc rived bell lapadula pronounced prevents untrusted program transferring information inappropriate object order rule e ectively regulate information ow model includes tight restriction subject change current level practical system current level selected principal log left unchanged principal log gain appreciation role untrusted subject model considering principal simultaneously logged adjacent terminal set high current level high principal allowed set low current level unclassi ed compartment human principal display highly sensitive material terminal type unclassi ed le untrusted subject process running untrusted program information transfer idea human principal granted clearance providing evidence trustworthiness principal monitored detect suspicious meeting excess cash sign corruption author untrusted program hand reach monitoring group principal reading leaked data large monitor mandatory access control variety bined discretionary access control using mechanism access control list fact bell lapadula recommended underlying security principle possessor sitive information ought disclose principal appropriately high clearance level speci c need know compartment provide crude approximation ciple people cleared particular compartment need know speci c document compartment fore wise owner object ability restrict access using acl unlike pure dac virus worm restriction serve ne access limit set simple security cleared subject denied cess lack appropriate acl entry adding acl entry grant access subject running inappropriate current level simple security trusted subject completely stopped leaking sensitive formation leaking information le network connection legitimate storage communication object ject disclose sensitive information way covert channel covert channel mechanism intended used communication manipulated subject observed achieving communication example subject cess highly sensitive information varied demand placed cpu disk based sensitive information subject run lower clearance level able detect change utilization complete protection covert channel impractical process resource utilization tightly controlled risk reduced moving outside area military classi cation level currently popular mac linux selinux version linux kernel quite exible enforce wide variety rule regarding object subject read write object tagged type label generalization classi cation level compartment subject assigned domain generalization clearance level popular guration tag le containing web page speci c label assigns apache web server domain allowed read le write read le way attacker exploit bug web server obtain control make execute arbitrary code leak dential information damage integrity example principle privilege virus worm model selinux illustrate security mechanism need limit action user program limiting program action important control untrusted programmer exploitable bug allow misused section address particular kind adversarial program malware pose especially chapter security security threat common feature virus worm guish kind malware trojan horse action programmed propagate system adversary e ectively attack er internet directly connecting attacking initial system programming attacked similarly attack sheer ubiquitousness virus worm constitute signi threat worm virus strive replicate di erence virus act modifying existing program adversary hope copied system executed modi ed program run inserted viral code original legitimate code viral code propagate program infected carrying action programmed perform worm hand doe modify existing program instead directly contact target exploit security vulnerability order transfer copy start copy running worm programmed action mere propagation propagation signi problem carried fast possible rapid propagation worm copy constitute attack virus greater problem day major tion channel personal computer diskette internet dominant worm common form malware earlier prominence virus people inaccurately use word virus refer worm vulnerability human intruder exploit principle exploited worm order propagate historically example worm used password guessing mentioned chapter email worm common today worm arrive email tachments run unwary user mean worm propagation come exploitation bu ow ability explain common chink system defense program read input contiguous block virtual memory known bu er rst byte input go rst byte bu er second second forth program cates bu er allocating progressively larger one input arrives case programmer test input size bu er defensive action unreasonably large input presented virus worm wise ow bu er unfortunately programmer perennially omit checking adversary perennially able nd program presented unusually large input try write input data address end bu er particularly problematic network server program provided input adversary internet consequence bu er ow depend heavily ming language implementation operating computer ture modern language java attempt write past end array detected detected error cause attacked server program crash case victory sary minor compared damage adversary exploiting bu er ow program written using primitive technology typical implementation programming language setting extra input data written address yond end bu er overwriting data assigned later address possible tactic adversary use look server program bu er followed particularly sensitive variable boolean ag indicating password successfully checked bu ow exploit typically di erent approach allows adversary inject entirely new instruction process execute ordinarily contain way server process action whatsoever limit authority granted extreme example misalignment authority control understand bu er ow lead execution trary code need consider fact typical runtime stack described appendix program variable bu er allocated space stack stack typically contains return address procedure invocation address instruction executed procedure invocation return stack grows downward virtual memory expanding higher address lower one return address follow bu er shown figure circumstance arises popular architecture bu er ow overwrite data value shown figure b overwrite return address shown figure c form bu er ow commonly called smashing stack current procedure invocation completes overwritten return chapter security stack frame procedure processing inputstack frame calling procedure caller s caller forth input bufferreturn address value value free spacestack frame calling procedure caller s caller forth long input exceeds buffer sizereturn address overwritten value value free spacestack frame calling procedure caller s caller forthstack layout attack attack b c attack codeaddress attack code overwritten value value free space figure input shown grey allowed ow memory allocated stack input bu er overwrite data value shown b return address shown c case modi ed return address point attack code included oversized input cause processor jump ed instruction address allow adversary choose existing code execute taken factor provides mean execute code provided adversary architecture operating system provide virtual memory anisms allow page virtual memory independently protected allow distinction reading data fetching instruction circumstance page ing stack need readable data contain executable extremely program legitimately write instruction stack jump adversary exploit situation writing large input ows bu er overwrites return address contains byte constituting adversary choice machine language instruction machine language instruction labeled attack code figure c overwritten return address used jump bu er executing provided instruction exploit prevalent considerable terest recently modifying virtual memory mechanism allow security assurance space readable writable executable niques preventing malware entering major measure use antivirus scanning program commonly scan worm program look distinctive pattern byte known signature known virus worm scanner need frequently updated signature newly emerging threat security assurance organization directly uence system security ner system installed operated design component developed organization exercise indirect control choosing procure component vendor demonstrate component suited organization need section explain kind security assurance provided vendor interpreted consumer component question operating middleware tem network device rewall intrusion detection security assurance eld referred target evaluation toe assurance derives independent evaluation toe satis e stated security requirement assurance product governed tional standard called common criterion developed harmonize previously independent national standard common ria known international standard organization number iso common criterion ne process dor contract quali ed independent assessor evaluate product meet set security requirement known security target st st individual requirement document speci c lar product evaluation speci c toe consumer easily compare product sts share common basis sts built modular fashion common group quirements published group requirement intended used basis multiple sts called protection pro le pp just sts built standard pps pp assembled ing standard menu potential requirement extra custom chapter security ments added stage bulk st requirement come standard list way standard pps consumer better position learn way landscape potential requirement critical product certi ed independent assessor meet st worthless st doe contain requirement appropriate particular consumer need requirement contained pps sts fall general egories functional requirement assurance requirement example functional requirement mandate spoo login method microsoft window satisfy requirement using example assurance requirement mandate detailed design document testing report sample code reviewed outside evaluator assurance requirement summarized numerical evaluation assurance level eal range example st based contain moderately rigorous demand regarding evidence actually meet functional requirement ordinary good development practice outside rity eld speci c assurance practice need incorporated development process including sively increasing use semiformal formal method figure give brief rubric eal taken common criterion documentation eal includes package sophisticated assurance requirement eals easily understood comparative way eal stricter make tempting focus eals need remember eal strict eal rubric functionally tested structurally tested methodically tested checked methodically designed tested reviewed semiformally designed tested semiformally veri ed design tested formally veri ed design tested figure table show brief rubric common criterion ation assurance level expanded description available common criterion security monitoring tell thorough job vendor demonstrating toe meet functional requirement tell demanding functional requirement importantly eal tell matched requirement need example microsoft contracted common criterion evaluation particular version window relative st included assumption network connection equally secure system management authorized user cooperative adversarial gave indication fare confronted adversary user population internet issue arise functional requirement st completely independent eal figure show relevant language microsoft weakness small excerpt particular st leave wondering value common criterion process lesson away common criterion process worthless relies educated consumer bene t process need understand vocabulary di erence eal security monitoring operator reason monitor attack successful unsuccessful gaining better understanding adversary behavior develop better countermeasure putting adversary notice gather evidence allow successful prosecution punishment deter attack tends work better adversary organization adversary internet coordinate advance legal counsel appropriate policy notice quickly detecting successful attack limit damage obtaining accurate information extent damage avoid overly aggressive response reinstalling software uncompromised system overly aggressive response chapter security system toe communicates assumed management control operate security policy constraint toe applicable networked distributed ronments entire network operates constraint resides single management domain security requirement address need trust external system communication link system user possess necessary authorization access information management sic toe expected act cooperating manner benign environment figure excerpt window security target st version october prepared microsoft corporation science application international corporation time money require downtime overly aggressive response magni e damage attack reason security professional active developing monitoring technique mentioned chapter network intrusion detection system idses summarize include robust logging facility integrity checking software honeypot intrusion detection system best thought anomaly tectors network idses gured spot anomalous result adversary internal network intruder id somewhat misleading id look speci c attack signature respond deviation past pattern activity example normally quiet desktop machine start spewing udp datagrams maximum rate network carry infected sql slammer worm id signature speci c worm ought raise warning sudden anomalous event detected internal particular network example operating programmed note repeated failed attempt log security monitoring istrator constitute particularly dangerous attack worthy notice unsuccessful sort anomaly routinely logged system chronological event log used reconstruct fact serving source drive alert biggest technical challenge successful attack adversary necessary access privilege clean log covering trace attack system use logging device log entry sent network centralized logging server monitoring approach periodically check integrity guration program modi ed successful attacker frequently modify program guration le door second way use initial vulnerability xed periodic check turn sign successful previous check stealthy unnoticed addition periodic check integrity checking come notice mean integrity checking administrator little choice treat compromised scrub clean reinstall scratch integrity checking allows successful attack detected guide mounting appropriate response example integrity monitoring tripwire basic principle operation cryptographic hash critical le computed stored database cd writable tripwire program stored form check copy tripwire recomputes cryptographic hash compare stored copy integrity checking need program attacker frequently install modi ed version program hide corruption example attacker install version psthat hide attacker process version lsthat show p andlsprograms unmodi ed kind camou age commonly called root kit nal form security monitoring mention use pot honeypot decoy used speci cally monitor adversary gured appear realistic possible used uinely valuable purpose monitoring subject extreme clandestine monitoring fully record adversary behavior tip o legitimate user reason connect chapter security honeypot monitoring anomaly detection ltering needed distinguish legitimate attack letting adversary immediately repelling attack learn attack technique yond initial connection learn vulnerability need repair system countermeasure need adversary allowed eypot thoroughly rewalled outbound attack provide mean launch attack system human monitor honeypot continuously ready intervene consideration help explain honeypot quite vogue best left large organization experienced security professional smaller organization bene t honeypot largely provide epidemiological evidence worm circulating serve internet community key security best practice appropriate security practice depend factor including defending home computer employer engaging custom development procuring installing guring operating existing system attempt uni ed list best practice ing applicable context everybody home user read website sans sysadmin audit network security institute http organization hire reputable sultants engage conversation legal counsel responsible noncomputer security human resource partment holistic perspective consider lose adversary gain likely adversary caught punished factor manipulable inherent vulnerability rewalls make sure correctly gured best approach combine hardware rewalls guarding key security best practice workgroup perimeter software rewalls guarding ual machine home use approach nat router serving hardware rewall software organization software scan incoming email risk individual client machine fail scan individual client machine protection defense depth particular guard infection sneak past network perimeter carried portable computer storage device software date includes ware operating application software exposed data network today includes nearly id integrity checking software tripwire robust logging platform step practical typical home user network communication vulnerable use cryption relying security network infrastructure principle applies storage medium physically shipped location user authentication described section physical security computer equipment vigilant service personnel extraordinary physical access stay good term employee cleanly hiring particularly sensitive position administrator candidly disclose ing background establish realistic expectation encourage people work night weekend employee vacation clearly communicate policy acceptable use monitoring phone call email originate storage medium arrive mail courier critical patch need install chapter security artist true agent member organization upper management cooperative preclude taking minute politely rm identity authority closely case user authority exercised process user control process action possible run program untrusted source failing run possible authority est possible monitoring need write setuid program check carefully doe user input bu er ow input interpolated shell command lowed exert control did programmer insert intentional particular input trigger program bypass normal security control tocttou race program owned user account granted necessary authority erally review principle listed section examine program communicates network cording exact standard setuid program exercise certain individual ying commercial airliner list maintained airline check issuing boarding pas pas issued web airport pas presented human airport fying document human us computer technology check pas match identifying document photo identifying document match ance person presenting check perimeter secured portion airport admission condition assume identifying document hard forge getting past perimeter control going check adversary admitted secure area despite y list key security best practice b vulnerability identi ed explained inattention security principle listed section c design countermeasure deter exploitation vulnerability identi ed use additional computer technology help sacri cing desirable property current organization check preprinted statement check require handwritten signature smaller check valid printed signature explainable term general principle security enumerated section section contains long list general security principle following audience suppose time explain principle explain software developer designing programming new system b information technology sta purchasing guring administering system c chief information executive supervising group weakness password security ministrator user turn forgetting password administrator ability reset password person gulled artist tell pitiful tale woe ting password rst authenticating user alternate manner example using photograph id card general category threat example b human sta ca stopped resetting password like programmed print letter acknowledging password change mailed ordinary postal mail registered address user enhance security prevent adversary obtaining access authentication chapter security blank web form lled password downloaded browser ssl using ssl send form server draw following partially ordered set based subset ordering set compartment figure page using n ments b cartesian product answer total ordering offt s c ug unlike figure page element left figure show cartesian product element partial order shown figure page element labeled security classi cation level set compartment instead shown just cles label circle shown black note diagram arranged di erently excerpt figure page expect nd element position using model compartment fn hgand classi cation level ft s c ug following statement true subject current level c compartment n h read object level c compartment n b subject current level c compartment n h read object level c compartment figure unlabeled version cartesian product partial order shown figure page key security best practice c subject current level c compartment n h read object level c compartment n d subject current level c compartment n h read object level c compartment n e subject current level c compartment n h read object level s compartment n f subject current level c compartment n h read object level s compartment g subject current level c compartment n h read object level s compartment n h subject current level c compartment n h read object level u compartment subject current level c compartment n h write object level c compartment n j subject current level c compartment n h write object level c compartment k subject current level c compartment n h write object level c compartment n l subject current level c compartment n h write object level c compartment n m subject current level c compartment n h write object level s compartment n n subject current level c compartment n h write object level s compartment o subject current level c compartment n h write object level s compartment n p subject current level c compartment n h write object level u compartment model condition subject read object modify object contain new information derived old model important principal run subject current security level principal cleared chapter security model subject running high current level read object labeled lower level lock block subject running lower level writing object explain compromise design goal model virus historically problem primarily system designed little regard principle privilege explain expected mind distinction virus worm common criterion assessment includes inspection design code documentation intended administrator user relevant explain di erence common criterion pp st eal certi ed high eal necessarily secure certi ed low eal explain distinguish honeypot idses code network server program audited rect processing received input way setuid program processing user input audited section point user authentication vulnerable user walking away replaced keyboard adversary section indicates vulnerability mitigated eliminated demanding reentry password appropriate moment explain vulnerability thoroughly gated using appropriately designed token b explain vulnerability eliminated using ric authentication programming project write program run string fewer lowercase ters library implementation report key security best practice program take detail hardware software context approximately replicate result consider shown figure page hash function point increase adversary work factor stored value disclosed based experiment indication work factor increase given assumption user pick password sort program checked sort circumstance increase work factor programming environment provide mean generating random number example java use class tems contain le list english word line example linux system doe le nd download web write program randomly chooses word letter long print hyphen tween serve passphrase example output example linux distribution word list contained word passphrases formed long random string lowercase letter need comparable number possibility memorizable exploration project user authentication system successfully attacked time usually generating publicity user question celebrity newspaper sit notice write summary failure involving paris hilton february source include article month brian mcwilliams macdev center article brian krebs issue washington post article cited note article contain contradictory information presumably taken grain salt nonetheless lesson draw designer authentication system user website http contains list chapter security security control correspond best tices listed chapter research write paper role trojan horse edly played unauthorized access cisco system unauthorized access lexisnexis seisint unit rst trojan horse reportedly version sshprogram second trojan horse reportedly masqueraded display nude photo teenage girl setting di erence aside commonality di erences nd way attack worked general lesson computer security gained incident unix linux system include program called sudo read documentation web http www write description program design ect principle explained chapter check website variety bank login form available http url http one document ndings using screen capture commercially available biometric system indicate provides identi cation authentication address space layout randomization doe help deter stack smashing attack bradley manning charged disclosing large volume classi ed information wikileaks write paper us publicly available information case illustrate general security ciples note single important source practical information security http number good book practical security matter gar nkel spa ord schwartz cheswick bellovin rubin northcutt et al broad treatment security anderson book highly key security best practice saltzer schroeder presented section general security principle tutorial paper paper described bilities access control list line chapter presentation important class security threat involves tricking imate user cooperating adversary stajano wilson analyzed method artist use example generates multiple password single master password described ross et al model described bell la padula series mitre corporation technical report early best summary later ed exposition published technical report sophisticated uential ow model published dorothy denning formal model surveyed landwehr problem covert channel described lampson important survey state security research published dorothy peter denning mentioned bu ow attack overwrite return address attacker instead arrange overwrite critical variable boolean ag used control access chen et al showed attack fact realistic currently popular defense place smashing attack alternate form attack likely gain ularity information common criterion available http www good overview introductory ment speci c st use illustration window used shapiro make similar point importance functional requirement exploration project mention user authentication failure ing paris hilton published account time included formation attack speci cally mentioned project assignment mcwilliams information attack shifted time project assignment mention article month later krebs chapter securityappendix stack compiler programming language produce language object code make crucial use stack stored puter memory stack used allocate space procedure called deallocate space procedure return space associated particular activation procedure called activation record reason stack called anactivation record stack stack runtime stack play central role runtime environment say supporting structure compiler expects present time object code run program written assembly language ally make use activation record stack assembly programmer normally write procedure following convention used compiler studied activation record stack course ming language compiler computer organization learned introductory computer science course previously studied topic appendix purpose understanding operating system need know detail activation record used need understanding stack space allocated order understand chapter explanation thread switching ground security issue discussed chapter section provide overview storage section explain storage represented using memory register section sketch used support procedure activation appendix stack storage concept like author writing computer system use word stack refer storage generalization simpler variety stack used mathematical study algorithm rst simpler kind stack explain storage go simple kind stack modi able object supporting tions push pop operation modi e stack state thought sequence value arranged chronological order according added stack new stack created doe hold value push operation add new value recent pop operation remove recent value return pop operation change stack state pop generally produce di erent result think pop returning recently pushed value popped value said stack note illegal pop stack example simple kind stack operates suppose new stack created value pushed order pop operation element returned pop operation longer stack second pop return pop illegal rst pop leave stack storage provides collection memory location individually loaded stored like element array collection location expand contract fashion explain operation available stack sense storage structure newly created stack start size zero underlying representation occupying memory space memory location valid loading storing stack point like array size stack expanded using allocate operation take parameter specifying new memory location available newly allocated memory location guaranteed located consecutive address allocate operation return smallest address location allocated block storage loaded stored using address calculated o set base address returned representing stack memory size stack decreased using deallocate operation parameter specifying number location removed storage managed fashion deallocate operation free recently allocated storage location deallocated storage location deallocated illegal use address loading storing normally size deallocation request match size responding allocation request example allocate location allocate deallocate nally deallocate remaining single deallocation request combine size allocation instance location preceding example deallocated complicated kind deallocation request free block memory location allocated case stack implementation need specify location partially deallocated block remain valid pursue issue relevant matter hand instead turn reality stack represented computer hardware representing stack memory standard representation stack large region consecutive ory location stack pointer register indicates location use size region chosen large stack normally ow virtual memory described chapter enforce limit expand size region necessary provided adjoining address use purpose allocated location stack end gion memory possibility allocated location occupy lowest address region allocation request expands stack upward higher address possibility allocated location occupy highest address region cation request expand stack downward lower address arrangement common practice assume remainder explanation stack pointer register indicates memory region use doe containing count location currently allocated holding address appendix stack allocated location location conceptually stack stack grows downward word misleading stack pointer contains numerically smallest memory address currently allocated location figure show stack allocating location stack pointer contains largest memory address region architecture stack pointer point free memory location allocated recently allocated location pointer location lower doe make signi di erence purpose book given representation allocate operation decrease stack pointer number location requested return new stack pointer value base address allocated block deallocate operation increase stack pointer number location freed example locating location figure leave stack pointer pointing address location remaining block storage point understand basic management stack space purpose space vide brief synopsis implementation make use stack space using stack procedure activation procedure call caller executes instruction jump beginning called procedure instruction store areturn address address calling procedure tion procedure way called procedure ready return jump return address resume execution calling procedure computer architecture di er store return address approach procedure instruction push return address stack approach used popular architecture known architecture implemented processor pentium family rst element procedure activation record return address pushed procedure instruction architecture mips procedure instruction place return address register called procedure doe using stack procedure activation stack block block free space figure stack grows downward occupying highest address region used store stack pointer point stack recently allocated block space example block size allocated stack pointer point location end memory region execute procedure call return return address remain register return instruction jump address stored register case procedure call procedure activation termed leaf approach return address doe rectly support nesting procedure activation called procedure turn calling procedure fourth support nesting chain return address needed procedure activation able return caller turn able return caller forth register hold return address simultaneously nonleaf procedure activation store return address register value activation record later retrieve result activation record hold return address architecture directly push return address stack rst place procedure activation need storage space local ables value arise course procedure tation storage register memory procedure call agreement regarding share register typically agreement speci e called procedure leave register way appendix stack containing value procedure return procedure entry calling procedure leave value register executes procedure register freely modi ed called dure calling procedure leave important value kind register likely saved stack called procedure promise leave register want use register storage reconcile ict saving register stack modifying restoring saved value returning caller know register temporarily modi ed approach known callee save callee save register activation record register callee overwrite compunction situation somewhat di erent register caller want save activation record caller save register procedure restores resumption approach known caller save architecture convention register preserved using approach using approach way procedure correctly interoperate detail matter purpose book matter activation record hold saved register stack natural place saving register thread switching described chapter value local procedure activation stored register example suppose procedure make use local array allocated procedure entered deallocated procedure return array stored memory array element accessed load store instruction lifetime array corresponds procedure activation array activation record chapter explain create security risk input read array checking input versus array size explain input run past end array overwrite part procedure activation record activation record caller caller caller forth potentially dangerous atul adya barbara liskov patrick generalized lation level nitions proceeding international ference data engineering page ieee computer society alfred aho peter denning je rey ullman principle optimal page replacement journal acm amd architecture programmer manual volume programming edition september publication dave anderson know jack disk queue dave anderson jim dyke erik riedel scsi ata proceeding annual conference file storage technology fast usenix march ross anderson security engineering guide building able distributed system wiley edition apple computer kernel programming inside mac o x apple computer hf plus volume format technical note apple computer march ozalp babaoglu william joy converting paging architecture lacking bit ings eighth acm symposium operating system principle page acm press gaurav banga peter druschel je rey mogul resource tainers new facility resource management server system bibliography proceeding symposium operating system design implementation page usenix bayer mccreight organization maintenance large ordered index acta informatica belady study replacement algorithm virtual storage computer ibm system journal belady nelson shedler anomaly time characteristic certain program running paging machine communication acm bell la padula secure computer uni ed exposition multics interpretation technical report mitre march bensoussan clingen multics virtual memory cepts design communication acm hal berenson phil bernstein jim gray jim melton elizabeth patrick critique ansi sql isolation level inproceedings acm sigmod international conference management data page acm press philip bernstein middleware model distributed service communication acm philip bernstein nathan goodman concurrency control distributed database system acm computing survey philip bernstein nathan goodman multiversion concurrency algorithm acm transaction database tems philip bernstein eric newcomer principle transaction processing morgan kaufmann publisher viktors berstis security protection data ibm inproceedings annual symposium computer ture page ieee computer society press mike blasgen jim gray mike mitoma tom price convoy phenomenon sigops operating system review daniel bobrow jerry burch el daniel murphy mond tomlinson tenex paged time sharing communication acm brinch hansen structured multiprogramming communication acm brinch hansen monitor concurrent pascal personal tory second acm sigplan conference history programming language page new york ny usa acm press burroughs corporation descriptor nition information processing bulletin sale cal service equipment system marketing division detroit michigan february byers luby mitzenmacher digital fountain proach asynchronous reliable multicast ieee journal selected area communication october calin cascaval colin blundell maged michael harold cain peng wu stefanie chiras siddhartha chatterjee software tional memory research toy communication acm november abhishek chandra micah adler pawan goyal prashant shenoy surplus fair scheduling cpu scheduling rithm symmetric multiprocessor proceeding fourth symposium operating design implementation osdi page usenix je rey chase henry levy michael feeley edward lazowska sharing protection ing acm transaction computer system peter chen edward lee garth gibson randy katz david patterson raid reliable secondary storage acm computing survey bibliography shuo chen jun xu emre sezer prachi gauriar shankar iyer attack realistic threat usenix security symposium page william cheswick steven bellovin aviel rubin wall internet security edition codd lowry mcdonough scalzi gramming stretch feasibility consideration communication acm november man elphick shoshani deadlock acm computing survey elli cohen david je erson protection hydra operating proceeding fifth acm symposium operating system principle page acm press douglas comer ubiquitous acm computing survey fernando o marjorie merwin daggett robert daley experimental proceeding spring joing computer conference page spartan book courtois heymans parnas concurrent control communication acm creasy origin ibm journal research development september daley neumann le secondary storage proceeding afips fall joint computer ference volume page spartan book robert daley jack dennis virtual memory process sharing multics communication acm dorothy denning lattice model secure information ow munications acm dorothy denning peter denning data security acm computing survey peter denning working set model program behavior munications acm peter denning virtual memory acm computing survey jack dennis segmentation design multiprogrammed computer system journal acm jack dennis earl van horn programming semantics multiprogrammed computation communication acm dijkstra solution problem concurrent programming control communication acm edsger dijkstra cooperating sequential process published manuscript identi ed edsger dijkstra cooperating sequential process genuys editor programming language nato advanced study institute page academic press edsger dijkstra hierarchical ordering sequential process operating system technique page academic press cort dougan paul mackerras victor yodaiken optimizing idle task mmu trick proceeding sium operating system design implementation page usenix aleksandar c pascal felber vincent gramoli rachid guerraoui stm research toy tions acm april zakir durumeric michael bailey alex halderman wide view scanning usenix security posium usenix security page san diego ca august usenix bibliography eswaran gray lorie traiger notion consistency predicate lock database tions acm fabry addressing communication acm renato figueiredo peter dinda e fortes et al special issue virtualization technology computer john fotheringham dynamic storage allocation atlas puter including automatic use backing store communication acm gregory ganger marshall kirk mckusick craig soules yale patt soft update solution metadata update problem le system acm transaction computer system simson gar nkel gene spa ord alan schwartz practical unix internet security edition gray note data base operating system bayer graham uller editor operating system advanced course chapter page originally published lecture note computer science vol jim gray transaction concept virtue limitation proceeding seventh international conference large datatabases page september jim gray raymond lorie gianfranco putzolu irving traiger granularity lock degree consistency shared data base ifip working conference modelling data base management system page reprinted reading database system ed michael stonebraker morgan kaufmann lishers jim gray paul mcjones mike blasgen bruce lindsay raymond rie tom price franco putzolu irving traiger recovery manager r database manager acm computing veys jim gray andreas reuter transaction processing concept technique morgan kaufmann publisher peter gutmann secure deletion data magnetic memory sixth usenix security symposium page habermann prevention deadlock communication acm theo haerder arder andreas reuter principle oriented database recovery acm computing survey tim harris james larus ravi rajwar transactional memory morgan claypool publisher edition tim harris simon marlow simon peyton jones maurice lihy composable memory transaction communication acm august michael harrison walter ruzzo je rey ullman tion operating system communication acm havender avoiding deadlock multitasking system ibm system journal joseph hellerstein achieving service rate objective cay usage scheduling ieee transaction software engineering august thomas herbert linux stack networking bedded system charles river medium maurice herlihy nir shavit art multiprocessor ming morgan kaufmann publisher dave hitz james lau michael malcolm file design nfs le server appliance usenix technical conference page hoare monitor operating structuring concept communication acm october bibliography gregor hohpe bobby woolf enterprise integration pattern designing building deploying messaging solution wesley richard holt deadlock property computer system acm computing survey merle houdek glen mitchell hash index help manage large virtual memory electronics march merle houdek frank soltis roy ho man ibm support addressing proceeding annual symposium computer architecture page ieee computer society press jerry huck jim hay architectural support translation ble management large address space machine proceeding annual international symposium computer architecture page acm press intel corporation intel itanium architecture software developer manual edition october eike jeseen misspelling jessen origin virtual memory concept ieee annals history computing october december kay lauder fair share scheduler communication acm january tim kempster colin stirling peter thanisch diluting acid sigmod record kessler mark hill page placement algorithm large cache acm transaction computer system november kilburn edward lanigan sumner storage ire transaction april donald ervin knuth art computer programming volume fundamental algorithm edition alex kogan erez petrank queue multiple queuers dequeuers proceeding acm symposium principle practice parallel programming ppopp page new york ny usa acm alex kogan erez petrank methodology creating fast free data structure proceeding acm sigplan posium principle practice parallel programming ppopp page new york ny usa acm brian krebs paris hilton hack started washington post http james kurose keith ross computer networking approach featuring internet edition butler lampson note nement problem cation acm butler lampson howard sturgis crash recovery tributed data storage paper circulated draft published material appeared distributed implementation ed lampson paul siegert lecture note computer science springer page page june carl landwehr formal model computer security acm puting survey nancy leveson clark turner investigation accident computer july henry levy peter lipman virtual memory management operating computer march tong li dan baumberger scott hahn scalable multiprocessor fair scheduling using distributed weighted sigplan notice february theodore linden operating structure support security reliable software acm computing survey bibliography tim lindholm frank yellin java virtual machine speci cation edition liu james layland scheduling algorithm programming environment journal acm january mattson gecsei slutz traiger evaluation technique storage hierarchy ibm system journal marshall kirk mckusick george design implementation freebsd operating brian mcwilliams paris got hacked macdev center february http john michael scott algorithm able synchronization multiprocessor acm action computer system february meyer seawright virtual machine ibm system journal maged michael hazard pointer safe memory reclamation object ieee transaction parallel distributed tems june juan navarro sitaram iyer peter druschel alan cox practical transparent operating support superpages proceeding symposium operating system design tion osdi page usenix needham walker cambridge cap computer protection proceeding sixth acm symposium operating system principle page acm press stephen northcutt lenny zeltser scott winter karen kent ronald ritchey inside network perimeter security sam edition ruoming pang vinod yegneswaran paul barford vern paxson larry peterson characteristic internet background radiation inbibliography imc proceeding acm sigcomm conference ternet measurement page acm press parmelee peterson tillman hat eld virtual storage virtual machine concept ibm system journal john pomeranz note anomaly paging communication acm sean quinlan sean dorward venti new approach archival storage proceeding conference file storage nologies page usenix association randell note storage fragmentation program tion communication acm john regehr inferring scheduling behavior hourglass proceeding usenix annual technical conference freenix track page monterey ca june dennis ritchie ken thompson unix tem communication acm july kay robbins steven robbins unix system programming communication concurrency thread prentice hall ohad rodeh shadowing clone acm transaction storage february mendel rosenblum john ousterhout design plementation le acm transaction computer system daniel rosenkrantz richard stearns philip lewis ii level concurrency control distributed database system acm transaction database system blake ross collin jackson nick miyake dan boneh john c mitchell stronger password authentication using browser extension usenix security symposium page bibliography larry rudolph zary segall dynamic decentralized cache scheme mimd parallel processor proceeding annual national symposium computer architecture page new york ny usa acm mark russinovich david solomon microsoft window ternals microsoft window server window xp window microsoft press edition jerome saltzer protection control information sharing multics communication acm jerome saltzer michael schroeder protection formation computer system proceeding ieee september douglas santry michael feeley norman hutchinson tair veitch ross carton jacob o deciding forget elephant le proceeding seventeenth acm symposium operating system principle page acm press science application international corporation window curity target technical report microsoft corporation october st version seawright mackinnon study plicity usefulness ibm system journal lui sha ragunathan rajkumar john lehoczky priority heritance protocol approach synchronization ieee transaction computer september lui sha ragunathan rajkumar shirish sathaye generalized scheduling theory framework developing time system proceeding ieee january jonathan shapiro understanding window evaluation computer february frank soltis design small business data processing ieee computer september frank soltis inside duke press edition craig soules garth goodson john strunk gory ganger metadata versioning le system proceeding conference file storage technology page usenix association frank stajano paul wilson understanding scam victim seven principle system security technical report university cambridge computer laboratory august inary extended vesion frank stajano paul wilson understanding scam victim seven principle system security communication acm march updated abridged vesion richard stearns daniel rosenkrantz distributed database concurrency control using proceeding acm sigmod international conference management data page acm press richard stevens illustrated protocol volume richard stevens stephen rago advanced programming unix environment edition adam sweeney doug doucette wei hu curtis anderson mike moto geo peck scalability xfs le usenix technical conference page syntegra common criterion introduction http talluri hill khalidi new page table address space proceeding fifteenth acm symposium operating system principle page acm press madhusudhan talluri use superpages subblocking dress translation hierarchy phd thesis computer science ment university wisconsin madison technical report andrew tanenbaum computer network prentice hall ptr edition bibliography ken thompson ections trusting trust communication acm august turing award lecture shahar timnat erez petrank practical simulation data structure proceeding acm plan symposium principle practice parallel ming ppopp page new york ny usa acm rollins turner henry levy segmented fifo page replacement inconference measurement modeling computer system page acm press carl waldspurger memory resource management vmware esx server proceeding symposium operating system design implementation page december carl waldspurger william weihl lottery scheduling ible resource management proceeding symposium operating design implementation osdi page carl waldspurger william weihl stride scheduling ministic resource management technical randum laboratory computer science sachusetts institute technology robert watson jonathan anderson ben laurie kris naway capiscum practical capability unix usenix security symposium page gerhard weikum gottfried vossen transactional information system theory algorithm practice concurrency trol recovery morgan kaufmann publisher john wilkes richard golding carl staelin tim sullivan hp autoraid hierarchical storage acm transaction computer system february avishai wool quantitative study rewall guration error ieee computer june wulf levin pierson overview hydra operating development proceeding fifth acm symposium operating system principle page acm press eric wustrow manish karir michael bailey farnam jahanian geo huston internet background radiation revisited proceeding acm sigcomm conference internet measurement imc page new york ny usa bibliographyindex abort access access control access control list access control discretionary access control mandatory access matrix access point accountability acid acknowledgment cumulative acknowledgment selective acl activation record activation record stack address resolution protocol address space identi er address space sparse address linear address physical address virtual addressable capability adleman leonard advanced encryption standard adversary adya atul aes processor alfred allocation delayed allocation resource anderson dave anderson jonathan anderson ross api application layer application programming interface application protocol arp asid associativity associativity set cryptography atlas atomic atomic transaction atomicity failure attribute metadata authentication authentication biometric authentication availability avoidance deadlock burroughs babaoglu ozalp index door banga gaurav barrier synchronization base priority batch processing baumberger dan bayer belady anomaly belady bell model bellovin steven berenson hal bernstein philip t bin hopping bind binding biometric authentication bitmap blasgen mike block group block map block indirect bound bounded bu er brinch hansen broker btrfs bucket hash bu er bu er bounded burroughs burst busy waiting byers cache bu er cache coherence coherence protocol cache memory callee save caller save canonical cap capability capability addressable capability posix capacity miss ccnuma cf chandra abhishek chase je rey checkpoint checkpointing chen peter chen shuo cheswick william cifs classi cation level clock replacement clojure closed clustered page table clustered paging codd code erasure man coherence protocol cache coherence cache collision hash coloring page column comer douglas commit committed read common criterion common internet file common object request broker chitecture compartment compensating transaction completely fair scheduler concurrent condition variable dentiality ict ict miss congestion connect connected consistent consumer container resource context switching control block task control block thread control program convoy convoy phenomenon cooperative multitasking copy write corba o fernando correlation id courtois covert channel cow cp cracker creasy credential cryptographic le cryptographic hash function cryptography cryptography cumulative acknowledgment cylinder dac daggett marjorie merwin daley robert data encryption standard data warehouse database datagram deadline inheritance deadlock deadlock avoidance deadlock detection deadlock prevention decay decay usage scheduling defense depth defragmentation delayed allocation demand paging demultiplex denial service denning dorothy denning peter dennis jack de descriptor descriptor table descriptor le desktop environment deterministic digital signature digital tree dijkstra edsger dining philosopher directory directory working index dirty dirty bit discretionary access control dispatching dll dns domain domain domain protection dorward sean do dotted decimal druschel peter durable durumeric zakir dyke jim library eal earliest deadline ecn edf elphick email worm encrypt principle energy entity tag erasure code error correction forward error output standard eswaran esx server etag evaluation assurance level exchange exclusion mutual exec family explicit congestion noti cation extent map external fragmentation fabry fail failure atomicity scheduling fetch policy ber fifo fifo segmented le le description open le descriptor le le o set le cryptographic le journaled le journaling le le virtual le sparse rewall rst rst replacement t scheduling ow control fork forward error correction page table fotheringham john fragmentation fragmentation external fragmentation internal frame free page list associativity gantt chart gar nkel simson gateway router global replacement goodman nathan gray jim group scheduling gutmann peter untsch habermann hahn scott handle handle table hard link scheduling arder theo hardware transactional memory harris tim harrison michael hash bucket hash collision hash function hash function cryptographic hash table hashed message authentication code hashed page table haskell havender hay jim head switch hellerstein joseph herlihy maurice heymans hierarchical page table mark hill mark hilton paris history tlb hmac hoare hohpe gregor hold lock hole holt richard honeypot htm html http huck jerry hydra hypertext markup language hypertext transfer protocol idempotent identi cation id importance impurity phase impurity phase index index node indirect block indirect block single ow control inheritance deadline inheritance priority inode input standard instruction pointer integrity internal fragmentation internet internet protocol interrupt interrupt handler intruder intrusion detection index inumber inversion priority inverted page table ip ipsec iseries isolated isolation isolation snapshot itanium java api java virtual machine jessen eike job journal journaled le journaling journaling le joy william jvm kempster tim kennaway kris kernel kernel mode kernel thread kessler key pair keylogger khalidi knuth donald ervin kogan alex krebs brian kurose james la padula label switching router lampson butler lan landwehr carl james latency rotational laurie ben layland james leaf recently used lehoczky john leveson nancy levy henry lf li tong linden theodore lindholm tim linear address linear page table link link layer link hard link soft link symbolic liskov barbara listening liu local area network local replacement locality spatial locality temporal lock lock mutual exclusion lock predicate lock queue lock synchronization locking log log redo log undo le logging lottery scheduling mark lru luby mac mac medium access control address mackinnon major page fault malware mandatory access control map block map extent mask mattson mccreight mcwilliams brian john memory management unit memory transactional memory virtual message authentication code message digest message digest function message passing message queuing middleware messaging messaging metadata metadata attribute meyer michael maged middleware middleware minor page fault miss capacity miss ict tlb mitzenmacher ml mmu mode modi ed page list modi ed page writer mogul je rey mom monitor mpls security multicast multics multilevel feedback queue scheduler multilevel page table multiplexing multiprocessor multiprotocol label switching multitasking cooperative multitasking preemptive multiversion concurrency control mutex mutual exclusion mutual exclusion lock mvcc canonical domain nat native thread navarro juan network network address translation network file network layer network protocol newcomer eric index nfs nice niceness node index nonblocking synchronization northcutt stephen notify numa patrick object object persistent o set le open le description operating operation opt optimal replacement orlov grigory osi open system interconnection reference model ousterhout john output standard packet pae page page cache page coloring page directory page fault page fault major page fault minor page fault soft page frame page table walker page table clustered page table page table hashed table hierarchical page table inverted page table linear page table multilevel paging clustered paging demand paging shadow pang ruoming parent process parmelee parnas password wallet pathname pc permission persistence persistent persistent object persistent storage petrank erez pgp phantom phase phase impurity phase phase impurity phish physical address physical address extension physical layer pipe pipeline placement policy polymorphism pop port number posix posix capability posix thread power pp precision architecture predicate lock preemptive multitasking prepaging pretty good privacy prevention deadlock principal priority priority inheritance priority inversion priority base process process id number process switching process parent processor producer program counter scheduling protection domain protection pro le protocol protocol application protocol network protocol transport proxy pthread cryptography messaging pure push quantum queue lock queueing spinlock quinlan sean race tree rago stephen raid rajkumar ragunathan rajwar ravi scheduling read read ahead read read committed lock reap record record resource recovery processing recursive locking redirection standard redo log reference bit regehr john registry remote method invocation remote procedure replacement policy resolver resource allocation resource allocation graph resource container resource manager resource record response time return address return interrupt reuter andreas riedel erik rijndael ritchie dennis rivest ronald rmi index robbins kay robbins steven rodeh ohad root kit rosenblum mendel rosenkrantz daniel ross blake ross keith rotational latency router router gateway router label switching row rpc rsa rubin aviel rudolph larry run queue runnable running runtime environment runtime stack runtime virtual russinovich mark ruzzo walter saltzer jerome sans santry douglas sathaye shirish scheduler scheduling scheduling decay usage scheduling scheduling scheduling group scheduling scheduling lottery scheduling scheduling stride scheduling virtual time scheduling weighted scholten carel schroeder michael schwartz alan scott michael sctp seawright secret shared sector secure hash algorithm secure socket layer internet mail tension security target linux seek segall zary segment segmentation segmented fifo selective acknowledgment selinux semaphore serial serializable server message block set associativity set group id set user id setgid setuid sfifo sha lui shadow paging shamir adi shapiro jonathan shared secret shavit nir shell shortest job shoshani shoulder sur ng signal signature signature digital simple security property single indirect block sjf skeleton smashing stack smb snapshot snapshot isolation sni er social engineering socket soft link soft page fault soft update software tlb software transactional memory solomon david soltis frank soules craig spa ord gene sparse address space sparse le spatial locality spinlock spinlock queueing spoof spurious wakeup ssl st stack algorithm stack pointer stack activation record stack runtime stajano frank standard error output standard redirection standard input standard output standby page list starvation stearns richard stevens richard sticky bit stirling colin stm storage persistent stream control transmission col stride scheduling stub sturgis howard subject supervisor mode swapping switch switching context switching process switching thread symbolic link cryptography synchronization synchronization barrier synchronization synchronization nonblocking synchronization synchronous write index mode table table hash tag entity talluri madhusudhan tanenbaum andrew target evaluation task task control block tcb tcp tcp vega temporal locality tenex text thanisch peter thompson ken thrashing thread thread control block thread switching thread kernel thread native thread throughput tie time check time use time slice timnat shahar tlb tlb hit tlb miss tlb software tm tocttou toe track transaction transaction context transaction manager transaction atomic transactional memory transactional memory hardware transactional memory software translation lookaside bu er transmission control protocol transport layer transport protocol trap traverse tree digital tree radix trie tripwire trojan horse tuple turnaround time turner clark turner rollins authentication commit locking udp ullman je rey unbound undo log unitary update soft urgency usenix user datagram protocol user mode thread valid bit van horn earl veri er vfs virtual address virtual le virtual machine monitor virtual memory virtual private network virtual runtime virtual time scheduling virus vmm vms volatile vossen gottfried vpn vtrr wafl wait wait queue synchronization waiting waiting busy wakeup spurious wal waldspurger carl walker page table wallet password wan warehouse data watson robert web service weighted fair queuing scheduling weikum gerhard wfq wide area network wilkes john wilson paul wool avishai woolf bobby work ow working directory working set worm worm email write write synchronous logging wrr wustrow eric yellin frank zero page list zero page thread zfs zombie