think stats exploratory data analysis python version stats exploratory data analysis python version allen downey green tea press needham massachusettscopyright allen downey green tea press washburn ave needham ma permission granted copy distribute modify document term creative common international license available http latex source book available http book introduction practical tool exploratory data ysis organization book follows process use start working dataset cleaning format data usually take time e ort read data clean transform check translation process intact variable exploration usually start examining variable time nding variable mean looking distribution value choosing appropriate summary statistic exploration identify possible relationship ables look table scatter plot compute correlation linear t analysis apparent relationship ables use multiple regression add control variable investigate complex relationship hypothesis testing reporting statistical result important answer question big e ect variability expect run measurement possible apparent e ect chance exploration visualization important tool nding possible relationship e ect apparent e ect hold scrutiny visualization e ective way communicate chapter preface book take computational approach advantage mathematical approach present idea using python code mathematical notation general python code readable executable reader download run modify chapter includes exercise reader develop solidify learning write program express standing code debugging program correcting understanding exercise involve experiment test statistical behavior example explore central limit theorem clt ating random sample computing sum resulting alizations demonstrate clt work doe idea hard grasp mathematically easy stand simulation example approximate running random simulation reinforces meaning book based programming language python reader import data source limited datasets cleaned formatted particular statistic tool book lends approach class student work project requires pose statistical question nd dataset address apply technique learn data demonstrate approach statistical analysis book present case study run chapter us data source national survey family growth nsfg conducted center disease control prevention cdc gather family life marriage divorce pregnancy tility use contraception men woman health http wrote book vii behavioral risk factor surveillance brfss conducted national center chronic disease prevention health promotion health condition risk behavior united state http example use data irs census boston marathon second edition think stats includes chapter rst edition substantially revised new chapter regression time series analysis survival analysis analytic method previous edition did use panda scipy statsmodels material new wrote book people write new textbook usually start reading stack old textbook result book contain material pretty order did fact used printed material writing book reason goal explore new approach material did want exposure existing approach making book available free license wanted make sure encumbered copyright restriction reader book access library printed terial tried make reference resource freely available internet proponent old medium think exclusive use electronic resource lazy unreliable right rst think wrong second wanted test chapter preface resource used wikipedia general cles read statistical topic good small change way include reference wikipedia page book encourage follow link case wikipedia page pick description leaf o vocabulary notation book generally consistent wikipedia unless good reason deviate resource useful fram mathworld reddit statistic forum http using code code data used book available http git version control allows track le make project collection le git control called repository github hosting service provides storage git repository convenient web interface github homepage repository provides way work code create copy repository github pressing fork button github account need create forking repository github use track code write working book clone repo mean make copy le computer clone repository need github account wo able write change github want use git download le zip le using button corner github page code written work python python translation developed book using anaconda continuum analytics free python distribution includes package need run using code ix code lot anaconda easy install default doe installation need administrative privilege support python python download anaconda http want use anaconda need following package representing analyzing data http basic numerical computation http scienti c computation including statistic http regression statistical analysis http visualization http commonly used package included python installation hard install environment trouble installing strongly recommend using anaconda python distribution include package clone repository unzip zip le folder le called run read data le run test print message like test passed import error probably mean package need install exercise use python script use ipython notebook used ipython notebook suggest start documentation http wrote book assuming reader familiar core python including feature panda numpy scipy familiar module skip chapter preface assume reader know basic mathematics including logarithm example summation refer calculus concept place calculus studied statistic think book good place start taken traditional statistic class hope book help repair damage allen downey professor computer science franklin olin college engineering needham ma contributor list suggestion correction send email downey make change based feedback add contributor list unless ask omitted include sentence error appears make easy search page section number ne quite easy work thanks downey june downey read early draft tions suggestion zhang error pethan molly farison helped debug solution molly spotted typo nikolas akerblom know big hyracotherium morrow clari ed code example street caught error nick time thanks kevin smith tim arnold work plastex used convert book docbook caplan sent suggestion improving using code xi ceipek error number typo debrouwere leo marihart iii jonathan hammler kent johnson error rst print edition org beyer typo book correction string accompanying code gannert sent patch le number correction lendenmann submitted erratum kearney sent excellent suggestion birch number helpful suggestion vanderlyn tschurwald ben small read early version book error roth carol willing carol novitsky performed technical review book error helpful suggestion palmer sent helpful suggestion correction kulyk typo er sent excellent pull request book supporting code user othesof sent number correction kurokawa working japanese translation book sent correction helpful suggestion white suggested idiomatic panda code sato spotted code error people typo similar error andrew heine abor ak dan kearney alexander gryzlov martin veillette haitao ma je pickhardt rohit deshpande joanne pratt lucian ursu paul glezen lin scott miller luigi chapter prefacecontents preface v wrote book vii using code viii exploratory data analysis statistical approach national survey family growth importing data dataframes variable transformation validation interpretation exercise glossary content distribution histogram representing histogram plotting histogram nsfg variable outlier baby summarizing distribution variance e ect size reporting result exercise glossary probability mass function pmfs plotting pmfs visualization class size paradox dataframe indexing exercise glossary xv cumulative distribution function limit pmfs percentile cdfs representing cdfs comparing cdfs statistic random number comparing percentile rank exercise glossary modeling distribution exponential distribution normal distribution normal probability plot lognormal distribution pareto distribution generating random number model exercise glossary content probability density function pdfs kernel density estimation distribution framework hist implementation pmf implementation cdf implementation moment skewness exercise glossary relationship variable scatter plot characterizing relationship correlation covariance pearson correlation nonlinear relationship spearman rank correlation correlation causation exercise glossary xvii estimation estimation game guess variance sampling distribution sampling bias exponential distribution exercise glossary hypothesis testing classical hypothesis testing hypothesistest testing di erence mean test statistic testing correlation testing proportion test baby error power replication exercise glossary content linear square square t implementation residual estimation goodness t testing linear model weighted resampling exercise glossary regression statsmodels multiple regression nonlinear relationship data mining prediction logistic regression estimating parameter implementation accuracy exercise glossary xix time series analysis importing cleaning plotting linear regression moving average missing value serial correlation autocorrelation prediction reading exercise glossary survival analysis survival curve hazard function inferring survival curve estimation marriage curve estimating survival curve dence interval cohort e ect extrapolation expected remaining lifetime exercise glossary content analytic method normal distribution sampling distribution representing normal distribution central limit theorem testing clt applying clt correlation test test discussion exercise exploratory data analysis thesis book data combined practical method answer question guide decision uncertainty example present case study motivated question heard wife expecting rst child rst baby tend arrive late google question nd plenty discussion people claim true say myth people say way rst baby come early discussion people provide data support claim example like friend given birth recently rst bies went week overdue going labour induced rst came week late think second going come week early think true sister mother rst early cousin report like called anecdotal evidence based data unpublished usually personal casual chapter exploratory data analysis wrong anecdote mean pick people quoted want evidence persuasive answer reliable standard anecdotal evidence usually fails number observation pregnancy length longer rst baby di erence probably small compared natural variation case compare large number pregnancy sure di erence exists bias people join discussion question interested rst baby late case process selecting data bias result rmation bias people believe claim likely contribute example rm people doubt claim likely cite counterexample anecdote personal story bered misrepresented repeated inaccurately better statistical approach address limitation anecdote use tool statistic include collection use data large national survey designed explicitly goal generating statistically valid inference population statistic generate statistic summarize data concisely evaluate di erent way visualize data data analysis look pattern di erences feature address question interested time check inconsistency identify national survey family growth use data sample estimate characteristic general population testing apparent e ect like di erence group evaluate e ect happened chance performing step care avoid pitfall reach conclusion justi able likely correct national survey family growth center disease control prevention cdc conducted national survey family growth nsfg intended gather family life marriage divorce nancy infertility use contraception men woman health survey result used plan health service health education gram statistical study family fertility health http use data collected survey investigate rst baby tend come late question order use data e ectively understand design study nsfg study mean capture shot group point time common alternative gitudinal study observes group repeatedly period time nsfg conducted seven time deployment called cycle use data cycle conducted january march goal survey draw conclusion population target population nsfg people united state aged ideally survey collect data member population seldom possible instead collect data subset chapter exploratory data analysis population called sample people participate survey called respondent general study meant representative mean member target population equal chance participating ideal hard achieve practice people conduct survey come close nsfg representative instead deliberately oversampled designer study recruited rate higher representation tion order make sure number respondent group large draw valid statistical inference course drawback oversampling easy draw conclusion general population based statistic survey come point later working kind data important familiar thecodebook document design study survey tions encoding response codebook user guide nsfg data available http importing data code data used book available http information downloading working code section download code le called run read data le run test print message like test passed let doe pregnancy data cycle nsfg le data le plain text ascii xed width column line le record contains data dataframes format le documented stata dictionary le stata statistical software context list variable name type index identify line nd variable example line infile dictionary caseid respondent id number byte pregordr pregnancy order number dictionary describes variable caseid string represents respondent id pregordr integer indicates pregnancy record describes respondent code downloaded includes python ule contains class function used book including function read stata dictionary nsfg data le used def readfempreg dct df gzip cleanfempreg df return df readstatadct take dictionary le return dct fixedwidthvariables object contains information tionary le dctprovides readfixedwidth read data le dataframes result readfixedwidth dataframe fundamental data structure provided panda python data statistic package use book dataframe contains row record case row pregnancy column chapter exploratory data analysis addition data dataframe contains variable name type provides method accessing modifying data print dfyou truncated view row column shape dataframe import nsfg df df row x column dataframe big display output truncated line report number row column attribute column return sequence column name unicode string index u caseid u pregordr u u result index panda data structure learn index later treat like list pregordr access column dataframe use column key pregordr df pregordr type pregordr class result series panda data structure series like python list additional feature print series index corresponding value pregordr variable pregordr length dtype example index integer general sortable type element integer type line includes variable series length data type type provided numpy run example machine access element series using integer index slice pregordr pregordr pregordr dtype result index operator result slice series access column dataframe using dot notation pregordr notation work column valid python identi er begin letter ca contain space variable seen variable nsfg dataset caseid pregordr seen variable total exploration book use following variable integer id chapter exploratory data analysis integer duration pregnancy week integer code outcome pregnancy code indicates live birth pregnancy serial number example code respondent rst pregnancy second pregnancy serial number live birth code respondent rst child outcome live birth eld blank contain pound ounce part birth weight baby mother age end pregnancy statistical weight associated respondent value indicates number people population respondent represents read codebook carefully variable arerecodes mean raw data collected survey calculated using raw data example prglngth live birth equal raw variable wksgest week gestation available estimated using mosgest month gestation time average number week month recodes based logic check consistency accuracy data general good idea use recodes available unless compelling reason process raw data transformation import data like check error deal special value convert data di erent format perform calculation operation called data cleaning transformation includescleanfempreg function clean variable planning use def cleanfempreg df df df df agepreg contains mother age end pregnancy data le agepreg encoded integer number centiyears rst line divide element agepreg yielding value year contain weight baby pound ounce pregnancy end live birth addition us special code ascertained refused don t know special value encoded number dangerous handled properly generate bogus result like baby thereplace method replaces value special point value represents number ieee standard mathematical operation returnnanif argument nan import numpy np nan computation nantend right thing panda function handle nanappropriately dealing missing data recurring issue line cleanfempreg creates new column bine pound ounce single quantity chapter exploratory data analysis important note add new column dataframe use dictionary syntax like correct df dot notation like wrong version dot notation add attribute dataframe object attribute treated new column validation data exported software environment imported error introduced getting familiar new dataset interpret data incorrectly introduce misunderstanding time validate data save time later avoid error way validate data compute basic statistic compare published result example nsfg codebook includes table summarize variable table outcome encodes outcome pregnancy value label total live birth induced abortion stillbirth miscarriage ectopic pregnancy current pregnancy series class provides method count ber time value appears select outcome series dataframe use compare published data validation result series sort series index value appear order comparing result published table look like value outcome correct similarly published table value label total inapplicable pound pound pound pound pound value count chapter exploratory data analysis count pound check add count check look closely notice value error pound baby deal error added line cleanfempreg statement replaces invalid value attribute vides way select row column dataframe example rst expression bracket row indexer second pression selects column expression yield series type bool true indicates condition true boolean series used index selects element satisfy condition interpretation work data e ectively think level time level statistic level context example let look sequence outcome respondent way data le organized processing collect pregnancy data respondent function doe def makepregmap df d defaultdict list index caseid d caseid index return d dfis dataframe pregnancy data iteritems method ate index row number caseid pregnancy dis dictionary map case id list index familiar defaultdict python collection module using d look respondent index respondent exercise example look respondent print list outcome pregnancy caseid df index caseid index index list index pregnancy corresponding respondent using list index selects indicated row yield series instead printing series selected value attribute numpy array outcome code live birth code miscarriage pregnancy ended spontaneously usually known ical cause statistically respondent unusual miscarriage common respondent reported remembering context data tell story woman pregnant time time ending miscarriage seventh recent pregnancy ended live birth consider data empathy natural moved story tell record nsfg dataset represents person provided honest answer personal question use data answer statistical question family life reproduction health time obligation consider people represented data ord respect gratitude exercise exercise repository downloaded nd le named ipython notebook launch ipython notebook command line like chapter exploratory data analysis ipython notebook ipython installed launch server run ground open browser view notebook familiar ipython suggest start http launch ipython notebook server run ipython notebook open new browser window startup message vides url load browser usually http new window list notebook repository cell lled execute cell instruction exercise try solution exercise exercise repository downloaded nd le named using le starting place write function read respondent le variable pregnum recode indicates time spondent pregnant print value count variable compare published result nsfg codebook respondent pregnancy le comparing pregnum respondent number record pregnancy le use make dictionary map caseid list index pregnancy dataframe solution exercise exercise best way learn statistic work project interested question like rst baby arrive late want investigate think question nd personally interesting item tional wisdom controversial topic question political quences formulate question lends statistical glossary look data help address question government good source data public research freely available good place start include http andhttp united kingdom http favorite data set general social survey http european social survey http like answered question look closely answer justi ed aws data analysis make conclusion unreliable case perform di erent analysis data look better source data nd published paper address question able raw data author make data available web sensitive data write author provide information plan use data agree certain term use persistent glossary evidence evidence personal collected ally study group interested studying refers group people term used subject study study collect data population particular point time repeated study repetition study called cycle study study follows population time collecting data group repeatedly dataset collection information single person chapter exploratory data analysis person responds survey subset population used collect data sample representative member population chance sample technique increasing representation order avoid error small sample size data value collected recorded little checking calculation interpretation value generated calculation logic plied raw data cleaning process include validating data identifying rors translating data type representation distribution histogram best way variable report value appear dataset time value appears description called distribution variable common representation distribution histogram graph show frequency value context mean number time value appears python way compute frequency dictionary given sequence value t hist x t hist x x result dictionary map value frequency alternatively use counter class ned collection module collection import counter counter counter t result counter object subclass chapter distribution option use panda method saw previous chapter book created class hist represents histogram provides method operate representing histogram hist constructor sequence dictionary panda series hist instantiate hist object like import hist hist hist hist object provide freq take value return frequency bracket operator doe thing hist look value appeared frequency value return unsorted list value hist loop value order use function sorted val sorted print val val use item iterate pair val freq print val freq plotting histogram figure histogram pound birth weight plotting histogram book wrote module called provides function plotting hists object ned based onpyplot matplotlib package section information installing matplotlib plothist withthinkplot try import thinkplot hist value frequency read documentation thinkplot athttp nsfg variable let data nsfg code chapter information downloading working code section start working new dataset suggest explore ables planning use time good way start chapter distribution figure histogram ounce birth weight looking histogram section transformed agepreg centiyears year single quantity section use variable demonstrate feature tograms start reading data selecting record live birth preg live preg expression bracket boolean series selects row dataframe return new dataframe generate plot histogram live birth hist hist pound frequency argument passed hist panda series nanvalues dropped label string appears legend hist plotted figure show result common value called mode pound distribution approximately nsfg variable figure histogram mother age end pregnancy figure histogram pregnancy length chapter distribution normal distribution called gaussian distribution unlike true normal distribution distribution asymmetric tailthat extends farther left right figure show histogram ounce birth weight theory expect distribution uniform value frequency fact common value common probably respondent round o birth weight close integer value figure show histogram agepreg mother age end pregnancy mode year distribution roughly shaped case tail extends farther right left mother fewer figure show histogram prglngth length pregnancy week far common value week left tail longer right early baby common pregnancy seldom past week doctor intervene outlier looking histogram easy identify common value shape distribution rare value visible going good idea check outlier extreme value error measurement recording curate report rare event hist provides method largest andsmallest integer nand return nlargest smallest value histogram week freq print week freq list pregnancy length live birth lowest value value week tainly error likely explanation outcome coded correctly value higher week probably legitimate baby week hard sure value probably error represent premature baby end range highest value week count doctor recommend induced labor pregnancy exceeds week longer value surprising particular week medically unlikely best way handle outlier depends knowledge information data come mean depends analysis planning perform example motivating question rst baby tend early late people ask question usually interested pregnancy analysis focus pregnancy longer week baby compare distribution pregnancy length rst baby divided dataframe live birth using birthord computed histogram first live live plotted histogram chapter distribution figure histogram pregnancy length width right left week frequency take number histogram planning plot us information choose appropriate collection color normally us center bar centered value gure use right left place corresponding bar value total width bar leaving space pair finally adjust axis data week ure show result histogram useful make frequent value ately apparent best choice comparing tions example fewer rst baby apparent di erences histogram sample size chapter address problem using probability mass summarizing distribution summarizing distribution histogram complete description distribution sample given histogram reconstruct value sample order detail distribution important necessary present histogram want summarize distribution descriptive statistic characteristic want report tendency value tend cluster particular point cluster variability value quickly probability drop o away mode extreme value far mode statistic designed answer question called summary statistic far common summary statistic mean meant central tendency distribution sample nvalues xi mean x sum value divided number value word nx ixi word used interchangeably make distinction sample summary statistic computed previous formula summary statistic choose central chapter distribution mean good description set value example apple pretty size one sold kets buy apple total weight pound reasonable summary say half pound pumpkin diverse suppose grow variety den day harvest decorative pumpkin pound pie pumpkin pound atlantic giant kin weighs pound mean sample pound told average pumpkin garden pound misleading example meaningful average typical pumpkin variance single number summarizes pumpkin weight little better number mean variance variance summary statistic intended variability spread distribution variance set value nx called mean variance mean squared deviation square root variance s standard deviation prior experience seen formula variance denominator statistic used estimate variance population using sample come chapter panda data structure provides method compute mean variance standard deviation mean var std e ect size live birth mean pregnancy length week standard deviation week mean expect deviation week common variance pregnancy length hard interpret especially unit week variance useful calculation good summary statistic e ect size ane ect size summary statistic intended wait size e ect example di erence group obvious choice di erence mean mean pregnancy length rst baby baby di erence week work hour fraction typical pregnancy length di erence assume estimate accurate di erence tical consequence fact observing large number pregnancy unlikely notice di erence way convey size e ect compare di erence group variability group cohen dis statistic intended ned s mean group si standard deviation python code computes cohen d def coheneffectsize diff len len chapter distribution d diff return d example di erence mean standard deviation small perspective di erence height men woman standard deviation http reporting result seen way di erence pregnancy length rst baby report result answer depends asking question scientist interested real e ect matter small doctor care e ect clinically signi di erences ect treatment decision pregnant woman interested result relevant like probability delivering early late report result depends goal trying demonstrate importance e ect choose summary tic emphasize di erences trying reassure patient choose statistic di erences context course decision guided professional ethic ok persuasive design statistical report visualization tell story clearly best make report honest acknowledge uncertainty limitation exercise exercise based result chapter suppose asked summarize learned rst baby arrive glossary summary statistic use wanted story evening news one use wanted reassure anxious patient finally imagine cecil adam author straight dope http job answer question rst baby arrive late write paragraph us result chapter answer question clearly precisely honestly exercise repository downloaded nd le named open cell lled execute cell instruction exercise follow instruction ll answer solution exercise repository downloaded nd le named use le starting place following exercise solution exercise mode distribution frequent value http statistic write function called mode take hist return frequent value challenging exercise write function called allmodes return list pair descending order frequency exercise using variable investigate rst bies lighter heavier compute cohen dto quantify di erence group doe compare di erence pregnancy length glossary value appear sample frequency mapping value frequency graph show chapter distribution number time value appears sample frequent value sample frequent value distribution idealization distribution known gaussian distribution distribution distribution value frequency distribution high low extreme tendency characteristic sample population itively average typical value value far central tendency measure spread value distribution statistic statistic quanti e aspect tribution like central tendency spread summary statistic used quantify spread deviation square root variance used measure spread ect size summary statistic intended quantify size e ect like di erence group signi result like di erence group relevant probability mass function code chapter information downloading working code section pmfs way represent distribution probability mass function pmf map value probability probability frequency expressed fraction sample size cies probability divide n called normalization given hist make dictionary map value probability n d x freq d x freq n use pmf class provided like hist pmf constructor list panda series dictionary hist pmf object example simple chapter probability mass function import pmf pmf pmf pmf normalized total probability pmf hist object similar way fact inherit method common parent class example method value anditems work way biggest di erence hist map value integer counter pmf map value probability look probability associated value use prob bracket operator equivalent pmf modify existing pmf incrementing probability associated value multiply probability factor modify pmf result normalized ities longer add check total return sum probability plotting pmfs renormalize normalize pmf object provide copy method make modify copy ecting original notation section inconsistent use pmf class pmffor instance class pmf mathematical concept probability mass function plotting pmfs thinkplot provides way plot pmfs plot pmf bar graph use bar graph useful number value pmf small plot pmf step function use option useful large number value pmf smooth function work hist object addition pyplot provides function called hist take sequence value computes histogram plot use hist object usually use figure show pmfs pregnancy length rst baby using bar graph left step function right plotting pmf instead histogram compare distribution mislead di erence sample size based gure rst baby likely arrive time week likely late week code generates figure chapter probability mass function figure pmf pregnancy length rst baby using bar graph step function right left week probability week preplot take optional parameter row andcols make grid gures case row gures rst gure left display pmfs using seen second preplot reset color generator subplot switch second gure right display pmfs using used axis option ensure gures visualization ax generally good idea intend compare gures visualization histogram pmfs useful exploring data trying identify pattern relationship idea going good step design visualization make pattern identi ed clear possible nsfg data biggest di erences distribution near mode make sense zoom graph transform data emphasize di erences week range diffs week week week week diff diff week diffs code week range week diffs di erence pmfs percentage point figure show result bar chart gure make pattern clearer rst baby likely born week somewhat likely born week hold conclusion tentatively used dataset identify apparent di erence chose visualization make di erence apparent ca sure e ect real random variation address concern later class size paradox want demonstrate kind computation pmf object example size paradox chapter probability mass function pointsdifference pmfs figure di erence percentage point week american college university ratio student surprised discover average class size bigger reason discrepancy typically class semester professor teach number student enjoy small class small ber student large class ahem large rst e ect obvious pointed second subtle let look example suppose college o er class given semester following distribution size size count class size paradox ask dean average class size construct pmf compute mean report average class size code d pmf d actual print mean survey group student ask student class compute mean think average class bigger let bigger compute distribution observed student bility associated class size number student class def biaspmf pmf label x p x x return class size x multiply probability x number student observe class size result new pmf represents biased distribution plot actual observed distribution biaspmf pmf observed pmf class size pmf figure show result biased distribution fewer small class large one mean biased distribution higher actual mean possible invert operation suppose want nd distribution class size college ca reliable data chapter probability mass function class observed figure distribution class size actual observed student dean alternative choose random sample student ask student class result biased reason just seen use estimate actual distribution function unbiases pmf def unbiaspmf pmf label x p x return similar biaspmf di erence divide probability byxinstead dataframe indexing dataframe indexing section read panda dataframe used select modify data column let look row selection start create numpy array random number use initialize dataframe import numpy np import panda array df array df default row column numbered starting zero provide column name column b df array df b provide row name set row name called index row name called label index b c d df array df b b c d chapter probability mass function saw previous chapter simple indexing selects column ing series df b c d dtype select row label use locattribute return series b dtype know integer position row label use theiloc attribute return series b dtype loccan list label case result dataframe index c index b c finally use slice select range row label df c b b c integer exercise df b b result case dataframe notice rst result includes end slice second doe advice row label simple integer use label consistently avoid using integer position exercise solution exercise exercise like class size paradox appears survey child ask child family family child likely appear sample family dren chance sample use nsfg respondent variable numkdhh construct actual tion number child household compute biased distribution surveyed child asked child including household plot actual biased distribution compute mean starting place use exercise section computed mean sample adding element dividing given pmf compute mean process slightly di erent ipixi thexiare unique value pmf xi similarly compute variance like ipi chapter probability mass function write function called pmfmean andpmfvar pmf object pute mean variance test method check consistent method mean andvarprovided pmf exercise started question rst baby likely late address computed di erence mean group baby ignored possibility di erence rst baby woman address version question select respondent baby compute pairwise di erences doe formulation question yield di erent result hint use exercise foot race start time fast runner usually pas lot people beginning race mile going speed ran mile relay race rst time noticed odd phenomenon overtook runner usually faster runner overtook usually faster rst thought distribution speed bimodal slow runner fast runner speed realized victim bias similar e ect class size race unusual way used staggered start team started di erent time team included runner di erent level ability result runner spread course little relationship speed location joined race runner near pretty random sample runner race doe bias come time course chance overtaking runner overtaken proportional di erence speed likely catch slow runner likely caught fast runner runner speed unlikely glossary write function called observedpmf take pmf representing actual distribution runner speed speed running observer return new pmf representing distribution runner speed seen observer test function use read result james joyce ramble dedham ma convert pace runner mph compute distribution speed observe ran relay race mph group runner solution exercise glossary mass function pmf representation tion function map value probability frequency expressed fraction sample size process dividing frequency sample size probability panda dataframe index special column contains row chapter probability mass functionschapter cumulative distribution function code chapter information loading working code section limit pmfs pmfs work number value small number value increase probability associated value get smaller e ect random noise increase example interested distribution birth weight nsfg data variable record weight birth pound figure show pmf value rst baby overall distribution resemble bell shape normal distribution value near mean value higher lower part gure hard interpret spike valley apparent di erences distribution hard tell feature meaningful hard overall pattern example distribution think higher mean chapter cumulative distribution function weight pound weight pmf figure pmf birth weight gure show limitation pmfs hard compare visually problem mitigated binning data dividing range value interval counting number value bin binning useful tricky size bin right big smooth noise smooth useful information alternative avoids problem cumulative distribution tion cdf subject chapter explain cdfs explain percentile percentile taken standardized test probably got result form raw score percentile rank context percentile rank fraction people scored lower percentile did better people took exam compute percentile rank value relative value sequence score percentile def percentilerank score count score score score count count len score return example score sequence got percentile rank given value easy nd percentile rank going way slightly harder given percentile rank want nd corresponding value option sort value search want def percentile score score score percentilerank score score return score result calculation percentile example centile value percentile rank distribution exam score percentile implementation percentile better approach use percentile rank compute index corresponding percentile def score index len score return score index di erence rank ing people use term precisely summarize percentilerank take value computes percentile rank set value percentile take percentile rank computes corresponding chapter cumulative distribution function cdfs understand percentile percentile rank ready tackle cumulative distribution function cdf cdf tion map value percentile rank cdf function x wherexis value appear distribution evaluate cdf x particular value x compute fraction value distribution equal look like function take sequence sample value x def evalcdf sample x count value sample value x count prob count len sample return prob function identical percentilerank result probability range percentile rank range example suppose collect sample value value cdf cdf cdf cdf cdf cdf cdf evaluate cdf value x just value appear sample xi smallest value sample cdf x representing cdfs figure example cdf ifxis greater largest value cdf x figure graphical representation cdf cdf sample step function representing cdfs provides class named cdf represents cdfs mental method cdf provides x given value x computes probability cdf x bracket operator equivalent prob p given probability p computes corresponding value x inverse cdf ofp cdf constructor argument list value panda series hist pmf cdf following code make cdf distribution pregnancy length nsfg live first cdf prglngth chapter cumulative distribution function length prglngth figure cdf pregnancy length thinkplot provides function named cdfthat plot cdfs line cdf week cdf figure show result way read cdf look percentile example look like pregnancy shorter week shorter week cdf provides visual representation shape distribution common value appear steep vertical section cdf example mode week apparent value week cdf range take time used cdfs think nd information clearly pmfs comparing cdfs cdfs especially useful comparing distribution example code plot cdf birth weight rst baby statistic weight pound weight figure cdf birth weight rst baby weight pound cdf figure show result compared figure gure make shape distribution di erences clearer rst baby slightly lighter distribution larger discrepancy mean statistic computed cdf easy compute percentile centile rank cdf class provides method x given value x computes percentile rank x p given percentile rank p computes ing value equivalent value percentile used compute summary statistic example percentile value divide distribution chapter cumulative distribution function half known median like mean median measure central tendency distribution actually nitions di erent erties percentile simple compute statistic interquartile range iqr measure spread distribution iqr di erence percentile generally percentile used summarize shape bution example distribution income reported tile split percentile distribution divided statistic like resent point cdf called quantiles http random number suppose choose random sample population live birth look percentile rank birth weight suppose compute cdf percentile rank think distribution look like compute make cdf birth weight weight cdf weight generate sample compute percentile rank value sample sample weight rank x x sample sample random sample birth weight chosen replacement value chosen rank list percentile rank finally make plot cdf percentile random number percentile rank figure cdf percentile rank random sample birth weight rank percentile rank cdf figure show result cdf approximately straight line mean distribution uniform outcome consequence way cdf ned gure show sample percentile percentile exactly expect regardless shape cdf distribution percentile rank uniform property useful basis simple algorithm generating random number given cdf percentile rank uniformly range nd value distribution sponds percentile rank chose cdf provides implementation algorithm called random chapter cumulative distribution function class cdf def random self return cdf provides sample take integer n return list n value chosen random cdf comparing percentile rank percentile rank useful comparing measurement di erent group example people compete foot race usually grouped age gender compare people di erent age group convert race time percentile rank year ago ran james joyce ramble dedham ma nished eld beat tied runner percentile rank eld generally given position eld size compute percentile rank def positiontopercentile position beat position percentile beat return percentile age group denoted year age came percentile rank age group running year hope division assuming percentile rank division slower expect answer question converting percentile rank position code def percentiletoposition percentile beat percentile position beat return exercise people come place percentile rank nishing time runner time beat maintain percentile rank exercise following exercise start solution exercise did weigh birth know mother know using nsfg data live birth compute distribution birth weight use nd percentile rank rst baby nd percentile rank distribution rst baby use distribution percentile higher mother apologize exercise number generated supposed uniform value range probability generate number plot pmf cdf distribution uniform glossary rank percentage value distribution equal given value value associated given percentile rank distribution function cdf function map value cumulative probability cdf x fraction sample equal x cdf function map cumulative probability p corresponding chapter cumulative distribution function percentile used measure central dency range di erence centile used measure spread sequence value correspond equally spaced centile rank example quartile distribution percentile property sampling process replacement mean value chosen replacement mean value chosen removed modeling distribution distribution used far called empirical distribution based empirical observation necessarily nite sample alternative analytic distribution characterized cdf mathematical function analytic distribution used model empirical distribution context model simpli cation leaf unneeded detail chapter present common analytic distribution us model data variety source code chapter information loading working code section exponential distribution start exponential distribution relatively simple cdf exponential distribution cdf x parameter determines shape distribution figure show cdf look like chapter modeling distribution cdf figure cdfs exponential distribution various parameter real world exponential distribution come look series event measure time event called interarrival time event equally likely occur time distribution interarrival time tends look like exponential distribution example look interarrival time birth december baby born hospital brisbane time birth baby reported local paper complete dataset le called repository df readbabyboom diffs cdf diffs actual cdf minute cdf readbabyboom read data le return dataframe column time sex andminutes whereminutes time birth converted minute midnight diffs di erence consecutive birth time cdfis example based information data dunn simple dataset demonstrating common distribution journal statistic education exponential distribution figure cdf interarrival time left ccdf scale right bution interarrival time figure left show cdf general shape exponential distribution tell way plot complementary cdf x scale data exponential distribution result straight line let work plot complementary cdf ccdf dataset think exponential expect function like taking log side yield scale ccdf straight line slope generate plot like cdf minute ccdf log chapter modeling distribution argument computes plementary cdf plotting log set theyaxis logarithmic scale figure right show result exactly straight indicates exponential distribution perfect model data likely underlying birth equally likely time exactly true reasonable model dataset exponential distribution simpli cation summarize distribution single parameter parameter interpreted rate number event occur average unit time example baby born hour rate birth minute mean exponential distribution mean time birth minute normal distribution thenormal distribution called gaussian commonly used describes phenomenon approximately turn good reason ubiquity section normal distribution characterized parameter mean standard deviation normal distribution called thestandard normal distribution cdf ned integral doe closed form solution algorithm evaluate provided scipy object represents normal distribution provides method cdf evaluates standard normal cdf import result correct median standard normal distribution mean half value fall median cdf normal distribution cdf figure cdf normal distribution range parameter take optional parameter loc speci e mean scale speci e standard deviation make function little easier use providing evalnormalcdf take parameter muandsigma evaluates cdf atx def evalnormalcdf x return x figure show cdfs normal distribution range parameter sigmoid shape curve recognizable characteristic normal distribution previous chapter looked distribution birth weight nsfg figure show empirical cdf weight live birth cdf normal distribution mean variance normal distribution good model dataset summarize distribution parameter resulting error di erence model data small percentile discrepancy data model light baby expect normal tion speci cally interested preterm baby chapter modeling distribution birth weight lb weight model data figure cdf birth weight normal model distribution right appropriate use normal model normal probability plot exponential distribution simple mations use test analytic distribution good model dataset normal distribution transformation alternative called normal probability plot way generate normal probability plot hard way easy way interested hard way read http easy way sort value sample standard normal distribution generate random sample size sample sort plot sorted value sample versus random normal probability plot standard normal valuesnormal probability plot figure normal probability plot random sample normal butions distribution sample approximately normal result straight line intercept muand slope sigma provides normalprobability take sample return numpy array x y sample yscontains sorted value sample xscontains random value standard normal distribution testnormalprobability generated fake sample actually drawn normal distribution various parameter figure show result line approximately straight value tail deviating value near mean let try real data code generate normal probability plot birth weight data previous section plot gray line represents model blue line represents data def makenormalplot weight mean std x fxs fys x chapter modeling distribution standard deviation weight lb normal probability plot live term figure normal probability plot birth weight fxs fys gray model x y weight x y birth weight weight panda series birth weight mean andstdare mean standard deviation fitline take sequence x intercept slope return xsand ysthat represent line given parameter evaluated value inxs normalprobability returnsxsandysthat contain value standard normal distribution value weight distribution weight normal data match model figure show result live birth term birth pregnancy length greater week curve match model near mean deviate tail heaviest baby heavier model expects lightest baby lighter select term birth remove lightest weight reduces discrepancy lower tail distribution plot suggests normal model describes distribution lognormal distribution adult weight kg weight adult weight kg model weight figure cdf adult weight linear scale left log scale right standard deviation mean tail good practical purpose depends purpose lognormal distribution logarithm set value normal distribution value lognormal distribution cdf lognormal distribution cdf normal distribution log xsubstituted cdflognormal x logx parameter lognormal distribution usually denoted remember parameter notthe mean standard deviation mean lognormal distribution exp standard deviation ugly http distribution sample approximately lognormal plot cdf scale characteristic shape normal distribution test sample t lognormal model make normal probability plot using log value chapter modeling distribution kg model weight kg model weight figure normal probability plot adult weight linear scale left log scale right example let look distribution adult weight proximately national center chronic disease prevention health promotion conduct annual survey behavioral risk factor surveillance brfss interviewed respondent asked demographic health health risk data collected weight kilogram respondent repository book contains ascii le contains data brfss read le analyzes data figure left show distribution adult weight linear scale tipped o possibility comment citation http subsequently proposes log transform suggests cause penman johnson changing shape body mass index distribution curve population ing chronic disease july online http disease control prevention cdc behavioral risk factor lance survey data atlanta georgia department health human service center disease control prevention pareto distribution normal model figure right show distribution log scale lognormal model lognormal model better t representation data doe make di erence particularly dramatic figure show normal probability plot adult weight w logarithm apparent data deviate substantially normal model hand lognormal model good match data pareto distribution thepareto distribution named economist vilfredo pareto used distribution wealth http used phenomenon natural social science including size city town sand particle meteorite forest re earthquake cdf pareto distribution cdf x parameter xmand determine location shape minimum possible value figure show cdfs pareto distribution di erent value simple visual test indicates empirical distribution t pareto distribution scale ccdf look like straight line let work plot ccdf sample pareto distribution linear scale expect function like taking log side yield chapter modeling distribution cdf figure cdfs pareto distribution di erent parameter plot log yversus logx look like straight line slope intercept logxm example let look size city town census bureau publishes population incorporated city town united state downloaded data http repository book le named repository contains read le plot distribution population figure show ccdf population scale largest city town fall straight line conclude researcher tail distribution t pareto model hand lognormal distribution model data ure show cdf population lognormal model left normal probability plot right plot good agreement data model model perfect pareto model applies largest generating random number data figure ccdfs city town population scale city better t distribution lognormal model better t model appropriate depends distribution relevant generating random number analytic cdfs used generate random number given tribution function cdf x way compute inverse cdf generate random value appropriate tribution choosing pfrom uniform distribution p example cdf exponential distribution solving xyields python write def expovariate lam chapter modeling distribution data populationmodel data figure cdf city town population scale left normal probability plot population right p x lam return x expovariate takeslamand return random value chosen nential distribution parameter lam note implementation called parameter lambecause lambda python keyword log unde ned little careful implementation return log ned model beginning chapter said real world phenomenon modeled analytic distribution ask like model analytic distribution abstraction mean leave detail considered irrelevant example observed distribution measurement error quirk speci c sample analytic model smooth exercise analytic model form data compression model t dataset small set parameter summarize large data surprising data natural phenomenon t alytic distribution observation provide insight physical system explain observed distribution ticular form example pareto distribution result erative process positive feedback preferential attachment process http analytic distribution lend mathematical analysis chapter important remember model imperfect data real world t analytic distribution perfectly people talk data generated model example say distribution human height normal distribution income lognormal taken literally claim true di erences real world mathematical model model useful capture relevant aspect real world leave unneeded detail depends planning use model exercise following exercise start solution exercise brfss section distribution height roughly normal parameter cm cm men cm cm woman order join blue man group male http percentage male population range hint use chapter modeling distribution exercise feel pareto distribution let di erent world distribution human height pareto parameter m distribution reasonable minimum m median plot distribution mean human height pareto world fraction population shorter mean billion people pareto world expect taller km tall expect tallest person exercise weibull distribution generalization exponential distribution come failure analysis http cdf cdf x k nd transformation make weibull distribution look like straight line slope intercept line indicate generate sample weibull tion use test transformation exercise small value n expect empirical distribution t analytic distribution exactly way evaluate quality t generate sample analytic distribution match data example section plotted distribution time birth saw approximately exponential distribution based data point data come exponential distribution generate value exponential distribution mean data minute birth plot distribution random value compare actual distribution use generate value exercise repository book nd set data le contains sequence random number generated analytic distribution nd script read data le plot cdf variety transforms run like glossary python based plot able infer kind distribution generated le stumped look contains code generated le exercise distribution wealth income modeled using lognormal pareto distribution better let look data current population survey cps joint e ort bureau labor statistic census bureau study income related variable data collected available http downloaded excel spreadsheet information household income converted csv le nd repository book nd read le extract distribution income dataset analytic distribution chapter good model data solution exercise glossary distribution distribution value sample distribution distribution cdf analytic tion useful simpli cation analytic distribution good model complex empirical distribution time elapsed time event cdf function map value x fraction value exceed x x normal distribution normal distribution mean standard deviation probability plot plot value sample versus random value standard normal chapter modeling distributionschapter probability density function code chapter information loading working code section pdfs derivative cdf called probability density function pdf example pdf exponential distribution pdfexpo x pdf normal distribution pdfnormal x evaluating pdf particular value xi usually useful result probability probability density physic density mass unit volume order mass multiply volume density constant integrate volume similarly probability density measure probability unit order probability mass integrate chapter probability density function provides class called pdf represents probability density function pdf object provides following method take value x return density bution x evaluates density discrete set value return pair sequence sorted value x probability density d evaluates density discrete set value turn normalized pmf approximates pdf return default set point used render andmakepmf pdf abstract parent class mean instantiate create pdf object instead ne child class inherits pdf provides nitions density getlinspace pdf provides render andmakepmf example provides class named normalpdf evaluates normal density function class normalpdf pdf def self mu sigma label def density self x return x def getlinspace self low high return low high normalpdf object contains parameter muandsigma us object represents normal distribution provides cdfandpdf method section kernel density estimation following example creates normalpdf mean variance adult female height cm brfss section computes density distribution location standard deviation mean mean var std var pdf mean std mean std result unit probability mass cm probability density doe mean plot pdf shape distribution pdf normal plot pdf smooth function contrasted render pmf step function figure show result pdf estimated sample compute section use makepmf approximate pdf pmf default resulting pmf contains point equally spaced mu sigma tomu sigma optionally makepmf andrender keyword argument low high andn kernel density estimation kernel density estimation kde algorithm take sample nd appropriately smooth pdf t data read detail http scipy provides implementation kde provides class calledestimatedpdf us chapter probability density function height cm sample kde figure normal pdf model adult female height kernel density estimate sample class estimatedpdf pdf def self sample sample def density self x return x take sample computes kernel density estimate result object provides evaluate method density take value sequence call turn resulting density word appears cause us lter based gaussian distribution smooth kde example generates sample normal distribution make estimatedpdf t sample mean std range sample sample kde sample list random height pdf object contains estimated kde distribution framework figure show normal density function kde based ple random height estimate good match original distribution estimating density function kde useful purpose exploration phase project cdfs usually best visualization distribution look cdf decide estimated pdf appropriate model distribution better choice presenting distribution audience unfamiliar cdfs estimated pdf way sample model population reason believe population distribution smooth use kde interpolate density value appear sample simulation based distribution sample sample size small appropriate smooth sample distribution using kde allows simulation explore possible outcome replicating observed data distribution framework point seen pmfs cdfs pdfs let minute review figure show function relate started pmfs represent probability discrete set value pmf cdf add probability mass cumulative probability cdf pmf compute di erences cumulative probability implementation operation section pdf derivative continuous cdf equivalently cdf integral pdf remember pdf map value probability density probability integrate discrete continuous distribution perform various kind smoothing form smoothing assume data chapter probability density function cdf cmf pmfsum diff integrate pdfcdfsmooth bincontinuous cumulativediscrete figure framework relates representation distribution tions analytic continuous distribution like exponential normal estimate parameter distribution option kernel density estimation opposite smoothing discretizing quantizing evaluate pdf discrete point generate pmf approximation pdf better approximation using numerical integration distinguish continuous discrete cdfs better discrete cdf mass function far tell us term hist implementation point know use basic type provided hist pmf cdf pdf section provide tail implemented material help use class e ectively strictly necessary hist pmf inherit parent class called leading underscore indicates class used code module indicates pmf implementation wrapper primary attribute d dictionary map value frequency value hashable type frequency integer numeric type contains method appropriate hist pmf value item andrender provides modi er method set incr mult andremove method implemented dictionary operation example class def incr self x x x term def mult self x factor x x factor def remove self x del x hist provides freq look frequency given value hist operator method based dictionary method constant time operation run time doe increase hist get bigger pmf implementation pmf hist thing pmf map value probability integer frequency sum probability pmf normalized pmf provides normalize computes sum probability divide factor class pmf def normalize self chapter probability density function total total raise valueerror total probability factor float fraction total x x factor return total fraction determines sum probability normalizing fault value total probability pmf normalized sonormalize raisesvalueerror hist pmf constructor argument dict hist pmf cdf panda series list value frequency pair sequence value instantiate pmf result normalized instantiate hist construct unnormalized pmf create pmf modify pmf modi er renormalize pmf cdf implementation cdf map value cumulative probability mented cdf value cdf ordered value useful compute inverse cdf map cumulative probability value implementaion chose sorted list way use binary search forward inverse lookup logarithmic time cdf constructor parameter sequence value da series dictionary map value probability sequence value probability pair hist pmf cdf given rameters treat sorted sequence value sequence corresponding cumulative probability given sequence panda series dictionary constructor make hist us hist initialize cdf implementation freqs zip sorted freqs xsis sorted list value freqs list corresponding computes cumulative sum frequency dividing total frequency yield cumulative probability nvalues time construct cdf proportional nlogn implementation prob take value return cumulative probability class cdf def prob self x x return index x p index return p thebisect module provides implementation binary search implementation value take cumulative probability return corresponding value class cdf def value self p p p raise valueerror p range index p return index given cdf compute pmf computing di erences consecutive cumulative probability cdf constructor pas pmf computes di erences calling class cdf def item self b b return zip chapter probability density function shift element ato right beginning replace rst element bwith compute di erence result numpy array probability cdf provides shift andscale modify value cdf probability treated immutable moment time sample reduce single number number statistic statistic seen far include mean variance median interquartile range araw moment kind statistic sample value xi kth raw moment nx ixk prefer python notation def rawmoment x k return sum x k x x len x result sample mean raw moment mean used computation thecentral moment useful kth central moment nx k python def centralmoment x k mean rawmoment x return sum x mean k x x len x result second central moment recognize variance nition variance give hint statistic called moment attach weight ruler location xi spin ruler mean skewness inertia spinning weight variance value familiar moment inertia http report statistic important think unit example value xiare cm rst raw moment cm second moment moment unit moment hard interpret second moment common report standard deviation square root variance unit xi skewness skewness property describes shape distribution distribution symmetric central tendency unskewed value extend farther right skewed value extend left skewed use doe usual connotation ness describes shape distribution say sampling process biased statistic commonly used quantify skewness bution given sequence value xi sample skewness computed like def standardizedmoment x k var centralmoment x std var return centralmoment x k std k def skewness x return standardizedmoment x standardized moment mean malized chapter probability density function negative skewness indicates distribution skews left positive skewness indicates distribution skews right magnitude strength skewness easy interpret practice computing sample skewness usually good idea outlier disproportionate e ect way evaluate asymmetry distribution look relationship mean median extreme value e ect mean median distribution skews left mean median distribution skews right mean greater pearson median skewness measure skewness based di erence sample mean median sample mean mi median si standard tion python def median x cdf x return def pearsonmedianskewness x median median x mean rawmoment x var centralmoment x std var gp mean median std return gp statistic robust mean vulnerable e ect outlier example let look skewness birth weight nsfg pregnancy data code estimate plot pdf live first data skewness mean medianbirth weight figure estimated pdf birthweight data nsfg pdf data pdf birth weight figure show result left tail appears longer right suspect distribution skewed left mean lb bit median lb consistent left skew skewness negative sample skewness pearson median skewness let compare distribution distribution adult weight brfss code df data pdf data pdf adult weight figure show result distribution appears skewed right sure mean bigger median sample skewness pearson median skewness sign skewness indicates distribution skews left right hard interpret sample skewness robust susceptible outlier result reliable applied skewed distribution exactly chapter probability density function mean medianadult weight figure estimated pdf adult weight data brfss pearson median skewness based computed mean variance susceptible outlier doe depend moment somewhat robust exercise solution exercise exercise distribution income famously skewed right exercise measure strong skew current population survey cps joint e ort bureau labor statistic census bureau study income related variable data collected available http downloaded excel spreadsheet information household income converted csv le nd repository book nd read le transforms data dataset form series income range number respondent fell range lowest range includes respondent reported annual household income highest range includes respondent glossary estimate mean statistic data make assumption lower upper bound value tributed range providesinterpolatesample show way model data take dataframe column income contains upper bound range freq contains number respondent frame take assumed upper bound highest range expressed dollar default value sent assumption largest income respondent million dollar interpolatesample generates sample hold income yield number respondent range actual data assumes income range equally spaced scale compute median mean skewness pearson skewness resulting sample fraction household report taxable income mean result depend assumed upper bound glossary density function pdf derivative ous cdf function map value probability density density quantity integrated range value yield probability value unit cm example probability density unit probability cm density estimation kde algorithm estimate pdf based sample approximate continuous function distribution discrete function opposite smoothing moment statistic based sum data raised chapter probability density function moment statistic based deviation mean raised power moment ratio moment unit measure asymmetric distribution skewness statistic intended quantify skewness distribution median skewness statistic intended quantify skewness distribution based median mean standard deviation statistic robust relatively immune e ect relationship variable far looked variable time chapter look relationship variable variable related knowing give information example height weight related people taller tend heavier course perfect relationship short heavy people tall light one trying guess weight accurate know height code chapter information loading working code section scatter plot simplest way check relationship variable ter plot making good scatter plot easy example plot weight versus height respondent brfss tion code read data le extract height weight df sample df height weight chapter relationship variable height cm kg height cm kg figure scatter plot weight versus height respondent brfss unjittered left jittered right samplerows chooses random subset data def samplerows df nrows index nrows sample index return sample dfis dataframe nrows number row choose replace boolean indicating sampling replacement word row chosen thinkplot provides scatter make scatter plot height weight height cm weight kg result figure left show shape relationship expected taller people tend heavier best representation data data scatter plot packed column problem height rounded nearest inch converted centimeter rounded mation lost translation ca information minimize e ect scatter plot jittering data mean adding random noise reverse e ect rounding o measurement rounded nearest inch o inch cm similarly weight o kg height height weight weight implementation jitter def jitter value n len value return n value value sequence result numpy array figure right show result jittering reduces visual e ect rounding make shape relationship clearer general jitter data purpose visualization avoid using jittered data analysis jittering best way represent data overlapping point hide data dense part gure give disproportionate emphasis outlier e ect called saturation solve problem alpha parameter make point partly transparent height weight figure left show result overlapping data point look darker darkness proportional density version plot detail apparent vertical cluster height horizontal line near kg pound data based pound likely explanation respondent reported rounded chapter relationship variable height cm kg height cm kg figure scatter plot jittering transparency left hexbin plot right using transparency work datasets gure show rst record brfss total handle larger datasets option hexbin plot divide graph hexagonal bin color bin according data point fall thinkplot provides hexbin height weight figure right show result advantage hexbin show shape relationship large datasets time size le generates drawback make outlier invisible point example easy make scatter plot show relationship clearly introducing misleading characterizing relationship height cm kg figure percentile weight range height bin characterizing relationship scatter plot provide general impression relationship ables visualization provide insight nature relationship option bin variable plot centile numpy panda provide function binning data df bin index bin group index dropna drop row nanin listed column arange make numpy array bin including increment digitize computes index bin contains value result numpy array integer index value fall lowest bin mapped index value highest bin mapped tolen bin groupby dataframe method return groupby object used forloop group iterates name group dataframes chapter relationship variable represent example print number row group like group group print len group group compute mean height cdf weight height group group cdfs group group finally plot percentile weight versus height percent weight percent cdf cdfs label dth percent height weight figure show result cm relationship variable roughly linear range includes data worry extreme correlation acorrelation statistic intended quantify strength tionship variable challenge measuring correlation variable want compare expressed unit unit come di erent distribution common solution problem transform value standard score number standard deviation mean transform lead son correlation transform value rank index sorted list value transform lead rank correlation covariance ifxis series nvalues xi convert standard score tracting mean dividing standard deviation numerator deviation distance mean dividing standardizes deviation value zare dimensionless unit distribution mean variance ifxis normally distributed ifxis skewed outlier doesz case robust use percentile rank compute new variable r thatriis rank xi distribution r uniform n regardless distribution x covariance covariance measure tendency variable vary series xandy deviation mean sample mean xand sample mean ifxand yvary deviation tend sign multiply product positive deviation sign negative opposite sign adding product give measure tendency vary covariance mean product cov x y nx dxidyi wherenis length series length studied linear algebra recognize covis dot product deviation divided length covariance maximized vector identical orthogonal chapter relationship variable negative point opposite direction implement def cov x y x x y y meanx meanx x meany meany y cov len x return cov default covcomputes deviation sample mean vide known mean xsandysare python sequence convert numpy array numpy array doe implementation covariance meant simple purpose explanation numpy panda provide implementation covariance apply correction small sample size covered return covariance matrix need pearson correlation covariance useful computation seldom reported summary statistic hard interpret problem unit product unit xandy example ance weight height brfss dataset mean solution problem divide deviation standard deviation yield standard score compute product standard score sx pearson correlation wheresxandsyare standard deviation xandy mean product nx pi rewrite factoring sxandsy x y sxsy value called pearson correlation karl pearson uential early statistician easy compute easy interpret standard score dimensionless implementation def corr x y x x y y meanx varx meanvar x meany vary meanvar y corr cov x y meanx meany varx vary return corr meanvar computes mean variance slightly separate call pearson correlation including positive say correlation positive mean variable high tends high negative correlation negative variable high low magnitude strength correlation variable perfectly correlated mean know make perfect prediction correlation real world perfect useful relation height weight strong correlation compared similar chapter relationship variable figure example datasets range correlation nonlinear relationship pearson correlation near tempting conclude relationship variable conclusion valid son correlation measure linear relationship nonlinear relationship strength figure http dependence show scatter plot correlation carefully constructed datasets row show linear relationship range correlation use row sense di erent value like second row show perfect correlation range slope demonstrates correlation unrelated slope talk estimating slope soon row show variable clearly related tionship nonlinear correlation moral story look scatter plot data blindly computing correlation spearman rank correlation spearman rank correlation pearson correlation work relationship variable linear variable roughly normal robust presence outlier spearman rank correlation alternative mitigates e ect outlier skewed distribution compute spearman relation compute rank value index sorted sample example sample rank value appears sorted list compute pearson correlation rank provides function computes spearman rank correlation def spearmancorr x y xranks x yranks y return corr xranks yranks convert argument panda series object use rank computes rank value return series use corr compute correlation rank use directly specify spearman method def spearmancorr x y x x y y return y spearman spearman rank correlation brfss data little higher pearson correlation possible reason di erence including relationship nonlinear pearson correlation tends timate strength relationship correlation ected direction distribution skewed contains outlier spearman rank tion robust brfss example know distribution weight roughly lognormal log transform approximates normal distribution chapter relationship variable skew way eliminate e ect skewness compute pearson correlation height result close rank correlation suggests skewness distribution weight explains di erence pearson spearman correlation correlation causation variable b correlated possible explanation cause b b cause set factor cause explanation called relationship correlation doe distinguish explanation doe tell one true rule summarized phrase doe imply causation pithy wikipedia page http provide evidence causation use time come b cause b way according common understanding tion order event help infer direction causation doe preclude possibility cause b use randomness divide large sample group dom compute mean variable expect di erence small group nearly identical variable eliminate spurious relationship work know relevant variable work better check group identical idea motivation randomized controlled trial subject assigned randomly group exercise group receives kind intervention like new medicine control group receives intervention treatment e ect known randomized controlled trial reliable way demonstrate causal relationship foundation medicine http unfortunately controlled trial possible laboratory science medicine discipline social science controlled periments rare usually impossible unethical alternative look natural experiment di erent ments applied group similar danger natural experiment group di er way apparent read topic http case possible infer causal relationship using regression analysis topic chapter exercise solution exercise exercise using data nsfg make scatter plot birth weight versus mother age plot percentile birth weight versus mother age compute pearson spearman correlation ize relationship variable glossary plot visualization relationship variable showing point row data random noise added data purpose chapter relationship variable loss information multiple point plotted statistic measure strength relationship variable transform set value mean variance score value standardized expressed standard deviation mean measure tendency variable vary gether index element appears sorted list controlled trial experimental design jects divided group random di erent group given di erent treatment group group controlled trial receives kind intervention group group controlled trial receives ment treatment e ect known experiment experimental design take advantage natural division subject group way approximately estimation code chapter information loading working code section estimation game let play game think distribution guess hint normal distribution random sample drawn think mean parameter distribution choice use sample mean x estimate example reasonable guess process called estimation statistic used sample mean called estimator using sample mean estimate obvious hard imagine reasonable alternative suppose change game introducing outlier thinking distribution normal distribution ple collected unreliable surveyor occasionally put decimal point wrong chapter estimation estimate use sample mean guess best choice alternative option identify discard outlier compute sample mean rest option use median estimator estimator best depends circumstance example outlier goal trying minimize error maximize chance getting right answer outlier sample mean minimizes mean squared error mse play game time time compute error sample mean minimizes mse mx wheremis number time play estimation game confused n size sample used compute function simulates estimation game computes root mean squared error rmse square root mse def mu sigma mean median range m x mu sigma range n xbar x median x xbar median print rmse xbar rmse mean mu print rmse median rmse median mu guess variance ni size sample mi number time play game mean list estimate based list median function computes rmse def rmse estimate actual estimate estimate mse return mse estimate list estimate actual actual value estimated practice course know actual did estimate purpose experiment compare performance estimator ran code rmse sample mean mean use xto estimate mean distribution based sample expect o average using median estimate mean yield rmse rms xyields lower rmse example minimizing mse nice property best strategy example suppose estimating distribution wind speed building site estimate high overbuild structure increasing cost low building collapse cost function error symmetric minimizing mse best strategy example suppose roll dice ask predict total exactly right prize case value minimizes mse bad guess total dice game want estimator highest chance right maximum likelihood estimator mle pick chance winning best guess variance thinking distribution normal distribution chapter estimation miliar sample think variance distribution obvious choice use sample variance estimator nx large sample adequate estimator small sample tends low unfortunate property called biased estimator estimator unbiased expected total mean error iteration estimation game fortunately simple statistic unbiased estimator explanation biased proof unbiased seehttp biggest problem estimator symbol used inconsistently variance refer symbol used function simulates estimation game test mance def mu sigma range m x mu sigma range n biased x unbiased x biased unbiased sampling distribution print mean error biased meanerror sigma print mean error unbiased meanerror sigma ni sample size mi number time play game default provide argument stand degree freedom wo explain term read http statistic meanerror computes mean di erence estimate actual value def meanerror estimate actual error estimate estimate return error ran code mean error expected biased estimator tends low mean error time smaller mincreases expect mean error approach property like mse bias expectation based iteration estimation game running simulation like one chapter compare estimator check desired property apply estimator real data just estimate meaningful say estimate unbiased unbiased property estimator estimate choose estimator appropriate property use generate estimate step characterize uncertainty estimate topic section sampling distribution suppose scientist studying gorilla wildlife preserve want know average weight adult female gorilla preserve weigh tranquilize dangerous chapter estimation possibly harmful gorilla important obtain information acceptable weigh sample gorilla let assume population preserve known choose representative sample adult female use sample mean x estimate unknown population mean having weighed female gorilla nd kg sample standard deviation kg sample mean unbiased estimator long run minimizes mse report single estimate summarizes result report kg dent estimate weigh gorilla larger population unlucky choose heaviest gorilla lightest one just chance variation estimate caused random selection called sampling error quantify sampling error simulate sampling process pothetical value xvaries know actual value population use estimate xands question answer actual value kg kg ran experiment time estimated mean x vary following function answer question def simulatesample mean j range m x mu sigma n xbar x xbar cdf mean ci stderr rmse mean mu muandsigma hypothetical value parameter ni sample size number gorilla measured mi number time run sampling distribution sample distribution figure sampling distribution x dence interval iteration choose nvalues normal distribution given parameter compute sample mean xbar run lations compute distribution cdf estimate result shown figure distribution called sampling tion estimator show estimate vary ran experiment mean sampling distribution pretty close hypothetical value mean experiment yield right answer average try lowest result kg highest kg range suggests estimate o kg common way summarize sampling distribution error se measure far expect estimate o average simulated experiment compute error compute root mean squared error rmse example roughly kg dence interval ci range includes given fraction sampling distribution example dence interval range percentile example ci chapter estimation standard error dence interval source confusion confuse standard error standard deviation remember standard deviation describes variability measured quantity example standard deviation gorilla weight kg standard error describes variability estimate example standard error mean based sample measurement kg way remember di erence sample size increase standard error get smaller standard deviation doe think probability actual rameter fall dence interval sadly true want make claim like use bayesian method book think bayes sampling distribution answer di erent question give sense reliable estimate telling vary ran experiment important remember dence interval standard error quantify sampling error error measuring population sampling distribution doe account source error notably sampling bias measurement error topic section sampling bias suppose instead weight gorilla nature preserve want know average weight woman city live unlikely allowed choose representative sample woman weigh simple alternative sampling choose random number phone book ask speak adult woman ask exponential distribution telephone sampling obvious limitation example sample limited people telephone number listed eliminates people phone poorer average people unlisted number richer home telephone day likely sample people job sample person answer phone likely sample people share phone line factor like income employment household size related plausible result survey ected way problem called sampling bias property sampling process sampling process vulnerable kind sampling bias people refuse answer question tendency refuse related weight ect result finally ask people weigh weighing result accurate helpful respondent round uncomfortable actual weight respondent helpful inaccuracy example measurement error report estimated quantity useful report standard error dence interval order quantify sampling error important remember sampling error source error biggest exponential distribution let play round estimation game thinking bution exponential distribution sample think parameter distribution general mean exponential distribution working ward choose chapter estimation li estimator just estimator mum likelihood estimator http distribution want maximize chance guessing li way know xi robust presence outlier expect l problem choose alternative based sample median median exponential distribution ln working backwards ne estimator ln wheremis sample median test performance estimator simulate sampling process def lam mean median range m x n l x lm x l lm print rmse l rmse mean lam print rmse lm rmse median lam print mean error l meanerror mean lam print mean error lm meanerror median lam run experiment rmse li estimator lm rmse ca tell experiment whetherlminimizes mse better lm sadly estimator biased lthe mean error forlmit converges exercise turn xi unbiased estimator mean distribution butlis unbiased estimator exercise following exercise nd starter code solution exercise chapter used xand median estimate lower mse used estimate biased run similar experiment xand median biased estimate check lower mse exercise suppose draw sample size tial distribution simulate experiment time plot sampling distribution estimate compute standard error estimate dence interval repeat experiment di erent value nand make plot standard error versus exercise game like hockey soccer time goal roughly exponential estimate team rate observing number goal score game estimation process little di erent sampling time goal let work write function take rate lam goal game simulates game generating time goal total time exceeds game return number goal scored write function simulates game store estimate lam computes mean error rmse way making estimate biased plot sampling distribution estimate dence interval standard error happens sampling error increasing value lam chapter estimation glossary process inferring parameter distribution sample statistic used estimate parameter squared error mse measure estimation error mean squared error rmse square root mse meaningful representation typical error magnitude likelihood estimator mle estimator putes point estimate likely correct estimator tendency estimator actual value parameter averaged repeated experiment error error estimate limited size sample variation chance bias error estimate sampling process representative population error error estimate inaccuracy ing recording data distribution distribution statistic ment repeated time error rmse estimate quanti e ity sampling error source error dence interval interval represents expected range estimator experiment repeated hypothesis testing code chapter information loading working code section classical hypothesis testing exploring data nsfg saw e ect cluding di erences rst baby far taken e ect face value chapter test fundamental question want address e ect sample likely appear larger population example nsfg sample di erence mean pregnancy length rst baby like know e ect ect real di erence woman appear sample chance way formulate question including fisher null hypothesis testing decision theory bayesian present subset make people use practice classical hypothesis testing bayesian inference sequel book think bayes chapter hypothesis testing goal classical hypothesis testing answer question sample apparent e ect probability seeing e ect chance answer question rst step quantify size apparent e ect choosing test statistic nsfg example apparent e ect di erence pregnancy length rst baby natural choice test statistic di erence mean group second step ne null hypothesis model based assumption apparent e ect real nsfg example null hypothesis di erence rst baby pregnancy length group distribution step compute probability seeing apparent e ect null hypothesis true nsfg example compute actual di erence mean pute probability seeing di erence big bigger null hypothesis step interpret result low e ect said statistically signi mean unlikely occurred chance case infer e ect likely appear larger population logic process similar proof contradiction prove mathematical statement assume temporarily false assumption lead contradiction conclude actually true similarly test hypothesis like e ect real assume ily null hypothesis based assumption compute probability apparent e ect low conclude null hypothesis unlikely hypothesistest hypothesistest provideshypothesistest class represents structure classical hypothesis test nition class hypothesistest object def self data data data def pvalue self range iters count sum x x return count iters def teststatistic self data raise unimplementedmethodexception def makemodel self pas def runmodel self raise unimplementedmethodexception hypothesistest abstract parent class provides complete tions method child class based hypothesistest andpvalue provide teststatistic runmodel optionally makemodel take data form appropriate call makemodel build representation null hypothesis pass data teststatistic computes size e ect sample pvalue computes probability apparent e ect null pothesis take parameter iters number simulation run rst line generates simulated data computes test chapter hypothesis testing store result fraction element exceed equal observed test statistic simple suppose toss coin time head tail based result suspect coin biased likely land head test hypothesis compute probability seeing di erence coin actually fair class cointest def teststatistic self data head tail data ab head tail return def runmodel self head tail n head tail sample ht range n hist sample data hist h hist t return data parameter data pair integer number head tail test statistic absolute di erence runmodel simulates coin toss assuming coin actually fair generates sample toss us hist count number head tail return pair integer instantiate cointest callpvalue ct cointest pvalue result mean coin fair expect di erence big time mackay information theory inference learning algorithm testing di erence mean interpret result convention threshold statistical signi cance e ect considered signi choice arbitrary later pends choice test statistic model null hypothesis considered precise measurement recommend interpreting according order magnitude e ect unlikely chance greater e ect plausibly explained chance considered borderline example conclude data provide strong evidence coin biased testing di erence mean common e ect test di erence mean group nsfg data saw mean pregnancy length rst baby slightly longer mean birth weight slightly smaller e ect statistically signi example null hypothesis distribution group way model null hypothesis tion value rst baby treating group big group class diffmeanspermute def teststatistic self data data ab return def makemodel self len len chapter hypothesis testing def runmodel self data return data data pair sequence group test statistic absolute di erence mean makemodel record size group nandm combine group numpy array runmodel simulates null hypothesis pooled value splitting group size nandm return value runmodel format observed data test di erence pregnancy length run live first data ht diffmeanspermute data pvalue makeframes read nsfg data return dataframes representing live birth rst baby extract pregnancy length numpy array pas data diffmeanspermute compute result mean expect di erence big observed e ect time e ect statistically signi hypothesistest provides plotcdf plot distribution test statistic gray line indicating observed e ect size test statistic cdf figure show result cdf intersects observed di erence complement run analysis birth weight computed attempt simulation yield e ect big observed di erence lb report p conclude di erence birth weight statistically signi test statistic difference mean week test figure cdf di erence mean pregnancy length null pothesis test statistic choosing best test statistic depends question trying address example relevant question pregnancy length di erent rst baby make sense test absolute di erence mean did previous section reason think rst baby likely late absolute value di erence instead use test statistic class diffmeansonesided diffmeanspermute def teststatistic self data data return diffmeansonesided inherits makemodel andrunmodel diffmeanspermute di erence teststatistic doe absolute value di erence kind test called count distribution di erences previous test using side chapter hypothesis testing version test general test half test depending shape distribution hypothesis rst baby born late speci c hypothesis smaller stronger hypothesis di erence statistically signi use framework test di erence standard deviation section saw evidence rst baby likely early late likely time hypothesize standard deviation higher test class diffstdpermute diffmeanspermute def teststatistic self data data return test hypothesis standard deviation rst baby higher just di erent statistically signi testing correlation framework test correlation example nsfg data set correlation birth weight mother age like older mother heavier baby e ect chance test statistic use pearson correlation spearman work reason expect positive correlation sided test reason test using absolute value correlation null hypothesis correlation mother age birth weight observed value simulate world distribution age birth weight variable testing proportion class correlationpermute def teststatistic self data x y data ab x y return def runmodel self x y x x return x y data pair sequence teststatistic computes absolute value pearson correlation runmodel xsand return simulated data code read data run test live first live agepreg data ht correlationpermute data pvalue usedropna thesubset argument drop row missing variable need actual correlation computed ations largest simulated correlation observed correlation small statistically signi example reminder signi doe mean e ect important signi practice mean unlikely occurred chance testing proportion suppose run casino suspect customer using crooked die modi ed make face chapter hypothesis testing apprehend alleged cheater scate die prove crooked roll die time following result value frequency average expect value appear time dataset value appears expected value appears di erences statistically signi test hypothesis compute expected frequency value di erence expected observed frequency total absolute di erence example expect come time deviation expectation total absolute di erence di erence chance version hypothesistest answer question class dicetest def teststatistic self data observed data n sum observed expected n sum ab observed expected return def runmodel self n sum value roll value n hist roll freqs value return freqs data represented list frequency observed value expected frequency test tic sum absolute di test null hypothesis die fair simulate drawing random sample value useshist compute return list frequency data mean die fair expect observed total deviation time apparent e ect statistically signi test previous section used total deviation test statistic testing proportion common use statistic ei whereoiare observed frequency eiare expected frequency python code class dicechitest dicetest def teststatistic self data observed data n sum observed expected n sum observed expected expected return squaring deviation taking absolute value give weight large deviation dividing expected standardizes deviation case e ect expected quencies equal using statistic substantially smaller got using total deviation threshold seriously consider e ect statistically signi considering test togther say result borderline rule possibility die crooked convict accused chapter hypothesis testing example demonstrates important point depends choice test statistic model null hypothesis choice determine e ect statistically signi baby earlier chapter looked pregnancy length rst baby concluded apparent di erences mean standard deviation statistically signi section saw apparent di erences distribution pregnancy length especially range week di erences statistically signi use test based statistic code combine element previous example class preglengthtest def makemodel self first len first first pmf range def runmodel self data return data data represented list pregnancy length null esis sample drawn distribution makemodel model distribution pooling sample using hstack runmodel generates simulated data pooled sample ting part makemodel ne value range week use baby probability value pooled bution code computes test statistic class preglengthtest def teststatistic self data first data stat first return stat def chisquared self length hist length observed expected len length stat sum observed expected expected return stat teststatistic computes statistic rst baby add chisquared take sequence pregnancy length computes histogram computes observed list frequency corresponding compute list expected frequency multiplies probability sample size return statistic stat nsfg data total statistic doe mean iteration largest test statistic generated null hypothesis conclude observed statistic unlikely null hypothesis apparent e ect tistically signi example demonstrates limitation test indicate di erence group say speci c di erence chapter hypothesis testing error classical hypothesis testing e ect considered statistically signi threshold commonly procedure raise question e ect actually chance probability wrongly consider signi probability false positive rate e ect real chance hypothesis test fail probability false negative rate false positive rate relatively easy compute threshold false positive rate real e ect null hypothesis true compute distribution test statistic simulating null hypothesis distribution cdf time run experiment test statistic t drawn cdft compute ity random value cdftexceedst t cdft t greater texceeds percentile doe value chosen cdftexceed percentile time perform hypothesis test threshold expect false positive time power false negative rate harder compute depends actual e ect size normally know option compute rate conditioned hypothetical e ect size example assume observed di erence group accurate use observed sample model population run hypothesis test simulated power def falsenegrate data data count range ht diffmeanspermute pvalue pvalue count return count falsenegrate take data form sequence group time loop simulates experiment drawing random sample group running hypothesis test check result count number false negative resample take sequence draw sample length replacement def resample x return x len x code test pregnancy length live first data falsenegrate data result mean actual di erence mean pregnancy length week expect experiment sample size yield negative test time result presented way actual di erence week expect positive test time positive rate called power test tivity ect ability test detect e ect given chapter hypothesis testing example test chance yielding positive result assuming di erence week rule thumb power considered acceptable say test general negative hypothesis test doe imply di erence group instead suggests di erence small detect sample size replication hypothesis testing process demonstrated chapter strictly speaking good practice performed multiple test run hypothesis test chance false positive acceptable run test expect false positive time second used dataset exploration testing explore large dataset nd surprising e ect test signi good chance generating false positive compensate multiple test adjust threshold http address problem partitioning data using set exploration testing eld practice required encouraged common address problem implicitly replicating published result typically rst paper report new result considered ploratory subsequent paper replicate result new data considered rmatory happens opportunity replicate result chapter rst edition book based cycle nsfg released october cdc released additional data based interview conducted contains code read clean data new exercise di erence mean pregnancy length week statistically signi p compared week original dataset di erence birth weight pound p compared lb original dataset correlation birth weight mother age p compared test statistically signi p original summary e ect statistically signi original dataset replicated new dataset di erence pregnancy length signi original bigger new dataset signi exercise solution exercise exercise sample size increase power hypothesis test crease mean likely positive e ect real conversely sample size decrease test likely positive e ect real investigate behavior run test chapter di erent set nsfg data use select random subset row dataframe happens test sample size decrease smallest sample size yield positive test exercise section simulated null hypothesis tion treated observed value represented entire population randomly assigned member population chapter hypothesis testing alternative use sample estimate distribution ulation draw random sample distribution process called resampling way implement resampling simplest draw sample replacement observed value section write class named diffmeansresample inherits diffmeanspermute override runmodel implement resampling permutation use model test di erences pregnancy length birth weight doe model ect result glossary testing process determining apparent e ect statistically signi statistic statistic used quantify e ect size hypothesis model based assumption apparent e ect chance probability e ect occur chance signi e ect statistically signi unlikely occur chance test way compute generating tations observed dataset test way compute generating sample replacement observed dataset test test asks chance e ect big observed e ect positive negative test test asks chance e ect big observed e ect sign glossary test test us statistic test statistic positive conclusion e ect real negative conclusion e ect chance probability positive test null hypothesis chapter hypothesis testingchapter linear square code chapter information ing working code section square t correlation measure strength sign relationship slope way estimate slope common alinear square t t line intended model relationship variable square t minimizes mean squared error mse line data suppose sequence point y want express function sequence x linear relationship x andyswith intercept inter slope slope expect y inter slope x unless correlation perfect prediction approximate vertical deviation line residual re y inter slope x residual random factor like measurement error random factor unknown example trying chapter linear square weight function height unknown factor include diet exercise body type parameter inter andslope wrong residual bigger make intuitive sense parameter want one minimize residual try minimize absolute value residual square cube common choice minimize sum squared residual sum re good reason important feature treating positive negative residual usually want give weight large residual weight largest residual dominates residual uncorrelated normally distributed mean constant unknown variance square t maximum likelihood estimator inter andslope seehttps value inter andslope minimize squared residual computed reason sense computational tant choosing method appropriate problem hand longer case worth considering squared uals right thing minimize example using xsto predict value y guessing high better worse guessing low case want compute cost function residual minimize total cost sum cost re computing square t quick easy good implementation implementation provides simple function demonstrate linear square def leastsquares x y meanx varx meanvar x meany mean y slope cov x y meanx meany varx inter meany slope meanx return inter slope leastsquares take sequence xsandysand return estimated tersinter andslope detail work http provides fitline take inter andslope turn tted line sequence x def fitline x inter slope x inter slope return use function compute square t birth weight function mother age live first live agepreg age weight inter slope age weight age inter slope estimated intercept slope lb lb year value hard interpret form intercept expected weight baby mother year old doe make sense context slope small grasp chapter linear square age year weight lb figure scatter plot birth weight mother age linear instead presenting intercept helpful present intercept mean case mean age year mean baby weight year old mother pound slope ounce year pound decade figure show scatter plot birth weight age tted line good idea look gure like assess relationship linear tted line like good model relationship residual useful test plot residual provides function computes residual def residual x y inter slope x x y y re y inter slope x return re residual take sequence xsandysand estimated parameter inter slope return di erences actual value estimation age year lb figure residual linear line visualize residual group respondent age compute centile group saw section figure show percentile residual age group median near zero expected interquartile range pound know mother age guess baby weight pound time ideally line indicating residual random parallel indicating variance residual age group fact line close parallel good curvature indicating relationship nonlinear linear t simple model probably good purpose estimation parameter slope andinter estimate based sample like estimate vulnerable sampling bias measurement error sampling error discussed chapter sampling bias caused sampling measurement error caused error chapter linear square collecting recording data sampling error result measuring sample entire population assess sampling error ask run experiment variability expect estimate answer question running simulated experiment computing sampling distribution estimate simulate experiment resampling data treat served pregnancy entire population draw sample replacement observed sample def samplingdistributions live t range iters sample live age weight estimate age weight estimate inters slope zip t return inters slope samplingdistributions take dataframe row live birth anditers number experiment simulate us resamplerows resample observed pregnancy seen samplerows chooses random row dataframe provides resamplerows return sample size original def resamplerows df return samplerows df len df resampling use simulated sample estimate parameter result sequence estimated intercept estimated slope summarize sampling distribution printing standard error dence interval def summarize estimate mean estimate stderr estimate estimation cdf estimate ci print mean se ci mean stderr ci summarize take sequence estimate actual value print mean estimate standard error dence interval intercept mean estimate standard error dence interval estimated slope compact form se ci factor low high end ci considered rough estimate visualize sampling error estimate plot tted line cluttered representation plot dence interval age code def plotconfidenceintervals x inters slope option inter slope zip inters slope fxs fys x inter slope fys p percent percent p p low high percent fxs low high option xsis sequence mother age inters andslopes estimated parameter generated samplingdistributions indicates dence interval plot plotconfidenceintervals generates tted line pair inter andslope store result sequence us percentilerows select upper lower percentile yfor value ofx dence interval selects percentile fillbetween draw polygon lls space line figure show dence interval curve tted birth weight function mother age vertical width chapter linear square age year weight lb figure dence interval showing variability tted line sampling error inter andslope represents e ect sampling error e ect smaller value near mean larger extreme goodness t way measure quality linear model goodness t simplest standard deviation residual use linear model make prediction std re root mean squared error rmse prediction example use mother age guess birth weight rmse guess lb guess birth weight knowing mother age rmse guess std y lb example knowing mother age doe improve prediction substantially way measure goodness t tion usually denoted called def coefdetermination y re return var re var y goodness t var re mse guess using model var y mse ratio fraction mse remains use model fraction mse model eliminates birth weight mother age mean mother age predicts half variance birth weight simple relationship determination pearson correlation example used quantify strength relationship easy interpret term predictive power opinion std re best representation quality prediction especially presented relation std y example people talk validity sat standardized test used college admission talk correlation sat score measure intelligence according study pearson correlation total sat score iq score sound like strong correlation sat score account variance iq iq score normalized std y rho rho using sat score predict iq reduces rmse point point correlation yield reduction rmse correlation look impressive remember better indicator reduction mse reduction rmse better indicator predictive chapter linear square testing linear model e ect mother age birth weight small little predictive power possible apparent relationship chance way test result linear option test apparent reduction mse chance case test statistic null hypothesis relationship variable simulate null hypothesis permutation section tested correlation mother age birth weight fact test equivalent test test foundp conclude apparent relationship mother age birth weight statistically signi approach test apparent slope chance null hypothesis slope actually zero case model birth weight random variation mean hypothesistest model class slopetest def teststatistic self data age weight data slope age weight return slope def makemodel self weight weight def runmodel self age weight return age weight data represented sequence age weight test statistic slope estimated leastsquares model null hypothesis represented mean weight baby deviation testing linear model mean generate simulated data permute deviation add mean code run hypothesis test live first live agepreg ht slopetest pvalue estimated slope small unlikely chance estimating simulating null hypothesis strictly correct simpler alternative remember computed sampling distribution slope section assumed observed slope correct simulated experiment resampling figure show sampling distribution slope section distribution slope generated null hypothesis pling distribution centered estimated slope slope null hypothesis centered distribution identical distribution symmetric reason section estimate way probability slope null hypothesis ceeds observed slope probability slope sampling distribution fall estimated slope negative compute probability slope sampling distribution exceeds second option easier normally want compute pling distribution parameter good approximation unless sample size small distribution residual skewed usually good precise code estimate slope using sampling chapter linear square slope lb year hypothesis sampling distribution figure sampling distribution estimated slope bution slope generated null hypothesis vertical line observed slope inters slope samplingdistributions live slope pvalue nd p weighted resampling far treated nsfg data representative sample mentioned section survey deliberately sample group order improve chance getting statistically signi result order improve power test involving group survey design useful purpose mean use sample estimate value general population accounting sampling process respondent nsfg data includes variable called finalwgt number people general population respondent represents value called sampling weight just weighted resampling example survey people country million respondent represents people oversample group factor person oversampled group lower weight correct oversampling use resampling draw sample survey using probability proportional sampling weight quantity want estimate generate sampling tributions standard error dence interval example estimate mean birth weight sampling weight section saw resamplerows chooses row dataframe giving row probability need thing using probability proportional sampling weight resamplerowsweighted take dataframe resamples row according weight finalwgt return dataframe containing resampled row def resamplerowsweighted df finalwgt weight df column cdf cdf dict weight index len weight sample index return sample weight series converting dictionary make map index weight cdfthe value index probability proportional weight index sequence row index sample dataframe contains selected row sample replacement row appear compare e ect resampling weight weight generate sampling distribution like estimate resamplerows live range iters weight look like estimate resamplerowsweighted live range iters chapter linear square following table summarizes result mean birth standard ci weight lb error unweighted weighted example e ect weighting small di ence estimated mean weighting pound ounce di erence substantially larger standard error estimate pound implies di erence chance exercise solution exercise exercise using data brfss compute linear square t log weight versus height best present estimated parameter model like variable transformed trying guess weight help know height like nsfg brfss oversamples group provides sampling weight respondent brfss data variable weight finalwt use resampling weight estimate mean height respondent brfss standard error mean dence interval doe correct weighting ect estimate glossary t line intended model relationship variable square t model dataset minimizes sum square glossary deviation actual value model t measure model t data determination statistic intended quantify ness weight value associated observation sample indicates population chapter linear squareschapter regression linear square t previous chapter example sion general problem tting kind model kind data use term historical accident indirectly related original meaning word goal regression analysis relationship set variable called dependent variable set variable called independent explanatory variable previous chapter used mother age explanatory variable predict birth weight dependent variable dent explanatory variable simple regression ter multiple regression explanatory variable dependent variable multivariate regression relationship dependent explanatory variable linear linear regression example dependent variable yand explanatory variable write following linear regression model intercept parameter associated parameter associated residual random variation unknown chapter regression given sequence value yand sequence nd parameter minimize sum cess called ordinary square computation similar generalized deal planatory variable nd detail http code chapter information loading working code section statsmodels previous chapter presented mentation simple linear regression intended easy read tiple regression switch statsmodels python package provides form regression analysis using anaconda statsmodels install example run model previous chapter el import smf live first formula agepreg model formula result statsmodels provides interface apis api us string identify dependent explanatory variable us syntax called patsy example separate dependent variable left explanatory variable right take formula string dataframe live return ols object represents model olsstands square thefitmethod t model data return regressionresults object contains statsmodels result available attribute params series map variable name parameter intercept slope like inter intercept slope agepreg estimated parameter leastsquares pvalues series map variable name associated check estimated slope statistically signi agepreg associated agepreg expected provides associated model similar testing statistically signi andresults providesresid sequence residual fittedvalues sequence tted value corresponding agepreg result object provides summary represents result readable format print print lot information relevant use simpler function called summarizeresults result model intercept agepreg std y std re std y standard deviation dependent variable rmse guess birth weight bene t tory variable std re standard deviation residual rmse guess informed mother age seen knowing mother age provides substantial improvement chapter regression multiple regression section saw rst baby tend lighter e ect statistically signi strange result obvious mechanism cause rst baby lighter wonder relationship spurious fact possible explanation e ect seen birth weight depends mother age expect mother rst baby younger calculation check explanation plausible use multiple regression investigate carefully let big di erence weight baby lb lighter ounce di erence age mother rst baby year younger running linear model change birth weight function age result agepreg slope agepreg slope pound year multiply slope di erence age expected di erence birth weight rst baby mother age slope result just half observed di erence clude tentatively observed di erence birth weight partly explained di erence mother age using multiple regression explore relationship ically live isfirst formula isfirst result formula multiple regression rst line creates new column named isfirst true rst baby false t model using isfirst planatory variable result intercept isfirst becauseisfirst boolean olstreats categorical variable mean value fall category like true false treated number estimated parameter e ect birth weight isfirst true result lb di erence birth weight rst baby slope intercept statistically signi mean unlikely occur chance model small mean isfirst doe account substantial variation birth weight result similar agepreg intercept agepreg parameter statistically signi low model rm result seen t single model includes variable formula isfirst agepreg intercept isfirst agepreg combined model parameter isfirst smaller half mean apparent e ect isfirst actually accounted byagepreg isfirst border statistical signi chapter regression model little higher indicates variable account variation birth weight nonlinear relationship remembering contribution agepreg nonlinear consider adding variable capture relationship option create column contains square age live formula isfirst agepreg estimating parameter agepreg e ectively tting parabola intercept isfirst agepreg parameter negative parabola curve downward consistent shape line figure quadratic model agepreg account variability birth weight parameter isfirst smaller model longer statistically signi using computed variable like common way t polynomial function data process considered linear regression dependent variable linear function explanatory ables regardless variable nonlinear function following table summarizes result regression rst agepreg model model model model data mining column table explanatory variable determination entry estimated parameter parenthesis asterisk indicate conclude apparent di erence birth weight explained di erence mother age include mother age model e ect isfirst get smaller remaining e ect chance example mother age act control variable including agepreg model di erence age mother making possible isolate e ect isfirst data mining far used regression model explanation example previous section discovered apparent di erence birth weight actually di erence mother age model low mean little predictive power section try better suppose expecting baby pool guess baby birth weight familiar betting pool http suppose really want win pool improve chance nsfg dataset includes variable pregnancy variable respondent maybe variable predictive power nd one useful try testing variable pregnancy table easy order use variable respondent table match pregnancy respondent theory iterate row pregnancy table use caseid nd corresponding respondent copy value correspondent table pregnancy table chapter regression better option recognize process join operation ned sql relational database language http sql join implemented dataframe method perform operation like live live resp join resp caseid rst line selects record pregnancy longer week assuming pool formed week date line read respondent le result dataframe ger index order look respondent replace thejoin method invoked live considered table passed resp table keyword argument indicates variable used match row table example column name appear table providersuffix string appended name overlapping column right table example table column named race encodes race respondent result join contains column named race panda implementation fast joining nsfg table take second ordinary desktop computer start testing variable t try join continue formula agepreg model formula len join prediction result valueerror typeerror continue variable construct model compute append result list model include agepreg know predictive power check explanatory variable variability sults regression unreliable check number observation model variable contain large number nan good candidate prediction variable cleaning encoded way work linear regression result overlook variable useful cleaned properly maybe nd good candidate prediction step sort result select variable yield highest value mse t print mse rst variable list followed viously ca use birth weight predict birth weight similarly prglngth useful predictive power pool assume pregnancy length related variable known rst useful predictive variable babysex indicates baby male female nsfg dataset boy lb heavier assuming sex baby known use chapter regression israce indicates respondent white black explanatory variable race problematic datasets like nsfg race correlated variable including income socioeconomic factor regression model race act proxy variable apparent correlation race caused factor variable list nbrnaliv indicates nancy yielded multiple birth twin triplet tend smaller baby know hypothetical expecting twin help list paydu indicates respondent owns home variable turn predictive datasets like nsfg income wealth correlated just example income related diet health health care factor likely ect birth weight variable list thing known later like bfeedwks number week baby breast fed ca use variable prediction want speculate reasonsbfeedwks correlated birth weight start theory use data test time start data looking possible theory second approach section demonstrates called data mining advantage data mining discover unexpected pattern hazard pattern discovers random spurious having identi ed potential explanatory variable tested model settled formula agepreg c race nbrnaliv totincr result formula formula us syntax seen c race tell formula parser patsy treat race categorical variable encoded numerically encoding babysex male female writing convert boolean true male false logistic regression similarly nbrnaliv true multiple birth true respondent house totincr encoded numerically increment representing annual income treat value numerical expressed unit result model intercept c race c race babysex nbrnaliv paydu agepreg totincr estimated parameter race larger expected especially control income encoding black white baby black mother lighter baby race lb seen boy heavier lb twin multiplets lighter lb people home heavier baby lb control income parameter mother age smaller saw section suggests variable correlated age probably including paydu andtotincr variable statistically signi low quite small rmse using model lb model drop chance winning pool substantially improved sorry logistic regression previous example explanatory variable numerical categorical including boolean dependent variable chapter regression linear regression generalized handle kind dependent ables dependent variable boolean generalized model called logistic regression dependent variable integer count called poisson regression example logistic regression let consider variation pool scenario suppose friend pregnant want predict baby boy girl use data nsfg nd factor ect ratio conventionally ned probability having boy encode dependent variable numerically example girl boy apply ordinary square problem linear model like whereyis dependent variable explanatory variable nd parameter minimize residual problem approach produce prediction hard interpret given estimated parameter value model predict meaningful value yare tempting interpret result like probability example say respondent particular value chance having boy possible model predict valid probability logistic regression avoids problem expressing prediction term odds probability familiar odds favor event ratio probability occur probability think team chance winning say odds favor chance winning time chance losing odds probability di erent representation information given probability compute odds like estimating parameter o p given odds favor convert probability like p o logistic regression based following model whereois odds favor particular outcome example owould odds having boy suppose estimated parameter explain minute suppose given value compute predicted value log o convert probability o p o pool scenario compute predictive probability having boy estimate parameter estimating parameter unlike linear regression logistic regression doe closed form tion solved guessing initial solution improving iteratively usual goal nd estimate mle set parameter maximizes likelihood data example suppose following data y start initial guess beta row compute beta beta beta chapter regression convert log odds probability o p o notice greater ois greater pi greater likelihood outcome example think probability boy outcome boy likelihood outcome girl likelihood compute like like y p overall likelihood data product like like like value beta likelihood data goal logistic regression nd parameter maximize lihood statistic package use iterative solver like newton method http regression implementation statsmodels provides implementation logistic regression called logit named function convert probability log odds strate use look variable ect sex ratio load nsfg data select pregnancy longer week live first df live logit requires dependent variable binary boolean create new column named boy usingastype int convert binary implementation df boy int factor ect sex ratio include parent age birth order race social status use logistic regression e ect appear nsfg data start mother age import smf model boy agepreg result summarizeresults result logit take argument ols formula patsy syntax dataframe result logit object represents model tains attribute called endog andexog contain endogenous able dependent variable exogenous ables explanatory variable numpy array convenient convert dataframes endog exog result binaryresults object similar regressionresults object got ols summary result intercept agepreg parameter agepreg positive suggests older mother likely boy mean apparent e ect easily chance determination doe apply logistic regression alternative used value useful comparing model example model includes factor believed associated sex ratio formula boy agepreg hpagelb birthord c race model formula result mother age model includes father age birth hpagelb birth order birthord race categorical variable chapter regression intercept c race c race agepreg hpagelb birthord estimated parameter statistically signi value little higher chance accuracy pool scenario interested accuracy model number successful prediction compared expect chance nsfg data boy girl baseline strategy guess time accuracy strategy just fraction boy actual endog boy baseline sinceactual encoded binary integer mean fraction boy compute accuracy model predict predict actual predict actual return numpy array probability round o multiplying actual yield predict boy right indicates positive similarly indicates case guess right accuracy fraction correct guess acc sum sum len actual exercise result slightly better baseline result seriously used data build test model model predictive power new data let use model make prediction pool suppose friend year old white husband expecting child column agepreg hpagelb birthord race new y new invoke new case construct dataframe column variable model result case guess model improves chance winning di erence small exercise solution exercise exercise suppose expecting baby participating pool predict date birth assuming bet placed week pregnancy variable use make best prediction limit variable known birth likely available people pool exercise hypothesis suggests mals sex ratio depends condition factor like mother age size health social status http study shown e ect human result mixed chapter tested variable related factor did nd statistically signi e ect sex ratio exercise use data mining approach test variable pregnancy respondent le nd factor substantial e ect chapter regression exercise quantity want predict count use poisson regression implemented statsmodels function calledpoisson work way olsandlogit exercise let use predict child woman born nsfg dataset variable called numbabes suppose meet woman year old black college graduate annual household income exceeds child predict born exercise quantity want predict categorical use multinomial logistic regression implemented statsmodels function called mnlogit exercise let use guess woman married cohabitating widowed divorced separated married nsfg dataset marital status encoded variable called rmarital suppose meet woman year old white high school graduate annual household income probability married cohabitating glossary related process estimating parameter t model data variable variable regression model like predict known endogenous variable variable variable used predict explain dependent variable known independent exogenous ables regression regression dependent explanatory variable regression regression multiple explanatory ables dependent variable regression regression based linear glossary square linear regression estimate ters minimizing squared error residual relationship relationship variable caused statistical artifact factor included model related variable variable variable included regression eliminate spurious relationship variable variable contributes information sion model indirectly relationship factor act proxy factor variable variable discrete set unordered value operation combine data dataframes using key match row frame mining approach nding relationship variable testing large number model regression form regression used dependent variable boolean regression form regression used dependent variable integer usually count alternative way representing probability p ratio probability complement chapter regressionchapter time series analysis atime series sequence measurement varies time famous example stick graph show global age temperature time http example work chapter come zachary jones researcher political science study black market cannabis http collected data web site called weed crowdsources market information asking participant report price quantity quality location cannabis transaction http goal project investigate e ect policy decision like legalization market nd project appealing example us data address important political question like drug policy hope nd chapter interesting opportunity reiterate importance maintaining professional attitude data analysis drug illegal important public policy question decision informed accurate data reported honestly code chapter information loading working code section chapter time series analysis importing cleaning data downloaded jones site repository book following code read panda dataframe transaction interpret value column date convert numpy object dataframe row reported transaction following column string city state abbreviation price paid dollar quantity purchased gram high medium low quality reported purchaser date report presumed shortly date purchase price gram dollar string state approximate latitude transaction based city approximate longitude transaction transaction event time treat dataset time series event equally spaced time number transaction reported day varies method used analyze time series require measurement equally spaced thing simpler order demonstrate method divide dataset group reported quality transform group equally spaced series computing mean daily price importing cleaning def groupbyqualityandday transaction group quality daily group group daily groupbyday group return daily groupby dataframe method return groupby object group used loop iterates name group dataframes represent value quality arelow medium andhigh group name loop iterates group call groupbyday computes daily average price return new dataframe def groupbyday transaction grouped transaction date ppg date daily func daily date start y daily year start return daily parameter transaction dataframe contains column date andppg select column group date result grouped map date dataframe contains price reported date aggregate groupby method iterates group applies function column group case column ppg result aggregate dataframe row date column ppg date dataframes stored numpy object represented integer nanosecond analysis coming convenient work time unit like year groupbyday add column named date copying chapter time series analysis index add year contains number year rst transaction number resulting dataframe column ppg date andyears plotting result groupbyqualityandday map quality dataframe daily price code use plot time series daily enumerate title price gram preplot mean planning make subplots laid row loop iterates dataframes creates scatter plot common plot time series line segment point case data point price highly variable adding line help label date use rotate degree making readable figure show result apparent feature plot gap november possible data collection active time data available consider way deal missing data later visually look like price high quality cannabis declining period price medium quality increasing price low quality increasing harder tell plotting gram high medium nov nov nov nov low figure time series daily price gram high medium low quality chapter time series analysis volatile mind quality data reported volunteer trend time ect change participant apply label linear regression method speci c time series analysis lem simple way started applying tool like linear regression following function take dataframe daily price computes square t returning model result object statsmodels def runlinearmodel daily model ppg year result return model result iterate quality t model daily model result runlinearmodel daily print result result quality intercept high medium low estimated slope indicate price high quality cannabis dropped cent year observed interval medium quality increased cent year low quality increased cent year estimate statistically signi small high quality cannabis mean time explanatory variable account observed variability price quality change price smaller variability price higher value smaller statistically signi linear regression gram fitted value model high figure time series daily price gram high quality cannabis linear square following code plot observed price tted value def plotfittedvalues model result year value year value year model saw section model contains exog andendog numpy array exogenous explanatory endogenous dependent variable plotfittedvalues make scatter plot data point line plot tted value figure show result high quality cannabis model like good linear t data linear regression appropriate choice data reason expect trend line simple function general price determined supply demand vary time unpredictable way linear regression model give equal weight data recent past purpose prediction probably weight recent chapter time series analysis assumption linear regression residual uncorrelated noise time series data assumption false successive value correlated section present alternative appropriate time series data moving average time series analysis based modeling assumption served series sum component smooth function capture persistent change periodic variation possibly including daily weekly monthly yearly cycle random variation trend regression way extract trend series saw previous section trend simple function good alternative amoving average moving average divide series overlapping region called window computes average value window simplest moving average rolling mean computes mean value window example window size rolling mean computes mean value panda provides take series window size return new series series array series array nan nan moving average rst value nan value mean rst element value mean apply cannabis data deal missing value day observed interval reported transaction quality category period data collection active dataframes used far date absent index skip day data analysis follows need represent missing data explicitly dataframe date reindexed date rst line computes date range includes day ginning end observed interval second line creates new dataframe data daily including row date lled nan plot rolling mean like window size value mean value figure left show result rolling mean good job smoothing noise extracting trend rst value nan missing value followed nan way ll gap minor nuisance alternative moving average ewma advantage suggests computes weighted average recent value highest weight weight previous value drop o exponentially second panda implementation ewma handle missing value better ewma ewma chapter time series analysis nov nov nov nov gram rolling mean high nov nov nov nov ewma high figure daily price rolling mean left moving average right thespan parameter corresponds roughly window size moving average control fast weight drop o determines number point make contribution average figure right show ewma data similar rolling mean ned missing value make easier work value noisy beginning time series based fewer data point missing value characterized trend time series step investigate seasonality periodic behavior time series data based human behavior exhibit daily weekly monthly yearly cycle section present method test seasonality work missing data solve problem rst simple common way ll missing data use moving average series method fillna doe just want reindexed ppg ewma serial correlation nov nov nov nov gram ewma high figure daily price lled data isnan fillna replaces corresponding value ewma drawback method understates noise series solve problem adding resampled residual resid ewma ewma resid len reindexed reindexed ppg ewma resid contains residual value including day ppgisnan contains sum moving average random sample residual finally fillna replacesnanwith value figure show result lled data visually similar actual value resampled residual random result di erent time later characterize error created missing value serial correlation price vary day day expect pattern price high monday expect high day chapter time series analysis low expect stay low pattern like called serial correlation value correlated series compute serial correlation shift time series interval called lag compute correlation shifted series original def serialcorr series x series lag y lag lag corr x y return corr shift rst lagvalues nan use slice remove computing corr apply serialcorr raw price data lag nd serial correlation high quality category medium low time series trend expect strong serial correlation example price falling expect value mean rst half series value mean second half interesting correlation persists subtract away trend example compute residual ewma compute serial correlation ewma resid ewma corr serialcorr resid serial correlation data high quality medium low value small indicating little serial correlation series check weekly monthly yearly seasonality ran analysis di erent lag result lag high medium low autocorrelation section test correlation statistically ni point tentatively conclude substantial seasonal pattern series lag autocorrelation think series serial correlation know lag test test autocorrelation function function map lag serial correlation given lag serial correlation used lag statsmodels used linear regression section vides function time series analysis including acf computes autocorrelation function import smtsa acf acf computes serial correlation lag nlags unbiased ag tell acfto correct estimate sample size result array correlation select daily price high quality extract correlation lag rm acf andserialcorr yield approximately result acf acf acf acf acf acfcomputes correlation series figure left show autocorrelation function quality egories gray region show normal variability expect actual autocorrelation fall outside range statistically signi false positive rate computing correlation lag time series expect point outside region fact conclude autocorrelations series explained chapter time series analysis lag day high medium low lag day high medium low figure autocorrelation function daily price left daily price simulated weekly seasonality right computed gray region resampling residual code function called simulateautocorrelation autocorrelation function look like seasonal component generated simulated data adding weekly cycle assuming demand cannabis higher weekend expect price higher simulate e ect select date fall friday saturday add random price chosen uniform distribution def addweeklyseasonality daily frisat fake frisat return fake frisat boolean series true day week friday saturday fake new dataframe initially copy daily modify adding random value total number friday saturday number random value generate figure right show autocorrelation function price prediction ulated seasonality expected correlation highest lag multiple high medium quality new correlation tistically signi low quality residual category large e ect bigger visible noise prediction time series analysis used investigate explain behavior system vary time make prediction linear regression used section used prediction regressionresults class provides predict take dataframe containing explanatory variable return sequence prediction code def generatesimpleprediction result year n len year inter n d dict d predict return predict result regressionresults object year sequence time value want prediction function construct dataframe pass predict return result want single prediction purpose important quantify error word want know accurate prediction likely source error account error prediction based estimated parameter depend random variation sample run iment expect estimate chapter time series analysis variation estimated parameter perfect observed data varies randomly trend expect variation continue future error seen evidence trend linear prediction based linear model eventually fail source error consider unexpected future event agricultural price ected weather price ected politics law write cannabis legal state legal medical purpose state legalize price likely federal government crack price modeling error unexpected future event hard quantify sampling error random variation easier deal rst quantify sampling error use resampling did section goal use actual observation simulate happen ran experiment simulation based assumption estimated parameter correct random uals di erent function run simulation def simulateresults daily model result runlinearmodel daily fake range iters resample runlinearmodel fake return daily dataframe containing observed price iters number simulation run simulateresults usesrunlinearmodel section estimate slope intercept observed prediction time loop generates dataset resampling residual adding tted value run linear model fake data store regressionresults object step use simulated result generate prediction def generatepredictions year n len year d dict n d predict predict n predict return generatepredictions take sequence result previous step year sequence oat speci e interval erate prediction indicates add resampled residual prediction generatepredictions iterates sequence regressionresults generates sequence prediction finally code plot dence interval tions def plotpredictions daily year simulateresults daily p percent percent p generatepredictions year true low high percent year low high gray generatepredictions year false chapter time series analysis gram prediction high figure prediction based linear t showing variation pling error prediction error low high percent year low high gray plotpredictions callsgeneratepredictions twice usespercentilerows select percentile year plot gray region bound figure show result dark gray region represents dence interval sampling error uncertainty estimated slope intercept sampling lighter region show dence interval prediction error sum sampling error random variation region quantify sampling error random variation eling error general modeling error hard quantify case address source error unpredictable external event regression model based assumption tionary parameter model change time speci cally assumes slope intercept constant distribution prediction gram prediction medium figure prediction based linear t showing variation interval observation looking moving average figure like slope change observed interval variance residual bigger rst half second result parameter depend interval observe e ect prediction extend simulateresults use interval observation di erent start end date mentation figure show result medium quality category lightest gray area show dence interval includes uncertainty pling error random variation variation interval observation model based entire interval positive slope indicating price increasing recent interval show sign decreasing price model based recent data negative slope result widest predictive interval includes possibility decreasing price chapter time series analysis reading time series analysis big topic chapter scratched surface important tool working time series data autoregression did cover turn useful example data worked learned material chapter prepared learn autoregression resource recommend philipp janert book data analysis open source tool medium chapter time series analysis pick leaf o exercise solution exercise exercise linear model used chapter obvious linear reason expect price change linearly time add exibility model adding quadratic term did section use quadratic model t time series daily price use model generate prediction write version runlinearmodel run quadratic model able reuse code generate prediction exercise write nition class named serialcorrelationtest extends hypothesistest section series lag data compute serial correlation series given lag compute observed correlation use class test serial correlation raw price data statistically signi test residual linear model did previous exercise quadratic model exercise way extend ewma model erate prediction simplest like compute ewma time series use point intercept inter glossary compute ewma di erences successive element time series use point slope slope predict value future time compute inter slope dt wheredtis di erence time prediction time observation use method generate prediction year observation hint ll missing value running analysis way time consecutive element sistent compute di erences successive element extend dataframe index future predicted value dataframe glossary series dataset value associated tamp series measurement time collected sequence consecutive value time series used compute moving average average statistic intended estimate underlying trend time series computing average kind series overlapping window mean moving average based mean value chapter time series analysis moving average ewma moving erage based weighted mean give highest weight recent value exponentially decreasing weight earlier ues parameter ewma determines quickly weight decrease correlation correlation time series shifted lagged version size shift serial correlation autocorrelation general term serial correlation lag function function map lag serial correlation model stationary parameter tion residual doe change survival analysis survival analysis way long thing used study human lifetime applies mechanical electronic component generally interval time event know diagnosed disease seen survival rate probability surviving ve year diagnosis estimate related statistic result survival analysis code chapter information loading working code section survival curve fundamental concept survival analysis survival curve s t function map duration t probability ing longer know distribution duration nding survival curve easy just complement cdf s t t wherecdf t probability lifetime equal chapter survival analysis survival cdf t week figure cdf survival curve pregnancy length hazard curve example nsfg dataset know duration complete pregnancy read data compute cdf preg complete outcome cdf complete cdf outcome code indicate live birth stillbirth miscarriage analysis excluding induced abortion ectopic pregnancy pregnancy progress respondent interviewed dataframe method query take boolean expression evaluates row selecting row yield true figure show cdf pregnancy length complement survival curve represent survival curve ne object wrap cdf adapts interface class survivalfunction object def self cdf cdf label survival curve property def t self return property def s self return survivalfunction provides property t sequence lifetime s survival curve python method invoked variable instantiate survivalfunction passing cdf lifetime sf survivalfunction cdf survivalfunction provides andprob evaluates survival curve class survivalfunction def self t return t def prob self t return t example sf fraction pregnancy proceed past rst trimester sf cdf pregnancy proceed past rst trimester survivalfunction provides render plot sfusing function inthinkplot sf chapter survival analysis figure show result curve nearly week show pregnancy end second trimester curve steepest week common pregnancy length hazard function survival curve derive hazard function pregnancy length hazard function map time t fraction cies continue tand end precise t t s t numerator fraction lifetime end t pmf t survivalfunction provides makehazard calculates hazard tion class survivalfunction def makehazard self s lam t enumerate hazard s s s lam t hazard return hazardfunction lam thehazardfunction object wrapper panda series class hazardfunction object def self d d inferring survival curve dcan dictionary type initialize series including series label string used identify hazardfunction plotted hazardfunction provides evaluate like hf hf pregnancy proceed week end week figure show hazard function pregnancy length time week hazard function erratic based small number case shape curve expected highest week little higher rst trimester second hazard function useful right important tool estimating survival curve section inferring survival curve give cdf lifetime easy compute survival hazard function scenario ca measure distribution lifetime directly infer example suppose following group patient long survive diagnosis patient diagnosed day point time patient survived longer patient died know survival time patient alive know survival time lower bound wait patient dead compute survival curve evaluating e ectiveness new treatment ca wait long need way estimate survival curve using incomplete tion cheerful example use nsfg data quantify long respondent married rst time chapter survival analysis respondent age year dataset provides snapshot woman di erent stage life woman married dataset includes date rst marriage age time woman married know age interviewed way knowing married know age rst marriage woman ing exclude rest compute cdf known data bad idea result doubly misleading older woman overrepresented likely married interviewed married woman overrepresented fact analysis lead conclusion woman married obviously incorrect estimation example desirable necessary include observation unmarried woman brings central algorithm survival analysis estimation general idea use data estimate hazard function convert hazard function survival curve estimate hazard function consider age number woman got married age number woman risk getting married includes woman married earlier age code def estimatehazardfunction complete ongoing counter complete counter ongoing t list estimation len complete len ongoing lam t t ended t censored t lam t ended ended censored return hazardfunction lam complete set complete observation case age respondent got married ongoing set incomplete observation age unmarried woman interviewed precompute counter map age number woman married age map age number unmarried woman interviewed age tsis union age respondent got married age ried woman interviewed sorted increasing order keep track number respondent considered risk age initially total number respondent result stored panda series map age estimated hazard function age time loop consider age t compute number event end t number respondent married age number event censored t number woman interviewed twhose future marriage date censored context mean data unavailable data collection process estimated hazard function fraction case risk end end loop subtract number case ended censored chapter survival analysis finally pas lam thehazardfunction constructor return result marriage curve test function data cleaning transformation nsfg variable need respondent date birth known respondent date respondent interviewed known spondents date respondent rst married applicable known respondent married prior date interview rst variable encoded integer number month december january read respondent le replace invalid value cmmarrhx resp resp cmmarrhx compute respondent age married age viewed resp agemarry resp age extract complete age marriage woman married ongoing age interview woman complete resp ongoing resp finally compute hazard estimating survival curve hf estimatehazardfunction complete ongoing figure show estimated hazard function low teen higher declining increase artifact estimation process number respondent risk decrease small number woman getting married yield large estimated hazard survival curve smooth noise estimating survival curve hazard function estimate survival curve chance surviving past time ti chance surviving time t cumulative product complementary hazard function t thehazardfunction class provides makesurvival computes product class hazardfunction def makesurvival self t s cdf t sf survivalfunction cdf return sf tsis sequence time hazard function estimated ssis cumulative product complementary hazard function survival curve way survivalfunction implemented compute complement s make cdf instantiate survivalfunction object figure show result survival curve steepest woman married curve nearly indicating woman marry age unlikely chapter survival analysis age year unmarried figure hazard function age rst marriage survival curve curve like basis famous magazine article newsweek reported old unmarried woman likely killed terrorist married statistic widely reported popular culture wrong based faulty analysis turned wrong cultural change progress continued newsweek ran article admitting wrong encourage read article statistic based reaction remind ethical obligation perform statistical analysis care interpret result appropriate cism present public accurately honestly dence interval analysis yield single estimate survival curve important quantify uncertainty estimate usual possible source error measurement error sampling error modeling error example measurement error probably small people generally dence interval born married expected report information accurately quantify sampling error resampling code def resamplesurvival resp low high t low high range iters sample resp hf sf estimatesurvival sample t low high t low high resamplesurvival takesresp dataframe respondent iters number time resample computes t sequence age evaluate survival curve inside loop resamplesurvival respondent using resamplerowsweighted saw section us process previous tions estimate hazard survival curve survival curve age t sequence evaluated survival curve percentilerows take sequence computes percentile returning dence interval survival curve figure show result survival curve estimated previous section dence interval take account sampling weight unlike estimated curve discrepancy indicates sampling weight substantial e ect chapter survival analysis age year unmarried figure survival curve age rst marriage dark line dence interval based weighted resampling gray line cohort e ect challenge survival analysis di erent part mated curve based di erent group respondent curve time ti based respondent age twhen interviewed leftmost curve includes data respondent rightmost includes oldest respondent relevant characteristic respondent changing time ne case likely marriage pattern di erent woman born di erent generation investigate e ect grouping respondent according decade birth group like ned date birth similar event called cohort di erences group called cohort e ect investigate cohort e ect nsfg marriage data gathered cycle data used book cycle data used section cycle data total datasets include respondent cohort e ect resps dataframe resp usecmbirth compute decade birth respondent date cm resp decade date cmbirth encoded integer number month december represents date timestamp object birth date instantiate dateoffset contains add result sequence timestamps converted datetimeindex finally extract year compute decade account sampling weight variability sampling error resample data group respondent decade plot survival curve range iters sample resp resp resps sample sample group decade estimatesurvivalbydecade group data nsfg cycle use di erent sampling weight sample separately use concat merge single dataframe parameter tellsconcat match respondent index instead creates new index estimatesurvivalbydecade plot survival curve cohort def estimatesurvivalbydecade resp group group hf sf estimatesurvival group sf figure show result pattern visible born married earliest successive cohort rying later later age chapter survival analysis age year figure survival curve respondent born di erent decade born follow surprising pattern prior age marrying slower rate predecessor age marrying faster age overtaken cohort age substantially likely married woman born turned ing newsweek article mentioned published tempting imagine article triggered marriage boom explanation pat possible article reaction indicative mood ected behavior cohort pattern cohort similar likely predecessor married age age caught previous cohort born likely marry age happens clear data wait cycle nsfg meantime make extrapolation extrapolation survival curve cohort end age cohort end age cohort hardly data extrapolate curve data previous cohort hazardfunction provides method extend copy tail longer hazardfunction class hazardfunction def extend self saw section hazardfunction contains series map t ndslast index selects value come later appends extend hazardfunction cohort using value predecessor def plotpredictionsbydecade group hf group group hf sf estimatesurvival group hf len hf hf enumerate hf hf sf sf group groupby object respondent grouped decade birth rst loop computes hazardfunction group second loop extends hazardfunction value sor contain value previous group chapter survival analysis age year figure survival curve respondent born di erent decade prediction later cohort convert hazardfunction survivalfunction plot figure show result removed cohort make diction visible result suggest age recent cohort converge cohort fewer married expected remaining lifetime given survival curve compute expected remaining lifetime function current age example given survival curve pregnancy length section compute expected time delivery rst step extract pmf lifetime survivalfunction provides method doe class survivalfunction def makepmf self pmf val prob expected remaining lifetime val prob cutoff filler pmf filler return pmf remember survivalfunction contains cdf lifetime loop copy value probability cdf pmf cutoff highest probability cdf cdf complete cdf incomplete plug provided value filler cap o cdf pregnancy length complete worry step compute expected remaining lifetime pected mean average survivalfunction provides method doe class survivalfunction def remaininglifetime self pmf d t sorted pmf t d t func pmf t return d remaininglifetime takesfiller passed makepmf func function used summarize distribution remaining lifetime pmfis pmf lifetime extracted survivalfunction dis dictionary contains result map current age t expected remaining chapter survival analysis remaining weeksremaining pregnancy length age year remaining yearsyears marriage figure expected remaining pregnancy length left year rst marriage right loop iterates value pmf value tit computes conditional distribution lifetime given lifetime exceedst doe removing value pmf time renormalizing remaining value us func summarize conditional distribution example result mean pregnancy length given length exceeds subtracting twe mean remaining pregnancy length figure left show expected remaining pregnancy length tion current duration example week expected remaining duration week term week termination pregnancy rst trimester bring average curve drop slowly rst trimester week pected remaining lifetime dropped week curve drop faster week week week curve level o week time period expected remaining lifetime week pass destination get closer process expected remaining lifetime property called memoryless past e ect diction behavior mathematical basis infuriating mantra obstetrics nurse day figure right show median remaining time rst marriage function age girl median time rst marriage year curve decrease age median remaining time year increase age started year based data young woman decreasing remaining mechanical component property called nbue better used expectation meaning new expected longer woman older increasing remaining time rst marriage component property called ubne better new expectation older longer expected newborn cancer patient ubne life expectancy increase longer live example computed median mean cdf incomplete survival curve project respondent marry age age rst marriage woman unknown ca compute mean deal unknown value replacing special value represents nity make mean nity age median ned long remaining lifetime nite true age hard ne meaningful expected remaining lifetime code computes plot function func lambda pmf chapter survival analysis survival curve pregnancy length case use default value remaininglifetime survival curve age rst marriage func function take pmf computes median percentile exercise solution exercise exercise nsfg cycle variable cmdivorcx contains date divorce respondent rst marriage applicable encoded compute duration marriage ended divorce duration far marriage ongoing estimate hazard survival curve duration marriage use resampling account sampling weight plot data resamples visualize sampling error consider dividing respondent group decade birth sibly age rst marriage glossary analysis set method describing predicting lifetime generally time event occurs curve function map time t bility surviving past function function map tto fraction people alive twho die estimation algorithm estimating hazard survival glossary group subject ned event like date birth particular interval time e ect di erence cohort property expected remaining lifetime better used expectation property expected remaining lifetime better new expectation chapter survival analysischapter analytic method book focused computational method like simulation pling problem solved analytic solution faster present method chapter explain work end chapter make suggestion integrating computational analytic method exploratory data analysis code chapter information downloading working code section normal distribution motivating example let review problem section suppose scientist studying gorilla wildlife preserve having weighed gorilla nd sample mean kg sample standard deviation kg use xto estimate population mean standard error estimate answer question need sampling distribution tion approximated distribution simulating chapter analytic method weighing gorilla computing xfor simulated experiment mulating distribution estimate result approximation sampling distribution use sampling distribution compute standard error dence interval standard deviation sampling distribution standard error estimate example kg interval percentile sampling tribution dence interval run experiment time expect estimate fall interval time example ci kg calculation analytically advantage fact weight adult female gorilla roughly normally distributed normal distribution property make amenable ysis linear transformation addition explain mean need notation distribution quantity x normal parameter write symbol distributed script letter nstands linear transformation xi like whereaandbare real number family distribution closed linear transformation family normal distribution property normal distribution closed addition x y y special case x sampling distribution general draw nvalues ofxand add x sampling distribution need compute sampling distribution remember compute xby weighing ngorillas adding total weight dividing assume distribution gorilla weight x approximately normal weigh ngorillas total weight y distributed using equation divide n sample mean z distributed using equation distribution zis sampling distribution mean zis show xi unbiased estimate variance sampling distribution standard deviation sampling distribution standard error estimate example kg ni standard error kg result consistent estimated simulation faster compute use sampling distribution compute dence interval dence interval xi interval percentile sincezis normally distributed compute percentile evaluating inverse cdf closed form cdf normal distribution inverse fast numerical method implemented scipy chapter analytic method saw section provides wrapper function make scipy function little easier use def evalnormalcdfinverse p return p given probability p return corresponding percentile normal distribution parameter muandsigma dence interval compute percentile like run experiment time expect estimate x fall range time consistent result got simulation representing normal distribution make calculation easier ned class called normal represents normal distribution encodes equation previous section look like class normal object def self mu mu def self return n g g instantiate normal represents distribution gorilla weight dist normal dist n central limit theorem normal providessum take sample size n return tion sum nvalues using equation def sum self n return normal n n normal know multiply divide using equation def self factor return normal factor factor def self divisor return divisor self compute sampling distribution mean sample size standard deviation sampling distribution kg saw previous section finally normal provides percentile use compute dence interval answer got use normal class later need bit analysis central limit theorem saw previous section add value drawn normal distribution distribution sum normal distribution property add value drawn distribution sum doe generally analytic distribution add nvalues distribution distribution sum converges normal nincreases speci cally distribution value mean standard distribution sum approximately n chapter analytic method result central limit theorem clt useful tool statistical analysis come caveat value drawn independently correlated clt doe apply seldom problem practice value come distribution requirement relaxed value drawn distribution nite mean variance pareto distribution rate convergence depends skewness distribution sum exponential distribution converge small sum lognormal distribution require larger size central limit theorem explains prevalence normal distribution natural world characteristic living thing ected genetic environmental factor e ect additive istics measure sum large number small e ect distribution tends normal testing clt central limit theorem work doe let try experiment try exponential distribution def makeexposamples sample n sample beta n range iters n sample return sample makeexposamples generates sample sum exponential value use value shorthand exponential tion parameter distribution iters number sum testing clt explain function start inside work way time sequence nexponential value compute sum sample list sum length iters easy nanditers confused ni number term sum iters number sum compute order characterize distribution sum return value list n sample pair pair make normal probability plot def normalplotsamples sample n sample sample plot sample d n plot normalplotsamples take list pair makeexposamples erates row normal probability plot figure row show result distribution sum exponential normal probability plot straight line distribution sum approximately normal indistinguishable normal figure row show similar result lognormal distribution lognormal distribution generally skewed exponential butions distribution sum take longer converge normal probability plot near straight approximately normal pareto distribution skewed lognormal depending parameter pareto distribution nite mean variance result central limit theorem doe apply figure row show distribution sum pareto value normal probability plot far straight mentioned clt doe apply value correlated test generate correlated value exponential distribution chapter analytic method sum expo sum expo sum expo lognormal sum lognormal sum lognormal figure distribution sum exponential value row normal value row testing clt sum pareto sum pareto sum pareto correlated expo sum correlated expo sum correlated expo figure distribution sum pareto value row correlated exponential value row chapter analytic method algorithm generating correlated value generate correlated normal value use normal cdf transform value uniform use inverse exponential cdf transform uniform value exponential generatecorrelated return iterator nnormal value serial relationrho def generatecorrelated rho n x yield x sigma rho range x x rho sigma yield x rst value standard normal value subsequent value depends predecessor previous value x mean value x rho variance note take standard deviation second argument variance generateexpocorrelated take resulting sequence transforms exponential def generateexpocorrelated rho n normal list generatecorrelated rho n uniform normal expo uniform return expo normal list correlated normal value uniform sequence uniform value expo correlated sequence exponential value ppfstands point function inverse cdf figure row show distribution sum correlated nential value correlation slows rate convergence normal probability plot nearly straight clt doe strictly apply value correlated moderate correlation seldom problem applying clt experiment meant central limit theorem work happens doe let use applying clt central limit theorem useful let example section testing apparent di erence mean pregnancy length rst baby seen apparent di erence week live first delta remember logic hypothesis testing compute probability observed di erence null hypothesis small conclude observed di erence unlikely chance example null hypothesis distribution pregnancy length rst baby compute sampling distribution mean like samplingdistmean len first samplingdistmean len sampling distribution based population pool live birth samplingdistmean take sequence value sample size return normal object representing sampling tribution def samplingdistmean data n mean var dist normal mean var return n n mean andvarare mean variance data approximate distribution data normal distribution dist example data normally distributed approximation good compute n n sampling distribution mean nvalues data chapter analytic method normally distributed sampling distribution mean central limit theorem compute sampling distribution di erence mean thenormal class know perform subtraction using equation def self return normal compute sampling distribution di erence like dist n mean make sense expect sample distribution mean average variance sampling distribution normal provides prob evaluates normal cdf use prob compute probability di erence large delta null hypothesis delta mean test test compute normal distribution symmetric sum tail consistent estimate section correlation test section used permutation test correlation birth weight mother age statistically signi thing analytically method based mathematical result given variable normally distributed correlation test uncorrelated generate sample size n compute pearson lation r compute transformed correlation distribution ti student parameter distribution analytic distribution cdf computed using gamma function use result compute sampling distribution correlation null hypothesis generate uncorrelated sequence normal value distribution correlation studentcdf take sample size n return sampling distribution correlation def studentcdf n t p t r t n t return r p tsis numpy array value t transformed correlation pscontains corresponding probability computed using cdf student implemented scipy parameter df stand freedom wo explain term read http statistic tsto correlation r apply inverse form result sampling distribution runder null hypothesis ure show distribution distribution generated section resampling nearly identical actual distribution normal pearson correlation based sample mean variance central limit theorem based statistic normally distributed data figure observed correlation chapter analytic method t sample figure sampling distribution correlation uncorrelated normal variable occur variable actually uncorrelated using analytic bution compute just unlikely t r t compute value tthat corresponds evaluate result example demonstrates advantage analytic method compute small practice usually doe matter test section used statistic test die crooked statistic measure total normalized deviation expected value table test chi squared sample figure sampling distribution statistic fair die reason statistic widely used sampling bution null hypothesis analytic remarkable called distribution like cdf computed using gamma function scipy provides implementation distribution use compute sampling distribution statistic def chisquaredcdf n x p x return x p figure show analytic result distribution got resampling similar especially tail usually care use distribution compute observed test statistic result consistent result section chapter analytic method parameter distribution freedom case correct parameter wherenis size table choosing parameter tricky honest dent right generate like figure compare analytic result resampling result discussion book focus computational method like resampling tion method advantage analysis easier explain understand example topic introductory statistic class hypothesis testing student really understand think approach presented chapter null hypothesis computing test fundamental idea clearer robust versatile analytic method based assumption hold practice computational method require fewer assumption adapted extended easily debuggable analytic method like black box plug number spit result easy make subtle error hard dent result right hard nd problem computational method lend incremental development testing foster dence result drawback computational method slow taking account pro con recommend following process use computational method exploration nd tory answer run time acceptable stop run time acceptable look opportunity optimize using analytic method method exercise replacing computational method analytic method propriate use computational method basis comparison providing mutual validation computational analytic result vast majority problem worked did past step exercise solution exercise exercise section saw distribution adult weight approximately lognormal possible explanation weight person gain year proportional current weight case adult weight product large number multiplicative factor fn wherewis adult weight birth weight fiis weight gain factor yeari log product sum log factor logfn central limit theorem distribution log wi approximately normal large n implies distribution wi lognormal model phenomenon choose distribution fthat reasonable generate sample adult weight choosing random value distribution birth weight choosing sequence factor distribution f computing product value ni needed converge lognormal distribution exercise section used central limit theorem nd sampling distribution di erence mean null hypothesis sample drawn chapter analytic method use distribution nd standard error estimate dence interval approximately correct precise compute sampling distribution alternate hypothesis sample drawn di erent population compute distribution use calculate standard error dence interval di erence mean exercise recent stein et al investigate e ect intervention intended mitigate task allocation student engineering team intervention student responded survey asked rate contribution aspect class project scale intervention male student reported higher score gramming aspect project female student average men ported score standard error woman reported average standard error compute sampling distribution gender gap di erence mean test statistically signi given standard error estimated mean need know sample size gure sampling distribution intervention gender gap smaller average score men se average score woman se compute sampling distribution gender gap test finally estimate change gender gap sampling distribution change statistically signi persistent e ect intervention mitigate task allocation student engineering team proceeding ieee frontier education conference abstraction accuracy acf adam cecil addition closed adult height adult weight age age group aggregate alpha anaconda ix analysis analytic distribution analytic method anecdotal evidence apparent e ect artifact risk australia autocorrelation function average bar plot bayesian inference bayesian statistic behavioral risk factor surveillance betting pool bias rmation observer oversampling sampling selection biased coin biased estimator binary binary search binning birth time birth weight blue man group boolean bracket operator brfss brisbane bureau labor statistic cannabis casino categorical variable causal relationship index causation ccdf cdf complementary cdf cdf interpreting cdf inverse census bureau central limit theorem vi central moment central tendency century month distribution statistic test city size class size cleaning v clinically signi clone viii closed form clt vi determination cohort cohort e ect complementary cdf compression computational method vi dence interval rmation bias rmatory result continuous distribution contradiction proof contributor x control group control variable v controlled trial correct positive correlation v serial cost function counter covariance crooked die study cumulative distribution function cumulative probability cumulative product current population survey cycle data collection data mining dataframe date birth date range datetimeindex debugging vi decile degree freedom density dependent variable derivative descriptive statistic deviation diagnosis dice dictionary dictwrapper digitize discrete distribution discretize distribution v analytic empirical exponential gaussian lognormal normal pareto student t uniform weibull distribution framework distribution comparing divorce dot product dropna ect size electrical component empirical distribution endogenous variable equally spaced data error estimatedpdf estimation v estimator biased unbiased ethic ewma exogenous variable expected remaining lifetime explanatory variable exploration exploratory data analysis exponential distribution moving age extrapolation false negative false positive eld size fillbetween llna rst baby fitline tted value fork viii frequency index gaussian distribution gender gap generative process git viii github viii goodness t gorilla group blue man groupby hashable hazard function hazardfunction height hexbin plot hist histogram hockey hockey stick graph method hstack hypothesis testing v hypothesistest identical income incomplete information independent index indexer loc inf installation ix interarrival time internal class interpolation interquartile range interval dence inverse cdf inverse cdf algorithm ipython ix iq iterative solver iterator james joyce ramble janert philipp jitter join estimation kde kernel density estimation lag square t leastsquares length pregnancy likelihood line plot linear algebra linear t v linear square linear model linear regression linear relationship linear transformation loc indexer log odds logarithm logarithmic scale logistic regression logit function lognormal distribution longitudinal study mackay david marital status mass matplotlib ix maximum likelihood estimator mean di erence rolling mean error mean squared error meanvar measurement error mechanical component median medicine memoryless missing value mle mode model modeling error moment inertia moving average mse multiple birth multiple regression v multiple test nan national survey family growth natural experiment nbue newsweek newton method noise nonlinear normal normal distribution normal probability plot normalization nsfg null hypothesis numpy ix observer bias odds test ordinary square index orthogonal vector outlier oversampling vi panda ix parabola parameter pareto distribution pareto world pareto vilfredo patsy pdf pdf pearson correlation pearson median skewness pearson karl percent point function percentile percentile rank permutation permutation test plot bar line normal probability scatter pmf pmf point estimation poisson regression population power prediction predictive power preferential attachment pregnancy length price price weed probability probability density probability density function probability mass function product proof contradiction property proxy variable pseudo pumpkin pyplot quadratic model quantile quantize quartile query quintile race race time random module random number randomized controlled trial rank rank correlation raw data raw moment recode record regression regression analysis regression model regressionresults reindex relay race replacement repository viii representative resample resampling weighted resampling test residual respondent rmse rolling mean sample sample mean sample median sample size sample skewness sample variance samplerows sampling bias sampling distribution sampling error sampling weight sat saturation scatter plot scipy ix seasonality selection bias sensitivity serial correlation series sex sex ratio shape signi simple regression index simulation skewness slope smoothing soccer span spearman correlation spread spurious relationship sql squared residual standard deviation pooled standard error standard normal distribution standard score standardize standardized moment stationary model statistically signi statsmodels ix step function straight dope student study sum summary statistic survival analysis survival curve survival rate survivalfunction symmetric tail telephone sampling test test statistic theory thinkplot threshold tick time series transaction transparency treatment group trend trimester hypothesis true negative true positive test census bureau ubne unbiased estimator underpowered uniform distribution unit variance visualization v wealth weibull distribution weight adult birth pumpkin sample weighted resampling window wrapper xticks index