a solution to this exclusive queue problem. Song lyric performed by Shania Twain Basic synchronization patterns Queue Exclusive queue hint Here are the variables I used in my solution: Queue hint 1leaders followers 2mutex Semaphore( ) 3leader Queue Semaphore( ) 4follower Queue Semaphore( ) 5rendezvous Semaphore( ) leaders andfollowers are counters that keep track of the number of dancers of each kinds that are waiting. The mutex guarantees exclusive access to the counters. leader Queue andfollower Queue are the queues where dancers wait. rendezvous is used to check that both threads are done dancing. Basic synchronization patterns Queue Exclusive queue solution Here is the code for leaders: Queue solution (leaders) 1mutex.wait() 2if followers : followers-- follower Queue.signal() 5else: leaders mutex.signal() leader Queue.wait() 10dance() 11rendezvous.wait() 12mutex.signal() When a leader arrives, it gets the mutex that protects leaders and followers . If there is a follower waiting, the leader decrements followers , signals a follower, and then invokes dance, all before releasing mutex. That guarantees that there can be only one follower thread runnin gdanceconcurrently. If there are no followers waiting, the leader has to give up th e mutex before waiting on leader Queue . The code for followers is similar: Queue solution (followers) 1mutex.wait() 2if leaders : leaders-- leader Queue.signal() 5else: followers mutex.signal() follower Queue.wait() 10dance() 11rendezvous.signal() When a follower arrives, it checks for a waiting leader. If th ere is one, the follower decrements leaders, signals a leader, and executes dance, all without releasing mutex. Actually, in this case the follower neverreleasesmutex; the leader does. We don t have to keep track of which thread has th e mutex because we know that one of them does, and either