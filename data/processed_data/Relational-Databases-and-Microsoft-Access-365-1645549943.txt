Relational Datab ases an d Micr osoft A ccess 365 Relational Datab ases an d Micr osoft Access 365 RON MCF ADYEN Relation al Dat abases an d Micr osoft A ccess 365 b y Ron McF adyn is lic ensed un der a Creativ e Comm ons Attribution-NonC omm ercial- ShareAlik e 4.0 Int ernation al Lic ense , except wh ere oth erwise n oted. This w ork is lic ensed un der Cr eative Comm ons A ttribution-NonC omm ercial- Shar eAlik e 4.0 Int ernational Public Lic ense. T o view a c opy of this lic ense visit http://creativecomm ons. org/lic enses/b y-nc-sa/4 .0/. This w ork can be distr ibut ed in unm odified f orm for n on-comm ercial pur poses. Modified v ersions can be ma de an d distr ibut ed for n on-comm ercial pur poses pr ovided th ey are distr ibut ed un der th e sam e license as th e original. O ther uses requir e per mission of th e auth or. Contents PREF ACE ix Acknowledgem ents x 1. REL ATIONAL D ATABASES AND MS A CCESS 1.1 Relational Datab ases 3 1.2 Micr osoft A ccess 8 1.2.1 Modif ying Ro ws 13 1.2.2 Addin g Ne w Ro ws 14 1.2.3 Deletin g Ro ws 15 1.2.4 Table Design V iew 16 2. CREA TING T ABLES 2.1 Usin g Design V iew To Cr eate Tables 23 2.1.1: Data T ypes 25 2.1.2: Proper ties 28 2.1.3: Primar y Keys 33 3. CREA TING F ORMS 3.1: Usin g th e Form W izard 39 3.2: Modif ying th e Form 41 3.2.1: Addin g a But ton 42 3.2.2: Addin g a L abel 44 3.2.3: Addin g a C alculat ed F ield 45 4. MICROSOF T ACCESS QUERIES 4.1: Simple Quer y 49 4.2: Projec tion Quer y 53 4.3: Selec tion Quer y 55 4.4: Sor ting th e Resul t 57 4.5: An d 59 4.6: Or 60 4.7: Joins 62 5. REL ATIONSHIPS AND THE REL ATIONSHIPS T OOL 5.1: Int egrity 67 5.2: Relationships 68 5.2.1: On e-To-Man y 69 5.2.2: On e-To-One 71 5.2.3: Man y-To-Man y 72 6. MICROSOF T ACCESS QUERIES – AD VANCED 6.1: Logical E xpressions 77 6.1.1: An d 78 6.1.2: Or 79 6.1.3: Not 80 6.2: Quer y Oper ators 82 6.2.1: Lik e 83 6.2.2: In 85 6.3: Quer y Proper ties 87 6.3.1: Top V alues 88 6.3.2: Unique V alues 90 6.4: Totals Quer y 93 6.5: Parameter Quer y 99 6.6: Cr osstab Quer y 101 6.7: Action Quer ies 103 6.7.1: Mak e Table Quer y 104 6.7.2: Appen d Quer y 105 6.7.3: Delet e Quer y 106 6.7.4: Updat e Quer y 107 6.8: Inn er an d Out er Joins 109 6.8.1: Inn er Join 111 6.8.2: Out er Join 114 6.8.3: Cartesian P roduc t 117 6.8.4: Self -Join 118 6.8.5: Anti-Join 120 6.8.6: Non-E qui Join 122 6.9: SQL Selec t Stat ement 124 6.10: SQL Union an d Union All 127 7. ENTIT Y REL ATIONSHIP MODELLING 7.1: Intr oduc tion 131 7.2: Entities 135 7.2.1: Weak Entities 137 7.3: Attribut es 140 7.3.1: Atomic A ttribut es 141 7.3.2: Composit e Attribut es 142 7.3.3: Sin gle-Valued A ttribut es 143 7.3.4: Mul ti-Valued A ttribut es 144 7.3.5: Der ived A ttribut es 146 7.3.6: Key Attribut es 147 7.3.7: Partial K ey 149 7.3.8: Sur rogat e Key 152 7.3.9: Non-K ey Attribut es 153 7.3.10: Nulls 154 7.3.11: Domains 155 7.4: Relationships 156 7.4.1: Degr ee 157 7.4.2: Particip ation 158 7.4.3: Cardinalit y 159 7.4.4: Recur sive Relationships 162 7.4.5: Identif ying Relationships 164 8. MAP PING AN ERD T O A REL ATIONAL D ATABASE 8.1: Mappin g Rules 171 8.1.1: Entit y Types 172 8.1.2: Relationship T ypes 173 8.1.3: Attribut es 174 8.2: Examples 175 9. DATA DEFINITION L ANGU AGE (DDL) 9.1: Runnin g DDL in MS A ccess 181 9.2: Example 182 9.2.1: DDL C omman ds 183 9.2.2: Cr eating th e Datab ase 184 10. NORMALIZA TION 10.1: Functional Depen dencies 189 10.1.1: Keys an d Non-K eys 195 10.1.2: An omalies 196 10.1.3: Partial F unctional Depen dencies 198 10.1.4: Transitiv e Functional Depen dencies 200 10.2: Nor mal F orms 202 10.2.1: First Nor mal F orm(1NF) 203 10.2.2: Bo yce-Codd Nor mal F orm (BCNF ) 206 10.3: Summar y 214 APPENDIX A Forms In volvin g Mul tiple T ables 223 APPENDIX B B.1: Dr awing Super types an d Subt ypes on th e Red 231 B.2: Super types, Subt ypes an d Relationships 233 B.3: Super types, Subt ypes an d Attribut es 234 B.3.1: Discr iminat or A ttribut es 235 B.4: Mappin g Super types an d Subt ypes t o a Relational Datab ase 236 B.4.1: Relations F or All Entit y Types 238 B.4.2: Relations f or Bot tom-Most Entit y Types 242 B.4.3: On e Relation Repr esentin g th e Wh ole Hier archy 244 PREF ACE This t ext is a f ree intr oduc tory text that intr oduc es MS A ccess an d relational datab ase design. Th e motivation is t o suppor t an intr oduc tory datab ase s ystem c ourse whic h, to th e student , is eith er a ser vice course pr ovidin g an intr oduc tion t o datab ase c oncepts, or , as a pr erequisit e for m ore advanced study in th e field. Various t exts ha ve been used with som e suc cess but w ere felt lacking for various r easons suc h as: (1) bein g workbook st yle with e xtensiv e tut orial lessons, (2) bein g too focused on a t echnology , (3) having design mat erial that did n ot fit w ell with m ore advanced c ourses, an d (4) bein g so e xpensiv e that som e students opt ed n ot to pur chase. Our sec ond-year course has n o pr erequisit es an d is tak en b y students f rom v arious disciplin es. However, most students ar e regist ered in eith er a C omput er Scien ce major pr ogram or th e Comput er Scien ce min or. Students wh o enr oll in th e course obtain: ( 1) a w orking knowledge of a personal datab ase s ystem (MS A ccess), (2) k nowledge of SQL (pr imar ily th e Selec t stat ement), an d (3) a wareness of c oncepts an d techniques n ecessar y to datab ase design. Following this c ourse, students can tak e thir d- an d fourth-y ear courses in th e datab ase subjec t area. Th e coverage of Entit y Relationship Modellin g in th ose c ourses is b ased on th e Ch en notation – as is usual f or a cademic t exts. T o be c onsist ent with th ose high er-level courses th e sam e appr oach is used h ere. It is our opinion that man y students fin d normalization th eory a difficul t topic . Man y presentations on n ormal f orms ar e m ore complicat ed than n ecessar y (e. g., som e texts will giv e m ore than on e definition of som e normal f orms). Our appr oach has been lar gely m otivated b y wr itings of Chr is Date. W e ha ve attempt ed t o giv e a suitable intr oduc tion t o normalization th eory for th e beginnin g datab ase student an d to relate that mat erial to oth er topics suc h as entit y relationship dia grams. This v ersion in cludes t wo appen dices that c over: ▪ creating forms that displa y data in a p arent/c hild f ormat wh ere two tables ar e related via a on e-toman y relationship , and ▪ entit y-relationship m odelin g for super types an d subt ypes. PREF ACE | ix Acknowledgem ents This w ork is lic ensed un der Creative Comm ons A ttribution-NonC omm ercial-Shar eAlik e 4.0 Int ernational Public License. This w ork can be distr ibut ed in unm odified f orm for n on-c omm ercial pur poses. Modified v ersions can be made an d distr ibut ed for n on-c omm ercial pur poses pr ovided th ey are distr ibut ed un der th e sam e lic ense as the original. O ther uses r equir e per mission of th e auth or. The websit e for this book is http://www.acs.uwinnipeg. ca/rmcfadyen/Cr eativeComm ons/ This pr ojec t is ma de possible with fun ding by th e Go vernment of Ontar io an d thr ough eC ampusOntar io’s suppor t of th e V irtual L earning Str ategy. To le arn m ore about th e V irtual L earning Str ategy visit: https://vls.ecampusontar io.ca. x | Acknowledgem ents 1. REL ATIONAL D ATABASES AND MS ACCESS A database is an or ganiz ed c ollec tion of data. A datab ase ma y be on p aper , or, held in c omput er files suc h as spreadsheets or m ore formally in a soft ware system k nown as a c omput erized datab ase mana gem ent s ystem (for e xample: DB2 , db4 o, IMS , MS A ccess, MS SQL Ser ver, mySQL , Oracle, S ybase, T otal, V ersant). In this book we focus on Relational datab ases an d on e specific r elational datab ase s ystem: Micr osoft A ccess a vailable with Micr osoft 365. There are man y diff erent c omm ercial r elational datab ase s ystems an d what y ou le arn here will assist y ou in usin g th ose oth ers. Because MS A ccess is a w orkstation/per sonal s ystem it is a c onvenient s ystem f or beginn ers. 1. REL ATIONAL D ATABASES AND MS A CCESS | 1 1.1 Relational Datab ases Relational Datab ases w ere intr oduc ed b y E. F. Codd in 19691; Codd’ s 1970 paper2 is consider ed on e of the great paper s in C omput er Scien ce. We begin with a v ery small e xample: a datab ase with on e relation, th e list of emplo yees sh own in figur e 1.1. You sh ould n otice this look s just lik e a t wo-dim ensional table of r ows an d columns. Th e nam e of th e table is Emplo yees, e ach column of th e table has its o wn title, an d each row has th e sam e struc ture. Each row has a v alue f or emplo yee number , first nam e, last nam e, an d gen der. As tables of data appe ar in so man y pla ces (n ewspaper ar ticles, t extbook s, web p ages, et c.) it is v ery likely y ou ha ve seen an d used this r epresentation f or data pr eviously . Emplo yee ID First Nam e Last Nam e Gen der 123 Joe Smith Male 333 Jim Jones Male 456 April Smith Female 842 Jenn y Jones Female 777 Tom Lee Male Figur e 1.1: A list of emplo yees Let us assum e th e Emplo yees table in figur e 1.1 has on e row for e ach emplo yee wh o works for som e hypoth etical c omp any. Data k ept f or e ach emplo yee c ompr ises th eir emplo yee identification number , their fir st an d last nam es, an d th eir gen der. Inf ormation struc tured in tables is v ery concise; at a glan ce we can obtain useful inf ormation. According to th e datab ase design m ethodology in Information Modelin g an d Relation al Databases3, a datab ase design er must be able t o express struc tured inf ormation as verbaliz ations . A verbalization that fits th e inf ormation in on e row of th e Emplo yees table is: ▪ Emplo yee with ID … has a first name …, a last name …, and is of … gen der In verbalizations lik e this th e ellipses ar e pla ceholder s: we can use v alues f rom a sin gle r ow to create complet e stat ements that e xplain th e meanin g of a r ow. For example, ▪ Emplo yee with ID 123 has a fir st nam e Joe, a last nam e Smith, an d is of Male gen der ▪ Emplo yee with ID 3 33 has a fir st nam e Jim, a last nam e Jon es, an d is of Male gen der A similar appr oach to organizin g knowledge about data appe ars in th e literatur e on lit eracy. In th e Jour nal of Re ading se veral ar ticles b y Kirsch an d Mosenthal discuss th e organization of inf ormation and its c onceptualization as docum ent sent ences. In Buildin g Docum ents by Combinin g Simple Lists4, Kirsch an d Mosenthal pr esent an e xample b ased on inf ormation f rom Th e W orld Almana c and Book of F acts: 1980 (Ne wspaper Ent erprise A ssociation, p . 427). That data is r eproduc ed in figur e 1.2. 1.1 Relational Datab ases | 3 Magazin es Circulation TV Guide 19,547,763 Reader’s Digest 18,094,192 National Geogr aphic 10, 249,748 Better Hom es & Gar dens 8,007,202 Family Cir cle 7,611,5 78 Woman ‘s Da y 7,535,855 McCall’s 6,502,880 Figur e 1.2: Circulation of leading U.S. magazin es A major point th e auth ors mak e is that suc h inf ormation can be r e-conceptualiz ed as a ser ies of simple docum ent sent ences formed f rom a b asic docum ent sent ence. This docum ent sent ence expresses an un derstan ding of th e tabular data in natur al lan guage. The docum ent sent ence for figur e 1.2 is: ▪ Magazin e X has a circulation of Y. Kirsch an d Mosenthal use v ariables (X an d Y) to stan d for data that c omes from a table. T aking values f rom a r ow, we plug v alues f or X an d Y int o th e docum ent sent ence to obtain sent ence instantiations: ▪ TV Guide has a cir culation of 19 ,547,763. ▪ Reader’s Digest has a cir culation of 18 ,094,192. ▪ National Geogr aphic has a cir culation of 10 ,249,748. ▪ Better Hom es & Gar dens has a cir culation of 8 ,007,202. ▪ Family Cir cle has a cir culation of 7 ,611,5 78. ▪ Woman ’s Da y has a cir culation of 7 ,535,855. ▪ McCall’s has a cir culation of 6 ,502,880. Docum ent sent ences an d verbalization sent ences ar e essentially th e sam e. Both sent ences use natur al lan guage t o express in w ords th e m eanin g of tabular data. Wh ether on e is designin g datab ases or r eading struc tured inf ormation, it can be useful f or un derstan ding to re-formulat e data as stat ements in natur al lan guage. Let us be a bit f ormal f or a m oment. Comm ercial relation al datab ase s ystems ar e systems wh ere data is or ganiz ed int o relations . Figur e 1.3 shows the gen eral struc ture of a r elation. W e say a relation compr ises a set of tuples where each tuple has th e sam e number of attribut e values, where each attribut e value is tak en from som e correspon ding dom ain, and wh ere a domain r epresents a set of valid v alues f or an at tribut e. 4 | 1.1 Relational Datab ases Figur e 1.3: Gen eral struc ture of a r elation The Emplo yees table in figur e 1.1 can be c onsider ed a r elation of 5 tuples wh ere each tuple has 4 v alues dr awn from e ach of th e emplo yee identifier , first nam e, last nam e, an d gen der domains. Similar ly, we can sa y the lists compr ising th e Cir culation of le ading U.S. Ma gazin es in figur e 1.2 can be c onsider ed a r elation with 7 tuples each ha ving 2 at tribut e values. Relations ar e typically implem ented in c omm ercial datab ases as tabular struc tures compr ising rows an d a fixed number of c olumns. E verybody is f amiliar with tables as th ey are comm onpla ce in t extbook s, paper s, magazin es, et c. This simplicit y of r epresentation is on e reason wh y relational datab ases ha ve been v ery successful as r eposit ories for impor tant data. Exercises To design a datab ase, a datab ase en gineer n eeds t o fin d good r epresentations of h ow an organization uses data. Good sour ces in clude input f orms, r epor ts, w eb p ages, et c. A challen ge for datab ase design ers is t o fin d th ese sour ces an d int erpret th em. 1) Consider th e following table of pr oduc t information sold b y ABC F oods. V erbalize the inf ormation present ed. 1.1 Relational Datab ases | 5 Produc t ID Produc t Nam e Unit Price Units In–Stock 1 Black Tea $2.00 44 2 Green T ea $3.00 33 3 Vegetar ian L asagne $10.00 20 4 Cajun Se asonin g $11.00 29 5 Cranber ry Sauc e $21.00 0 2) Suppose th e following input f orm is used t o ent er conta ct information. V erbalize the inf ormation that is bein g collec ted: 3) Consider th e following repor t that th e Human Resour ces dep artment of ABC F oods must pr oduc e. Verbalize the inf ormation in that r epor t. 6 | 1.1 Relational Datab ases Emplo yee ID First Nam e Last Nam e Dep artment 1 John Smith Receivin g 2 Lee Daniels Sales 3 April Turner Sales 4 Thomas Trump Marketing 5 Lee Smith Marketing 1 Derivabilit y, Redun dancy, and Consist ency of Relations St ored in L arge Data Bank s; IBM Rese arch Repor t, 1969 . 2 A Relational Model of Data f or Large Shar ed Data Bank s; CACM 13, No . 6, Jun e 1970. 3 Information m odelin g an d relational datab ases, 2n d edition; T erry Halpin an d Tony Mor gan; Mor gan Kaufmann Publish ers; ISBN - 13 978-0-12-373568- 3. 4 Buildin g docum ents b y combinin g simple lists; Ir win S . Kirsch an d Peter B . Mosenthal; Jour nal of Re ading, Vol. 33, No . 2, pp. 132-134. 1.1 Relational Datab ases | 7 1.2 Micr osoft A ccess MS A ccess is a r elational datab ase s ystem f or w orkstations that run th e Micr osoft W indows oper ating system. MS A ccess is t ypically used b y individuals f or data th ey use per sonally , but in som e situations a sin gle MS A ccess datab ase ma y be used b y a gr oup of people or small dep artment. MS A ccess datab ases ar e stored in a sin gle file that has a file suffix of “ .accdb” or “ .mdb”. Datab ases created usin g MS A ccess 2 007 an d lat er ha ve a file suffix “ .accdb”, and datab ases cr eated usin g MS Access 2 003 or e arlier ha ve a file suffix “ .mdb”. We will be usin g datab ases wh ere th e files ha ve nam es en ding in “ .accdb”. You n eed t o use MS A ccess 2 007 or lat er to open th ese datab ases. W e have used A ccess a vailable in Micr osoft 365. Our fir st sample datab ase is in a file nam ed Libr ary.accdb; this datab ase is a vailable f rom th e websit e associat ed with this t ext. To use this datab ase, y ou must fir st do wnlo ad th e file c ontainin g th e datab ase, an d th en eith er: ▪ Navigat e to its location in F ile E xplor er, and open th e datab ase b y double -clicking th e file nam e. Figur e 1.4: Double -click the dat abase file t o open th e sample database ▪ Star t Access an d th en br owse to th e folder h oldin g th e datab ase, selec t it, and open it . Selec t Open in A ccess: 8 | 1.2 Micr osoft A ccess Then br owse to th e location of th e datab ase file an d open th e file: Figur e 1.5: W ith A ccess st arted, br owse an d open th e dat abase When y ou open this datab ase, y ou see a list of objec ts (figur e 1.6) in th e datab ase; y ou will see three tables: Book , Loan, Member : 1.2 Micr osoft A ccess | 9 Figur e 1.6: Th e Hom e tab in MS A ccess sh ows you th e table n ames Double -click a table nam e an d MS A ccess opens th e table in Datasheet View; you can see th e contents of Book in figur e 1.7. The datash eet vie w for a table is e asily obtain ed, but it is n ot a particular ly user -friendly w ay to vie w an d mana ge data in a table. W e will le arn oth er w ays of handling data with MS A ccess F orms. Th e Book table has thr ee fields (i. e., at tribut es): callNo , title, auth or. Wh en w e vie w a table w e see data or ganiz ed int o rows an d columns. Th e data in on e row correspon ds to on e book; if th ere are 11 book s, th en w e ha ve a table of 11 r ows. Figur e 1.7: Dat asheet V iew of a t able The Book table c ontains on e row for each book in th e libr ary. We can v erbalize the content of a r ow as: 10 | 1.2 Micr osoft A ccess ▪ The book identified by call number … is titled … and is auth ored by … Substitutin g actual v alues f rom r ows we can mak e explicit stat ements suc h as: ▪ The book identified b y call number PC 14 V48 1965 is titled Medie val misc ellan y and is auth ored b y Freder ick Whit ehead ▪ The book identified b y call number QA 76.76 A65P7 6 2011 is titled Programmin g Android and is auth ored b y Zigur d R Medniek s Knowing that book s are identified b y their call number an d sin ce th e abo ve stat ements use th e conjun ction ‘and’, the abo ve verbalization can be e xpressed in an elem entar y form as: ▪ The book identified by call number … is titled … ▪ The book identified by call number … is auth ored by … Each of th ese e xpressions is c onsider ed elem entar y because e ach stat es on e fact about a specific book . We cann ot mak e these stat ements an y simpler . Of c ourse, w e can n ow substitut e values f rom th e table an d obtain: ▪ The book identified b y call number PC 14 V48 1965 is titled Medie val misc ellan y ▪ The book identified b y call number PC 14 V48 1965 is auth ored b y Freder ick Whit ehead ▪ The book identified b y call number QA 76.76 A65P7 6 2011 is titled Programmin g Android ▪ The book identified b y call number QA 76.76 A65P7 6 2011 is auth ored b y Zigur d R Medniek s At this point , expressin g verbalizations this w ay ma y seem tr ivial an d unn ecessar y, but th ey do ser ve a pur pose – th ey mak e it c lear that th e title an d th e auth or’s nam e serve only t o descr ibe a book , and that th e call number identifies th e book . An aim of a datab ase design er is t o un derstan d data requir ements in t erms of th ese elem entar y forms. We will ha ve more to say about this in a lat er chapt er. Up t o this point w e ha ve seen h ow to: ▪ open an MS A ccess datab ase; ▪ recogniz e the datab ase c ompr ises a number of tables; ▪ open a table t o see it displa yed as a c ollec tion of r ows an d columns; ▪ verbalize the inf ormation in a table. Next, we will e xamin e th e basic f eatur es of MS A ccess that allo w us t o change, inser t, and delet e data. 1.2 Micr osoft A ccess | 11 Exercises Recall that an elem entar y verbalization is on e wh ere the verbalization cann ot be simplified in an y fur ther w ay. Simpler stat ements w ould r esul t in a loss of inf ormation. 1) Re write the verbalization f or th e Emplo yees table usin g elem entar y verbalizations. 2) Is th e verbalization giv en for Circulation of Leadin g U.S. Magazin es in elem entar y form? 3) What elem entar y verbalizations apply t o th e Loan table in th e Libr ary datab ase? 4) What v erbalizations apply t o th e Member table in th e Libr ary datab ase? 5) View th e data in th e Loan table. E ach row in th e table c orrespon ds to a m ember bor rowing a book . Notic e how th e call number field c ontains v alues that appe ar in th e Book table an d how th e id field contains v alues that appe ar in th e Member table. All r ows ha ve a v alue f or th e dat e bor rowed field. Wh y would som e of th e dat e retur ned fields appe ar to ha ve no value at all? The web sit e for th ese n otes has a number of datab ases. Do wnlo ad th e Univ ersity datab ase an d examin e its c ontents. This datab ase c ontains inf ormation about dep artments an d courses in a fic tional univ ersity. Typically , a univ ersity is or ganiz ed int o faculties whic h compr ise dep artments an d th ose departments off er courses. F or instan ce, man y univ ersities ha ve a F aculty of Scien ce whic h itself ma y contain dep artments suc h as Math ematics, Statistics, an d Ph ysics. E ach of th ese dep artments will off er courses f or students t o tak e: Intr oduc tion t o Calculus, Intr oduc tion t o Statistics, Discr ete Math ematics, etc. 12 | 1.2 Micr osoft A ccess 1.2.1 Modif ying Ro ws With th e Book table open in MS A ccess an d with th e cur sor position ed in a r ow, try modifying th e data r ecorded f or that book . If you position th e mouse cur sor y ou can c hange th e value r ecorded for th e book’ s call number , title or auth or. Try doin g this – r emember y ou can alw ays do wnlo ad this datab ase a gain if y ou wish t o get b ack to what y ou star ted with. A s you begin m odifying a value (e. g., a ddin g an ‘s’ t o mak e th e last nam e Mat thews) an editin g symbol appe ars to th e left of th e row: Figur e 1.8: Editin g a r ow If you r ecogniz e that y ou ar e mak ing a mistak e you can un do y our editin g action b y pressin g th e Escape k ey. To mak e your c hange per man ent y ou must m ove th e cur sor t o an other row for th e updat e to be complet ed – wh en y ou do this, y ou will n ote the editin g symbol disappe ars. In som e situations, y ou will fin d MS A ccess pr ovides a f ormal Un do cap abilit y. Consider th e following figur e that sh ows an Un do ic on in th e upper left c orner that appe ared aft er Mat thew w as changed t o Mat thews an d th e cur sor m oved to th e next row: Figur e 1.9: Th e Un do ic on – c lick it an d th e last ac tion is un done 1.2.1 Modif ying Ro ws | 13 1.2.2 Addin g Ne w Ro ws Try addin g a n ew book t o th e Book table. Y ou can a dd a n ew book b y fir st clicking on th e Ne w Record but ton sh own n ear th e bot tom of th e win dow: Figur e 1.10: To add new record To complet e th e action of a ddin g a n ew book y ou must t ype v alues f or callNo , title, an d auth or. As a fir st example use a call number that does n ot appe ar for an y oth er book . As we will soon see the Book table is design ed in suc h a w ay that e ach book must ha ve a diff erent call number . Your addition will be suc cessful if y our book is giv en a call number that n o oth er book has. Wh en y ou a dd a new row, you must m ove the cur sor out of th e row for th e addition t o be c omplet ed. As a sec ond example tr y to add a n ew book , but this tim e, use a call number that alr eady appe ars in th e table. In this case MS A ccess will r ejec t your n ew record. Try this an d you will see a r esponse similar t o: Figur e 1.11: MS Access messa ge for duplicat e primar y key value The impor tant p art of this m essa ge for us is th e part that r efers to duplic ate values or duplic ate data. Wh en w e try to add a r ow with th e sam e call number as som e oth er row MS A ccess r efers to the duplicat ed call number v alue. Not e that y ou can pr ess th e Escape k ey to remove th e new row from th e table displa y. Soon w e discuss table design wh ere you will see that th e call number field is design ed to be th e primary key of th e Book table. Addin g a r ow to a table is also r eferred to as inser ting or appen ding a r ow. 14 | 1.2.2 Addin g Ne w Ro ws 1.2.3 Deletin g Ro ws You can r emove a book f rom th e table b y highlightin g a r ow (c lick in th e cell just t o th e left of a call number ) and th en pr ess th e Delet e key on th e keyboard: Figur e 1.12: Delet e a record: selec t, press delet e When y ou pr ess th e Delet e key MS A ccess will r espon d in on e of t wo w ays depen ding on whether or n ot th ere is an e xistin g reference to th e row you ar e trying to delet e: A reference to th e book does n ot appe ar in th e Loan table: Figur e 1.13: P rompt m essage A reference to th e book does appe ar in th e Loan table: Figur e 1.14: Prompt m essage When y ou vie w th e Loan table y ou can see th e book s that libr ary m ember s ha ve tak en out an d whether a book has been r etur ned. Ro ws in th e Loan table ha ve references to rows in th e Book table and to rows in th e Member table. Th e def ault action in MS A ccess is that a deletion is disallo wed if there is som e row in a table that has a r eference to it. So, we cann ot delet e a book if th ere is a L oan row referencing it. We ha ve br iefly sh own h ow to m odify, add an d delet e data in tables. Ne xt, we intr oduc e th e design per spec tive for tables. 1.2.3 Deletin g Ro ws | 15 1.2.4 Table Design V iew Up t o this point w e ha ve been openin g tables in Datash eet V iew wh ere we can vie w an d change data in r ows of a table. Wh en in Datash eet V iew w e can s witch from datash eet vie w to Design View by right -clicking on Book an d choosin g Design V iew (see figur e 1.13). Wh en th e Design V iew ic on is clicked, th e displa y changes t o reveal design inf ormation (see figur e 1.14). Figur e 1.15: Clic k on th e Design V iew Ic on to Switch to Design V iew When y ou c lick the Design V iew icon y ou will see th e displa y change as sh own in figur e 1.14 – y ou will see th e field nam es list ed alon g with th eir datatype, and according to th e field wh ere th e cur sor is locat ed y ou see other proper ties for that field. Datat ypes v ary som ewhat f rom on e datab ase s ystem t o an other, but of c ourse there are man y similar ities t oo. Proper ties ar e oth er characteristics that y ou can defin e for a field suc h as th e maximum len gth of v alues st ored for th e field. Gen erally, we want data in a datab ase t o be r easonable an d correct. We can use datat ypes an d proper ties t o achieve certain t ypes of c orrectness. C onsider th e following int egrity rules as rules we would lik e to enf orce: ▪ Call number s, titles, an d auth ors are alphanum eric. Any text you can t ype on th e keyboard is acceptable. ▪ Each call number must be unique (th ere can be n o duplicat es) ▪ Each book must ha ve a title ▪ A value f or call number must be n o more than 50 c haracters lon g ▪ A value f or title must be n o more than 25 5 characters lon g ▪ A value f or auth or must be n o more than 25 5 characters lon g ▪ The auth or field can be left out (it can be null). Now w e discuss h ow th ese int egrity rules ar e obtain ed in T able Design V iew. 16 | 1.2.4 Table Design V iew Figur e 1.16: T able Design V iew In figur e 1.14 th e cur sor is locat ed on th e callNo field; som e pr oper ties of callNo ar e cir cled and discussed belo w: ▪ Beside th e callNo field y ou can see th e key icon. This m eans th e callNo field is th e primary key. A primar y key is a unique identifier – e very row in th e table must ha ve a unique v alue in that field. Every table sh ould ha ve a PK specified an d th ere can be only on e PK for a table. Wh en a field is defin ed as th e PK th en a v alue must be pr ovided in e ach an d every row. ▪ The callNo field has a datat ype of Short Text and a field siz e of 50 . Any value y ou can t ype on th e keyboard is a cceptable but th e overall len gth, number of c haracters, is r estricted to at m ost 50 . ▪ The callNo field is indexed and in this case n o duplicat es ar e allo wed. Th e index construc ted b y MS Access is similar in pur pose t o th e index at th e back of an y book: th e index allo ws MS A ccess t o quic kly locat e a specified r ow. However, this in dex is diff erent f rom that at th e back of a book because it allo ws only on e entr y per in dexed v alue ( No Duplic ates is specified f or th e Indexed proper ty). E ach call number is unique. As you m ove the cur sor up an d do wn y ou sh ould n ote the following for this sample table: F or title: ▪ The title field has a datat ype of Short Text with a field siz e of 25 5. A t ext field can c ompr ise an y combination of let ters, digits, an d pun ctuation. An y value ent ered b y a user cann ot exceed 25 5 characters in len gth. ▪ A value is req